/*!
 * froala_editor v2.3.5 (https://www.froala.com/wysiwyg-editor)
 * License https://froala.com/wysiwyg-editor/terms/
 * Copyright 2014-2016 Froala Labs
 */
function invokeEditor(e,t){var e="#"+e;switch(t){case"solution":jQuery(e).froalaEditor({pasteDeniedAttrs:["class","id","style"],htmlRemoveTags:["script","style","base"],pluginsEnabled:["fullscreen","paragraphFormat","paragraphStyle","fontSize","fontFamily","colors","align","lists","image","imageManager","video","table","link","codeView","lineBreaker","codeInsert","pasteHandler","codeBeautifier","commonEvents","pasteToggler"],toolbarButtons:["paragraphFormat","fontFamily","fontSize","color","bold","italic","underline","strikethrough","paragraphStyle","|","align","|","formatOL","formatUL","outdent","indent","|","insertLink","insertTable","insertImage","insertVideo","codeInsert","insertHR","|","plainText","defaultFormatting","originalFormatting","|","html","fullscreen"],toolbarButtonsSM:null,toolbarButtonsMD:null,toolbarButtonsXS:null,fontFamily:{"'Andale Mono', AndaleMono, monospace":"Andale Mono","Arial,Helvetica,sans-serif":"Arial","'Arial Black',Gadget,sans-serif":"Arial Black","'Book Antiqua', Georgia, serif":"Book Antiqua","'Comic Sans MS', cursive, sans-serif":"Comic Sans MS","'Courier New', Courier, monospace":"Courier New","Georgia,serif":"Georgia","Helvetica,sans-serif":"Helvetica","Helvetica Neue":"Helvetica Neue","Impact,Charcoal,sans-serif":"Impact",Symbol:"Symbol","Tahoma,Geneva,sans-serif":"Tahoma","'Trebuchet MS', Helvetica, sans-serif":"Trebuchet MS","'Times New Roman',Times,serif":"Times New Roman","Terminal, monospace":"Terminal","Verdana,Geneva,sans-serif":"Verdana",Webdings:"Webdings",Windings:"Windings"},fontSize:["8","9","10","11","12","13","14","16","18","24","30","36","48","60","72","96"],toolbarSticky:!1,toolbarContainer:"#sticky_redactor_toolbar",tabSpaces:4,charCounterCount:!1,lineBreakerTags:["table","hr","form","dl","span.fr-video","pre"],linkInsertButtons:["linkBack","|"],linkEditButtons:["linkOpen","linkEdit","linkRemove"],imageUploadURL:"/solutions_uploaded_images",imageUploadMethod:"POST",imageUploadParam:"image[uploaded_data]",imageUploadParams:{_uniquekey:(new Date).getTime(),authenticity_token:jQuery('[name="csrf-token"]').attr("content")},imageManagerLoadURL:"/solutions_uploaded_images",imageManagerLoadMethod:"GET",sanitizeType:"solution"})}}!function(e){"function"==typeof define&&define.amd?define(["jquery"],e):"object"==typeof module&&module.exports?module.exports=function(t,i){return void 0===i&&(i="undefined"!=typeof window?require("jquery"):require("jquery")(t)),e(i),i}:e(jQuery)}(function(e){"use strict";var t=function(i,n){this.id=++e.FE.ID,this.opts=e.extend(!0,{},e.extend({},t.DEFAULTS,"object"==typeof n&&n));var r=JSON.stringify(this.opts);e.FE.OPTS_MAPPING[r]=e.FE.OPTS_MAPPING[r]||this.id,this.sid=e.FE.OPTS_MAPPING[r],e.FE.SHARED[this.sid]=e.FE.SHARED[this.sid]||{},this.shared=e.FE.SHARED[this.sid],this.shared.count=(this.shared.count||0)+1,this.$oel=e(i),this.$oel.data("froala.editor",this),this.o_doc=i.ownerDocument,this.o_win="defaultView"in this.o_doc?this.o_doc.defaultView:this.o_doc.parentWindow;var s=e(this.o_win).scrollTop();this.$oel.on("froala.doInit",e.proxy(function(){this.$oel.off("froala.doInit"),this.doc=this.$el.get(0).ownerDocument,this.win="defaultView"in this.doc?this.doc.defaultView:this.doc.parentWindow,this.$doc=e(this.doc),this.$win=e(this.win),this.opts.pluginsEnabled||(this.opts.pluginsEnabled=Object.keys(e.FE.PLUGINS)),this.opts.initOnClick?(this.load(e.FE.MODULES),this.$el.on("touchstart.init",function(){e(this).data("touched",!0)}),this.$el.on("touchmove.init",function(){e(this).removeData("touched")}),this.$el.on("mousedown.init touchend.init dragenter.init focus.init",e.proxy(function(t){if("touchend"==t.type&&!this.$el.data("touched"))return!0;if(1===t.which||0===t.which){this.$el.off("mousedown.init touchstart.init touchmove.init touchend.init dragenter.init focus.init"),this.load(e.FE.MODULES),this.load(e.FE.PLUGINS);var i=t.originalEvent&&t.originalEvent.originalTarget;i&&"IMG"==i.tagName&&e(i).trigger("mousedown"),"undefined"==typeof this.ul&&this.destroy(),"touchend"==t.type&&this.image&&t.originalEvent&&t.originalEvent.target&&e(t.originalEvent.target).is("img")&&setTimeout(e.proxy(function(){this.image.edit(e(t.originalEvent.target))},this),100),this.events.trigger("initialized")}},this))):(this.load(e.FE.MODULES),this.load(e.FE.PLUGINS),e(this.o_win).scrollTop(s),"undefined"==typeof this.ul&&this.destroy(),this.events.trigger("initialized"))},this)),this._init()};t.DEFAULTS={initOnClick:!1,pluginsEnabled:null},t.MODULES={},t.PLUGINS={},t.VERSION="2.3.5",t.INSTANCES=[],t.OPTS_MAPPING={},t.SHARED={},t.ID=0,t.prototype._init=function(){var t=this.$oel.prop("tagName"),i=e.proxy(function(){this._original_html=this._original_html||this.$oel.html(),this.$box=this.$box||this.$oel,this.opts.fullPage&&(this.opts.iframe=!0),this.opts.iframe?(this.$iframe=e('<iframe src="about:blank" frameBorder="0">'),this.$wp=e("<div></div>"),this.$box.html(this.$wp),this.$wp.append(this.$iframe),this.$iframe.get(0).contentWindow.document.open(),this.$iframe.get(0).contentWindow.document.write("<!DOCTYPE html>"),this.$iframe.get(0).contentWindow.document.write("<html><head></head><body></body></html>"),this.$iframe.get(0).contentWindow.document.close(),this.$el=this.$iframe.contents().find("body"),this.$head=this.$iframe.contents().find("head"),this.$html=this.$iframe.contents().find("html"),this.iframe_document=this.$iframe.get(0).contentWindow.document,this.$oel.trigger("froala.doInit")):(this.$el=e("<div></div>"),this.$wp=e("<div></div>").append(this.$el),this.$box.html(this.$wp),this.$oel.trigger("froala.doInit"))},this),n=e.proxy(function(){this.$box=e("<div>"),this.$oel.before(this.$box).hide(),this._original_html=this.$oel.val(),this.$oel.parents("form").on("submit."+this.id,e.proxy(function(){this.events.trigger("form.submit")},this)),this.$oel.parents("form").on("reset."+this.id,e.proxy(function(){this.events.trigger("form.reset")},this)),i()},this),r=e.proxy(function(){this.$el=this.$oel,this.$el.attr("contenteditable",!0).css("outline","none").css("display","inline-block"),this.opts.multiLine=!1,this.opts.toolbarInline=!1,this.$oel.trigger("froala.doInit")},this),s=e.proxy(function(){this.$el=this.$oel,this.opts.toolbarInline=!1,this.$oel.trigger("froala.doInit")},this),o=e.proxy(function(){this.$el=this.$oel,this.opts.toolbarInline=!1,this.$oel.on("click.popup",function(e){e.preventDefault()}),this.$oel.trigger("froala.doInit")},this);this.opts.editInPopup?o():"TEXTAREA"==t?n():"A"==t?r():"IMG"==t?s():"BUTTON"==t||"INPUT"==t?(this.opts.editInPopup=!0,this.opts.toolbarInline=!1,o()):i()},t.prototype.load=function(t){for(var i in t)if(t.hasOwnProperty(i)){if(this[i])continue;if(e.FE.PLUGINS[i]&&this.opts.pluginsEnabled.indexOf(i)<0)continue;if(this[i]=new t[i](this),this[i]._init&&(this[i]._init(),this.opts.initOnClick&&"core"==i))return!1}},t.prototype.destroy=function(){this.shared.count--,this.events.$off();var t=this.html.get();if(this.events.trigger("destroy",[],!0),this.events.trigger("shared.destroy",void 0,!0),0===this.shared.count){for(var i in this.shared)this.shared.hasOwnProperty(i)&&(null==this.shared[i],e.FE.SHARED[this.sid][i]=null);e.FE.SHARED[this.sid]={}}this.$oel.parents("form").off("."+this.id),this.$oel.off("click.popup"),this.$oel.removeData("froala.editor"),this.$oel.off("froalaEditor"),this.core.destroy(t),e.FE.INSTANCES.splice(e.FE.INSTANCES.indexOf(this),1)},e.fn.froalaEditor=function(i){for(var n=[],r=0;r<arguments.length;r++)n.push(arguments[r]);if("string"==typeof i){var s=[];return this.each(function(){var t=e(this),r=t.data("froala.editor");if(!r)return console.warn("Editor should be initialized before calling the "+i+" method.");var o,a;if(i.indexOf(".")>0&&r[i.split(".")[0]]?(r[i.split(".")[0]]&&(o=r[i.split(".")[0]]),a=i.split(".")[1]):(o=r,a=i.split(".")[0]),!o[a])return e.error("Method "+i+" does not exist in Froala Editor.");var l=o[a].apply(r,n.slice(1));void 0===l?s.push(this):0===s.length&&s.push(l)}),1==s.length?s[0]:s}return"object"!=typeof i&&i?void 0:this.each(function(){var n=e(this).data("froala.editor");if(!n){var r=this;new t(r,i)}})},e.fn.froalaEditor.Constructor=t,e.FroalaEditor=t,e.FE=t,e.FE.MODULES.node=function(t){function i(t){return t&&"IFRAME"!=t.tagName?e(t).contents():[]}function n(t){return t?t.nodeType!=Node.ELEMENT_NODE?!1:e.FE.BLOCK_TAGS.indexOf(t.tagName.toLowerCase())>=0:!1}function r(r,s){if(e(r).find("table").length>0)return!1;if(r.querySelectorAll(e.FE.VOID_ELEMENTS.join(",")).length-r.querySelectorAll("br").length)return!1;if(r.querySelectorAll(t.opts.htmlAllowedEmptyTags.join(":not(.fr-marker),")+":not(.fr-marker)").length)return!1;if(r.querySelectorAll(e.FE.BLOCK_TAGS.join(",")).length>1)return!1;if(r.querySelectorAll(t.opts.htmlDoNotWrapTags.join(":not(.fr-marker),")+":not(.fr-marker)").length)return!1;var o=i(r);1==o.length&&n(o[0])&&(o=i(o[0]));for(var a=!1,l=0;l<o.length;l++){var c=o[l];if(!(s&&e(c).hasClass("fr-marker")||c.nodeType==Node.TEXT_NODE&&0==c.textContent.length)){if("BR"!=c.tagName&&(c.textContent||"").replace(/\u200B/gi,"").replace(/\n/g,"").length>0)return!1;if(a)return!1;"BR"==c.tagName&&(a=!0)}}return!0}function s(i){for(;i&&i.parentNode!==t.$el.get(0)&&(!i.parentNode||!e(i.parentNode).hasClass("fr-inner"));)if(i=i.parentNode,n(i))return i;return null}function o(i,r,s){if("undefined"==typeof r&&(r=[]),"undefined"==typeof s&&(s=!0),r.push(t.$el.get(0)),r.indexOf(i.parentNode)>=0||i.parentNode&&e(i.parentNode).hasClass("fr-inner")||i.parentNode&&e.FE.SIMPLE_ENTER_TAGS.indexOf(i.parentNode.tagName)>=0&&s)return null;for(;r.indexOf(i.parentNode)<0&&i.parentNode&&!e(i.parentNode).hasClass("fr-inner")&&(e.FE.SIMPLE_ENTER_TAGS.indexOf(i.parentNode.tagName)<0||!s)&&(!n(i)||!n(i.parentNode)||!s);)i=i.parentNode;return i}function a(e){var t={},i=e.attributes;if(i)for(var n=0;n<i.length;n++){var r=i[n];t[r.nodeName]=r.value}return t}function l(e){for(var t="",i=a(e),n=Object.keys(i).sort(),r=0;r<n.length;r++){var s=n[r],o=i[s];t+=o.indexOf('"')<0?" "+s+'="'+o+'"':" "+s+"='"+o+"'"}return t}function c(e){for(var t=e.attributes,i=0;i<t.length;i++){var n=t[i];e.removeAttribute(n.nodeName)}}function d(e){return"<"+e.tagName.toLowerCase()+l(e)+">"}function u(e){return"</"+e.tagName.toLowerCase()+">"}function h(t,i){"undefined"==typeof i&&(i=!0);for(var n=t.previousSibling;n&&i&&e(n).hasClass("fr-marker");)n=n.previousSibling;return n?n.nodeType==Node.TEXT_NODE&&""===n.textContent?h(n):!1:!0}function p(t,i){"undefined"==typeof i&&(i=!0);for(var n=t.nextSibling;n&&i&&e(n).hasClass("fr-marker");)n=n.nextSibling;return n?n.nodeType==Node.TEXT_NODE&&""===n.textContent?p(n):!1:!0}function f(t){return t&&t.nodeType==Node.ELEMENT_NODE&&e.FE.VOID_ELEMENTS.indexOf((t.tagName||"").toLowerCase())>=0}function m(e){return e?["UL","OL"].indexOf(e.tagName)>=0:!1}function g(e){return e===t.$el.get(0)}function v(e){return e&&e.className&&(e.className||"").indexOf("fr-deletable")>=0}function _(e){return e===t.doc.activeElement&&(!t.doc.hasFocus||t.doc.hasFocus())&&!!(g(e)||e.type||e.href||~e.tabIndex)}function y(e){return(!e.getAttribute||"false"!=e.getAttribute("contenteditable"))&&["STYLE","SCRIPT"].indexOf(e.tagName)<0}return{isBlock:n,isEmpty:r,blockParent:s,deepestParent:o,rawAttributes:a,attributes:l,clearAttributes:c,openTagString:d,closeTagString:u,isFirstSibling:h,isLastSibling:p,isList:m,isElement:g,contents:i,isVoid:f,hasFocus:_,isEditable:y,isDeletable:v}},e.extend(e.FE.DEFAULTS,{htmlAllowedTags:["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","blockquote","br","button","canvas","caption","cite","code","col","colgroup","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","header","hgroup","hr","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","menu","menuitem","meter","nav","noscript","object","ol","optgroup","option","output","p","param","pre","progress","queue","rp","rt","ruby","s","samp","script","style","section","select","small","source","span","strike","strong","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","tr","track","u","ul","var","video","wbr"],htmlRemoveTags:["script","style"],htmlAllowedAttrs:["accept","accept-charset","accesskey","action","align","allowfullscreen","allowtransparency","alt","async","autocomplete","autofocus","autoplay","autosave","background","bgcolor","border","charset","cellpadding","cellspacing","checked","cite","class","color","cols","colspan","content","contenteditable","contextmenu","controls","coords","data","data-.*","datetime","default","defer","dir","dirname","disabled","download","draggable","dropzone","enctype","for","form","formaction","frameborder","headers","height","hidden","high","href","hreflang","http-equiv","icon","id","ismap","itemprop","keytype","kind","label","lang","language","list","loop","low","max","maxlength","media","method","min","mozallowfullscreen","multiple","name","novalidate","open","optimum","pattern","ping","placeholder","poster","preload","pubdate","radiogroup","readonly","rel","required","reversed","rows","rowspan","sandbox","scope","scoped","scrolling","seamless","selected","shape","size","sizes","span","src","srcdoc","srclang","srcset","start","step","summary","spellcheck","style","tabindex","target","title","type","translate","usemap","value","valign","webkitallowfullscreen","width","wrap"],htmlAllowComments:!0,fullPage:!1}),e.FE.HTML5Map={B:"STRONG",I:"EM",STRIKE:"S"},e.FE.MODULES.clean=function(t){function i(e){if(e.className&&e.className.indexOf("fr-marker")>=0)return!1;var n,r=t.node.contents(e),s=[];for(n=0;n<r.length;n++)r[n].nodeType!=Node.ELEMENT_NODE||t.node.isVoid(r[n])?r[n].nodeType==Node.TEXT_NODE&&(r[n].textContent=r[n].textContent.replace(/\u200b/g,"").replace(/&/g,"&amp;")):r[n].textContent.replace(/\u200b/g,"").length!=r[n].textContent.length&&i(r[n]);if(e.nodeType==Node.ELEMENT_NODE&&!t.node.isVoid(e)&&(e.normalize(),r=t.node.contents(e),s=e.querySelectorAll(".fr-marker"),0==r.length-s.length)){for(n=0;n<r.length;n++)if((r[n].className||"").indexOf("fr-marker")<0)return!1;for(n=0;n<s.length;n++)e.parentNode.insertBefore(s[n].cloneNode(!0),e);return e.parentNode.removeChild(e),!1}}function n(e){if(e.nodeType==Node.COMMENT_NODE)return"<!--"+e.nodeValue+"-->";if(e.nodeType==Node.TEXT_NODE)return e.textContent.replace(/\&/g,"&amp;").replace(/\</g,"&lt;").replace(/\>/g,"&gt;").replace(/\u00A0/g,"&nbsp;");if(e.nodeType!=Node.ELEMENT_NODE)return e.outerHTML;if(e.nodeType==Node.ELEMENT_NODE&&["STYLE","SCRIPT"].indexOf(e.tagName)>=0)return e.outerHTML;if("IFRAME"==e.tagName)return e.outerHTML;var i=e.childNodes;if(0===i.length)return e.outerHTML;for(var r="",s=0;s<i.length;s++)r+=n(i[s]);return t.node.openTagString(e)+r+t.node.closeTagString(e)}function r(e){return R=[],e=e.replace(/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,function(e){return R.push(e),"[FROALA.EDITOR.SCRIPT "+(R.length-1)+"]"}),e=e.replace(/<img((?:[\w\W]*?)) src="/g,'<img$1 data-fr-src="')}function s(e){return e=e.replace(/\[FROALA\.EDITOR\.SCRIPT ([\d]*)\]/gi,function(e,i){return t.opts.htmlRemoveTags.indexOf("script")>=0?"":R[parseInt(i,10)]}),e=e.replace(/<img((?:[\w\W]*?)) data-fr-src="/g,'<img$1 src="')}function o(e){var t;for(t in e)e.hasOwnProperty(t)&&(t.match(O)||delete e[t]);for(var i="",n=Object.keys(e).sort(),r=0;r<n.length;r++)t=n[r],i+=e[t].indexOf('"')<0?" "+t+'="'+e[t]+'"':" "+t+"='"+e[t]+"'";return i}function a(e,i,n){if(t.opts.fullPage){var r=t.html.extractDoctype(n),s=o(t.html.extractNodeAttrs(n,"html"));i=null==i?t.html.extractNode(n,"head")||"<title></title>":i;var a=o(t.html.extractNodeAttrs(n,"head")),l=o(t.html.extractNodeAttrs(n,"body"));return r+"<html"+s+"><head"+a+">"+i+"</head><body"+l+">"+e+"</body></html>"}return e}function l(i,r){var s=e("<div>"+i+"</div>"),o="";if(s){for(var a=t.node.contents(s.get(0)),l=0;l<a.length;l++)r(a[l]);a=t.node.contents(s.get(0));for(var l=0;l<a.length;l++)o+=n(a[l])}return o}function c(e,i,n){e=r(e);var o=e,c=null;if(t.opts.fullPage){var o=t.html.extractNode(e,"body")||(e.indexOf("<body")>=0?"":e);n&&(c=t.html.extractNode(e,"head")||"")}o=l(o,i),c&&(c=l(c,i));var d=a(o,c,e);return s(d)}function d(e){return e.replace(/\u200b/g,"").length==e.length?e:t.clean.exec(e,i)}function u(){var i=t.$el.get(0).querySelectorAll(Object.keys(e.FE.HTML5Map).join(","));if(i.length){var n=!1;0==t.$el.get(0).querySelectorAll(".fr-marker").length&&(t.selection.save(),n=!0);for(var r=0;r<i.length;r++)""===t.node.attributes(i[r])&&e(i[r]).replaceWith("<"+e.FE.HTML5Map[i[r].tagName]+">"+i[r].innerHTML+"</"+e.FE.HTML5Map[i[r].tagName]+">");n&&t.selection.restore()}}function h(i){if("SPAN"==i.tagName&&(i.className||"").indexOf("fr-marker")>=0)return!1;if("PRE"==i.tagName&&f(i),i.nodeType==Node.ELEMENT_NODE&&(i.getAttribute("data-fr-src")&&i.setAttribute("data-fr-src",t.helpers.sanitizeURL(i.getAttribute("data-fr-src"))),i.getAttribute("href")&&i.setAttribute("href",t.helpers.sanitizeURL(i.getAttribute("href"))),["TABLE","TBODY","TFOOT","TR"].indexOf(i.tagName)>=0&&(i.innerHTML=i.innerHTML.trim())),!t.opts.pasteAllowLocalImages&&i.nodeType==Node.ELEMENT_NODE&&"IMG"==i.tagName&&i.getAttribute("data-fr-src")&&0==i.getAttribute("data-fr-src").indexOf("file://"))return i.parentNode.removeChild(i),!1;if(i.nodeType==Node.ELEMENT_NODE&&e.FE.HTML5Map[i.tagName]&&""===t.node.attributes(i)){var n=e.FE.HTML5Map[i.tagName],r="<"+n+">"+i.innerHTML+"</"+n+">";i.insertAdjacentHTML("beforebegin",r),i=i.previousSibling,i.parentNode.removeChild(i.nextSibling)}if(t.opts.htmlAllowComments||i.nodeType!=Node.COMMENT_NODE)if(i.tagName&&i.tagName.match(D))i.parentNode.removeChild(i);else if(i.tagName&&!i.tagName.match(E))i.outerHTML=i.innerHTML;else{var s=i.attributes;if(s)for(var o=s.length-1;o>=0;o--){var a=s[o];a.nodeName.match(O)||i.removeAttribute(a.nodeName)}}else 0!==i.data.indexOf("[FROALA.EDITOR")&&i.parentNode.removeChild(i)}function p(e){for(var i=t.node.contents(e),n=0;n<i.length;n++)i[n].nodeType!=Node.TEXT_NODE&&p(i[n]);h(e)}function f(e){var t=e.innerHTML;t.indexOf("\n")>=0&&(e.innerHTML=t.replace(/\n/g,"<br>"))}function m(i,n,r,s){"undefined"==typeof n&&(n=[]),"undefined"==typeof r&&(r=[]),"undefined"==typeof s&&(s=!1),i=i.replace(/\u0009/g,"");var o,a=e.merge([],t.opts.htmlAllowedTags);for(o=0;o<n.length;o++)a.indexOf(n[o])>=0&&a.splice(a.indexOf(n[o]),1);var l=e.merge([],t.opts.htmlAllowedAttrs);for(o=0;o<r.length;o++)l.indexOf(r[o])>=0&&l.splice(l.indexOf(r[o]),1);return l.push("data-fr-.*"),l.push("fr-.*"),E=new RegExp("^"+a.join("$|^")+"$","gi"),O=new RegExp("^"+l.join("$|^")+"$","gi"),D=new RegExp("^"+t.opts.htmlRemoveTags.join("$|^")+"$","gi"),i=c(i,p,!0)}function g(){for(var i=t.$el.get(0).querySelectorAll("blockquote + blockquote"),n=0;n<i.length;n++){var r=i[n];t.node.attributes(r)==t.node.attributes(r.previousSibling)&&(e(r).prev().append(e(r).html()),e(r).remove())}}function v(){for(var e=t.$el.get(0).querySelectorAll("tr"),i=0;i<e.length;i++){for(var n=e[i].children,r=!0,s=0;s<n.length;s++)if("TH"!=n[s].tagName){r=!1;break}if(0!=r&&0!=n.length){for(var o=e[i];o&&"TABLE"!=o.tagName&&"THEAD"!=o.tagName;)o=o.parentNode;var a=o;"THEAD"!=a.tagName&&(a=t.doc.createElement("THEAD"),o.insertBefore(a,o.firstChild)),a.appendChild(e[i])}}}function _(){var i=t.html.defaultTag();if(i)for(var n=t.$el.get(0).querySelectorAll("td > "+i+", th > "+i),r=0;r<n.length;r++)""===t.node.attributes(n[r])&&e(n[r]).replaceWith(n[r].innerHTML+"<br>")}function y(){v(),_()}function b(){var e=[],i=function(e){return!t.node.isList(e.parentNode)};do{if(e.length){var n=e[0],r=t.doc.createElement("ul");n.parentNode.insertBefore(r,n);do{var s=n;n=n.nextSibling,r.appendChild(s)}while(n&&"LI"==n.tagName)}e=[];for(var o=t.$el.get(0).querySelectorAll("li"),a=0;a<o.length;a++)i(o[a])&&e.push(o[a])}while(e.length>0)}function w(){for(var e=t.$el.get(0).querySelectorAll("ol + ol, ul + ul"),i=0;i<e.length;i++){var n=e[i];if(t.node.isList(n.previousSibling)&&t.node.openTagString(n)==t.node.openTagString(n.previousSibling)){for(var r=t.node.contents(n),s=0;s<r.length;s++)n.previousSibling.appendChild(r[s]);n.parentNode.removeChild(n)}}}function k(){var e,i=function(t){0===t.querySelectorAll("LI").length&&(e=!0,t.parentNode.removeChild(t))};do{e=!1;for(var n=t.$el.get(0).querySelectorAll("li:empty"),r=0;r<n.length;r++)n[r].parentNode.removeChild(n[r]);for(var s=t.$el.get(0).querySelectorAll("ul, ol"),r=0;r<s.length;r++)i(s[r])}while(e===!0)}function C(){for(var i=t.$el.get(0).querySelectorAll("ul > ul, ol > ol, ul > ol, ol > ul"),n=0;n<i.length;n++){var r=i[n],s=r.previousSibling;s&&("LI"==s.tagName?s.appendChild(r):e(r).wrap("<li></li>"))}}function x(){for(var i=t.$el.get(0).querySelectorAll("li > ul, li > ol"),n=0;n<i.length;n++){var r=i[n];if(r.nextSibling){var s=r.nextSibling,o=e("<li>");e(r.parentNode).after(o);do{var a=s;s=s.nextSibling,o.append(a)}while(s)}}}function A(){for(var i=t.$el.get(0).querySelectorAll("li > ul, li > ol"),n=0;n<i.length;n++){var r=i[n];if(t.node.isFirstSibling(r))e(r).before("<br/>");else if(r.previousSibling&&"BR"==r.previousSibling.tagName){for(var s=r.previousSibling.previousSibling;s&&e(s).hasClass("fr-marker");)s=s.previousSibling;s&&"BR"!=s.tagName&&e(r.previousSibling).remove()}}}function T(){for(var i=t.$el.get(0).querySelectorAll("li:empty"),n=0;n<i.length;n++)e(i[n]).remove()}function S(){for(var i=t.$el.get(0).querySelectorAll("ul, ol"),n=0;n<i.length;n++)for(var r=t.node.contents(i[n]),s=null,o=r.length-1;o>=0;o--)"LI"!=r[o].tagName?(s||(s=e("<li>"),s.insertBefore(r[o])),s.prepend(r[o])):s=null}function M(){b(),w(),k(),C(),x(),A(),S(),T()}function N(){t.opts.fullPage&&e.merge(t.opts.htmlAllowedTags,["head","title","style","link","base","body","html","meta"])}var E,D,O,R=[],R=[];return{_init:N,html:m,toHTML5:u,tables:y,lists:M,quotes:g,invisibleSpaces:d,exec:c}},e.FE.XS=0,e.FE.SM=1,e.FE.MD=2,e.FE.LG=3,e.FE.MODULES.helpers=function(t){function i(){var e,t,i=-1;return"Microsoft Internet Explorer"==navigator.appName?(e=navigator.userAgent,t=new RegExp("MSIE ([0-9]{1,}[\\.0-9]{0,})"),null!==t.exec(e)&&(i=parseFloat(RegExp.$1))):"Netscape"==navigator.appName&&(e=navigator.userAgent,t=new RegExp("Trident/.*rv:([0-9]{1,}[\\.0-9]{0,})"),null!==t.exec(e)&&(i=parseFloat(RegExp.$1))),i}function n(){var e={},t=i();if(t>0)e.msie=!0;else{var n=navigator.userAgent.toLowerCase(),r=/(edge)[ \/]([\w.]+)/.exec(n)||/(chrome)[ \/]([\w.]+)/.exec(n)||/(webkit)[ \/]([\w.]+)/.exec(n)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(n)||/(msie) ([\w.]+)/.exec(n)||n.indexOf("compatible")<0&&/(mozilla)(?:.*? rv:([\w.]+)|)/.exec(n)||[],s={browser:r[1]||"",version:r[2]||"0"};r[1]&&(e[s.browser]=!0),e.chrome?e.webkit=!0:e.webkit&&(e.safari=!0)}return e.msie&&(e.version=t),e}function r(){return/(iPad|iPhone|iPod)/g.test(navigator.userAgent)&&!a()}function s(){return/(Android)/g.test(navigator.userAgent)&&!a()}function o(){return/(Blackberry)/g.test(navigator.userAgent)}function a(){return/(Windows Phone)/gi.test(navigator.userAgent)}function l(){return s()||r()||o()}function c(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(e){window.setTimeout(e,1e3/60)}}function d(e){return parseInt(e,10)||0}function u(){var t=e('<div class="fr-visibility-helper"></div>').appendTo("body"),i=d(t.css("margin-left"));return t.remove(),i}function h(){return"ontouchstart"in window||window.DocumentTouch&&document instanceof DocumentTouch}function p(e){if(!/^(https?:|ftps?:|)\/\//i.test(e))return!1;e=String(e).replace(/</g,"%3C").replace(/>/g,"%3E").replace(/"/g,"%22").replace(/ /g,"%20");var t=/(http|ftp|https):\/\/[a-z\u00a1-\uffff0-9{}]+(\.[a-z\u00a1-\uffff0-9{}]*)*([a-z\u00a1-\uffff0-9.,@?^=%&amp;:\/~+#-_{}]*[a-z\u00a1-\uffff0-9@?^=%&amp;\/~+#-_{}])?/gi;return t.test(e)}function f(e){if(/^(https?:|ftps?:|)\/\//i.test(e)){if(!p(e)&&!p("http:"+e))return""}else e=encodeURIComponent(e).replace(/%23/g,"#").replace(/%2F/g,"/").replace(/%25/g,"%").replace(/mailto%3A/gi,"mailto:").replace(/file%3A/gi,"file:").replace(/sms%3A/gi,"sms:").replace(/tel%3A/gi,"tel:").replace(/notes%3A/gi,"notes:").replace(/data%3Aimage/gi,"data:image").replace(/blob%3A/gi,"blob:").replace(/webkit-fake-url%3A/gi,"webkit-fake-url:").replace(/%3F/g,"?").replace(/%3D/g,"=").replace(/%26/g,"&").replace(/&amp;/g,"&").replace(/%2C/g,",").replace(/%3B/g,";").replace(/%2B/g,"+").replace(/%40/g,"@").replace(/%5B/g,"[").replace(/%5D/g,"]").replace(/%7B/g,"{").replace(/%7D/g,"}");return e}function m(e){return e&&!e.propertyIsEnumerable("length")&&"object"==typeof e&&"number"==typeof e.length}function g(e){function t(e){return("0"+parseInt(e,10).toString(16)).slice(-2)}try{return e&&"transparent"!==e?/^#[0-9A-F]{6}$/i.test(e)?e:(e=e.match(/^rgb\((\d+),\s*(\d+),\s*(\d+)\)$/),("#"+t(e[1])+t(e[2])+t(e[3])).toUpperCase()):""}catch(i){return null}}function v(e){var t=/^#?([a-f\d])([a-f\d])([a-f\d])$/i;e=e.replace(t,function(e,t,i,n){return t+t+i+i+n+n});var i=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);return i?"rgb("+parseInt(i[1],16)+", "+parseInt(i[2],16)+", "+parseInt(i[3],16)+")":""}function _(t){var i=(t.css("text-align")||"").replace(/-(.*)-/g,"");if(["left","right","justify","center"].indexOf(i)<0){if(!w){var n=e('<div dir="auto" style="text-align: initial; position: fixed; left: -3000px;"><span id="s1">.</span><span id="s2">.</span></div>');e("body").append(n);var r=n.find("#s1").get(0).getBoundingClientRect().left,s=n.find("#s2").get(0).getBoundingClientRect().left;n.remove(),w=s>r?"left":"right"}i=w}return i}function y(){return null==k&&(k=navigator.platform.toUpperCase().indexOf("MAC")>=0),k}function b(){t.browser=n()}var w,k=null;return{_init:b,isIOS:r,isMac:y,isAndroid:s,isBlackberry:o,isWindowsPhone:a,isMobile:l,requestAnimationFrame:c,getPX:d,screenSize:u,isTouch:h,sanitizeURL:f,isArray:m,RGBToHex:g,HEXtoRGB:v,isURL:p,getAlignment:_}},e.FE.MODULES.events=function(t){function i(e,t,i){_(e,t,i)}function n(){i(t.$el,"cut copy paste beforepaste",function(e){w(e.type,[e])})}function r(){i(t.$el,"click mouseup mousedown touchstart touchend dragenter dragover dragleave dragend drop dragstart",function(e){w(e.type,[e])}),v("mousedown",function(){for(var i=0;i<e.FE.INSTANCES.length;i++)e.FE.INSTANCES[i]!=t&&e.FE.INSTANCES[i].popups&&e.FE.INSTANCES[i].popups.areVisible()&&e.FE.INSTANCES[i].$el.find(".fr-marker").remove()})}function s(){i(t.$el,"keydown keypress keyup input",function(e){w(e.type,[e])})}function o(){i(t.$win,t._mousedown,function(e){w("window.mousedown",[e]),p()}),i(t.$win,t._mouseup,function(e){w("window.mouseup",[e])}),i(t.$win,"cut copy keydown keyup touchmove touchend",function(e){w("window."+e.type,[e])})}function a(){i(t.$doc,"dragend drop",function(e){w("document."+e.type,[e])})}function l(i){if("undefined"==typeof i&&(i=!0),!t.$wp)return!1;if(t.helpers.isIOS()&&t.$win.get(0).focus(),!t.core.hasFocus()&&i){var n=t.$win.scrollTop();return t.$el.focus(),n!=t.$win.scrollTop()&&t.$win.scrollTop(n),!1}if(!t.core.hasFocus()||t.$el.find(".fr-marker").length>0)return!1;var r=t.selection.info(t.$el.get(0));if(r.atStart&&t.selection.isCollapsed()&&null!=t.html.defaultTag()){var s=t.markers.insert();if(s&&!t.node.blockParent(s)){e(s).remove();var o=t.$el.find(t.html.blockTagsQuery()).get(0);o&&(e(o).prepend(e.FE.MARKERS),t.selection.restore())}else s&&e(s).remove()}}function c(){i(t.$el,"focus",function(e){m()&&(l(!1),M===!1&&w(e.type,[e]))}),i(t.$el,"blur",function(e){m()&&M===!0&&(w(e.type,[e]),p())}),v("focus",function(){M=!0}),v("blur",function(){M=!1})}function d(){t.helpers.isMobile()?(t._mousedown="touchstart",t._mouseup="touchend",t._move="touchmove",t._mousemove="touchmove"):(t._mousedown="mousedown",t._mouseup="mouseup",t._move="",t._mousemove="mousemove")}function u(i){var n=e(i.currentTarget);return t.edit.isDisabled()||n.hasClass("fr-disabled")?(i.preventDefault(),!1):"mousedown"===i.type&&1!==i.which?!0:(t.helpers.isMobile()||i.preventDefault(),(t.helpers.isAndroid()||t.helpers.isWindowsPhone())&&0===n.parents(".fr-dropdown-menu").length&&(i.preventDefault(),i.stopPropagation()),n.addClass("fr-selected"),t.events.trigger("commands.mousedown",[n]),void 0)}function h(i,n){var r=e(i.currentTarget);if(t.edit.isDisabled()||r.hasClass("fr-disabled"))return i.preventDefault(),!1;if("mouseup"===i.type&&1!==i.which)return!0;if(!r.hasClass("fr-selected"))return!0;if("touchmove"!=i.type){if(i.stopPropagation(),i.stopImmediatePropagation(),i.preventDefault(),!r.hasClass("fr-selected"))return e(".fr-selected").removeClass("fr-selected"),!1;if(e(".fr-selected").removeClass("fr-selected"),r.data("dragging")||r.attr("disabled"))return r.removeData("dragging"),!1;var s=r.data("timeout");s&&(clearTimeout(s),r.removeData("timeout")),n.apply(t,[i])}else r.data("timeout")||r.data("timeout",setTimeout(function(){r.data("dragging",!0)},100))}function p(){T=!0}function f(){T=!1}function m(){return T}function g(e,i,n){_(e,t._mousedown,i,function(e){t.edit.isDisabled()||u(e)},!0),_(e,t._mouseup+" "+t._move,i,function(e){t.edit.isDisabled()||h(e,n)},!0),_(e,"mousedown click mouseup",i,function(e){t.edit.isDisabled()||e.stopPropagation()},!0),v("window.mouseup",function(){t.edit.isDisabled()||(e.find(i).removeClass("fr-selected"),p())})}function v(e,i,n){var r=e.split(" ");if(r.length>1){for(var s=0;s<r.length;s++)v(r[s],i,n);return!0}"undefined"==typeof n&&(n=!1);var o;o=0!=e.indexOf("shared.")?S[e]=S[e]||[]:t.shared._events[e]=t.shared._events[e]||[],n?o.unshift(i):o.push(i)}function _(e,i,n,r,s){"function"==typeof n&&(s=r,r=n,n=!1);var o=s?t.shared.$_events:N,a=s?t.sid:t.id;n?e.on(i.split(" ").join(".ed"+a+" ")+".ed"+a,n,r):e.on(i.split(" ").join(".ed"+a+" ")+".ed"+a,r),o.indexOf(e.get(0))<0&&o.push(e.get(0))}function y(t,i){for(var n=0;n<t.length;n++)e(t[n]).off(".ed"+i)}function b(){y(N,t.id),N=[],0==t.shared.count&&(y(t.shared.$_events,t.sid),t.shared.$_events=null)}function w(i,n,r){if(!t.edit.isDisabled()||r){var s;if(0!=i.indexOf("shared."))s=S[i];else{if(t.shared.count>0)return!1;s=t.shared._events[i]}var o;if(s)for(var a=0;a<s.length;a++)if(o=s[a].apply(t,n),o===!1)return!1;return o=t.$oel.triggerHandler("froalaEditor."+i,e.merge([t],n||[])),o===!1?!1:o}}function k(i,n,r){if(!t.edit.isDisabled()||r){var s;if(0!=i.indexOf("shared."))s=S[i];else{if(t.shared.count>0)return!1;s=t.shared._events[i]}var o;if(s)for(var a=0;a<s.length;a++)o=s[a].apply(t,[n]),"undefined"!=typeof o&&(n=o);return o=t.$oel.triggerHandler("froalaEditor."+i,e.merge([t],[n])),"undefined"!=typeof o&&(n=o),n}}function C(){for(var e in S)S.hasOwnProperty(e)&&delete S[e]}function x(){for(var e in t.shared._events)t.shared._events.hasOwnProperty(e)&&delete t.shared._events[e]}function A(){t.shared.$_events=t.shared.$_events||[],t.shared._events={},d(),r(),o(),a(),s(),c(),p(),n(),v("destroy",C),v("shared.destroy",x)}var T,S={},M=!1,N=[];return{_init:A,on:v,trigger:w,bindClick:g,disableBlur:f,enableBlur:p,blurActive:m,focus:l,chainTrigger:k,$on:_,$off:b}},e.FE.INVISIBLE_SPACE="&#8203;",e.FE.START_MARKER='<span class="fr-marker" data-id="0" data-type="true" style="display: none; line-height: 0;">'+e.FE.INVISIBLE_SPACE+"</span>",e.FE.END_MARKER='<span class="fr-marker" data-id="0" data-type="false" style="display: none; line-height: 0;">'+e.FE.INVISIBLE_SPACE+"</span>",e.FE.MARKERS=e.FE.START_MARKER+e.FE.END_MARKER,e.FE.MODULES.markers=function(t){function i(i,n){return e('<span class="fr-marker" data-id="'+n+'" data-type="'+i+'" style="display: '+(t.browser.safari?"none":"inline-block")+'; line-height: 0;">'+e.FE.INVISIBLE_SPACE+"</span>",t.doc)[0]}function n(n,r,s){try{var o=n.cloneRange();if(o.collapse(r),o.insertNode(i(r,s)),r===!0&&n.collapsed)for(var a=t.$el.find('span.fr-marker[data-type="true"][data-id="'+s+'"]'),l=a.get(0).nextSibling;l&&l.nodeType===Node.TEXT_NODE&&0===l.textContent.length;)e(l).remove(),l=a.nextSibling;if(r===!0&&!n.collapsed){var a=t.$el.find('span.fr-marker[data-type="true"][data-id="'+s+'"]').get(0),l=a.nextSibling;if(l&&l.nodeType===Node.ELEMENT_NODE&&t.node.isBlock(l)){var c=[l];do l=c[0],c=t.node.contents(l);while(c[0]&&t.node.isBlock(c[0]));e(l).prepend(e(a))}}if(r===!1&&!n.collapsed){var a=t.$el.find('span.fr-marker[data-type="false"][data-id="'+s+'"]').get(0),l=a.previousSibling;if(l&&l.nodeType===Node.ELEMENT_NODE&&t.node.isBlock(l)){var c=[l];do l=c[c.length-1],c=t.node.contents(l);while(c[c.length-1]&&t.node.isBlock(c[c.length-1]));e(l).append(e(a))}a.parentNode&&["TD","TH"].indexOf(a.parentNode.tagName)>=0&&a.parentNode.previousSibling&&!a.previousSibling&&e(a.parentNode.previousSibling).append(a)}var d=t.$el.find('span.fr-marker[data-type="'+r+'"][data-id="'+s+'"]').get(0);return d&&(d.style.display="none"),d}catch(u){return null
}}function r(){if(!t.$wp)return null;try{var i=t.selection.ranges(0),n=i.commonAncestorContainer;if(n!=t.$el.get(0)&&0==t.$el.find(n).length)return null;var r=i.cloneRange(),s=i.cloneRange();r.collapse(!0);var o=e('<span class="fr-marker" style="display: none; line-height: 0;">'+e.FE.INVISIBLE_SPACE+"</span>",t.doc)[0];if(r.insertNode(o),o=t.$el.find("span.fr-marker").get(0)){for(var a=o.nextSibling;a&&a.nodeType===Node.TEXT_NODE&&0===a.textContent.length;)e(a).remove(),a=t.$el.find("span.fr-marker").get(0).nextSibling;return t.selection.clear(),t.selection.get().addRange(s),o}return null}catch(l){console.warn("MARKER",l)}}function s(){t.selection.isCollapsed()||t.selection.remove();var i=t.$el.find(".fr-marker").get(0);if(null==i&&(i=r()),null==i)return null;var n;if(n=t.node.deepestParent(i))if(t.node.isBlock(n)&&t.node.isEmpty(n))e(n).replaceWith('<span class="fr-marker"></span>');else{var s=i,o="",a="";do s=s.parentNode,o+=t.node.closeTagString(s),a=t.node.openTagString(s)+a;while(s!=n);e(i).replaceWith('<span id="fr-break"></span>');var l=t.node.openTagString(n)+e(n).html()+t.node.closeTagString(n);l=l.replace(/<span id="fr-break"><\/span>/g,o+'<span class="fr-marker"></span>'+a),e(n).replaceWith(l)}return t.$el.find(".fr-marker").get(0)}function o(e){var i=e.clientX,n=e.clientY;a();var s,o=null;if("undefined"!=typeof t.doc.caretPositionFromPoint?(s=t.doc.caretPositionFromPoint(i,n),o=t.doc.createRange(),o.setStart(s.offsetNode,s.offset),o.setEnd(s.offsetNode,s.offset)):"undefined"!=typeof t.doc.caretRangeFromPoint&&(s=t.doc.caretRangeFromPoint(i,n),o=t.doc.createRange(),o.setStart(s.startContainer,s.startOffset),o.setEnd(s.startContainer,s.startOffset)),null!==o&&"undefined"!=typeof t.win.getSelection){var l=t.win.getSelection();l.removeAllRanges(),l.addRange(o)}else if("undefined"!=typeof t.doc.body.createTextRange)try{o=t.doc.body.createTextRange(),o.moveToPoint(i,n);var c=o.duplicate();c.moveToPoint(i,n),o.setEndPoint("EndToEnd",c),o.select()}catch(d){return!1}r()}function a(){t.$el.find(".fr-marker").remove()}return{place:n,insert:r,split:s,insertAtPoint:o,remove:a}},e.FE.MODULES.selection=function(t){function i(){var e="";return t.win.getSelection?e=t.win.getSelection():t.doc.getSelection?e=t.doc.getSelection():t.doc.selection&&(e=t.doc.selection.createRange().text),e.toString()}function n(){var e="";return e=t.win.getSelection?t.win.getSelection():t.doc.getSelection?t.doc.getSelection():t.doc.selection.createRange()}function r(e){var i=n(),r=[];if(i&&i.getRangeAt&&i.rangeCount)for(var r=[],s=0;s<i.rangeCount;s++)r.push(i.getRangeAt(s));else r=t.doc.createRange?[t.doc.createRange()]:[];return"undefined"!=typeof e?r[e]:r}function s(){var e=n();try{e.removeAllRanges?e.removeAllRanges():e.empty?e.empty():e.clear&&e.clear()}catch(t){}}function o(){var s=n();try{if(s.rangeCount){var o=r(0),a=o.startContainer;if(a.nodeType==Node.TEXT_NODE&&o.startOffset==(a.textContent||"").length&&a.nextSibling&&(a=a.nextSibling),a.nodeType==Node.ELEMENT_NODE){var l=!1;if(a.childNodes.length>0&&a.childNodes[o.startOffset]){for(var c=a.childNodes[o.startOffset];c&&c.nodeType==Node.TEXT_NODE&&0==c.textContent.length;)c=c.nextSibling;if(c&&c.textContent.replace(/\u200B/g,"")===i().replace(/\u200B/g,"")&&(a=c,l=!0),!l&&a.childNodes.length>1&&o.startOffset>0&&a.childNodes[o.startOffset-1]){for(var c=a.childNodes[o.startOffset-1];c&&c.nodeType==Node.TEXT_NODE&&0==c.textContent.length;)c=c.nextSibling;c&&c.textContent.replace(/\u200B/g,"")===i().replace(/\u200B/g,"")&&(a=c,l=!0)}}else if(!o.collapsed&&a.nextSibling&&a.nextSibling.nodeType==Node.ELEMENT_NODE){var c=a.nextSibling;c&&c.textContent.replace(/\u200B/g,"")===i().replace(/\u200B/g,"")&&(a=c,l=!0)}!l&&a.childNodes.length>0&&e(a.childNodes[0]).text().replace(/\u200B/g,"")===i().replace(/\u200B/g,"")&&["BR","IMG","HR"].indexOf(a.childNodes[0].tagName)<0&&(a=a.childNodes[0])}for(;a.nodeType!=Node.ELEMENT_NODE&&a.parentNode;)a=a.parentNode;for(var d=a;d&&"HTML"!=d.tagName;){if(d==t.$el.get(0))return a;d=e(d).parent()[0]}}}catch(u){}return t.$el.get(0)}function a(){var s=n();try{if(s.rangeCount){var o=r(0),a=o.endContainer;if(a.nodeType==Node.ELEMENT_NODE){var l=!1;if(a.childNodes.length>0&&a.childNodes[o.endOffset]&&e(a.childNodes[o.endOffset]).text()===i())a=a.childNodes[o.endOffset],l=!0;else if(!o.collapsed&&a.previousSibling&&a.previousSibling.nodeType==Node.ELEMENT_NODE){var c=a.previousSibling;c&&c.textContent.replace(/\u200B/g,"")===i().replace(/\u200B/g,"")&&(a=c,l=!0)}else if(!o.collapsed&&a.childNodes.length>0&&a.childNodes[o.endOffset]){var c=a.childNodes[o.endOffset].previousSibling;c.nodeType==Node.ELEMENT_NODE&&c&&c.textContent.replace(/\u200B/g,"")===i().replace(/\u200B/g,"")&&(a=c,l=!0)}!l&&a.childNodes.length>0&&e(a.childNodes[a.childNodes.length-1]).text()===i()&&["BR","IMG","HR"].indexOf(a.childNodes[a.childNodes.length-1].tagName)<0&&(a=a.childNodes[a.childNodes.length-1])}for(a.nodeType==Node.TEXT_NODE&&0==o.endOffset&&a.previousSibling&&a.previousSibling.nodeType==Node.ELEMENT_NODE&&(a=a.previousSibling);a.nodeType!=Node.ELEMENT_NODE&&a.parentNode;)a=a.parentNode;for(var d=a;d&&"HTML"!=d.tagName;){if(d==t.$el.get(0))return a;d=e(d).parent()[0]}}}catch(u){}return t.$el.get(0)}function l(e,t){var i=e;return i.nodeType==Node.ELEMENT_NODE&&i.childNodes.length>0&&i.childNodes[t]&&(i=i.childNodes[t]),i.nodeType==Node.TEXT_NODE&&(i=i.parentNode),i}function c(){var i=[],s=n();if(y()&&s.rangeCount)for(var o=r(),a=0;a<o.length;a++){var c=o[a],d=l(c.startContainer,c.startOffset),u=l(c.endContainer,c.endOffset);t.node.isBlock(d)&&i.indexOf(d)<0&&i.push(d);var h=t.node.blockParent(d);h&&i.indexOf(h)<0&&i.push(h);for(var p=[],f=d;f!==u&&f!==t.$el.get(0);)p.indexOf(f)<0&&f.children&&f.children.length?(p.push(f),f=f.children[0]):f.nextSibling?f=f.nextSibling:f.parentNode&&(f=f.parentNode,p.push(f)),t.node.isBlock(f)&&p.indexOf(f)<0&&i.indexOf(f)<0&&(f!==u||c.endOffset>0)&&i.push(f);t.node.isBlock(u)&&i.indexOf(u)<0&&c.endOffset>0&&i.push(u);var h=t.node.blockParent(u);h&&i.indexOf(h)<0&&i.push(h)}for(var a=i.length-1;a>0;a--)e(i[a]).find(i).length&&"LI"!=i[a].tagName&&i.splice(a,1);return i}function d(){if(t.$wp){t.markers.remove();for(var e=r(),i=[],n=0;n<e.length;n++)if(e[n].startContainer!==t.doc){var s=e[n],o=s.collapsed,a=t.markers.place(s,!0,n),l=t.markers.place(s,!1,n);if(t.$el.get(0).normalize(),t.browser.safari&&!o){var s=t.doc.createRange();s.setStartAfter(a),s.setEndBefore(l),i.push(s)}}if(t.browser.safari&&i.length){t.selection.clear();for(var n=0;n<i.length;n++)t.selection.get().addRange(i[n])}}}function u(){var i=t.$el.get(0).querySelectorAll('.fr-marker[data-type="true"]');if(!t.$wp)return t.markers.remove(),!1;if(0===i.length)return!1;if(t.browser.msie||t.browser.edge)for(var r=0;r<i.length;r++)i[r].style.display="inline-block";t.core.hasFocus()||t.browser.msie||t.browser.webkit||t.$el.focus(),s();for(var o=n(),r=0;r<i.length;r++){var a=e(i[r]).data("id"),l=i[r],c=t.doc.createRange(),d=t.$el.find('.fr-marker[data-type="false"][data-id="'+a+'"]');(t.browser.msie||t.browser.edge)&&d.css("display","inline-block");var u=null;if(d.length>0){d=d[0];try{for(var p=!1,f=l.nextSibling;f&&f.nodeType==Node.TEXT_NODE&&0==f.textContent.length;){var m=f;f=f.nextSibling,e(m).remove()}for(var g=d.nextSibling;g&&g.nodeType==Node.TEXT_NODE&&0==g.textContent.length;){var m=g;g=g.nextSibling,e(m).remove()}if(l.nextSibling==d||d.nextSibling==l){for(var v=l.nextSibling==d?l:d,_=v==l?d:l,y=v.previousSibling;y&&y.nodeType==Node.TEXT_NODE&&0==y.length;){var m=y;y=y.previousSibling,e(m).remove()}if(y&&y.nodeType==Node.TEXT_NODE)for(;y&&y.previousSibling&&y.previousSibling.nodeType==Node.TEXT_NODE;)y.previousSibling.textContent=y.previousSibling.textContent+y.textContent,y=y.previousSibling,e(y.nextSibling).remove();for(var b=_.nextSibling;b&&b.nodeType==Node.TEXT_NODE&&0==b.length;){var m=b;b=b.nextSibling,e(m).remove()}if(b&&b.nodeType==Node.TEXT_NODE)for(;b&&b.nextSibling&&b.nextSibling.nodeType==Node.TEXT_NODE;)b.nextSibling.textContent=b.textContent+b.nextSibling.textContent,b=b.nextSibling,e(b.previousSibling).remove();if(y&&(t.node.isVoid(y)||t.node.isBlock(y))&&(y=null),b&&(t.node.isVoid(b)||t.node.isBlock(b))&&(b=null),y&&b&&y.nodeType==Node.TEXT_NODE&&b.nodeType==Node.TEXT_NODE){e(l).remove(),e(d).remove();var w=y.textContent.length;y.textContent=y.textContent+b.textContent,e(b).remove(),t.spaces.normalize(y),c.setStart(y,w),c.setEnd(y,w),p=!0}else!y&&b&&b.nodeType==Node.TEXT_NODE?(e(l).remove(),e(d).remove(),t.spaces.normalize(b),u=e(t.doc.createTextNode("​")),e(b).before(u),c.setStart(b,0),c.setEnd(b,0),p=!0):!b&&y&&y.nodeType==Node.TEXT_NODE&&(e(l).remove(),e(d).remove(),t.spaces.normalize(y),u=e(t.doc.createTextNode("​")),e(y).after(u),c.setStart(y,y.textContent.length),c.setEnd(y,y.textContent.length),p=!0)}if(!p){var k,C;if(t.browser.chrome&&l.nextSibling==d)k=h(d,c,!0)||c.setStartAfter(d),C=h(l,c,!1)||c.setEndBefore(l);else{l.previousSibling==d&&(l=d,d=l.nextSibling),d.nextSibling&&"BR"===d.nextSibling.tagName||!d.nextSibling&&t.node.isBlock(l.previousSibling)||l.previousSibling&&"BR"==l.previousSibling.tagName||(l.style.display="inline",d.style.display="inline",u=e(t.doc.createTextNode("​")));var x=l.previousSibling;x&&x.style&&"block"==t.win.getComputedStyle(x).display&&!t.opts.enter==e.FE.ENTER_BR?(c.setEndAfter(x),c.setStartAfter(x)):(k=h(l,c,!0)||e(l).before(u)&&c.setStartBefore(l),C=h(d,c,!1)||e(d).after(u)&&c.setEndAfter(d))}"function"==typeof k&&k(),"function"==typeof C&&C()}}catch(A){console.warn("RESTORE RANGE",A)}}u&&u.remove();try{o.addRange(c)}catch(A){console.warn("ADD RANGE",A)}}t.markers.remove()}function h(i,n,r){var s=i.previousSibling,o=i.nextSibling;if(s&&o&&s.nodeType==Node.TEXT_NODE&&o.nodeType==Node.TEXT_NODE){var a=s.textContent.length;return r?(o.textContent=s.textContent+o.textContent,e(s).remove(),e(i).remove(),t.spaces.normalize(o),function(){n.setStart(o,a)}):(s.textContent=s.textContent+o.textContent,e(o).remove(),e(i).remove(),t.spaces.normalize(s),function(){n.setEnd(s,a)})}if(s&&!o&&s.nodeType==Node.TEXT_NODE){var a=s.textContent.length;return r?(t.spaces.normalize(s),function(){n.setStart(s,a)}):(t.spaces.normalize(s),function(){n.setEnd(s,a)})}return o&&!s&&o.nodeType==Node.TEXT_NODE?r?(t.spaces.normalize(o),function(){n.setStart(o,0)}):(t.spaces.normalize(o),function(){n.setEnd(o,0)}):!1}function p(){return!0}function f(){for(var e=r(),t=0;t<e.length;t++)if(!e[t].collapsed)return!1;return!0}function m(e){var i,n,r=!1,s=!1;if(t.win.getSelection){var o=t.win.getSelection();o.rangeCount&&(i=o.getRangeAt(0),n=i.cloneRange(),n.selectNodeContents(e),n.setEnd(i.startContainer,i.startOffset),r=""===n.toString(),n.selectNodeContents(e),n.setStart(i.endContainer,i.endOffset),s=""===n.toString())}else t.doc.selection&&"Control"!=t.doc.selection.type&&(i=t.doc.selection.createRange(),n=i.duplicate(),n.moveToElementText(e),n.setEndPoint("EndToStart",i),r=""===n.text,n.moveToElementText(e),n.setEndPoint("StartToEnd",i),s=""===n.text);return{atStart:r,atEnd:s}}function g(){if(f())return!1;t.$el.find("td, th, img").prepend('<span class="fr-mk">'+e.FE.INVISIBLE_SPACE+"</span>");var i=!1,n=m(t.$el.get(0));return n.atStart&&n.atEnd&&(i=!0),t.$el.find(".fr-mk").remove(),i}function v(i,n){"undefined"==typeof n&&(n=!0);var r=e(i).html();r&&r.replace(/\u200b/g,"").length!=r.length&&e(i).html(r.replace(/\u200b/g,""));for(var s=t.node.contents(i),o=0;o<s.length;o++)s[o].nodeType!=Node.ELEMENT_NODE?e(s[o]).remove():(v(s[o],0==o),0==o&&(n=!1));i.nodeType==Node.TEXT_NODE?e(i).replaceWith('<span data-first="true" data-text="true"></span>'):n&&e(i).attr("data-first",!0)}function _(i,n){var r=t.node.contents(i.get(0));["TD","TH"].indexOf(i.get(0).tagName)>=0&&1==i.find(".fr-marker").length&&e(r[0]).hasClass("fr-marker")&&i.attr("data-del-cell",!0);for(var s=0;s<r.length;s++){var o=r[s];e(o).hasClass("fr-marker")?n=(n+1)%2:n?e(o).find(".fr-marker").length>0?n=_(e(o),n):["TD","TH"].indexOf(o.tagName)<0&&!e(o).hasClass("fr-inner")?!t.opts.keepFormatOnDelete||t.$el.find("[data-first]").length>0?e(o).remove():v(o):e(o).hasClass("fr-inner")?0==e(o).find(".fr-inner").length?e(o).html("<br>"):e(o).find(".fr-inner").filter(function(){return 0==e(this).find("fr-inner").length}).html("<br>"):(e(o).empty(),e(o).attr("data-del-cell",!0)):e(o).find(".fr-marker").length>0&&(n=_(e(o),n))}return n}function y(){try{if(!t.$wp)return!1;for(var e=r(0),i=e.commonAncestorContainer;i&&!t.node.isElement(i);)i=i.parentNode;return t.node.isElement(i)?!0:!1}catch(n){return!1}}function b(){if(f())return!0;d();for(var i=function(t){for(var i=t.previousSibling;i&&i.nodeType==Node.TEXT_NODE&&0==i.textContent.length;){var n=i,i=i.previousSibling;e(n).remove()}return i},n=function(t){for(var i=t.nextSibling;i&&i.nodeType==Node.TEXT_NODE&&0==i.textContent.length;){var n=i,i=i.nextSibling;e(n).remove()}return i},r=t.$el.find('.fr-marker[data-type="true"]'),s=0;s<r.length;s++)for(var o=r[s];!i(o)&&!t.node.isBlock(o.parentNode)&&!t.$el.is(o.parentNode);)e(o.parentNode).before(o);for(var a=t.$el.find('.fr-marker[data-type="false"]'),s=0;s<a.length;s++){for(var l=a[s];!n(l)&&!t.node.isBlock(l.parentNode)&&!t.$el.is(l.parentNode);)e(l.parentNode).after(l);l.parentNode&&t.node.isBlock(l.parentNode)&&t.node.isEmpty(l.parentNode)&&!t.$el.is(l.parentNode)&&t.opts.keepFormatOnDelete&&e(l.parentNode).after(l)}if(p()){_(t.$el,0);var c=t.$el.find('[data-first="true"]');if(c.length)t.$el.find(".fr-marker").remove(),c.append(e.FE.INVISIBLE_SPACE+e.FE.MARKERS).removeAttr("data-first"),c.attr("data-text")&&c.replaceWith(c.html());else{t.$el.find("table").filter(function(){var t=e(this).find("[data-del-cell]").length>0&&e(this).find("[data-del-cell]").length==e(this).find("td, th").length;return t}).remove(),t.$el.find("[data-del-cell]").removeAttr("data-del-cell");for(var r=t.$el.find('.fr-marker[data-type="true"]'),s=0;s<r.length;s++){var h=r[s],m=h.nextSibling,g=t.$el.find('.fr-marker[data-type="false"][data-id="'+e(h).data("id")+'"]').get(0);if(g){if(m&&m==g);else if(h){var v=t.node.blockParent(h),y=t.node.blockParent(g),b=!1,w=!1;if(v&&["UL","OL"].indexOf(v.tagName)>=0&&(v=null,b=!0),y&&["UL","OL"].indexOf(y.tagName)>=0&&(y=null,w=!0),e(h).after(g),v==y);else if(null!=v||b)if(null!=y||w||0!=e(v).parentsUntil(t.$el,"table").length)v&&y&&0==e(v).parentsUntil(t.$el,"table").length&&0==e(y).parentsUntil(t.$el,"table").length&&(e(v).append(e(y).html()),e(y).remove());else{for(var m=v;!m.nextSibling&&m.parentNode!=t.$el.get(0);)m=m.parentNode;for(m=m.nextSibling;m&&"BR"!=m.tagName;){var k=m.nextSibling;e(v).append(m),m=k}m&&"BR"==m.tagName&&e(m).remove()}else{var C=t.node.deepestParent(h);C?(e(C).after(e(y).html()),e(y).remove()):0==e(y).parentsUntil(t.$el,"table").length&&(e(h).next().after(e(y).html()),e(y).remove())}}}else g=e(h).clone().attr("data-type",!1),e(h).after(g)}}}t.opts.keepFormatOnDelete||t.html.fillEmptyBlocks(),t.html.cleanEmptyTags(!0),t.clean.lists(),t.spaces.normalize();var x=t.$el.find(".fr-marker:last").get(0),A=t.$el.find(".fr-marker:first").get(0);x&&A&&!x.nextSibling&&A.previousSibling&&"BR"==A.previousSibling.tagName&&t.node.isElement(x.parentNode)&&t.node.isElement(A.parentNode)&&t.$el.append("<br>"),u()}function w(i){if(e(i).find(".fr-marker").length>0)return!1;for(var n=t.node.contents(i);n.length&&t.node.isBlock(n[0]);)i=n[0],n=t.node.contents(i);e(i).prepend(e.FE.MARKERS)}function k(i){if(e(i).find(".fr-marker").length>0)return!1;for(var n=t.node.contents(i);n.length&&t.node.isBlock(n[n.length-1]);)i=n[n.length-1],n=t.node.contents(i);e(i).append(e.FE.MARKERS)}function C(i){for(var n=i.previousSibling;n&&n.nodeType==Node.TEXT_NODE&&0==n.textContent.length;)n=n.previousSibling;return n?(t.node.isBlock(n)?k(n):"BR"==n.tagName?e(n).before(e.FE.MARKERS):e(n).after(e.FE.MARKERS),!0):!1}function x(i){for(var n=i.nextSibling;n&&n.nodeType==Node.TEXT_NODE&&0==n.textContent.length;)n=n.nextSibling;return n?(t.node.isBlock(n)?w(n):e(n).before(e.FE.MARKERS),!0):!1}return{text:i,get:n,ranges:r,clear:s,element:o,endElement:a,save:d,restore:u,isCollapsed:f,isFull:g,inEditor:y,remove:b,blocks:c,info:m,setAtEnd:k,setAtStart:w,setBefore:C,setAfter:x,rangeElement:l}},e.FE.MODULES.spaces=function(t){function i(e){var t=e.nextSibling||e.parentNode;return e.parentNode.removeChild(e),t}function n(e,t){return e&&e.parentNode===t||"PRE"===t.nodeName?t.nextSibling||t.parentNode:t.firstChild||t.nextSibling||t.parentNode}function r(e){if(e.firstChild&&"PRE"!==e.nodeName&&!(["STYLE","SCRIPT"].indexOf(e.tagName)>=0)){for(var r=null,s=null,o=n(s,e);o!==e&&"PRE"!==o.nodeName&&["STYLE","SCRIPT"].indexOf(o.tagName)<0;){if(o.nodeType===Node.TEXT_NODE){var a=o.data.replace(/[ \r\n\t]+/g," ");if(r&&!/ $/.test(r.data)||" "!==a[0]||o.previousSibling&&t.node.isVoid(o.previousSibling)&&"BR"!==o.previousSibling.tagName||(a=a.substr(1)),!a||0==a.length){o=i(o);continue}o.data=a,r=o}else o.nodeType===Node.ELEMENT_NODE&&(t.node.isBlock(o)||t.node.isVoid(o)?(r&&r.data&&(t.node.isBlock(o)||"BR"===o.tagName)&&(r.data=r.data.replace(/ $/,"")),r=null):0==o.textContent.length&&(r=o));var l=n(s,o);s=o,o=l}r&&r.data&&(r.data=r.data.replace(/ $/,""),r.data||i(r))}}function s(i,n){if("undefined"!=typeof i&&i||(i=t.$el.get(0)),"undefined"==typeof n&&(n=!1),n&&r(i),!i.getAttribute||"false"!=i.getAttribute("contenteditable"))if(i.nodeType==Node.ELEMENT_NODE&&["STYLE","SCRIPT","HEAD"].indexOf(i.tagName)<0)for(var o=t.node.contents(i),a=o.length-1;a>=0;a--)(o[a].tagName!=Node.ELEMENT_NODE||(o[a].className||"").indexOf("fr-marker")<0)&&s(o[a]);else if(i.nodeType==Node.TEXT_NODE&&i.textContent.length>0){i.previousSibling,i.nextSibling;var l=i.textContent;l=l.replace(new RegExp(e.FE.UNICODE_NBSP,"g")," ");for(var c="",d=0;d<l.length;d++)c+=32!=l.charCodeAt(d)||0!==d&&32!=c.charCodeAt(d-1)?l[d]:e.FE.UNICODE_NBSP;(!i.nextSibling||t.node.isBlock(i.nextSibling)||i.nextSibling.nodeType==Node.ELEMENT_NODE&&t.win.getComputedStyle(i.nextSibling)&&"block"==t.win.getComputedStyle(i.nextSibling).display)&&(c=c.replace(/ $/,e.FE.UNICODE_NBSP)),!i.previousSibling||t.node.isVoid(i.previousSibling)||t.node.isBlock(i.previousSibling)||(c=c.replace(/^\u00A0([^ $])/," $1"),1!==c.length||160!==c.charCodeAt(0)||!i.nextSibling||t.node.isVoid(i.nextSibling)||t.node.isBlock(i.nextSibling)||(c=" ")),c=c.replace(/([^ \u00A0])\u00A0([^ \u00A0])/g,"$1 $2"),i.textContent!=c&&(i.textContent=c)}}return{normalize:s}},e.FE.UNICODE_NBSP=String.fromCharCode(160),e.FE.VOID_ELEMENTS=["area","base","br","col","embed","hr","img","input","keygen","link","menuitem","meta","param","source","track","wbr"],e.FE.BLOCK_TAGS=["address","article","aside","audio","blockquote","canvas","dd","div","dl","dt","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","header","hgroup","hr","li","main","nav","noscript","ol","output","p","pre","section","table","tbody","td","tfoot","th","thead","tr","ul","video"],e.extend(e.FE.DEFAULTS,{htmlAllowedEmptyTags:["textarea","a","iframe","object","video","style","script",".fa",".fr-emoticon"],htmlDoNotWrapTags:["script","style"],htmlSimpleAmpersand:!1}),e.FE.MODULES.html=function(t){function i(){return t.opts.enter==e.FE.ENTER_P?"p":t.opts.enter==e.FE.ENTER_DIV?"div":t.opts.enter==e.FE.ENTER_BR?null:void 0}function n(){var i=[],n=t.$el.get(0).querySelectorAll(s()),r=s();r+=","+e.FE.VOID_ELEMENTS.join(","),r+=","+t.opts.htmlAllowedEmptyTags.join(":not(.fr-marker),")+":not(.fr-marker)";for(var o=n.length-1;o>=0;o--)if(!(n[o].querySelectorAll(r).length>0||n[o].textContent&&n[o].textContent.replace(/\u200B|\n/g,"").length>0)){for(var a=t.node.contents(n[o]),l=!1,c=0;c<a.length;c++)if(a[c].nodeType!=Node.COMMENT_NODE&&a[c].textContent&&a[c].textContent.replace(/\u200B|\n/g,"").length>0){l=!0;break}l||i.push(n[o])}return i}function r(){return e.FE.BLOCK_TAGS.join(":empty, ")+":empty"}function s(){return e.FE.BLOCK_TAGS.join(", ")}function o(i){var n=e.merge([],e.FE.VOID_ELEMENTS);n=e.merge(n,t.opts.htmlAllowedEmptyTags),"undefined"==typeof i&&(n=e.merge(n,e.FE.BLOCK_TAGS));var r,s;do{s=!1,r=t.$el.get(0).querySelectorAll("*:empty:not("+n.join("):not(")+"):not(.fr-marker)");for(var o=0;o<r.length;o++)(0===r[o].attributes.length||"undefined"!=typeof r[o].getAttribute("href"))&&(e(r[o]).remove(),s=!0);r=t.$el.get(0).querySelectorAll("*:empty:not("+n.join("):not(")+"):not(.fr-marker)")}while(r.length&&s)}function a(n,r){var s=i();if(r&&(s='div class="fr-temp-div"'),s)for(var o=t.node.contents(n.get(0)),a=null,l=0;l<o.length;l++){var c=o[l];if(c.nodeType==Node.ELEMENT_NODE&&(t.node.isBlock(c)||e(c).is(t.opts.htmlDoNotWrapTags.join(","))&&!e(c).hasClass("fr-marker")))a=null;else if(c.nodeType!=Node.ELEMENT_NODE&&c.nodeType!=Node.TEXT_NODE)a=null;else if(c.nodeType==Node.ELEMENT_NODE&&"BR"==c.tagName)if(null==a)r?e(c).replaceWith("<"+s+' data-empty="true"><br></div>'):e(c).replaceWith("<"+s+"><br></"+s+">");else{e(c).remove();for(var d=t.node.contents(a),u=!1,h=0;h<d.length;h++)if(!e(d[h]).hasClass("fr-marker")&&(d[h].nodeType!=Node.TEXT_NODE||0!==d[h].textContent.replace(/ /g,"").length)){u=!0;break}u===!1&&(a.append("<br>"),a.data("empty",!0)),a=null}else c.nodeType==Node.TEXT_NODE&&0==c.textContent.replace(/\n/g,"").replace(/(^ *)|( *$)/g,"").length?e(c).remove():(null==a&&(a=e("<"+s+">"),e(c).before(a)),c.nodeType==Node.TEXT_NODE&&e(c).text().trim().length>0?(a.append(e(c).clone()),e(c).remove()):a.append(e(c)))}}function l(i,n,r,s){return t.$wp?("undefined"==typeof i&&(i=!1),"undefined"==typeof n&&(n=!1),"undefined"==typeof r&&(r=!1),"undefined"==typeof s&&(s=!1),a(t.$el,i),s&&t.$el.find(".fr-inner").each(function(){a(e(this),i)}),n&&t.$el.find("td, th").each(function(){a(e(this),i)}),r&&t.$el.find("blockquote").each(function(){a(e(this),i)}),void 0):!1}function c(){t.$el.find("div.fr-temp-div").each(function(){e(this).data("empty")||"LI"==this.parentNode.tagName||t.node.isBlock(this.previousSibling)?e(this).replaceWith(e(this).html()):e(this).replaceWith(e(this).html()+"<br>")}),t.$el.find(".fr-temp-div").removeClass("fr-temp-div").filter(function(){return""==e(this).attr("class")}).removeAttr("class")}function d(){for(var i=n(),r=0;r<i.length;r++){var s=i[r];"false"==s.getAttribute("contenteditable")||0!=s.querySelectorAll(t.opts.htmlAllowedEmptyTags.join(":not(.fr-marker),")+":not(.fr-marker)").length||t.node.isVoid(s)||"TABLE"!=s.tagName&&"TBODY"!=s.tagName&&"TR"!=s.tagName&&s.appendChild(t.doc.createElement("br"))}if(t.browser.msie&&t.opts.enter==e.FE.ENTER_BR){var o=t.node.contents(t.$el.get(0));o.length&&o[o.length-1].nodeType==Node.TEXT_NODE&&t.$el.append("<br>")}}function u(){return t.$el.find(s())}function h(e){if("undefined"==typeof e&&(e=t.$el.get(0)),e&&["SCRIPT","STYLE","PRE"].indexOf(e.tagName)>=0)return!1;for(var i=t.node.contents(e),n=i.length-1;n>=0;n--)i[n].nodeType==Node.TEXT_NODE?(i[n].textContent=i[n].textContent.replace(/(?!^)( ){2,}(?!$)/g," "),i[n].textContent=i[n].textContent.replace(/\n/g," "),i[n].textContent=i[n].textContent.replace(/^[ ]{2,}/g," "),i[n].textContent=i[n].textContent.replace(/[ ]{2,}$/g," "),(t.node.isBlock(e)||t.node.isElement(e))&&(i[n].previousSibling||(i[n].textContent=i[n].textContent.replace(/^ */,"")),i[n].nextSibling||(i[n].textContent=i[n].textContent.replace(/ *$/,"")),i[n].previousSibling&&i[n].nextSibling&&" "==i[n].textContent&&(i[n].textContent=i[n].previousSibling&&i[n].nextSibling&&t.node.isBlock(i[n].previousSibling)&&t.node.isBlock(i[n].nextSibling)?"":"\n"))):h(i[n])}function p(e){return e&&(t.node.isBlock(e)||["STYLE","SCRIPT","HEAD","BR","HR"].indexOf(e.tagName)>=0||e.nodeType==Node.COMMENT_NODE)}function f(i){if("undefined"==typeof i&&(i=t.$el.get(0)),i.nodeType==Node.ELEMENT_NODE&&["STYLE","SCRIPT","HEAD"].indexOf(i.tagName)<0){for(var n=t.node.contents(i),r=n.length-1;r>=0;r--)if(!e(n[r]).hasClass("fr-marker")){var s=f(n[r]);if(1==s)return!0}}else if(i.nodeType==Node.TEXT_NODE&&i.textContent.length>0){var o=i.previousSibling,a=i.nextSibling;if(p(o)&&p(a)&&0===i.textContent.trim().length)return!0;var l=i.textContent;l=l.replace(new RegExp(e.FE.UNICODE_NBSP,"g")," ");for(var c="",d=0;d<l.length;d++)c+=32!=l.charCodeAt(d)||0!==d&&32!=c.charCodeAt(d-1)?l[d]:e.FE.UNICODE_NBSP;if(i.nextSibling||(c=c.replace(/ $/,e.FE.UNICODE_NBSP)),i.previousSibling&&!t.node.isVoid(i.previousSibling)&&(c=c.replace(/^\u00A0([^ $])/," $1")),c=c.replace(/([^ \u00A0])\u00A0([^ \u00A0])/g,"$1 $2"),i.textContent!=c)return!0}return!1}function m(e,t,i){var n=new RegExp(t,"gi"),r=n.exec(e);return r?r[i]:null}function g(e,t){var i=e.match(/<!DOCTYPE ?([^ ]*) ?([^ ]*) ?"?([^"]*)"? ?"?([^"]*)"?>/i);return i?t.implementation.createDocumentType(i[1],i[3],i[4]):t.implementation.createDocumentType("html")}function v(e){var t=e.doctype,i="<!DOCTYPE html>";return t&&(i="<!DOCTYPE "+t.name+(t.publicId?' PUBLIC "'+t.publicId+'"':"")+(!t.publicId&&t.systemId?" SYSTEM":"")+(t.systemId?' "'+t.systemId+'"':"")+">"),i}function _(){o(),l(),h(),t.spaces.normalize(null,!0),t.html.fillEmptyBlocks(),t.clean.quotes(),t.clean.lists(),t.clean.tables(),t.clean.toHTML5(),t.selection.restore(),y(),t.placeholder.refresh()}function y(){t.core.isEmpty()&&(null!=i()?0===t.$el.get(0).querySelectorAll(s()).length&&0===t.$el.get(0).querySelectorAll(t.opts.htmlDoNotWrapTags.join(":not(.fr-marker),")+":not(.fr-marker)").length&&(t.core.hasFocus()?(t.$el.html("<"+i()+">"+e.FE.MARKERS+"<br/></"+i()+">"),t.selection.restore()):t.$el.html("<"+i()+">"+"<br/></"+i()+">")):0===t.$el.get(0).querySelectorAll("*:not(.fr-marker):not(br)").length&&(t.core.hasFocus()?(t.$el.html(e.FE.MARKERS+"<br/>"),t.selection.restore()):t.$el.html("<br/>")))}function b(e,t){return m(e,"<"+t+"[^>]*?>([\\w\\W]*)</"+t+">",1)}function w(i,n){var r=e("<div "+(m(i,"<"+n+"([^>]*?)>",1)||"")+">");return t.node.rawAttributes(r.get(0))}function k(e){return m(e,"<!DOCTYPE([^>]*?)>",0)||"<!DOCTYPE html>"}function C(i){var n=t.clean.html(i||"",[],[],t.opts.fullPage);if(t.opts.fullPage){var r=b(n,"body")||(n.indexOf("<body")>=0?"":n),s=w(n,"body"),o=b(n,"head")||"<title></title>",a=w(n,"head"),l=e("<div>").append(o).contents().each(function(){(this.nodeType==Node.COMMENT_NODE||["BASE","LINK","META","NOSCRIPT","SCRIPT","STYLE","TEMPLATE","TITLE"].indexOf(this.tagName)>=0)&&this.parentNode.removeChild(this)}).end().html().trim();o=e("<div>").append(o).contents().map(function(){return this.nodeType==Node.COMMENT_NODE?"<!--"+this.nodeValue+"-->":["BASE","LINK","META","NOSCRIPT","SCRIPT","STYLE","TEMPLATE","TITLE"].indexOf(this.tagName)>=0?this.outerHTML:""}).toArray().join("");var c=k(n),d=w(n,"html");t.$el.html(l+"\n"+r),t.node.clearAttributes(t.$el.get(0)),t.$el.attr(s),t.$el.addClass("fr-view"),t.$el.attr("spellcheck",t.opts.spellcheck),t.$el.attr("dir",t.opts.direction),t.$head.html(o),t.node.clearAttributes(t.$head.get(0)),t.$head.attr(a),t.node.clearAttributes(t.$html.get(0)),t.$html.attr(d),t.iframe_document.doctype.parentNode.replaceChild(g(c,t.iframe_document),t.iframe_document.doctype)}else t.$el.html(n);var u=t.edit.isDisabled();t.edit.on(),t.core.injectStyle(t.opts.iframeStyle),_(),t.opts.useClasses||(t.$el.find("[fr-original-class]").each(function(){this.setAttribute("class",this.getAttribute("fr-original-class")),this.removeAttribute("fr-original-class")}),t.$el.find("[fr-original-style]").each(function(){this.setAttribute("style",this.getAttribute("fr-original-style")),this.removeAttribute("fr-original-style")})),u&&t.edit.off(),t.events.trigger("html.set")}function x(e,i){if(!t.$wp)return t.$oel.clone().removeClass("fr-view").removeAttr("contenteditable").get(0).outerHTML;var n="";t.events.trigger("html.beforeGet");var r,s=function(e){var t=/(#[^\s\+>~\.\[:]+)/g,i=/(\[[^\]]+\])/g,n=/(\.[^\s\+>~\.\[:]+)/g,r=/(::[^\s\+>~\.\[:]+|:first-line|:first-letter|:before|:after)/gi,s=/(:[\w-]+\([^\)]*\))/gi,o=/(:[^\s\+>~\.\[:]+)/g,a=/([^\s\+>~\.\[:]+)/g;!function(){var t=/:not\(([^\)]*)\)/g;t.test(e)&&(e=e.replace(t,"     $1 "))}();var l=100*(e.match(t)||[]).length+10*(e.match(i)||[]).length+10*(e.match(n)||[]).length+10*(e.match(s)||[]).length+10*(e.match(o)||[]).length+(e.match(r)||[]).length;return e=e.replace(/[\*\s\+>~]/g," "),e=e.replace(/[#\.]/g," "),l+=(e.match(a)||[]).length},o=[],a={};if(!t.opts.useClasses&&!i){for(r=0;r<t.doc.styleSheets.length;r++){var l,c=0;try{l=t.doc.styleSheets[r].cssRules,t.doc.styleSheets[r].ownerNode&&"STYLE"==t.doc.styleSheets[r].ownerNode.nodeType&&(c=1)}catch(d){}if(l)for(var u=0,h=l.length;h>u;u++)if(l[u].selectorText&&l[u].style.cssText.length>0){var p,f=l[u].selectorText.replace(/body |\.fr-view /g,"").replace(/::/g,":");try{p=t.$el.get(0).querySelectorAll(f)}catch(d){p=[]}for(var m=0;m<p.length;m++){!p[m].getAttribute("fr-original-style")&&p[m].getAttribute("style")?(p[m].setAttribute("fr-original-style",p[m].getAttribute("style")),o.push(p[m])):p[m].getAttribute("fr-original-style")||o.push(p[m]),a[p[m]]||(a[p[m]]={});for(var g=1e3*c+s(l[u].selectorText),_=l[u].style.cssText.split(";"),y=0;y<_.length;y++){var b=_[y].trim().split(":")[0];a[p[m]][b]||(a[p[m]][b]=0,(p[m].getAttribute("fr-original-style")||"").indexOf(b+":")>=0&&(a[p[m]][b]=1e4)),g>=a[p[m]][b]&&(a[p[m]][b]=g,_[y].trim().length&&(p[m].style[b.trim()]=_[y].trim().split(":")[1].trim()))}}}}for(r=0;r<o.length;r++)if(o[r].getAttribute("class")&&(o[r].setAttribute("fr-original-class",o[r].getAttribute("class")),o[r].removeAttribute("class")),(o[r].getAttribute("fr-original-style")||"").trim().length>0)for(var w=o[r].getAttribute("fr-original-style").split(";"),m=0;m<w.length;m++)w[m].indexOf(":")>0&&(o[r].style[w[m].split(":")[0].trim()]=w[m].split(":")[1].trim())}if(t.core.isEmpty()?t.opts.fullPage&&(n=v(t.iframe_document),n+="<html"+t.node.attributes(t.$html.get(0))+">"+t.$html.find("head").get(0).outerHTML+"<body></body></html>"):("undefined"==typeof e&&(e=!1),t.opts.fullPage?(n=v(t.iframe_document),t.$el.removeClass("fr-view"),n+="<html"+t.node.attributes(t.$html.get(0))+">"+t.$html.html()+"</html>",t.$el.addClass("fr-view")):n=t.$el.html()),!t.opts.useClasses&&!i)for(r=0;r<o.length;r++)o[r].getAttribute("fr-original-class")&&(o[r].setAttribute("class",o[r].getAttribute("fr-original-class")),o[r].removeAttribute("fr-original-class")),o[r].getAttribute("fr-original-style")?(o[r].setAttribute("style",o[r].getAttribute("fr-original-style")),o[r].removeAttribute("fr-original-style")):o[r].removeAttribute("style");t.opts.fullPage&&(n=n.replace(/<style data-fr-style="true">(?:[\w\W]*?)<\/style>/g,""),n=n.replace(/<link([^>]*)data-fr-style="true"([^>]*)>/g,""),n=n.replace(/<style(?:[\w\W]*?)class="firebugResetStyles"(?:[\w\W]*?)>(?:[\w\W]*?)<\/style>/g,""),n=n.replace(/<body((?:[\w\W]*?)) spellcheck="true"((?:[\w\W]*?))>((?:[\w\W]*?))<\/body>/g,"<body$1$2>$3</body>"),n=n.replace(/<body((?:[\w\W]*?)) contenteditable="(true|false)"((?:[\w\W]*?))>((?:[\w\W]*?))<\/body>/g,"<body$1$3>$4</body>"),n=n.replace(/<body((?:[\w\W]*?)) dir="([\w]*)"((?:[\w\W]*?))>((?:[\w\W]*?))<\/body>/g,"<body$1$3>$4</body>"),n=n.replace(/<body((?:[\w\W]*?))class="([\w\W]*?)(fr-rtl|fr-ltr)([\w\W]*?)"((?:[\w\W]*?))>((?:[\w\W]*?))<\/body>/g,'<body$1class="$2$4"$5>$6</body>'),n=n.replace(/<body((?:[\w\W]*?)) class=""((?:[\w\W]*?))>((?:[\w\W]*?))<\/body>/g,"<body$1$2>$3</body>")),t.opts.htmlSimpleAmpersand&&(n=n.replace(/\&amp;/gi,"&")),t.events.trigger("html.afterGet"),e||(n=n.replace(/<span[^>]*? class\s*=\s*["']?fr-marker["']?[^>]+>\u200b<\/span>/gi,"")),n=t.clean.invisibleSpaces(n);var k=t.events.chainTrigger("html.get",n);return"string"==typeof k&&(n=k),n=n.replace(/<pre(?:[\w\W]*?)>(?:[\w\W]*?)<\/pre>/g,function(e){return e.replace(/<br>/g,"\n")})}function A(){var i=function(i,n){for(;n&&(n.nodeType==Node.TEXT_NODE||!t.node.isBlock(n))&&!t.node.isElement(n);)n&&n.nodeType!=Node.TEXT_NODE&&e(i).wrapInner(t.node.openTagString(n)+t.node.closeTagString(n)),n=n.parentNode;n&&i.innerHTML==n.innerHTML&&(i.innerHTML=n.outerHTML)},n=function(){var i,n=null;return t.win.getSelection?(i=t.win.getSelection(),i&&i.rangeCount&&(n=i.getRangeAt(0).commonAncestorContainer,n.nodeType!=Node.ELEMENT_NODE&&(n=n.parentNode))):(i=t.doc.selection)&&"Control"!=i.type&&(n=i.createRange().parentElement()),null!=n&&(e.inArray(t.$el.get(0),e(n).parents())>=0||n==t.$el.get(0))?n:null},r="";if("undefined"!=typeof t.win.getSelection){t.browser.mozilla&&(t.selection.save(),t.$el.find('.fr-marker[data-type="false"]').length>1&&(t.$el.find('.fr-marker[data-type="false"][data-id="0"]').remove(),t.$el.find('.fr-marker[data-type="false"]:last').attr("data-id","0"),t.$el.find(".fr-marker").not('[data-id="0"]').remove()),t.selection.restore());for(var s=t.selection.ranges(),o=0;o<s.length;o++){var a=document.createElement("div");a.appendChild(s[o].cloneContents()),i(a,n()),e(a).find(".fr-element").length>0&&(a=t.$el.get(0)),r+=a.innerHTML}}else"undefined"!=typeof t.doc.selection&&"Text"==t.doc.selection.type&&(r=t.doc.selection.createRange().htmlText);
return r}function T(t){var i=e("<div>").html(t);return i.find(s()).length>0}function S(e){var i=t.doc.createElement("div");return i.innerHTML=e,t.selection.setAtEnd(i),i.innerHTML}function M(e){return e.replace(/</gi,"&lt;").replace(/>/gi,"&gt;").replace(/"/gi,"&quot;").replace(/'/gi,"&#39;")}function N(i,n,r){t.selection.isCollapsed()||t.selection.remove();var s;if(s=n?i:t.clean.html(i),s=s.replace(/\r|\n/g," "),i.indexOf('class="fr-marker"')<0&&(s=S(s)),t.core.isEmpty())t.$el.html(s);else{var o=t.markers.insert();if(o){var a;if((T(s)||r)&&(a=t.node.deepestParent(o))){var o=t.markers.split();if(!o)return!1;e(o).replaceWith(s)}else e(o).replaceWith(s)}else t.$el.append(s)}_(),t.events.trigger("html.inserted")}function E(i){var n=null;"undefined"==typeof i&&(n=t.selection.element());var r,s;do{s=!1,r=t.$el.get(0).querySelectorAll("*:not(.fr-marker)");for(var o=0;o<r.length;o++){var a=r[o];if(n!=a){var l=a.textContent;0===a.children.length&&1===l.length&&8203==l.charCodeAt(0)&&(e(a).remove(),s=!0)}}}while(s)}function D(){var e=function(){E(),t.placeholder&&t.placeholder.refresh()};t.events.on("mouseup",e),t.events.on("keydown",e),t.events.on("contentChanged",y)}return{defaultTag:i,emptyBlocks:n,emptyBlockTagsQuery:r,blockTagsQuery:s,fillEmptyBlocks:d,cleanEmptyTags:o,cleanWhiteTags:E,doNormalize:f,cleanBlankSpaces:h,blocks:u,getDoctype:v,set:C,get:x,getSelected:A,insert:N,wrap:l,unwrap:c,escapeEntities:M,checkIfEmpty:y,extractNode:b,extractNodeAttrs:w,extractDoctype:k,_init:D}},e.extend(e.FE.DEFAULTS,{height:null,heightMax:null,heightMin:null,width:null}),e.FE.MODULES.size=function(e){function t(){i(),e.opts.height&&e.$el.css("minHeight",e.opts.height-e.helpers.getPX(e.$el.css("padding-top"))-e.helpers.getPX(e.$el.css("padding-bottom"))),e.$iframe.height(e.$el.outerHeight(!0))}function i(){e.opts.heightMin?e.$el.css("minHeight",e.opts.heightMin):e.$el.css("minHeight",""),e.opts.heightMax?(e.$wp.css("maxHeight",e.opts.heightMax),e.$wp.css("overflow","auto")):(e.$wp.css("maxHeight",""),e.$wp.css("overflow","")),e.opts.height?(e.$wp.height(e.opts.height),e.$el.css("minHeight",e.opts.height-e.helpers.getPX(e.$el.css("padding-top"))-e.helpers.getPX(e.$el.css("padding-bottom"))),e.$wp.css("overflow","auto")):(e.$wp.css("height",""),e.opts.heightMin||e.$el.css("minHeight",""),e.opts.heightMax||e.$wp.css("overflow","")),e.opts.width&&e.$box.width(e.opts.width)}function n(){return e.$wp?(i(),e.$iframe&&(e.events.on("keyup",t),e.events.on("commands.after",t),e.events.on("html.set",t),e.events.on("init",t),e.events.on("initialized",t)),void 0):!1}return{_init:n,syncIframe:t,refresh:i}},e.extend(e.FE.DEFAULTS,{language:null}),e.FE.LANGUAGE={},e.FE.MODULES.language=function(t){function i(e){return r&&r.translation[e]?r.translation[e]:e}function n(){e.FE.LANGUAGE&&(r=e.FE.LANGUAGE[t.opts.language]),r&&r.direction&&(t.opts.direction=r.direction)}var r;return{_init:n,translate:i}},e.extend(e.FE.DEFAULTS,{placeholderText:"Type something"}),e.FE.MODULES.placeholder=function(t){function i(){t.$placeholder||o();var i=0,n=0,r=0,s=0,a=t.node.contents(t.$el.get(0));if(a.length&&a[0].nodeType==Node.ELEMENT_NODE){var l=e(a[0]);t.opts.toolbarInline||(i=t.helpers.getPX(l.css("margin-top")),r=t.helpers.getPX(l.css("padding-top")),n=t.helpers.getPX(l.css("margin-left")),s=t.helpers.getPX(l.css("padding-left"))),t.$placeholder.css("font-size",l.css("font-size")),t.$placeholder.css("line-height",l.css("line-height"))}else t.$placeholder.css("font-size",t.$el.css("font-size")),t.$placeholder.css("line-height",t.$el.css("line-height"));t.$wp.addClass("show-placeholder"),t.$placeholder.css({marginTop:Math.max(t.helpers.getPX(t.$el.css("margin-top")),i),paddingTop:Math.max(t.helpers.getPX(t.$el.css("padding-top")),r),paddingLeft:Math.max(t.helpers.getPX(t.$el.css("padding-left")),s),marginLeft:Math.max(t.helpers.getPX(t.$el.css("margin-left")),n)}).text(t.language.translate(t.opts.placeholderText||t.$oel.attr("placeholder")||"")),t.$placeholder.html(t.$placeholder.text().replace(/\n/g,"<br>"))}function n(){t.$wp.removeClass("show-placeholder")}function r(){return t.$wp?t.$wp.hasClass("show-placeholder"):!0}function s(){return t.$wp?(t.core.isEmpty()?i():n(),void 0):!1}function o(){t.$placeholder=e('<span class="fr-placeholder"></span>'),t.$wp.append(t.$placeholder)}function a(){return t.$wp?(t.events.on("init input keydown keyup contentChanged initialized",s),void 0):!1}return{_init:a,show:i,hide:n,refresh:s,isVisible:r}},e.FE.MODULES.edit=function(e){function t(){if(e.browser.mozilla)try{e.doc.execCommand("enableObjectResizing",!1,"false"),e.doc.execCommand("enableInlineTableEditing",!1,"false")}catch(t){}if(e.browser.msie)try{e.doc.body.addEventListener("mscontrolselect",function(e){return e.preventDefault(),!1})}catch(t){}}function i(){e.$wp?(e.$el.attr("contenteditable",!0),e.$el.removeClass("fr-disabled"),e.$tb&&e.$tb.removeClass("fr-disabled"),t()):e.$el.is("a")&&e.$el.attr("contenteditable",!0),s=!1}function n(){e.$wp?(e.$el.attr("contenteditable",!1),e.$el.addClass("fr-disabled"),e.$tb&&e.$tb.addClass("fr-disabled")):e.$el.is("a")&&e.$el.attr("contenteditable",!1),s=!0}function r(){return s}var s=!1;return{on:i,off:n,disableDesign:t,isDisabled:r}},e.extend(e.FE.DEFAULTS,{editorClass:null,typingTimer:500,iframe:!1,requestWithCORS:!0,requestWithCredentials:!1,requestHeaders:{},useClasses:!0,spellcheck:!0,iframeStyle:'html{margin:0px;height:auto;}body{height:auto;padding:10px;background:transparent;color:#000000;position:relative;z-index: 2;-webkit-user-select:auto;margin:0px;overflow:hidden;min-height:20px;}body:after{content:"";display:block;clear:both;}',iframeStyleFiles:[],direction:"auto",zIndex:1,disableRightClick:!1,scrollableContainer:"body",keepFormatOnDelete:!1,theme:null}),e.FE.MODULES.core=function(t){function i(i){if(t.opts.iframe){t.$head.find("style[data-fr-style], link[data-fr-style]").remove(),t.$head.append('<style data-fr-style="true">'+i+"</style>");for(var n=0;n<t.opts.iframeStyleFiles.length;n++){var r=e('<link data-fr-style="true" rel="stylesheet" href="'+t.opts.iframeStyleFiles[n]+'">');r.get(0).addEventListener("load",t.size.syncIframe),t.$head.append(r)}}}function n(){t.opts.iframe||t.$el.addClass("fr-element fr-view")}function r(){if(t.$box.addClass("fr-box"+(t.opts.editorClass?" "+t.opts.editorClass:"")),t.$wp.addClass("fr-wrapper"),n(),t.opts.iframe){t.$iframe.addClass("fr-iframe"),t.$el.addClass("fr-view");for(var e=0;e<t.o_doc.styleSheets.length;e++){var i;try{i=t.o_doc.styleSheets[e].cssRules}catch(r){}if(i)for(var s=0,o=i.length;o>s;s++)!i[s].selectorText||0!==i[s].selectorText.indexOf(".fr-view")&&0!==i[s].selectorText.indexOf(".fr-element")||i[s].style.cssText.length>0&&(t.opts.iframeStyle+=0===i[s].selectorText.indexOf(".fr-view")?i[s].selectorText.replace(/\.fr-view/g,"body")+"{"+i[s].style.cssText+"}":i[s].selectorText.replace(/\.fr-element/g,"body")+"{"+i[s].style.cssText+"}")}}"auto"!=t.opts.direction&&t.$box.removeClass("fr-ltr fr-rtl").addClass("fr-"+t.opts.direction),t.$el.attr("dir",t.opts.direction),t.$wp.attr("dir",t.opts.direction),t.opts.zIndex>1&&t.$box.css("z-index",t.opts.zIndex),t.opts.theme&&t.$box.addClass(t.opts.theme+"-theme")}function s(){return t.node.isEmpty(t.$el.get(0))}function o(){t.drag_support={filereader:"undefined"!=typeof FileReader,formdata:!!t.win.FormData,progress:"upload"in new XMLHttpRequest}}function a(e,i){var n=new XMLHttpRequest;n.open(i,e,!0),t.opts.requestWithCredentials&&(n.withCredentials=!0);for(var r in t.opts.requestHeaders)t.opts.requestHeaders.hasOwnProperty(r)&&n.setRequestHeader(r,t.opts.requestHeaders[r]);return n}function l(e){"TEXTAREA"==t.$oel.get(0).tagName&&t.$oel.val(e),t.$wp&&("TEXTAREA"==t.$oel.get(0).tagName?(t.$el.html(""),t.$wp.html(""),t.$box.replaceWith(t.$oel),t.$oel.show()):(t.$wp.replaceWith(e),t.$el.html(""),t.$box.removeClass("fr-view fr-ltr fr-box "+(t.opts.editorClass||"")),t.opts.theme&&t.$box.addClass(t.opts.theme+"-theme"))),this.$wp=null,this.$el=null,this.$box=null}function c(){return t.browser.mozilla&&t.helpers.isMobile()?t.selection.inEditor():t.node.hasFocus(t.$el.get(0))||t.$el.find("*:focus").length>0}function d(e){if(!e)return!1;var i=e.data("instance");return i?i.id==t.id:!1}function u(){if(e.FE.INSTANCES.push(t),o(),t.$wp){r(),t.html.set(t._original_html),t.$el.attr("spellcheck",t.opts.spellcheck),t.helpers.isMobile()&&(t.$el.attr("autocomplete",t.opts.spellcheck?"on":"off"),t.$el.attr("autocorrect",t.opts.spellcheck?"on":"off"),t.$el.attr("autocapitalize",t.opts.spellcheck?"on":"off")),t.opts.disableRightClick&&t.events.$on(t.$el,"contextmenu",function(e){return 2==e.button?!1:void 0});try{t.doc.execCommand("styleWithCSS",!1,!1)}catch(i){}}t.events.on("drop",function(e){e.preventDefault(),e.stopPropagation()}),"TEXTAREA"==t.$oel.get(0).tagName&&(t.events.on("contentChanged",function(){t.$oel.val(t.html.get())}),t.events.on("form.submit",function(){t.$oel.val(t.html.get())}),t.events.on("form.reset",function(){t.html.set(t._original_html)}),t.$oel.val(t.html.get())),t.helpers.isIOS()&&t.events.$on(t.$doc,"selectionchange",function(){t.$doc.get(0).hasFocus()||t.$win.get(0).focus()}),t.events.trigger("init")}return{_init:u,destroy:l,isEmpty:s,getXHR:a,injectStyle:i,hasFocus:c,sameInstance:d}},e.FE.MODULES.format=function(t){function i(e,t){var i="<"+e;for(var n in t)t.hasOwnProperty(n)&&(i+=" "+n+'="'+t[n]+'"');return i+=">"}function n(e){return"</"+e+">"}function r(e,t){var i=e;for(var n in t)t.hasOwnProperty(n)&&(e+="id"==n?"#"+t[n]:"class"==n?"."+t[n]:"["+n+'="'+t[n]+'"]');return i}function s(e,t){return e&&e.nodeType==Node.ELEMENT_NODE?(e.matches||e.matchesSelector||e.msMatchesSelector||e.mozMatchesSelector||e.webkitMatchesSelector||e.oMatchesSelector).call(e,t):!1}function o(n,r,s){if(n){if(t.node.isBlock(n))return o(n.firstChild,r,s),!1;for(var a=e(i(r,s)).insertBefore(n),l=n;l&&!e(l).is(".fr-marker")&&0==e(l).find(".fr-marker").length;){var c=l;l=l.nextSibling,a.append(c)}if(l)e(l).find(".fr-marker").length&&o(l.firstChild,r,s);else{for(var d=a.get(0).parentNode;d&&!d.nextSibling&&!t.node.isElement(d);)d=d.parentNode;if(d){var u=d.nextSibling;u&&(t.node.isBlock(u)?o(u.firstChild,r,s):o(u,r,s))}}a.is(":empty")&&a.remove()}}function a(a,l){if("undefined"==typeof l&&(l={}),l.style&&delete l.style,t.selection.isCollapsed()){t.markers.insert();var c=t.$el.find(".fr-marker");c.replaceWith(i(a,l)+e.FE.INVISIBLE_SPACE+e.FE.MARKERS+n(a)),t.selection.restore()}else{t.selection.save();var d=t.$el.find('.fr-marker[data-type="true"]').get(0).nextSibling;o(d,a,l);var u;do u=t.$el.find(r(a,l)+" > "+r(a,l)),u.each(function(){e(this).replaceWith(this.innerHTML)});while(u.length);t.$el.get(0).normalize();for(var h=t.$el.get(0).querySelectorAll(".fr-marker"),p=0;p<h.length;p++){var f=e(h[p]);1==f.data("type")?s(f.get(0).nextSibling,r(a,l))&&f.next().prepend(f):s(f.get(0).previousSibling,r(a,l))&&f.prev().append(f)}t.selection.restore()}}function l(e,i,n,o){if(!o){var a=!1;if(e.data("type")===!0)for(;t.node.isFirstSibling(e.get(0))&&!e.parent().is(t.$el);)e.parent().before(e),a=!0;else if(e.data("type")===!1)for(;t.node.isLastSibling(e.get(0))&&!e.parent().is(t.$el);)e.parent().after(e),a=!0;if(a)return!0}if(e.parents(i).length||"undefined"==typeof i){var l="",c="",d=e.parent();if(d.is(t.$el)||t.node.isBlock(d.get(0)))return!1;for(;"undefined"==typeof i&&!t.node.isBlock(d.parent().get(0))||"undefined"!=typeof i&&!s(d.get(0),r(i,n));)l+=t.node.closeTagString(d.get(0)),c=t.node.openTagString(d.get(0))+c,d=d.parent();var u=e.get(0).outerHTML;e.replaceWith('<span id="mark"></span>');var h=d.html().replace(/<span id="mark"><\/span>/,l+t.node.closeTagString(d.get(0))+c+u+l+t.node.openTagString(d.get(0))+c);return d.replaceWith(t.node.openTagString(d.get(0))+h+t.node.closeTagString(d.get(0))),!0}return!1}function c(i,n,o,a){for(var l=t.node.contents(i.get(0)),d=0;d<l.length;d++){var u=l[d];e(u).hasClass("fr-marker")?n=(n+1)%2:n?e(u).find(".fr-marker").length>0?n=c(e(u),n,o,a):(e(e(u).find(o||"*").get().reverse()).each(function(){t.node.isBlock(this)||t.node.isVoid(this)||e(this).replaceWith(this.innerHTML)}),("undefined"==typeof o&&u.nodeType==Node.ELEMENT_NODE&&!t.node.isVoid(u)&&!t.node.isBlock(u)||s(u,r(o,a)))&&e(u).replaceWith(u.innerHTML)):e(u).find(".fr-marker").length>0&&(n=c(e(u),n,o,a))}return n}function d(i,n){"undefined"==typeof n&&(n={}),n.style&&delete n.style;var r=t.selection.isCollapsed();t.selection.save();for(var s=!0;s;){s=!1;for(var o=t.$el.find(".fr-marker"),a=0;a<o.length;a++)if(l(e(o[a]),i,n,r)){s=!0;break}}c(t.$el,0,i,n),r&&t.$el.find(".fr-marker").before(e.FE.INVISIBLE_SPACE).after(e.FE.INVISIBLE_SPACE),t.html.cleanEmptyTags(),t.$el.get(0).normalize(),t.selection.restore()}function u(e,t){g(e,t)?d(e,t):a(e,t)}function h(t,i){var n=e(t);n.css(i,""),""===n.attr("style")&&n.replaceWith(n.html())}function p(t,i){return 0===e(t).attr("style").indexOf(i+":")||e(t).attr("style").indexOf(";"+i+":")>=0||e(t).attr("style").indexOf("; "+i+":")>=0}function f(i,n){if(t.selection.isCollapsed()){t.markers.insert();var r=t.$el.find(".fr-marker"),s=r.parent();t.node.openTagString(s.get(0))=='<span style="'+i+": "+s.css(i)+';">'&&t.node.isEmpty(s.get(0))?s.replaceWith('<span style="'+i+": "+n+';">'+e.FE.INVISIBLE_SPACE+e.FE.MARKERS+"</span>"):t.node.isEmpty(s.get(0))&&s.is("span")?(r.replaceWith(e.FE.MARKERS),s.css(i,n)):r.replaceWith('<span style="'+i+": "+n+';">'+e.FE.INVISIBLE_SPACE+e.FE.MARKERS+"</span>"),t.selection.restore()}else{if(t.selection.save(),null===n)for(var a=t.$el.find(".fr-marker"),l=0;l<a.length;l++){var r=e(a[l]);if(r.data("type")===!0)for(;t.node.isFirstSibling(r.get(0))&&!r.parent().is(t.$el);)r.parent().before(r);else for(;t.node.isLastSibling(r.get(0))&&!r.parent().is(t.$el);)r.parent().after(r)}var c=t.$el.find('.fr-marker[data-type="true"]').get(0).nextSibling,d={"class":"fr-unprocessed"};for(n&&(d.style=i+": "+n+";"),o(c,"span",d),t.$el.find(".fr-marker + .fr-unprocessed").each(function(){e(this).prepend(e(this).prev())}),t.$el.find(".fr-unprocessed + .fr-marker").each(function(){e(this).prev().append(this)});t.$el.find("span.fr-unprocessed").length>0;){var u=t.$el.find("span.fr-unprocessed:first").removeClass("fr-unprocessed");if(u.parent().get(0).normalize(),u.parent().is("span")&&1==u.parent().get(0).childNodes.length){u.parent().css(i,n);var f=u;u=u.parent(),f.replaceWith(f.html())}for(var m=u.find("span"),l=m.length-1;l>=0;l--)h(m[l],i);var g=u.parentsUntil(t.$el,"span[style]").filter(function(){return p(this,i)});if(g.length){var v="",_="",y="",b="",w=u.get(0);do w=w.parentNode,e(w).addClass("fr-split"),v+=t.node.closeTagString(w),_=t.node.openTagString(e(w).clone().addClass("fr-split").get(0))+_,g.get(0)!=w&&(y+=t.node.closeTagString(w),b=t.node.openTagString(e(w).clone().addClass("fr-split").get(0))+b);while(g.get(0)!=w);var k=v+t.node.openTagString(e(g.get(0)).clone().css(i,n||"").get(0))+b+u.css(i,"").get(0).outerHTML+y+"</span>"+_;u.replaceWith('<span id="fr-break"></span>');var C=g.get(0).outerHTML;e(g.get(0)).replaceWith(C.replace(/<span id="fr-break"><\/span>/g,k))}}for(;t.$el.find(".fr-split:empty").length>0;)t.$el.find(".fr-split:empty").remove();t.$el.find(".fr-split").removeClass("fr-split"),t.$el.find('span[style=""]').removeAttr("style"),t.$el.find('span[class=""]').removeAttr("class"),t.html.cleanEmptyTags(),e(t.$el.find("span").get().reverse()).each(function(){this.attributes&&0!=this.attributes.length||e(this).replaceWith(this.innerHTML)}),t.$el.get(0).normalize();var x=t.$el.find("span[style] + span[style]");for(l=0;l<x.length;l++){var A=e(x[l]),T=e(x[l]).prev();A.get(0).previousSibling==T.get(0)&&t.node.openTagString(A.get(0))==t.node.openTagString(T.get(0))&&(A.prepend(T.html()),T.remove())}t.$el.get(0).normalize(),t.selection.restore()}}function m(e){f(e,null)}function g(e,i){"undefined"==typeof i&&(i={}),i.style&&delete i.style;var n=t.selection.ranges(0),o=n.startContainer;o.nodeType==Node.ELEMENT_NODE&&o.childNodes.length>0&&o.childNodes[n.startOffset]&&(o=o.childNodes[n.startOffset]);for(var a=o;a&&a.nodeType==Node.ELEMENT_NODE&&!s(a,r(e,i));)a=a.firstChild;if(a&&a.nodeType==Node.ELEMENT_NODE&&s(a,r(e,i)))return!0;var l=o;for(l&&l.nodeType!=Node.ELEMENT_NODE&&(l=l.parentNode);l&&l.nodeType==Node.ELEMENT_NODE&&l!=t.$el.get(0)&&!s(l,r(e,i));)l=l.parentNode;return l&&l.nodeType==Node.ELEMENT_NODE&&l!=t.$el.get(0)&&s(l,r(e,i))?!0:!1}return{is:g,toggle:u,apply:a,remove:d,applyStyle:f,removeStyle:m}},e.FE.COMMANDS={bold:{title:"Bold",refresh:function(e){e.toggleClass("fr-active",this.format.is("strong"))}},italic:{title:"Italic",refresh:function(e){e.toggleClass("fr-active",this.format.is("em"))}},underline:{title:"Underline",refresh:function(e){e.toggleClass("fr-active",this.format.is("u"))}},strikeThrough:{title:"Strikethrough",refresh:function(e){e.toggleClass("fr-active",this.format.is("s"))}},subscript:{title:"Subscript",refresh:function(e){e.toggleClass("fr-active",this.format.is("sub"))}},superscript:{title:"Superscript",refresh:function(e){e.toggleClass("fr-active",this.format.is("sup"))}},outdent:{title:"Decrease Indent"},indent:{title:"Increase Indent"},undo:{title:"Undo",undo:!1,forcedRefresh:!0,disabled:!0},redo:{title:"Redo",undo:!1,forcedRefresh:!0,disabled:!0},insertHR:{title:"Insert Horizontal Line"},clearFormatting:{title:"Clear Formatting"},selectAll:{title:"Select All",undo:!1}},e.FE.RegisterCommand=function(t,i){e.FE.COMMANDS[t]=i},e.FE.MODULES.commands=function(t){function i(i,n){if(t.events.trigger("commands.before",e.merge([i],n||[]))!==!1){var r=e.FE.COMMANDS[i]&&e.FE.COMMANDS[i].callback||a[i],s=!0;e.FE.COMMANDS[i]&&"undefined"!=typeof e.FE.COMMANDS[i].focus&&(s=e.FE.COMMANDS[i].focus),t.core.hasFocus()||!s||t.popups.areVisible()||t.events.focus(!0),e.FE.COMMANDS[i]&&e.FE.COMMANDS[i].undo!==!1&&t.undo.saveStep(),r&&r.apply(t,e.merge([i],n||[])),t.events.trigger("commands.after",e.merge([i],n||[])),e.FE.COMMANDS[i]&&e.FE.COMMANDS[i].undo!==!1&&t.undo.saveStep()}}function n(e,i){t.format.toggle(i)}function r(i){t.selection.save(),t.html.wrap(!0,!0,!0,!0),t.selection.restore();for(var n=t.selection.blocks(),r=0;r<n.length;r++)if("LI"!=n[r].tagName&&"LI"!=n[r].parentNode.tagName){var s=e(n[r]),o="rtl"==t.opts.direction||"rtl"==s.css("direction")?"margin-right":"margin-left",a=t.helpers.getPX(s.css(o));s.css(o,Math.max(a+20*i,0)||""),s.removeClass("fr-temp-div")}t.selection.save(),t.html.unwrap(),t.selection.restore()}function s(e){return function(){i(e)}}function o(){t.events.on("keydown",function(e){var i=t.selection.element();return i&&"HR"==i.tagName&&!t.keys.isArrow(e.which)?(e.preventDefault(),!1):void 0}),t.events.on("keyup",function(i){var n=t.selection.element();if(n&&"HR"==n.tagName)if(i.which==e.FE.KEYCODE.ARROW_LEFT||i.which==e.FE.KEYCODE.ARROW_UP){if(n.previousSibling)return t.node.isBlock(n.previousSibling)?t.selection.setAtEnd(n.previousSibling):e(n).before(e.FE.MARKERS),t.selection.restore(),!1}else if((i.which==e.FE.KEYCODE.ARROW_RIGHT||i.which==e.FE.KEYCODE.ARROW_DOWN)&&n.nextSibling)return t.node.isBlock(n.nextSibling)?t.selection.setAtStart(n.nextSibling):e(n).after(e.FE.MARKERS),t.selection.restore(),!1}),t.events.on("mousedown",function(e){return e.target&&"HR"==e.target.tagName?(e.preventDefault(),e.stopPropagation(),!1):void 0}),t.events.on("mouseup",function(){var i=t.selection.element(),n=t.selection.endElement();i==n&&i&&"HR"==i.tagName&&(i.nextSibling&&(t.node.isBlock(i.nextSibling)?t.selection.setAtStart(i.nextSibling):e(i).after(e.FE.MARKERS)),t.selection.restore())})}var a={bold:function(){n("bold","strong")},subscript:function(){n("subscript","sub")},superscript:function(){n("superscript","sup")},italic:function(){n("italic","em")},strikeThrough:function(){n("strikeThrough","s")},underline:function(){n("underline","u")},undo:function(){t.undo.run()},redo:function(){t.undo.redo()},indent:function(){r(1)},outdent:function(){r(-1)},show:function(){t.opts.toolbarInline&&t.toolbar.showInline(null,!0)},insertHR:function(){t.selection.remove();var e="";t.core.isEmpty()&&(e="<br>",t.html.defaultTag()&&(e="<"+t.html.defaultTag()+">"+e+"</"+t.html.defaultTag()+">")),t.html.insert('<hr id="fr-just">'+e);var i=t.$el.find("hr#fr-just");i.removeAttr("id"),t.selection.setAfter(i.get(0))||t.selection.setBefore(i.get(0)),t.selection.restore()},clearFormatting:function(){t.format.remove()},selectAll:function(){t.doc.execCommand("selectAll",!1,!1)}},l={};for(var c in a)a.hasOwnProperty(c)&&(l[c]=s(c));return e.extend(l,{exec:i,_init:o})},e.FE.MODULES.cursorLists=function(t){function i(e){for(var t=e;"LI"!=t.tagName;)t=t.parentNode;return t}function n(e){for(var i=e;!t.node.isList(i);)i=i.parentNode;return i}function r(r){var s,o=i(r),a=o.nextSibling,l=o.previousSibling,c=t.html.defaultTag();if(t.node.isEmpty(o,!0)&&a){for(var d="",u="",h=r.parentNode;!t.node.isList(h)&&h.parentNode&&"LI"!==h.parentNode.tagName;)d=t.node.openTagString(h)+d,u+=t.node.closeTagString(h),h=h.parentNode;d=t.node.openTagString(h)+d,u+=t.node.closeTagString(h);var p="";for(p=h.parentNode&&"LI"==h.parentNode.tagName?u+"<li>"+e.FE.MARKERS+"<br>"+d:c?u+"<"+c+">"+e.FE.MARKERS+"<br>"+"</"+c+">"+d:u+e.FE.MARKERS+"<br>"+d,e(o).html('<span id="fr-break"></span>');["UL","OL"].indexOf(h.tagName)<0||h.parentNode&&"LI"===h.parentNode.tagName;)h=h.parentNode;var f=t.node.openTagString(h)+e(h).html()+t.node.closeTagString(h);f=f.replace(/<span id="fr-break"><\/span>/g,p),e(h).replaceWith(f),t.$el.find("li:empty").remove()}else l&&a||!t.node.isEmpty(o,!0)?(e(o).before("<li><br></li>"),e(r).remove()):l?(s=n(o),s.parentNode&&"LI"==s.parentNode.tagName?e(s.parentNode).after("<li>"+e.FE.MARKERS+"<br></li>"):c?e(s).after("<"+c+">"+e.FE.MARKERS+"<br></"+c+">"):e(s).after(e.FE.MARKERS+"<br>"),e(o).remove()):(s=n(o),s.parentNode&&"LI"==s.parentNode.tagName?a?e(s.parentNode).before("<li>"+e.FE.MARKERS+"<br></li>"):e(s.parentNode).after("<li>"+e.FE.MARKERS+"<br></li>"):c?e(s).before("<"+c+">"+e.FE.MARKERS+"<br></"+c+">"):e(s).before(e.FE.MARKERS+"<br>"),e(o).remove())}function s(n){for(var r=i(n),s="",o=n,a="",l="";o!=r;){o=o.parentNode;var c="A"==o.tagName&&t.cursor.isAtEnd(n,o)?"fr-to-remove":"";a=t.node.openTagString(e(o).clone().addClass(c).get(0))+a,l=t.node.closeTagString(o)+l}s=l+s+a+e.FE.MARKERS,e(n).replaceWith('<span id="fr-break"></span>');var d=t.node.openTagString(r)+e(r).html()+t.node.closeTagString(r);d=d.replace(/<span id="fr-break"><\/span>/g,s),e(r).replaceWith(d)}function o(n){for(var r=i(n),s=e.FE.MARKERS,o="",a=n,l=!1;a!=r;){a=a.parentNode;var c="A"==a.tagName&&t.cursor.isAtEnd(n,a)?"fr-to-remove":"";l||a==r||t.node.isBlock(a)||(l=!0,o+=e.FE.INVISIBLE_SPACE),o=t.node.openTagString(e(a).clone().addClass(c).get(0))+o,s+=t.node.closeTagString(a)}var d=o+s;e(n).remove(),e(r).after(d)}function a(r){var s=i(r),o=s.previousSibling;if(o){o=e(o).find(t.html.blockTagsQuery()).get(-1)||o,e(r).replaceWith(e.FE.MARKERS);var a=t.node.contents(o);a.length&&"BR"==a[a.length-1].tagName&&e(a[a.length-1]).remove(),e(s).find(t.html.blockTagsQuery()).not("ol, ul, table").each(function(){this.parentNode==s&&e(this).replaceWith(e(this).html()+(t.node.isEmpty(this)?"":"<br>"))});for(var l,c=t.node.contents(s)[0];c&&!t.node.isList(c);)l=c.nextSibling,e(o).append(c),c=l;for(o=s.previousSibling;c;)l=c.nextSibling,e(o).append(c),c=l;e(s).remove()}else{var d=n(s);if(e(r).replaceWith(e.FE.MARKERS),d.parentNode&&"LI"==d.parentNode.tagName){var u=d.previousSibling;t.node.isBlock(u)?(e(s).find(t.html.blockTagsQuery()).not("ol, ul, table").each(function(){this.parentNode==s&&e(this).replaceWith(e(this).html()+(t.node.isEmpty(this)?"":"<br>"))}),e(u).append(e(s).html())):e(d).before(e(s).html())}else{var h=t.html.defaultTag();h&&0===e(s).find(t.html.blockTagsQuery()).length?e(d).before("<"+h+">"+e(s).html()+"</"+h+">"):e(d).before(e(s).html())}e(s).remove(),0===e(d).find("li").length&&e(d).remove()}}function l(n){var r,s=i(n),o=s.nextSibling;if(o){r=t.node.contents(o),r.length&&"BR"==r[0].tagName&&e(r[0]).remove(),e(o).find(t.html.blockTagsQuery()).not("ol, ul, table").each(function(){this.parentNode==o&&e(this).replaceWith(e(this).html()+(t.node.isEmpty(this)?"":"<br>"))});for(var a,l=n,c=t.node.contents(o)[0];c&&!t.node.isList(c);)a=c.nextSibling,e(l).after(c),l=c,c=a;for(;c;)a=c.nextSibling,e(s).append(c),c=a;e(n).replaceWith(e.FE.MARKERS),e(o).remove()}else{for(var d=s;!d.nextSibling&&d!=t.$el.get(0);)d=d.parentNode;if(d==t.$el.get(0))return!1;if(d=d.nextSibling,t.node.isBlock(d))e.FE.NO_DELETE_TAGS.indexOf(d.tagName)<0&&(e(n).replaceWith(e.FE.MARKERS),r=t.node.contents(s),r.length&&"BR"==r[r.length-1].tagName&&e(r[r.length-1]).remove(),e(s).append(e(d).html()),e(d).remove());else for(r=t.node.contents(s),r.length&&"BR"==r[r.length-1].tagName&&e(r[r.length-1]).remove(),e(n).replaceWith(e.FE.MARKERS);d&&!t.node.isBlock(d)&&"BR"!=d.tagName;)e(s).append(e(d)),d=d.nextSibling}}return{_startEnter:r,_middleEnter:s,_endEnter:o,_backspace:a,_del:l}},e.FE.NO_DELETE_TAGS=["TH","TD","TABLE","FORM"],e.FE.SIMPLE_ENTER_TAGS=["TH","TD","LI","DL","DT","FORM"],e.FE.MODULES.cursor=function(t){function i(e){return e?t.node.isBlock(e)?!0:e.nextSibling?!1:i(e.parentNode):!1}function n(e){return e?t.node.isBlock(e)?!0:e.previousSibling?!1:n(e.parentNode):!1}function r(e,i){return e?e==t.$wp.get(0)?!1:e.previousSibling?!1:e.parentNode==i?!0:r(e.parentNode,i):!1}function s(e,i){return e?e==t.$wp.get(0)?!1:e.nextSibling?!1:e.parentNode==i?!0:s(e.parentNode,i):!1}function o(i){return e(i).parentsUntil(t.$el,"LI").length>0&&0===e(i).parentsUntil("LI","TABLE").length}function a(i){var n=e(i).parentsUntil(t.$el,"BLOCKQUOTE").length>0,r=t.node.deepestParent(i,[],!n);if(r&&"BLOCKQUOTE"==r.tagName){var s=t.node.deepestParent(i,[e(i).parentsUntil(t.$el,"BLOCKQUOTE").get(0)]);s&&s.previousSibling&&(r=s)}if(null!==r){var o,a=r.previousSibling;if(t.node.isBlock(r)&&t.node.isEditable(r)&&a&&e.FE.NO_DELETE_TAGS.indexOf(a.tagName)<0)if(t.node.isDeletable(a))e(a).remove(),e(i).replaceWith(e.FE.MARKERS);else if(t.node.isEditable(a))if(t.node.isBlock(a))if(t.node.isEmpty(a)&&!t.node.isList(a))e(a).remove();else{if(t.node.isList(a)&&(a=e(a).find("li:last").get(0)),o=t.node.contents(a),o.length&&"BR"==o[o.length-1].tagName&&e(o[o.length-1]).remove(),"BLOCKQUOTE"==a.tagName&&"BLOCKQUOTE"!=r.tagName)for(o=t.node.contents(a);o.length&&t.node.isBlock(o[o.length-1]);)a=o[o.length-1],o=t.node.contents(a);else if("BLOCKQUOTE"!=a.tagName&&"BLOCKQUOTE"==r.tagName)for(o=t.node.contents(r);o.length&&t.node.isBlock(o[0]);)r=o[0],o=t.node.contents(r);e(i).replaceWith(e.FE.MARKERS),e(a).append(t.node.isEmpty(r)?e.FE.MARKERS:r.innerHTML),e(r).remove()}else e(i).replaceWith(e.FE.MARKERS),"BLOCKQUOTE"==r.tagName&&a.nodeType==Node.ELEMENT_NODE?e(a).remove():(e(a).after(t.node.isEmpty(r)?"":e(r).html()),e(r).remove(),"BR"==a.tagName&&e(a).remove())}}function l(i){for(var n=i;!n.previousSibling;)if(n=n.parentNode,t.node.isElement(n))return!1;n=n.previousSibling;var r;if(!t.node.isBlock(n)&&t.node.isEditable(n)){for(r=t.node.contents(n);n.nodeType!=Node.TEXT_NODE&&!t.node.isDeletable(n)&&r.length&&t.node.isEditable(n);)n=r[r.length-1],r=t.node.contents(n);if(n.nodeType==Node.TEXT_NODE){if(t.helpers.isIOS())return!0;var s=n.textContent,o=s.length-1;if(t.opts.tabSpaces&&s.length>=t.opts.tabSpaces){var a=s.substr(s.length-t.opts.tabSpaces,s.length-1);0==a.replace(/ /g,"").replace(new RegExp(e.FE.UNICODE_NBSP,"g"),"").length&&(o=s.length-t.opts.tabSpaces)}n.textContent=s.substring(0,o),n.textContent.length&&55357==n.textContent.charCodeAt(n.textContent.length-1)&&(n.textContent=n.textContent.substr(0,n.textContent.length-1)),0==n.textContent.length?2!=n.parentNode.childNodes.length||n.parentNode!=i.parentNode||t.node.isBlock(n.parentNode)||t.node.isElement(n.parentNode)?(e(n).after(e.FE.MARKERS),t.node.isElement(n.parentNode)&&!i.nextSibling&&n.previousSibling&&"BR"==n.previousSibling.tagName&&e(i).after("<br>"),n.parentNode.removeChild(n)):(e(n.parentNode).after(e.FE.MARKERS),e(n.parentNode).remove()):e(n).after(e.FE.MARKERS)}else t.node.isDeletable(n)?(e(n).after(e.FE.MARKERS),e(n).remove()):t.events.trigger("node.remove",[e(n)])!==!1&&(e(n).after(e.FE.MARKERS),e(n).remove())}else if(e.FE.NO_DELETE_TAGS.indexOf(n.tagName)<0&&t.node.isEditable(n))if(t.node.isEmpty(n)&&!t.node.isList(n))e(n).remove(),e(i).replaceWith(e.FE.MARKERS);else{for(t.node.isList(n)&&(n=e(n).find("li:last").get(0)),r=t.node.contents(n),r&&"BR"==r[r.length-1].tagName&&e(r[r.length-1]).remove(),r=t.node.contents(n);r&&t.node.isBlock(r[r.length-1]);)n=r[r.length-1],r=t.node.contents(n);e(n).append(e.FE.MARKERS);for(var l=i;!l.previousSibling;)l=l.parentNode;for(;l&&"BR"!==l.tagName&&!t.node.isBlock(l);){var c=l;l=l.nextSibling,e(n).append(c)}l&&"BR"==l.tagName&&e(l).remove(),e(i).remove()}else i.nextSibling&&"BR"==i.nextSibling.tagName&&e(i.nextSibling).remove()}function c(){var s=!1,c=t.markers.insert();if(!c)return!0;t.$el.get(0).normalize();var d=c.previousSibling;if(d){var u=d.textContent;u&&u.length&&8203==u.charCodeAt(u.length-1)&&(1==u.length?e(d).remove():(d.textContent=d.textContent.substr(0,u.length-1),d.textContent.length&&55357==d.textContent.charCodeAt(d.textContent.length-1)&&(d.textContent=d.textContent.substr(0,d.textContent.length-1))))}return i(c)?s=l(c):n(c)?o(c)&&r(c,e(c).parents("li:first").get(0))?t.cursorLists._backspace(c):a(c):s=l(c),e(c).remove(),t.$el.find("blockquote:empty").remove(),t.html.fillEmptyBlocks(),t.html.cleanEmptyTags(),t.clean.quotes(),t.clean.lists(),t.spaces.normalize(),t.selection.restore(),s}function d(i){var n=e(i).parentsUntil(t.$el,"BLOCKQUOTE").length>0,r=t.node.deepestParent(i,[],!n);if(r&&"BLOCKQUOTE"==r.tagName){var s=t.node.deepestParent(i,[e(i).parentsUntil(t.$el,"BLOCKQUOTE").get(0)]);s&&s.nextSibling&&(r=s)}if(null!==r){var o,a=r.nextSibling;if(t.node.isBlock(r)&&(t.node.isEditable(r)||t.node.isDeletable(r))&&a&&e.FE.NO_DELETE_TAGS.indexOf(a.tagName)<0)if(t.node.isDeletable(a))e(a).remove(),e(i).replaceWith(e.FE.MARKERS);else if(t.node.isBlock(a)&&t.node.isEditable(a))if(t.node.isList(a))if(t.node.isEmpty(r,!0))e(r).remove(),e(a).find("li:first").prepend(e.FE.MARKERS);else{var l=e(a).find("li:first");"BLOCKQUOTE"==r.tagName&&(o=t.node.contents(r),o.length&&t.node.isBlock(o[o.length-1])&&(r=o[o.length-1])),0===l.find("ul, ol").length&&(e(i).replaceWith(e.FE.MARKERS),l.find(t.html.blockTagsQuery()).not("ol, ul, table").each(function(){this.parentNode==l.get(0)&&e(this).replaceWith(e(this).html()+(t.node.isEmpty(this)?"":"<br>"))}),e(r).append(t.node.contents(l.get(0))),l.remove(),0===e(a).find("li").length&&e(a).remove())}else{if(o=t.node.contents(a),o.length&&"BR"==o[0].tagName&&e(o[0]).remove(),"BLOCKQUOTE"!=a.tagName&&"BLOCKQUOTE"==r.tagName)for(o=t.node.contents(r);o.length&&t.node.isBlock(o[o.length-1]);)r=o[o.length-1],o=t.node.contents(r);else if("BLOCKQUOTE"==a.tagName&&"BLOCKQUOTE"!=r.tagName)for(o=t.node.contents(a);o.length&&t.node.isBlock(o[0]);)a=o[0],o=t.node.contents(a);e(i).replaceWith(e.FE.MARKERS),e(r).append(a.innerHTML),e(a).remove()}else{for(e(i).replaceWith(e.FE.MARKERS);a&&"BR"!==a.tagName&&!t.node.isBlock(a)&&t.node.isEditable(a);){var c=a;a=a.nextSibling,e(r).append(c)}a&&"BR"==a.tagName&&t.node.isEditable(a)&&e(a).remove()}}}function u(n){for(var r=n;!r.nextSibling;)if(r=r.parentNode,t.node.isElement(r))return!1;if(r=r.nextSibling,"BR"==r.tagName&&t.node.isEditable(r))if(r.nextSibling){if(t.node.isBlock(r.nextSibling)&&t.node.isEditable(r.nextSibling)){if(!(e.FE.NO_DELETE_TAGS.indexOf(r.nextSibling.tagName)<0))return e(r).remove(),void 0;r=r.nextSibling,e(r.previousSibling).remove()}}else if(i(r)){if(o(n))t.cursorLists._del(n);else{var s=t.node.deepestParent(r);s&&(e(r).remove(),d(n))}return}var a;if(!t.node.isBlock(r)&&t.node.isEditable(r)){for(a=t.node.contents(r);r.nodeType!=Node.TEXT_NODE&&a.length&&!t.node.isDeletable(r)&&t.node.isEditable(r);)r=a[0],a=t.node.contents(r);r.nodeType==Node.TEXT_NODE?(e(r).before(e.FE.MARKERS),r.textContent=r.textContent.length&&55357==r.textContent.charCodeAt(0)?r.textContent.substring(2,r.textContent.length):r.textContent.substring(1,r.textContent.length)):t.node.isDeletable(r)?(e(r).before(e.FE.MARKERS),e(r).remove()):t.events.trigger("node.remove",[e(r)])!==!1&&(e(r).before(e.FE.MARKERS),e(r).remove()),e(n).remove()}else if(e.FE.NO_DELETE_TAGS.indexOf(r.tagName)<0&&(t.node.isEditable(r)||t.node.isDeletable(r)))if(t.node.isDeletable(r))e(n).replaceWith(e.FE.MARKERS),e(r).remove();else if(t.node.isList(r))n.previousSibling?(e(r).find("li:first").prepend(n),t.cursorLists._backspace(n)):(e(r).find("li:first").prepend(e.FE.MARKERS),e(n).remove());else if(a=t.node.contents(r),a&&"BR"==a[0].tagName&&e(a[0]).remove(),a&&"BLOCKQUOTE"==r.tagName){var l=a[0];for(e(n).before(e.FE.MARKERS);l&&"BR"!=l.tagName;){var c=l;l=l.nextSibling,e(n).before(c)
}l&&"BR"==l.tagName&&e(l).remove()}else e(n).after(e(r).html()).after(e.FE.MARKERS),e(r).remove()}function h(){var r=t.markers.insert();if(!r)return!1;if(t.$el.get(0).normalize(),i(r))if(o(r))if(0===e(r).parents("li:first").find("ul, ol").length)t.cursorLists._del(r);else{var s=e(r).parents("li:first").find("ul:first, ol:first").find("li:first");s=s.find(t.html.blockTagsQuery()).get(-1)||s,s.prepend(r),t.cursorLists._backspace(r)}else d(r);else n(r)?u(r):u(r);e(r).remove(),t.$el.find("blockquote:empty").remove(),t.html.fillEmptyBlocks(),t.html.cleanEmptyTags(),t.clean.quotes(),t.clean.lists(),t.spaces.normalize(),t.selection.restore()}function p(){t.$el.find(".fr-to-remove").each(function(){for(var i=t.node.contents(this),n=0;n<i.length;n++)i[n].nodeType==Node.TEXT_NODE&&(i[n].textContent=i[n].textContent.replace(/\u200B/g,""));e(this).replaceWith(this.innerHTML)})}function f(i,n,r){var o,a=t.node.deepestParent(i,[],!r);if(a&&"BLOCKQUOTE"==a.tagName)return s(i,a)?(o=t.html.defaultTag(),o?e(a).after("<"+o+">"+e.FE.MARKERS+"<br>"+"</"+o+">"):e(a).after(e.FE.MARKERS+"<br>"),e(i).remove(),!1):(g(i,n,r),!1);if(null==a)o=t.html.defaultTag(),o&&t.node.isElement(i.parentNode)?e(i).replaceWith("<"+o+">"+e.FE.MARKERS+"<br>"+"</"+o+">"):e(i).replaceWith("<br/>"+e.FE.MARKERS+"<br/>");else{var l=i,c="";(!t.node.isBlock(a)||n)&&(c="<br/>");var d="",u="";o=t.html.defaultTag();var h="",p="";o&&t.node.isBlock(a)&&(h="<"+o+">",p="</"+o+">",a.tagName==o.toUpperCase()&&(h=t.node.openTagString(e(a).clone().removeAttr("id").get(0))));do if(l=l.parentNode,!n||l!=a||n&&!t.node.isBlock(a))if(d+=t.node.closeTagString(l),l==a&&t.node.isBlock(a))u=h+u;else{var f="A"==l.tagName&&s(i,l)?"fr-to-remove":"";u=t.node.openTagString(e(l).clone().addClass(f).get(0))+u}while(l!=a);c=d+c+u+(i.parentNode==a&&t.node.isBlock(a)?"":e.FE.INVISIBLE_SPACE)+e.FE.MARKERS,t.node.isBlock(a)&&!e(a).find("*:last").is("br")&&e(a).append("<br/>"),e(i).after('<span id="fr-break"></span>'),e(i).remove(),a.nextSibling&&!t.node.isBlock(a.nextSibling)||t.node.isBlock(a)||e(a).after("<br>");var m;m=!n&&t.node.isBlock(a)?t.node.openTagString(a)+e(a).html()+p:t.node.openTagString(a)+e(a).html()+t.node.closeTagString(a),m=m.replace(/<span id="fr-break"><\/span>/g,c),e(a).replaceWith(m)}}function m(i,n,o){var a,l=t.node.deepestParent(i,[],!o);if(l&&"BLOCKQUOTE"==l.tagName){if(r(i,l))return a=t.html.defaultTag(),a?e(l).before("<"+a+">"+e.FE.MARKERS+"<br>"+"</"+a+">"):e(l).before(e.FE.MARKERS+"<br>"),e(i).remove(),!1;s(i,l)?f(i,n,!0):g(i,n,!0)}if(null==l)a=t.html.defaultTag(),a&&t.node.isElement(i.parentNode)?e(i).replaceWith("<"+a+">"+e.FE.MARKERS+"<br>"+"</"+a+">"):e(i).replaceWith("<br>"+e.FE.MARKERS);else{if(t.node.isBlock(l))if(n)e(i).remove(),e(l).prepend("<br>"+e.FE.MARKERS);else{if(t.node.isEmpty(l,!0))return f(i,n,o);e(l).before(t.node.openTagString(e(l).clone().removeAttr("id").get(0))+"<br>"+t.node.closeTagString(l))}else e(l).before("<br>");e(i).remove()}}function g(i,n,o){var a=t.node.deepestParent(i,[],!o);if(null==a)t.html.defaultTag()&&i.parentNode===t.$el.get(0)?e(i).replaceWith("<"+t.html.defaultTag()+">"+e.FE.MARKERS+"<br></"+t.html.defaultTag()+">"):((!i.nextSibling||t.node.isBlock(i.nextSibling))&&e(i).after("<br>"),e(i).replaceWith("<br>"+e.FE.MARKERS));else{var l=i,c="";"PRE"==a.tagName&&(n=!0),(!t.node.isBlock(a)||n)&&(c="<br>");var d="",u="";do{var h=l;if(l=l.parentNode,"BLOCKQUOTE"==a.tagName&&t.node.isEmpty(h)&&!e(h).hasClass("fr-marker")&&e(h).find(i).length>0&&e(h).after(i),("BLOCKQUOTE"!=a.tagName||!s(i,l)&&!r(i,l))&&(!n||l!=a||n&&!t.node.isBlock(a))){d+=t.node.closeTagString(l);var p="A"==l.tagName&&s(i,l)?"fr-to-remove":"";u=t.node.openTagString(e(l).clone().addClass(p).removeAttr("id").get(0))+u}}while(l!=a);var f=a==i.parentNode&&t.node.isBlock(a)||i.nextSibling;if("BLOCKQUOTE"==a.tagName){i.previousSibling&&t.node.isBlock(i.previousSibling)&&i.nextSibling&&"BR"==i.nextSibling.tagName&&(e(i.nextSibling).after(i),i.nextSibling&&"BR"==i.nextSibling.tagName&&e(i.nextSibling).remove());var m=t.html.defaultTag();c=d+c+(m?"<"+m+">":"")+e.FE.MARKERS+"<br>"+(m?"</"+m+">":"")+u}else c=d+c+u+(f?"":e.FE.INVISIBLE_SPACE)+e.FE.MARKERS;e(i).replaceWith('<span id="fr-break"></span>');var g=t.node.openTagString(a)+e(a).html()+t.node.closeTagString(a);g=g.replace(/<span id="fr-break"><\/span>/g,c),e(a).replaceWith(g)}}function v(r){var s=t.markers.insert();if(!s)return!0;t.$el.get(0).normalize();var a=!1;e(s).parentsUntil(t.$el,"BLOCKQUOTE").length>0&&(r=!1,a=!0),e(s).parentsUntil(t.$el,"TD, TH").length&&(a=!1),i(s)?!o(s)||r||a?f(s,r,a):t.cursorLists._endEnter(s):n(s)?!o(s)||r||a?m(s,r,a):t.cursorLists._startEnter(s):!o(s)||r||a?g(s,r,a):t.cursorLists._middleEnter(s),p(),t.html.fillEmptyBlocks(),t.html.cleanEmptyTags(),t.clean.lists(),t.spaces.normalize(),t.selection.restore()}return{enter:v,backspace:c,del:h,isAtEnd:s}},e.FE.MODULES.data=function(e){function t(e){return e}function i(e){if(!e)return e;for(var i="",s=t("charCodeAt"),o=t("fromCharCode"),a=u.indexOf(e[0]),l=1;l<e.length-2;l++){for(var c=n(++a),d=e[s](l),h="";/[0-9-]/.test(e[l+1]);)h+=e[++l];h=parseInt(h,10)||0,d=r(d,c,h),d^=31&a-1,i+=String[o](d)}return i}function n(e){for(var t=e.toString(),i=0,n=0;n<t.length;n++)i+=parseInt(t.charAt(n),10);return i>10?i%9+1:i}function r(e,t,i){for(var n=Math.abs(i);n-->0;)e-=t;return 0>i&&(e+=123),e}function s(e){return e&&"none"==e.css("display")?(e.remove(),!0):!1}function o(){return s(c)||s(d)}function a(){return e.$box?(e.$box.append(p(t(p("kTDD4spmKD1klaMB1C7A5RA1G3RA10YA5qhrjuvnmE1D3FD2bcG-7noHE6B2JB4C3xXA8WF6F-10RG2C3G3B-21zZE3C3H3xCA16NC4DC1f1hOF1MB3B-21whzQH5UA2WB10kc1C2F4D3XC2YD4D1C4F3GF2eJ2lfcD-13HF1IE1TC11TC7WE4TA4d1A2YA6XA4d1A3yCG2qmB-13GF4A1B1KH1HD2fzfbeQC3TD9VE4wd1H2A20A2B-22ujB3nBG2A13jBC10D3C2HD5D1H1KB11uD-16uWF2D4A3F-7C9D-17c1E4D4B3d1D2CA6B2B-13qlwzJF2NC2C-13E-11ND1A3xqUA8UE6bsrrF-7C-22ia1D2CF2H1E2akCD2OE1HH1dlKA6PA5jcyfzB-22cXB4f1C3qvdiC4gjGG2H2gklC3D-16wJC1UG4dgaWE2D5G4g1I2H3B7vkqrxH1H2EC9C3E4gdgzKF1OA1A5PF5C4WWC3VA6XA4e1E3YA2YA5HE4oGH4F2H2IB10D3D2NC5G1B1qWA9PD6PG5fQA13A10XA4C4A3e1H2BA17kC-22cmOB1lmoA2fyhcptwWA3RA8A-13xB-11nf1I3f1B7GB3aD3pavFC10D5gLF2OG1LSB2D9E7fQC1F4F3wpSB5XD3NkklhhaE-11naKA9BnIA6D1F5bQA3A10c1QC6Kjkvitc2B6BE3AF3E2DA6A4JD2IC1jgA-64MB11D6C4==")))),c=e.$box.find("> div:last"),d=c.find("> a"),void("rtl"==e.opts.direction&&c.css("left","auto").css("right",0))):!1}function l(){var i=e.opts.key||[""];"string"==typeof i&&(i=[i]),e.ul=!0;for(var n=0;n<i.length;n++){var r=p(i[n])||"";if(!(r!==p(t(p("mcVRDoB1BGILD7YFe1BTXBA7B6==")))&&r.indexOf(h,r.length-h.length)<0&&[p("9qqG-7amjlwq=="),p("KA3B3C2A6D1D5H5H1A3=="),p("QzbzvxyB2yA-9m==")].indexOf(h)<0)){e.ul=!1;break}}e.ul===!0&&a(),e.events.on("contentChanged",function(){e.ul===!0&&o()&&a()}),e.events.on("destroy",function(){c&&c.length&&c.remove()},!0)}var c,d,u="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",h=function(){for(var e=0,t=document.domain,i=t.split("."),n="_gd"+(new Date).getTime();e<i.length-1&&-1==document.cookie.indexOf(n+"="+n);)t=i.slice(-1-++e).join("."),document.cookie=n+"="+n+";domain="+t+";";return document.cookie=n+"=;expires=Thu, 01 Jan 1970 00:00:01 GMT;domain="+t+";",(t||"").replace(/(^\.*)|(\.*$)/g,"")}(),p=t(i);return{_init:l}},e.FE.ENTER_P=0,e.FE.ENTER_DIV=1,e.FE.ENTER_BR=2,e.FE.KEYCODE={BACKSPACE:8,TAB:9,ENTER:13,SHIFT:16,CTRL:17,ALT:18,ESC:27,SPACE:32,ARROW_LEFT:37,ARROW_UP:38,ARROW_RIGHT:39,ARROW_DOWN:40,DELETE:46,ZERO:48,ONE:49,TWO:50,THREE:51,FOUR:52,FIVE:53,SIX:54,SEVEN:55,EIGHT:56,NINE:57,FF_SEMICOLON:59,FF_EQUALS:61,QUESTION_MARK:63,A:65,B:66,C:67,D:68,E:69,F:70,G:71,H:72,I:73,J:74,K:75,L:76,M:77,N:78,O:79,P:80,Q:81,R:82,S:83,T:84,U:85,V:86,W:87,X:88,Y:89,Z:90,META:91,NUM_ZERO:96,NUM_ONE:97,NUM_TWO:98,NUM_THREE:99,NUM_FOUR:100,NUM_FIVE:101,NUM_SIX:102,NUM_SEVEN:103,NUM_EIGHT:104,NUM_NINE:105,NUM_MULTIPLY:106,NUM_PLUS:107,NUM_MINUS:109,NUM_PERIOD:110,NUM_DIVISION:111,SEMICOLON:186,DASH:189,EQUALS:187,COMMA:188,PERIOD:190,SLASH:191,APOSTROPHE:192,TILDE:192,SINGLE_QUOTE:222,OPEN_SQUARE_BRACKET:219,BACKSLASH:220,CLOSE_SQUARE_BRACKET:221},e.extend(e.FE.DEFAULTS,{enter:e.FE.ENTER_P,multiLine:!0,tabSpaces:0}),e.FE.MODULES.keys=function(t){function i(e){t.opts.multiLine?t.helpers.isIOS()||(e.preventDefault(),e.stopPropagation(),t.selection.isCollapsed()||t.selection.remove(),t.cursor.enter()):(e.preventDefault(),e.stopPropagation())}function n(e){e.preventDefault(),e.stopPropagation(),t.opts.multiLine&&(t.selection.isCollapsed()||t.selection.remove(),t.cursor.enter(!0))}function r(e){t.selection.isCollapsed()?t.cursor.backspace()||(e.preventDefault(),e.stopPropagation(),x=!1):(e.preventDefault(),e.stopPropagation(),t.selection.remove(),t.html.fillEmptyBlocks(),x=!1),t.placeholder.refresh()}function s(e){e.preventDefault(),e.stopPropagation(),""===t.selection.text()?t.cursor.del():t.selection.remove(),t.placeholder.refresh()}function o(i){if(t.browser.mozilla){i.preventDefault(),i.stopPropagation(),t.selection.isCollapsed()||t.selection.remove(),t.markers.insert();var n=t.$el.find(".fr-marker").get(0),r=n.previousSibling,s=n.nextSibling;!s&&n.parentNode&&"A"==n.parentNode.tagName?(e(n).parent().after("&nbsp;"+e.FE.MARKERS),e(n).remove()):(r&&r.nodeType==Node.TEXT_NODE&&1==r.textContent.length&&160==r.textContent.charCodeAt(0)?e(r).after(" "):e(n).before("&nbsp;"),e(n).replaceWith(e.FE.MARKERS)),t.selection.restore()}}function a(){if(t.browser.mozilla&&t.selection.isCollapsed()&&!S){var e=t.selection.ranges(0),i=e.startContainer,n=e.startOffset;i&&i.nodeType==Node.TEXT_NODE&&n<=i.textContent.length&&n>0&&32==i.textContent.charCodeAt(n-1)&&(t.selection.save(),t.spaces.normalize(),t.selection.restore())}}function l(){t.selection.isFull()&&setTimeout(function(){var i=t.html.defaultTag();i?t.$el.html("<"+i+">"+e.FE.MARKERS+"<br/></"+i+">"):t.$el.html(e.FE.MARKERS+"<br/>"),t.selection.restore(),t.placeholder.refresh(),t.button.bulkRefresh(),t.undo.saveStep()},0)}function c(e){if(t.opts.tabSpaces>0)if(t.selection.isCollapsed()){t.undo.saveStep(),e.preventDefault(),e.stopPropagation();for(var i="",n=0;n<t.opts.tabSpaces;n++)i+="&nbsp;";t.html.insert(i),t.placeholder.refresh(),t.undo.saveStep()}else e.preventDefault(),e.stopPropagation(),e.shiftKey?t.commands.outdent():t.commands.indent()}function d(){S=!1}function u(){return S}function h(a){t.events.disableBlur(),x=!0;var l=a.which;if(16===l)return!0;if(229===l)return S=!0,!0;S=!1;var d=y(l)&&!v(a),u=l==e.FE.KEYCODE.BACKSPACE||l==e.FE.KEYCODE.DELETE;if((t.selection.isFull()&&!t.opts.keepFormatOnDelete&&!t.placeholder.isVisible()||u&&t.placeholder.isVisible()&&t.opts.keepFormatOnDelete)&&(d||u)){var h=t.html.defaultTag();if(h?t.$el.html("<"+h+">"+e.FE.MARKERS+"<br/></"+h+">"):t.$el.html(e.FE.MARKERS+"<br/>"),t.selection.restore(),!y(l))return a.preventDefault(),!0}l==e.FE.KEYCODE.ENTER?a.shiftKey?n(a):i(a):l!=e.FE.KEYCODE.BACKSPACE||v(a)||a.altKey?l!=e.FE.KEYCODE.DELETE||v(a)||a.altKey?l==e.FE.KEYCODE.SPACE?o(a):l==e.FE.KEYCODE.TAB?c(a):v(a)||!y(a.which)||t.selection.isCollapsed()||a.ctrlKey||t.selection.remove():t.placeholder.isVisible()?(a.preventDefault(),a.stopPropagation()):s(a):t.placeholder.isVisible()?(a.preventDefault(),a.stopPropagation()):r(a),t.events.enableBlur()}function p(i){for(var n=0;n<i.length;n++)i[n].nodeType==Node.TEXT_NODE&&/\u200B/gi.test(i[n].textContent)?(i[n].textContent=i[n].textContent.replace(/\u200B/gi,""),0===i[n].textContent.length&&e(i[n]).remove()):i[n].nodeType==Node.ELEMENT_NODE&&"IFRAME"!=i[n].nodeType&&p(t.node.contents(i[n]))}function f(){if(!t.$wp)return!0;var i;t.opts.height||t.opts.heightMax?(i=t.position.getBoundingRect().top,t.helpers.isIOS()&&(i-=e(t.o_win).scrollTop()),t.opts.iframe&&(i+=t.$iframe.offset().top),i>t.$wp.offset().top-e(t.o_win).scrollTop()+t.$wp.height()-20&&t.$wp.scrollTop(i+t.$wp.scrollTop()-(t.$wp.height()+t.$wp.offset().top)+e(t.o_win).scrollTop()+20)):(i=t.position.getBoundingRect().top,t.opts.toolbarBottom&&(i+=t.opts.toolbarStickyOffset),t.helpers.isIOS()&&(i-=e(t.o_win).scrollTop()),t.opts.iframe&&(i+=t.$iframe.offset().top),i+=t.opts.toolbarStickyOffset,i>t.o_win.innerHeight-20&&e(t.o_win).scrollTop(i+e(t.o_win).scrollTop()-t.o_win.innerHeight+20),i=t.position.getBoundingRect().top,t.opts.toolbarBottom||(i-=t.opts.toolbarStickyOffset),t.helpers.isIOS()&&(i-=e(t.o_win).scrollTop()),t.opts.iframe&&(i+=t.$iframe.offset().top),i<t.$tb.height()+20&&e(t.o_win).scrollTop(i+e(t.o_win).scrollTop()-t.$tb.height()-20))}function m(){var i=t.selection.element(),n=t.node.blockParent(i);if(n&&"DIV"==n.tagName&&t.selection.info(n).atStart){var r=t.html.defaultTag();n.previousSibling&&"DIV"!=n.previousSibling.tagName&&r&&"div"!=r&&(t.selection.save(),e(n).replaceWith("<"+r+">"+n.innerHTML+"</"+r+">"),t.selection.restore())}}function g(i){if(S)return S=!1,!1;if(!t.selection.isCollapsed())return!0;if(i&&(i.which===e.FE.KEYCODE.META||i.which==e.FE.KEYCODE.CTRL))return!0;if(i&&_(i.which))return!0;i&&i.which==e.FE.KEYCODE.ENTER&&t.helpers.isIOS()&&m(),i&&(i.which==e.FE.KEYCODE.ENTER||i.which==e.FE.KEYCODE.BACKSPACE||i.which>=37&&i.which<=40&&!t.browser.msie)&&(i.which==e.FE.KEYCODE.BACKSPACE&&x||f());var n=Array.prototype.slice.call(t.$el.get(0).querySelectorAll(t.html.blockTagsQuery()),0);n.push(t.$el.get(0));for(var r=[],s=0;s<n.length;s++)if(["TD","TH"].indexOf(n[s].tagName)<0)for(var o=n[s].children,a=0;a<o.length;a++)"BR"==o[a].tagName&&r.push(o[a]);for(var n=[],s=0;s<r.length;s++){var l=r[s],c=l.previousSibling,d=l.nextSibling,u=t.node.blockParent(l)||t.$el.get(0);c&&u&&"BR"!=c.tagName&&!t.node.isBlock(c)&&!d&&e(u).text().replace(/\u200B/g,"").length>0&&e(c).text().length>0&&(t.$el.is(u)&&!d&&t.opts.enter==e.FE.ENTER_BR&&t.browser.msie||(t.selection.save(),e(l).remove(),t.selection.restore()))}r=[];var h=function(t){if(!t)return!1;var i=e(t).html();return i=i.replace(/<span[^>]*? class\s*=\s*["']?fr-marker["']?[^>]+>\u200b<\/span>/gi,""),i&&/\u200B/.test(i)&&i.replace(/\u200B/gi,"").length>0?!0:!1},g=function(e){var i=/[\u3041-\u3096\u30A0-\u30FF\u4E00-\u9FFF\u3130-\u318F\uAC00-\uD7AF]/gi;return!t.helpers.isIOS()||0===((e.textContent||"").match(i)||[]).length},v=t.selection.element();h(v)&&0===e(v).find("li").length&&!e(v).hasClass("fr-marker")&&"IFRAME"!=v.tagName&&g(v)&&(t.selection.save(),p(t.node.contents(v)),t.selection.restore()),!t.browser.mozilla&&t.html.doNormalize(v)&&(t.selection.save(),t.spaces.normalize(),t.selection.restore())}function v(e){if(-1!=navigator.userAgent.indexOf("Mac OS X")){if(e.metaKey&&!e.altKey)return!0}else if(e.ctrlKey&&!e.altKey)return!0;return!1}function _(t){return t>=e.FE.KEYCODE.ARROW_LEFT&&t<=e.FE.KEYCODE.ARROW_DOWN?!0:void 0}function y(i){if(i>=e.FE.KEYCODE.ZERO&&i<=e.FE.KEYCODE.NINE)return!0;if(i>=e.FE.KEYCODE.NUM_ZERO&&i<=e.FE.KEYCODE.NUM_MULTIPLY)return!0;if(i>=e.FE.KEYCODE.A&&i<=e.FE.KEYCODE.Z)return!0;if(t.browser.webkit&&0===i)return!0;switch(i){case e.FE.KEYCODE.SPACE:case e.FE.KEYCODE.QUESTION_MARK:case e.FE.KEYCODE.NUM_PLUS:case e.FE.KEYCODE.NUM_MINUS:case e.FE.KEYCODE.NUM_PERIOD:case e.FE.KEYCODE.NUM_DIVISION:case e.FE.KEYCODE.SEMICOLON:case e.FE.KEYCODE.FF_SEMICOLON:case e.FE.KEYCODE.DASH:case e.FE.KEYCODE.EQUALS:case e.FE.KEYCODE.FF_EQUALS:case e.FE.KEYCODE.COMMA:case e.FE.KEYCODE.PERIOD:case e.FE.KEYCODE.SLASH:case e.FE.KEYCODE.APOSTROPHE:case e.FE.KEYCODE.SINGLE_QUOTE:case e.FE.KEYCODE.OPEN_SQUARE_BRACKET:case e.FE.KEYCODE.BACKSLASH:case e.FE.KEYCODE.CLOSE_SQUARE_BRACKET:return!0;default:return!1}}function b(i){var n=i.which;return v(i)||n>=37&&40>=n||!y(n)&&n!=e.FE.KEYCODE.DELETE&&n!=e.FE.KEYCODE.BACKSPACE&&n!=e.FE.KEYCODE.ENTER?!0:(A||(T=t.snapshot.get()),clearTimeout(A),A=setTimeout(function(){A=null,t.undo.saveStep()},Math.max(250,t.opts.typingTimer)),void 0)}function w(e){return v(e)?!0:(T&&A&&(t.undo.saveStep(T),T=null),void 0)}function k(){A&&(clearTimeout(A),t.undo.saveStep(),T=null)}function C(){if(t.events.on("keydown",b),t.events.on("input",a),t.events.on("keyup",w),t.events.on("keypress",d),t.events.on("keydown",h),t.events.on("keyup",g),t.events.on("html.inserted",g),t.events.on("cut",l),t.$el.get(0).msGetInputContext)try{t.$el.get(0).msGetInputContext().addEventListener("MSCandidateWindowShow",function(){S=!0}),t.$el.get(0).msGetInputContext().addEventListener("MSCandidateWindowHide",function(){S=!1,g()})}catch(e){}}var x,A,T,S=!1;return{_init:C,ctrlKey:v,isCharacter:y,isArrow:_,forceUndo:k,isIME:u}},e.extend(e.FE.DEFAULTS,{pastePlain:!1,pasteDeniedTags:["colgroup","col"],pasteDeniedAttrs:["class","id","style"],pasteAllowLocalImages:!1}),e.FE.MODULES.paste=function(t){function i(i){e.FE.copied_html=t.html.getSelected(),e.FE.copied_text=e("<div>").html(e.FE.copied_html).text(),"cut"==i.type&&(t.undo.saveStep(),setTimeout(function(){t.html.wrap(),t.events.focus(),t.undo.saveStep()},0))}function n(e){if(f)return!1;if(e.originalEvent&&(e=e.originalEvent),t.events.trigger("paste.before",[e])===!1)return!1;if(u=t.$win.scrollTop(),e&&e.clipboardData&&e.clipboardData.getData){var i="",n=e.clipboardData.types;if(t.helpers.isArray(n))for(var s=0;s<n.length;s++)i+=n[s]+";";else i=n;if(h="",/text\/html/.test(i)?h=e.clipboardData.getData("text/html"):/text\/rtf/.test(i)&&t.browser.safari?h=e.clipboardData.getData("text/rtf"):/text\/plain/.test(i)&&!this.browser.mozilla&&(h=t.html.escapeEntities(e.clipboardData.getData("text/plain")).replace(/\n/g,"<br>")),""!==h)return a(),e.preventDefault&&(e.stopPropagation(),e.preventDefault()),!1;h=null}else if(e&&e.clipboardData&&"manual"==e.clipboardData.type)return h=e.clipboardData.dataHTML,a(),e.preventDefault&&(e.stopPropagation(),e.preventDefault()),!1;r()}function r(){t.selection.save(),t.events.disableBlur(),h=null,p?p.html(""):(p=e('<div contenteditable="true" style="position: fixed; top: 0; left: -9999px; height: 100%; width: 0; word-break: break-all; overflow:hidden; z-index: 9999; line-height: 140%;" tabindex="-1"></div>'),t.$box.after(p),t.events.on("destroy",function(){p.remove()})),p.focus(),t.win.setTimeout(a,1)}function s(i){i=i.replace(/<p(.*?)class="?'?MsoListParagraph"?'? ([\s\S]*?)>([\s\S]*?)<\/p>/gi,"<ul><li>$3</li></ul>"),i=i.replace(/<p(.*?)class="?'?NumberedText"?'? ([\s\S]*?)>([\s\S]*?)<\/p>/gi,"<ol><li>$3</li></ol>"),i=i.replace(/<p(.*?)class="?'?MsoListParagraphCxSpFirst"?'?([\s\S]*?)(level\d)?([\s\S]*?)>([\s\S]*?)<\/p>/gi,"<ul><li$3>$5</li>"),i=i.replace(/<p(.*?)class="?'?NumberedTextCxSpFirst"?'?([\s\S]*?)(level\d)?([\s\S]*?)>([\s\S]*?)<\/p>/gi,"<ol><li$3>$5</li>"),i=i.replace(/<p(.*?)class="?'?MsoListParagraphCxSpMiddle"?'?([\s\S]*?)(level\d)?([\s\S]*?)>([\s\S]*?)<\/p>/gi,"<li$3>$5</li>"),i=i.replace(/<p(.*?)class="?'?NumberedTextCxSpMiddle"?'?([\s\S]*?)(level\d)?([\s\S]*?)>([\s\S]*?)<\/p>/gi,"<li$3>$5</li>"),i=i.replace(/<p(.*?)class="?'?MsoListBullet"?'?([\s\S]*?)(level\d)?([\s\S]*?)>([\s\S]*?)<\/p>/gi,"<li$3>$5</li>"),i=i.replace(/<p(.*?)class="?'?MsoListParagraphCxSpLast"?'?([\s\S]*?)(level\d)?([\s\S]*?)>([\s\S]*?)<\/p>/gi,"<li$3>$5</li></ul>"),i=i.replace(/<p(.*?)class="?'?NumberedTextCxSpLast"?'?([\s\S]*?)(level\d)?([\s\S]*?)>([\s\S]*?)<\/p>/gi,"<li$3>$5</li></ol>"),i=i.replace(/<span([^<]*?)style="?'?mso-list:Ignore"?'?([\s\S]*?)>([\s\S]*?)<span/gi,"<span><span"),i=i.replace(/<!--\[if \!supportLists\]-->([\s\S]*?)<!--\[endif\]-->/gi,""),i=i.replace(/<!\[if \!supportLists\]>([\s\S]*?)<!\[endif\]>/gi,""),i=i.replace(/(\n|\r| class=(")?Mso[a-zA-Z0-9]+(")?)/gi," "),i=i.replace(/<!--[\s\S]*?-->/gi,""),i=i.replace(/<(\/)*(meta|link|span|\\?xml:|st1:|o:|font)(.*?)>/gi,"");for(var n=["style","script","applet","embed","noframes","noscript"],r=0;r<n.length;r++){var s=new RegExp("<"+n[r]+".*?"+n[r]+"(.*?)>","gi");i=i.replace(s,"")}i=i.replace(/&nbsp;/gi," "),i=i.replace(/<td([^>]*)><\/td>/g,"<td$1><br></td>"),i=i.replace(/<th([^>]*)><\/th>/g,"<th$1><br></th>");var o;do o=i,i=i.replace(/<[^\/>][^>]*><\/[^>]+>/gi,"");while(i!=o);i=i.replace(/<lilevel([^1])([^>]*)>/gi,'<li data-indent="true"$2>'),i=i.replace(/<lilevel1([^>]*)>/gi,"<li$1>"),i=t.clean.html(i,t.opts.pasteDeniedTags,t.opts.pasteDeniedAttrs),i=i.replace(/<a>(.[^<]+)<\/a>/gi,"$1"),i=i.replace(/<br> */g,"<br>");var a=e("<div>").html(i);return a.find("li[data-indent]").each(function(t,i){var n=e(i);if(n.prev("li").length>0){var r=n.prev("li").find("> ul, > ol");0===r.length&&(r=e("ul"),n.prev("li").append(r)),r.append(i)}else n.removeAttr("data-indent")}),t.html.cleanBlankSpaces(a.get(0)),i=a.html()}function o(i){var n=e("<div>").html(i);n.find("p, div, h1, h2, h3, h4, h5, h6, pre, blockquote").each(function(i,n){e(n).replaceWith("<"+(t.html.defaultTag()||"DIV")+">"+e(n).html()+"</"+(t.html.defaultTag()||"DIV")+">")}),e(n.find("*").not("p, div, h1, h2, h3, h4, h5, h6, pre, blockquote, ul, ol, li, table, tbody, thead, tr, td, br, img").get().reverse()).each(function(){e(this).replaceWith(e(this).html())});var r=function(i){for(var n=t.node.contents(i),s=0;s<n.length;s++)3!=n[s].nodeType&&1!=n[s].nodeType?e(n[s]).remove():r(n[s])};return r(n.get(0)),n.html()}function a(){t.keys.forceUndo();var i=t.snapshot.get();null===h&&(h=p.html(),t.selection.restore(),t.events.enableBlur());var n=t.events.chainTrigger("paste.beforeCleanup",h);"string"==typeof n&&(h=n);var r=!1;h.match(/(class=\"?Mso|class=\'?Mso|style=\"[^\"]*\bmso\-|style=\'[^\']*\bmso\-|w:WordDocument)/gi)&&(r=!0),h.indexOf("<body")>=0&&(h=h.replace(/[.\s\S\w\W<>]*<body[^>]*>([.\s\S\w\W<>]*)<\/body>[.\s\S\w\W<>]*/g,"$1"));var a=!1;if(h.indexOf('id="docs-internal-guid')>=0&&(h=h.replace(/^.* id="docs-internal-guid[^>]*>(.*)<\/b>.*$/,"$1"),a=!0),r?(h=h.replace(/^\n*/g,"").replace(/^ /g,""),0===h.indexOf("<colgroup>")&&(h="<table>"+h+"</table>"),h=s(h),h=c(h)):(t.opts.htmlAllowComments=!1,h=t.clean.html(h,t.opts.pasteDeniedTags,t.opts.pasteDeniedAttrs),t.opts.htmlAllowComments=!0,h=c(h),h=h.replace(/\r|\n|\t/g,""),e.FE.copied_text&&e("<div>").html(h).text().replace(/(\u00A0)/gi," ").replace(/\r|\n/gi,"")==e.FE.copied_text.replace(/(\u00A0)/gi," ").replace(/\r|\n/gi,"")&&(h=e.FE.copied_html),h=h.replace(/^ */g,"").replace(/ *$/g,"")),t.opts.pastePlain&&(h=o(h)),n=t.events.chainTrigger("paste.afterCleanup",h),"string"==typeof n&&(h=n),""!==h){var d=e("<div>").html(h);t.spaces.normalize(d.get(0)),d.find("span").each(function(){0==this.attributes.length&&e(this).replaceWith(this.innerHTML)}),a||d.find("br").each(function(){this.previousSibling&&t.node.isBlock(this.previousSibling)&&e(this).remove()}),t.opts.enter==e.FE.ENTER_BR&&d.find("p, div").each(function(t,i){e(i).replaceWith(e(i).html()+(i.nextSibling?"<br>":""))}),h=d.html(),t.html.insert(h,!0)}l(),t.undo.saveStep(i),t.undo.saveStep()}function l(){t.events.trigger("paste.after")}function c(i){for(var n,r=e("<div>").html(i),s=r.find("*:empty:not(br, img, td, th)");s.length;){for(n=0;n<s.length;n++)e(s[n]).remove();s=r.find("*:empty:not(br, img, td, th)")}for(var o=r.find("> div:not([style]), td > div, th > div, li > div");o.length&&n++<100;){var a=e(o[o.length-1]);t.html.defaultTag()&&"div"!=t.html.defaultTag()?a.replaceWith("<"+t.html.defaultTag()+">"+a.html()+"</"+t.html.defaultTag()+">"):a.find("*:last").is("br")?a.replaceWith(a.html()):a.replaceWith(a.html()+"<br>"),o=r.find("> div:not([style]), td > div, th > div, li > div")}for(o=r.find("div:not([style])");o.length;){for(n=0;n<o.length;n++){var l=e(o[n]),c=l.html().replace(/\u0009/gi,"").trim();l.replaceWith(c)}o=r.find("div:not([style])")}return r.html()}function d(){t.events.on("copy",i),t.events.on("cut",i),t.events.on("paste",n),t.browser.msie&&t.browser.version<11&&(t.events.on("mouseup",function(e){2==e.button&&(setTimeout(function(){f=!1},50),f=!0)},!0),t.events.on("beforepaste",n))}var u,h,p,f=!1;return{_init:d}},e.extend(e.FE.DEFAULTS,{shortcutsEnabled:["show","bold","italic","underline","strikeThrough","indent","outdent","undo","redo"],shortcutsHint:!0}),e.FE.SHORTCUTS_MAP={},e.FE.RegisterShortcut=function(t,i,n,r,s,o){e.FE.SHORTCUTS_MAP[(s?"^":"")+(o?"@":"")+t]={cmd:i,val:n,letter:r,shift:s,option:o},e.FE.DEFAULTS.shortcutsEnabled.push(i)},e.FE.RegisterShortcut(e.FE.KEYCODE.E,"show",null,"E",!1,!1),e.FE.RegisterShortcut(e.FE.KEYCODE.B,"bold",null,"B",!1,!1),e.FE.RegisterShortcut(e.FE.KEYCODE.I,"italic",null,"I",!1,!1),e.FE.RegisterShortcut(e.FE.KEYCODE.U,"underline",null,"U",!1,!1),e.FE.RegisterShortcut(e.FE.KEYCODE.S,"strikeThrough",null,"S",!1,!1),e.FE.RegisterShortcut(e.FE.KEYCODE.CLOSE_SQUARE_BRACKET,"indent",null,"]",!1,!1),e.FE.RegisterShortcut(e.FE.KEYCODE.OPEN_SQUARE_BRACKET,"outdent",null,"[",!1,!1),e.FE.RegisterShortcut(e.FE.KEYCODE.Z,"undo",null,"Z",!1,!1),e.FE.RegisterShortcut(e.FE.KEYCODE.Z,"redo",null,"Z",!0,!1),e.FE.MODULES.shortcuts=function(t){function i(i){if(!t.opts.shortcutsHint)return null;if(!s){s={};for(var n in e.FE.SHORTCUTS_MAP)e.FE.SHORTCUTS_MAP.hasOwnProperty(n)&&t.opts.shortcutsEnabled.indexOf(e.FE.SHORTCUTS_MAP[n].cmd)>=0&&(s[e.FE.SHORTCUTS_MAP[n].cmd+"."+(e.FE.SHORTCUTS_MAP[n].val||"")]={shift:e.FE.SHORTCUTS_MAP[n].shift,option:e.FE.SHORTCUTS_MAP[n].option,letter:e.FE.SHORTCUTS_MAP[n].letter})}var r=s[i];return r?(t.helpers.isMac()?String.fromCharCode(8984):"Ctrl+")+(r.shift?t.helpers.isMac()?String.fromCharCode(8679):"Shift+":"")+(r.option?t.helpers.isMac()?String.fromCharCode(8997):"Alt+":"")+r.letter:null}function n(i){if(!t.core.hasFocus())return!0;var n=i.which,r=-1!=navigator.userAgent.indexOf("Mac OS X")?i.metaKey:i.ctrlKey,s=(i.shiftKey?"^":"")+(i.altKey?"@":"")+n;if(r&&e.FE.SHORTCUTS_MAP[s]){var o=e.FE.SHORTCUTS_MAP[s].cmd;if(o&&t.opts.shortcutsEnabled.indexOf(o)>=0){var a,l=e.FE.SHORTCUTS_MAP[s].val;if(o&&!l?a=t.$tb.find('.fr-command[data-cmd="'+o+'"]'):o&&l&&(a=t.$tb.find('.fr-command[data-cmd="'+o+'"][data-param1="'+l+'"]')),a.length)return i.preventDefault(),i.stopPropagation(),a.parents(".fr-toolbar").data("instance",t),"keydown"==i.type&&t.button.exec(a),!1;if(o&&t.commands[o])return i.preventDefault(),i.stopPropagation(),"keydown"==i.type&&t.commands[o](),!1}}}function r(){t.events.on("keydown",n,!0),t.events.on("keyup",n,!0)}var s=null;return{_init:r,get:i}},e.FE.MODULES.snapshot=function(e){function t(e){for(var t=e.parentNode.childNodes,i=0,n=null,r=0;r<t.length;r++){if(n){var s=t[r].nodeType===Node.TEXT_NODE&&""===t[r].textContent,o=n.nodeType===Node.TEXT_NODE&&t[r].nodeType===Node.TEXT_NODE;s||o||i++}if(t[r]==e)return i;n=t[r]}}function i(i){var n=[];if(!i.parentNode)return[];for(;!e.node.isElement(i);)n.push(t(i)),i=i.parentNode;return n.reverse()}function n(e,t){for(;e&&e.nodeType===Node.TEXT_NODE;){var i=e.previousSibling;i&&i.nodeType==Node.TEXT_NODE&&(t+=i.textContent.length),e=i}return t}function r(e){return{scLoc:i(e.startContainer),scOffset:n(e.startContainer,e.startOffset),ecLoc:i(e.endContainer),ecOffset:n(e.endContainer,e.endOffset)}}function s(){var t={};if(e.events.trigger("snapshot.before"),t.html=e.$wp?e.$el.html():e.$oel.get(0).outerHTML,t.ranges=[],e.$wp&&e.selection.inEditor()&&e.core.hasFocus())for(var i=e.selection.ranges(),n=0;n<i.length;n++)t.ranges.push(r(i[n]));return e.events.trigger("snapshot.after"),t}function o(t){for(var i=e.$el.get(0),n=0;n<t.length;n++)i=i.childNodes[t[n]];return i}function a(t,i){try{var n=o(i.scLoc),r=i.scOffset,s=o(i.ecLoc),a=i.ecOffset,l=e.doc.createRange();l.setStart(n,r),l.setEnd(s,a),t.addRange(l)}catch(c){console.warn(c)}}function l(t){e.$el.html()!=t.html&&e.$el.html(t.html);var i=e.selection.get();e.selection.clear(),e.events.focus(!0);for(var n=0;n<t.ranges.length;n++)a(i,t.ranges[n])}function c(t,i){return t.html!=i.html?!1:e.core.hasFocus()&&JSON.stringify(t.ranges)!=JSON.stringify(i.ranges)?!1:!0}return{get:s,restore:l,equal:c}},e.FE.MODULES.undo=function(e){function t(t){var i=t.which,n=e.keys.ctrlKey(t);n&&(90==i&&t.shiftKey&&t.preventDefault(),90==i&&t.preventDefault())}function i(){return 0===e.undo_stack.length||e.undo_index<=1?!1:!0}function n(){return e.undo_index==e.undo_stack.length?!1:!0}function r(t){return!e.undo_stack||e.undoing||e.$el.get(0).querySelectorAll(".fr-marker").length?!1:("undefined"==typeof t?(t=e.snapshot.get(),e.undo_stack[e.undo_index-1]&&e.snapshot.equal(e.undo_stack[e.undo_index-1],t)||(s(),e.undo_stack.push(t),e.undo_index++,t.html!=u&&(e.events.trigger("contentChanged"),u=t.html))):(s(),e.undo_index>0?e.undo_stack[e.undo_index-1]=t:(e.undo_stack.push(t),e.undo_index++)),void 0)}function s(){if(!e.undo_stack||e.undoing)return!1;for(;e.undo_stack.length>e.undo_index;)e.undo_stack.pop()}function o(){if(e.undo_index>1){e.undoing=!0;var t=e.undo_stack[--e.undo_index-1];clearTimeout(e._content_changed_timer),e.snapshot.restore(t),u=t.html,e.popups.hideAll(),e.toolbar.enable(),e.events.trigger("contentChanged"),e.events.trigger("commands.undo"),e.undoing=!1}}function a(){if(e.undo_index<e.undo_stack.length){e.undoing=!0;var t=e.undo_stack[e.undo_index++];clearTimeout(e._content_changed_timer),e.snapshot.restore(t),u=t.html,e.popups.hideAll(),e.toolbar.enable(),e.events.trigger("contentChanged"),e.events.trigger("commands.redo"),e.undoing=!1}}function l(){e.undo_index=0,e.undo_stack=[]}function c(){e.undo_stack=[]}function d(){l(),e.events.on("initialized",function(){u=e.html.get(!1,!0)}),e.events.on("blur",function(){e.undo.saveStep()}),e.events.on("keydown",t),e.events.on("destroy",c)}var u=null;return{_init:d,run:o,redo:a,canDo:i,canRedo:n,dropRedo:s,reset:l,saveStep:r}},e.FE.ICON_DEFAULT_TEMPLATE="font_awesome",e.FE.ICON_TEMPLATES={font_awesome:'<i class="fa fa-[NAME]"></i>',text:'<span style="text-align: center;">[NAME]</span>',image:"<img src=[SRC] alt=[ALT] />"},e.FE.ICONS={bold:{NAME:"bold"},italic:{NAME:"italic"},underline:{NAME:"underline"},strikeThrough:{NAME:"strikethrough"},subscript:{NAME:"subscript"},superscript:{NAME:"superscript"},color:{NAME:"tint"},outdent:{NAME:"outdent"},indent:{NAME:"indent"},undo:{NAME:"rotate-left"},redo:{NAME:"rotate-right"},insertHR:{NAME:"minus"},clearFormatting:{NAME:"eraser"},selectAll:{NAME:"mouse-pointer"}},e.FE.DefineIconTemplate=function(t,i){e.FE.ICON_TEMPLATES[t]=i},e.FE.DefineIcon=function(t,i){e.FE.ICONS[t]=i},e.FE.MODULES.icon=function(){function t(t){var i=null,n=e.FE.ICONS[t];if("undefined"!=typeof n){var r=n.template||e.FE.ICON_DEFAULT_TEMPLATE;r&&(r=e.FE.ICON_TEMPLATES[r])&&(i=r.replace(/\[([a-zA-Z]*)\]/g,function(e,i){return"NAME"==i?n[i]||t:n[i]}))}return i||t}return{create:t}},e.FE.MODULES.tooltip=function(t){function i(){t.$tooltip&&t.$tooltip.removeClass("fr-visible").css("left","-3000px").css("position","fixed")}function n(i,n){if(i.data("title")||i.data("title",i.attr("title")),!i.data("title"))return!1;t.$tooltip||s(),i.removeAttr("title"),t.$tooltip.text(i.data("title")),t.$tooltip.addClass("fr-visible");var r=i.offset().left+(i.outerWidth()-t.$tooltip.outerWidth())/2;0>r&&(r=0),r+t.$tooltip.outerWidth()>e(t.o_win).width()&&(r=e(t.o_win).width()-t.$tooltip.outerWidth()),"undefined"==typeof n&&(n=t.opts.toolbarBottom);var o=n?i.offset().top-t.$tooltip.height():i.offset().top+i.outerHeight();t.$tooltip.css("position",""),t.$tooltip.css("left",r),t.$tooltip.css("top",Math.ceil(o)),"static"!=e(t.o_doc).find("body").css("position")?(t.$tooltip.css("margin-left",-e(t.o_doc).find("body").offset().left),t.$tooltip.css("margin-top",-e(t.o_doc).find("body").offset().top)):(t.$tooltip.css("margin-left",""),t.$tooltip.css("margin-top",""))}function r(r,s,o){t.helpers.isMobile()||(t.events.$on(r,"mouseenter",s,function(i){e(i.currentTarget).hasClass("fr-disabled")||t.edit.isDisabled()||n(e(i.currentTarget),o)},!0),t.events.$on(r,"mouseleave "+t._mousedown+" "+t._mouseup,s,function(){i()},!0))}function s(){t.helpers.isMobile()||(t.shared.$tooltip?t.$tooltip=t.shared.$tooltip:(t.shared.$tooltip=e('<div class="fr-tooltip"></div>'),t.$tooltip=t.shared.$tooltip,t.opts.theme&&t.$tooltip.addClass(t.opts.theme+"-theme"),e(t.o_doc).find("body").append(t.$tooltip)),t.events.on("shared.destroy",function(){t.$tooltip.html("").removeData().remove(),t.$tooltip=null},!0))}return{hide:i,to:n,bind:r}},e.FE.MODULES.button=function(t){function i(i){var n=e(i.currentTarget),r=n.next(),s=n.hasClass("fr-active");t.helpers.isMobile();var o=e(".fr-dropdown.fr-active").not(n),a=n.parents(".fr-toolbar, .fr-popup").data("instance")||t;if(a.helpers.isIOS()&&0==a.$el.get(0).querySelectorAll(".fr-marker").length&&(a.selection.save(),a.selection.clear(),a.selection.restore()),!s){var l=n.data("cmd");r.find(".fr-command").removeClass("fr-active"),e.FE.COMMANDS[l]&&e.FE.COMMANDS[l].refreshOnShow&&e.FE.COMMANDS[l].refreshOnShow.apply(a,[n,r]),r.css("left",n.offset().left-n.parent().offset().left-("rtl"==t.opts.direction?r.width()-n.outerWidth():0)),t.opts.toolbarBottom?r.css("bottom",t.$tb.height()-n.position().top):r.css("top",n.position().top+n.outerHeight())}n.addClass("fr-blink").toggleClass("fr-active"),setTimeout(function(){n.removeClass("fr-blink")},300),r.offset().left+r.outerWidth()>e(t.opts.scrollableContainer).offset().left+e(t.opts.scrollableContainer).outerWidth()&&r.css("margin-left",-(r.offset().left+r.outerWidth()-e(t.opts.scrollableContainer).offset().left-e(t.opts.scrollableContainer).outerWidth())),o.removeClass("fr-active"),o.parent(".fr-toolbar:not(.fr-inline)").css("zIndex",""),0!=n.parents(".fr-popup").length||t.opts.toolbarInline||(n.hasClass("fr-active")?t.$tb.css("zIndex",(t.opts.zIndex||1)+4):t.$tb.css("zIndex",""))
}function n(t){t.addClass("fr-blink"),setTimeout(function(){t.removeClass("fr-blink")},500);for(var i=t.data("cmd"),n=[];"undefined"!=typeof t.data("param"+(n.length+1));)n.push(t.data("param"+(n.length+1)));var r=e(".fr-dropdown.fr-active");r.length&&(r.removeClass("fr-active"),r.parent(".fr-toolbar:not(.fr-inline)").css("zIndex","")),t.parents(".fr-popup, .fr-toolbar").data("instance").commands.exec(i,n)}function r(t){var i=e(t.currentTarget);n(i)}function s(t){var n=e(t.currentTarget),s=n.parents(".fr-popup, .fr-toolbar").data("instance");if(0!=n.parents(".fr-popup").length||n.data("popup")||s.popups.hideAll(),s.popups.areVisible()&&!s.popups.areVisible(s)){for(var o=0;o<e.FE.INSTANCES.length;o++)e.FE.INSTANCES[o]!=s&&e.FE.INSTANCES[o].popups&&e.FE.INSTANCES[o].popups.areVisible()&&e.FE.INSTANCES[o].$el.find(".fr-marker").remove();s.popups.hideAll()}n.hasClass("fr-dropdown")?i(t):(r(t),e.FE.COMMANDS[n.data("cmd")]&&0!=e.FE.COMMANDS[n.data("cmd")].refreshAfterCallback&&s.button.bulkRefresh())}function o(e){var t=e.find(".fr-dropdown.fr-active");t.length&&(t.removeClass("fr-active"),t.parent(".fr-toolbar:not(.fr-inline)").css("zIndex",""))}function a(e){e.preventDefault(),e.stopPropagation()}function l(e){return e.stopPropagation(),t.helpers.isMobile()?void 0:!1}function c(i,n){t.events.bindClick(i,".fr-command:not(.fr-disabled)",s),t.events.$on(i,t._mousedown+" "+t._mouseup+" "+t._move,".fr-dropdown-menu",a,!0),t.events.$on(i,t._mousedown+" "+t._mouseup+" "+t._move,".fr-dropdown-menu .fr-dropdown-wrapper",l,!0);var r=i.get(0).ownerDocument,c="defaultView"in r?r.defaultView:r.parentWindow,d=function(n){(!n||n.type==t._mouseup&&n.target!=e("html").get(0)||"keydown"==n.type&&(t.keys.isCharacter(n.which)&&!t.keys.ctrlKey(n)||n.which==e.FE.KEYCODE.ESC))&&o(i)};t.events.$on(e(c),t._mouseup+" resize keydown",d,!0),t.opts.iframe&&t.events.$on(t.$win,t._mouseup,d,!0),i.hasClass("fr-popup")?e.merge(y,i.find(".fr-btn").toArray()):e.merge(_,i.find(".fr-btn").toArray()),t.tooltip.bind(i,".fr-btn, .fr-title",n)}function d(e,i){var n="";if(i.html)n+="function"==typeof i.html?i.html.call(t):i.html;else{var r=i.options;"function"==typeof r&&(r=r()),n+='<ul class="fr-dropdown-list">';for(var s in r)if(r.hasOwnProperty(s)){var o=t.shortcuts.get(e+"."+s);o=o?'<span class="fr-shortcut">'+o+"</span>":"",n+='<li><a class="fr-command" data-cmd="'+e+'" data-param1="'+s+'" title="'+r[s]+'">'+t.language.translate(r[s])+"</a></li>"}n+="</ul>"}return n}function u(e,i,n){var r=i.displaySelection;"function"==typeof r&&(r=r(t));var s;if(r){var o="function"==typeof i.defaultSelection?i.defaultSelection(t):i.defaultSelection;s='<span style="width:'+(i.displaySelectionWidth||100)+'px">'+(o||t.language.translate(i.title))+"</span>"}else s=t.icon.create(i.icon||e);var a=i.popup?' data-popup="true"':"",l=t.shortcuts.get(e+".");l=l?" ("+l+")":"";var c='<button type="button" tabindex="-1" aria-label="'+(t.language.translate(i.title)||"")+'" title="'+(t.language.translate(i.title)||"")+l+'" class="fr-command fr-btn'+("dropdown"==i.type?" fr-dropdown":"")+(i.displaySelection?" fr-selection":"")+(i.back?" fr-back":"")+(i.disabled?" fr-disabled":"")+(n?"":" fr-hidden")+'" data-cmd="'+e+'"'+a+">"+s+"</button>";if("dropdown"==i.type){var u='<div class="fr-dropdown-menu"><div class="fr-dropdown-wrapper"><div class="fr-dropdown-content">';u+=d(e,i),u+="</div></div></div>",c+=u}return c}function h(i,n){for(var r="",s=0;s<i.length;s++){var o=i[s],a=e.FE.COMMANDS[o];if(!(a&&"undefined"!=typeof a.plugin&&t.opts.pluginsEnabled.indexOf(a.plugin)<0))if(a){var l="undefined"!=typeof n?n.indexOf(o)>=0:!0;r+=u(o,a,l)}else"|"==o?r+='<div class="fr-separator fr-vs"></div>':"-"==o&&(r+='<div class="fr-separator fr-hs"></div>')}return r}function p(i){var n,r=i.parents(".fr-popup, .fr-toolbar").data("instance")||t,s=i.data("cmd");i.hasClass("fr-dropdown")?n=i.next():i.removeClass("fr-active"),e.FE.COMMANDS[s]&&e.FE.COMMANDS[s].refresh?e.FE.COMMANDS[s].refresh.apply(r,[i,n]):t.refresh[s]&&r.refresh[s](i,n)}function f(i){var n=t.$tb?t.$tb.data("instance")||t:t;return 0==t.events.trigger("buttons.refresh")?!0:(setTimeout(function(){for(var t=n.selection.inEditor()&&n.core.hasFocus(),r=0;r<i.length;r++){var s=e(i[r]),o=s.data("cmd");0==s.parents(".fr-popup").length?t||e.FE.COMMANDS[o]&&e.FE.COMMANDS[o].forcedRefresh?n.button.refresh(s):s.hasClass("fr-dropdown")||s.removeClass("fr-active"):s.parents(".fr-popup").is(":visible")&&n.button.refresh(s)}},0),void 0)}function m(){f(_),f(y)}function g(){_=[],y=[]}function v(){t.opts.toolbarInline?t.events.on("toolbar.show",m):(t.events.on("mouseup",m),t.events.on("keyup",m),t.events.on("blur",m),t.events.on("focus",m),t.events.on("contentChanged",m)),t.events.on("shared.destroy",g)}var _=[];(t.opts.toolbarInline||t.opts.toolbarContainer)&&(t.shared.buttons||(t.shared.buttons=[]),_=t.shared.buttons);var y=[];return t.shared.popup_buttons||(t.shared.popup_buttons=[]),y=t.shared.popup_buttons,{_init:v,buildList:h,bindCommands:c,refresh:p,bulkRefresh:m,exec:n}},e.FE.POPUP_TEMPLATES={"text.edit":"[_EDIT_]"},e.FE.RegisterTemplate=function(t,i){e.FE.POPUP_TEMPLATES[t]=i},e.FE.MODULES.popups=function(t){function i(i,n){n.is(":visible")||(n=e(t.opts.scrollableContainer)),n.is(C[i].data("container"))||(C[i].data("container",n),n.append(C[i]))}function n(n,r,a,l){if(o()&&t.$el.find(".fr-marker").length>0&&(t.events.disableBlur(),t.selection.restore()),h([n]),!C[n])return!1;e(".fr-dropdown.fr-active").removeClass("fr-active").parent(".fr-toolbar").css("zIndex",""),C[n].data("instance",t),t.$tb&&t.$tb.data("instance",t);var c=C[n].outerWidth();C[n].outerHeight();var d=s(n);C[n].addClass("fr-active").removeClass("fr-hidden").find("input, textarea").removeAttr("disabled");var u=C[n].data("container");t.opts.toolbarInline&&u&&t.$tb&&u.get(0)==t.$tb.get(0)&&(i(n,e(t.opts.scrollableContainer)),a=t.$tb.offset().top-t.helpers.getPX(t.$tb.css("margin-top")),r=t.$tb.offset().left+t.$tb.outerWidth()/2+(parseFloat(t.$tb.find(".fr-arrow").css("margin-left"))||0)+t.$tb.find(".fr-arrow").outerWidth()/2,t.$tb.hasClass("fr-above")&&a&&(a+=t.$tb.outerHeight()),l=0),u=C[n].data("container"),!t.opts.iframe||l||d||(r&&(r-=t.$iframe.offset().left),a&&(a-=t.$iframe.offset().top)),u.is(t.$tb)?t.$tb.css("zIndex",(t.opts.zIndex||1)+4):C[n].css("zIndex",(t.opts.zIndex||1)+4),r&&(r-=c/2),t.opts.toolbarBottom&&u&&t.$tb&&u.get(0)==t.$tb.get(0)&&(C[n].addClass("fr-above"),a&&(a-=C[n].outerHeight())),C[n].removeClass("fr-active"),t.position.at(r,a,C[n],l||0),C[n].addClass("fr-active");var p=C[n].find("input:visible, textarea:visible").get(0);p&&(0==t.$el.find(".fr-marker").length&&t.core.hasFocus()&&t.selection.save(),t.events.disableBlur(),e(p).select().focus()),t.opts.toolbarInline&&t.toolbar.hide(),t.events.trigger("popups.show."+n),_(n)._repositionPopup(),f()}function r(e,i){t.events.on("popups.show."+e,i)}function s(e){return C[e]&&C[e].hasClass("fr-active")&&t.core.sameInstance(C[e])||!1}function o(e){for(var t in C)if(C.hasOwnProperty(t)&&s(t)&&("undefined"==typeof e||C[t].data("instance")==e))return!0;return!1}function a(e){C[e]&&C[e].hasClass("fr-active")&&(C[e].removeClass("fr-active fr-above"),t.events.trigger("popups.hide."+e),t.$tb&&(t.opts.zIndex>1?t.$tb.css("zIndex",t.opts.zIndex+1):t.$tb.css("zIndex","")),t.events.disableBlur(),C[e].find("input, textarea, button").filter(":focus").blur(),C[e].find("input, textarea").attr("disabled","disabled"))}function l(e,i){t.events.on("popups.hide."+e,i)}function c(e){var i=C[e];if(i&&!i.data("inst"+t.id)){var n=_(e);y(n,e)}return i}function d(e,i){t.events.on("popups.refresh."+e,i)}function u(i){t.events.trigger("popups.refresh."+i);for(var n=C[i].find(".fr-command"),r=0;r<n.length;r++){var s=e(n[r]);0==s.parents(".fr-dropdown-menu").length&&t.button.refresh(s)}}function h(e){"undefined"==typeof e&&(e=[]);for(var t in C)C.hasOwnProperty(t)&&e.indexOf(t)<0&&a(t)}function p(){t.shared.exit_flag=!0}function f(){t.shared.exit_flag=!1}function m(){return t.shared.exit_flag}function g(i,n){var r=e.FE.POPUP_TEMPLATES[i];"function"==typeof r&&(r=r.apply(t));for(var s in n)n.hasOwnProperty(s)&&(r=r.replace("[_"+s.toUpperCase()+"_]",n[s]));return r}function v(i,n){var r=g(i,n),s=e('<div class="fr-popup'+(t.helpers.isMobile()?" fr-mobile":" fr-desktop")+(t.opts.toolbarInline?" fr-inline":"")+'"><span class="fr-arrow"></span>'+r+"</div>");t.opts.theme&&s.addClass(t.opts.theme+"-theme"),t.opts.zIndex>1&&t.$tb.css("z-index",t.opts.zIndex+2),"auto"!=t.opts.direction&&s.removeClass("fr-ltr fr-rtl").addClass("fr-"+t.opts.direction),s.find("input, textarea").attr("dir",t.opts.direction).attr("disabled","disabled");var o=e("body");return o.append(s),s.data("container",o),C[i]=s,t.button.bindCommands(s,!1),s}function _(i){var n=C[i];return{_windowResize:function(){var e=n.data("instance")||t;!e.helpers.isMobile()&&n.is(":visible")&&(e.events.disableBlur(),e.popups.hide(i),e.events.enableBlur())},_inputFocus:function(i){var r=n.data("instance")||t;if(i.preventDefault(),setTimeout(function(){r.events.enableBlur()},0),r.helpers.isMobile()){var s=e(r.o_win).scrollTop();setTimeout(function(){e(r.o_win).scrollTop(s)},0)}},_inputBlur:function(){var i=n.data("instance")||t;document.activeElement!=this&&e(this).is(":visible")&&(i.events.blurActive()&&i.events.trigger("blur"),i.events.enableBlur())},_inputKeydown:function(r){var o=n.data("instance")||t,a=r.which;if(e.FE.KEYCODE.TAB==a){r.preventDefault();var l=n.find("input, textarea, button, select").filter(":visible").not(":disabled").toArray();l.sort(function(t,i){return r.shiftKey?e(t).attr("tabIndex")<e(i).attr("tabIndex"):e(t).attr("tabIndex")>e(i).attr("tabIndex")}),o.events.disableBlur();var c=l.indexOf(this)+1;c==l.length&&(c=0),e(l[c]).focus()}else if(e.FE.KEYCODE.ENTER==a)n.find(".fr-submit:visible").length>0&&(r.preventDefault(),r.stopPropagation(),o.events.disableBlur(),o.button.exec(n.find(".fr-submit:visible:first")));else{if(e.FE.KEYCODE.ESC==a)return r.preventDefault(),r.stopPropagation(),o.$el.find(".fr-marker")&&(o.events.disableBlur(),e(this).data("skip",!0),o.selection.restore(),o.events.enableBlur()),s(i)&&n.find(".fr-back:visible").length?o.button.exec(n.find(".fr-back:visible:first")):o.popups.hide(i),o.opts.toolbarInline&&o.toolbar.showInline(null,!0),!1;r.stopPropagation()}},_windowKeydown:function(r){if(!t.core.sameInstance(n))return!0;var o=n.data("instance")||t,a=r.which;if(e.FE.KEYCODE.ESC==a){if(s(i)&&o.opts.toolbarInline)return r.stopPropagation(),s(i)&&n.find(".fr-back:visible").length?o.button.exec(n.find(".fr-back:visible:first")):(o.popups.hide(i),o.toolbar.showInline(null,!0)),!1;s(i)&&n.find(".fr-back:visible").length?o.button.exec(n.find(".fr-back:visible:first")):o.popups.hide(i)}},_editorKeydown:function(r){var o=n.data("instance")||t;o.keys.ctrlKey(r)||r.which==e.FE.KEYCODE.ESC||(s(i)&&n.find(".fr-back:visible").length?o.button.exec(n.find(".fr-back:visible:first")):o.popups.hide(i))},_preventFocus:function(i){var r=n.data("instance")||t;r.events.disableBlur();var s=i.originalEvent?i.originalEvent.target||i.originalEvent.originalTarget:null,o="input, textarea, button, select, label, .fr-command";return s&&!e(s).is(o)&&0===e(s).parents(o).length?(i.stopPropagation(),!1):(s&&e(s).is(o)&&i.stopPropagation(),f(),void 0)},_editorMouseup:function(){n.is(":visible")&&m()&&n.find("input:focus, textarea:focus, button:focus, select:focus").filter(":visible").length>0&&t.events.disableBlur()},_windowMouseup:function(e){if(!t.core.sameInstance(n))return!0;var r=n.data("instance")||t;n.is(":visible")&&m()&&(e.stopPropagation(),r.markers.remove(),r.popups.hide(i),f())},_doPlaceholder:function(){var t=e(this).next();0==t.length&&e(this).after("<label>"+e(this).attr("placeholder")+"</label>"),e(this).toggleClass("fr-not-empty",""!=e(this).val())},_repositionPopup:function(){if(!t.opts.height&&!t.opts.heightMax||t.opts.toolbarInline)return!0;if(t.$wp&&s(i)&&n.parent().get(0)==e(t.opts.scrollableContainer).get(0)){var r=n.offset().top-t.$wp.offset().top,o=t.$wp.outerHeight();n.hasClass("fr-above")&&(r+=n.outerHeight()),r>o||0>r?n.addClass("fr-hidden"):n.removeClass("fr-hidden")}}}}function y(e,i){t.events.on("mouseup",e._editorMouseup,!0),t.$wp&&t.events.on("keydown",e._editorKeydown),t.events.on("blur",function(){o()&&t.markers.remove(),h()}),t.$wp&&!t.helpers.isMobile()&&t.events.$on(t.$wp,"scroll.popup"+i,e._repositionPopup),t.events.on("window.keydown",e._windowKeydown),t.events.on("window.mouseup",e._windowMouseup,!0),C[i].data("inst"+t.id,!0),t.events.on("destroy",function(){t.core.sameInstance(C[i])&&C[i].removeClass("fr-active").appendTo("body")},!0)}function b(i,n){var r=v(i,n),s=_(i);return y(s,i),t.events.$on(r,"mousedown mouseup touchstart touchend touch","*",s._preventFocus,!0),t.events.$on(r,"focus","input, textarea, button, select",s._inputFocus,!0),t.events.$on(r,"blur","input, textarea, button, select",s._inputBlur,!0),t.events.$on(r,"keydown","input, textarea, button, select",s._inputKeydown,!0),t.events.$on(r,"keydown keyup change input","input, textarea",s._doPlaceholder,!0),t.helpers.isIOS()&&t.events.$on(r,"touchend","label",function(){e("#"+e(this).attr("for")).prop("checked",function(e,t){return!t})},!0),t.events.$on(e(t.o_win),"resize",s._windowResize,!0),r}function w(){for(var e in C)if(C.hasOwnProperty(e)){var t=C[e];t.html("").removeData().remove(),C[e]=null}C=[]}function k(){t.events.on("shared.destroy",w,!0),t.events.on("window.mousedown",p),t.events.on("window.touchmove",f),t.events.on("mousedown",function(e){o()&&(e.stopPropagation(),t.$el.find(".fr-marker").remove(),p(),t.events.disableBlur())})}t.shared.popups||(t.shared.popups={});var C=t.shared.popups;return t.shared.exit_flag=!1,{_init:k,create:b,get:c,show:n,hide:a,onHide:l,hideAll:h,setContainer:i,refresh:u,onRefresh:d,onShow:r,isVisible:s,areVisible:o}},e.FE.MODULES.position=function(t){function i(){var i,n=t.selection.ranges(0);if(n&&n.collapsed&&t.selection.inEditor()){var r=!1;0==t.$el.find(".fr-marker").length&&(t.selection.save(),r=!0);var s=t.$el.find(".fr-marker:first");s.css("display","inline"),s.css("line-height","");var o=s.offset(),a=s.outerHeight();s.css("display","none"),s.css("line-height",0),i={},i.left=o.left,i.width=0,i.height=a,i.top=o.top-(t.helpers.isIOS()?0:e(t.o_win).scrollTop()),i.right=1,i.bottom=1,i.ok=!0,r&&t.selection.restore()}else n&&(i=n.getBoundingClientRect());return i}function n(i,n,r){var s=i.outerHeight();if(!t.helpers.isMobile()&&t.$tb&&i.parent().get(0)!=t.$tb.get(0)){i.parent().height()-20-(t.opts.toolbarBottom?t.$tb.outerHeight():0);var o=i.parent().offset().top,a=n-s-(r||0);i.parent().get(0)==e(t.opts.scrollableContainer).get(0)&&(o-=i.parent().position().top);var l=e(t.opts.scrollableContainer).get(0).scrollHeight;o+n+s>e(t.opts.scrollableContainer).offset().top+l&&i.parent().offset().top+a>0?(n=a,i.addClass("fr-above")):i.removeClass("fr-above")}return n}function r(i,n){var r=i.outerWidth();return n+r>e(t.opts.scrollableContainer).width()-10&&(n=e(t.opts.scrollableContainer).width()-r-10),0>n&&(n=10),n}function s(n){var r=i();n.css("top",0).css("left",0);var s=r.top+r.height,a=r.left+r.width/2-n.outerWidth()/2+e(t.o_win).scrollLeft();t.opts.iframe||(s+=e(t.o_win).scrollTop()),o(a,s,n,r.height)}function o(e,i,s,o){var a=s.data("container");!a||a.is("body")&&"static"==a.css("position")||(e&&(e-=a.offset().left),i&&(i-=a.offset().top),"BODY"!=a.get(0).tagName?(e&&(e+=a.scrollLeft()),i&&(i+=a.scrollTop())):"absolute"==a.css("position")&&(e&&(e+=a.position().left),i&&(i+=a.position().top))),t.opts.iframe&&a&&t.$tb&&a.get(0)!=t.$tb.get(0)&&(e&&(e+=t.$iframe.offset().left),i&&(i+=t.$iframe.offset().top));var l=r(s,e);if(e){s.css("left",l);var c=s.find(".fr-arrow");c.data("margin-left")||c.data("margin-left",t.helpers.getPX(c.css("margin-left"))),c.css("margin-left",e-l+c.data("margin-left"))}i&&s.css("top",n(s,i,o))}function a(i){var n=e(i),r=n.is(".fr-sticky-on"),s=n.data("sticky-top"),o=n.data("sticky-scheduled");if("undefined"==typeof s){n.data("sticky-top",0);var a=e('<div class="fr-sticky-dummy" style="height: '+n.outerHeight()+'px;"></div>');t.$box.prepend(a)}else t.$box.find(".fr-sticky-dummy").css("height",n.outerHeight());if(t.core.hasFocus()||t.$tb.find("input:visible:focus").length>0){var l=e(window).scrollTop(),c=Math.min(Math.max(l-t.$tb.parent().offset().top,0),t.$tb.parent().outerHeight()-n.outerHeight());c!=s&&c!=o&&(clearTimeout(n.data("sticky-timeout")),n.data("sticky-scheduled",c),n.outerHeight()<l-t.$tb.parent().offset().top&&n.addClass("fr-opacity-0"),n.data("sticky-timeout",setTimeout(function(){var i=e(window).scrollTop(),r=Math.min(Math.max(i-t.$tb.parent().offset().top,0),t.$tb.parent().outerHeight()-n.outerHeight());r>0&&"BODY"==t.$tb.parent().get(0).tagName&&(r+=t.$tb.parent().position().top),r!=s&&(n.css("top",Math.max(r,0)),n.data("sticky-top",r),n.data("sticky-scheduled",r)),n.removeClass("fr-opacity-0")},100))),r||(n.css("top","0"),n.width(t.$tb.parent().width()),n.addClass("fr-sticky-on"),t.$box.addClass("fr-sticky-box"))}else clearTimeout(e(i).css("sticky-timeout")),n.css("top","0"),n.css("position",""),n.width(""),n.data("sticky-top",0),n.removeClass("fr-sticky-on"),t.$box.removeClass("fr-sticky-box")}/**
     * Update sticky location for browsers that don't support sticky.
     * https://github.com/filamentgroup/fixed-sticky
     *
     * The MIT License (MIT)
     *
     * Copyright (c) 2013 Filament Group
     */
function l(i){if(i.offsetWidth){var n,r,s=e(i),o=s.outerHeight(),a=s.data("sticky-position"),l=e("body"==t.opts.scrollableContainer?t.o_win:t.opts.scrollableContainer).outerHeight(),c=0,d=0;"body"!==t.opts.scrollableContainer&&(c=e(t.opts.scrollableContainer).offset().top,d=e(t.o_win).outerHeight()-c-l);var u="body"==t.opts.scrollableContainer?e(t.o_win).scrollTop():c,h=s.is(".fr-sticky-on");s.data("sticky-parent")||s.data("sticky-parent",s.parent());var p=s.data("sticky-parent"),f=p.offset().top,m=p.outerHeight();if(s.data("sticky-offset")||(s.data("sticky-offset",!0),s.after('<div class="fr-sticky-dummy" style="height: '+o+'px;"></div>')),!a){var g="auto"!==s.css("top")||"auto"!==s.css("bottom");g||s.css("position","fixed"),a={top:s.hasClass("fr-top"),bottom:s.hasClass("fr-bottom")},g||s.css("position",""),s.data("sticky-position",a),s.data("top",s.hasClass("fr-top")?s.css("top"):"auto"),s.data("bottom",s.hasClass("fr-bottom")?s.css("bottom"):"auto")}var v=function(){return u+n>f&&f+m-o>=u+n},_=function(){return u+l-r>f+o&&f+m>u+l-r};n=t.helpers.getPX(s.data("top")),r=t.helpers.getPX(s.data("bottom"));var y=a.top&&v(),b=a.bottom&&_();y||b?(s.css("width",p.width()+"px"),h||(s.addClass("fr-sticky-on"),s.removeClass("fr-sticky-off"),s.css("top")&&("auto"!=s.data("top")?s.css("top",t.helpers.getPX(s.data("top"))+c):s.data("top","auto")),s.css("bottom")&&("auto"!=s.data("bottom")?s.css("bottom",t.helpers.getPX(s.data("bottom"))+d):s.css("bottom","auto")))):s.hasClass("fr-sticky-off")||(s.width(""),s.removeClass("fr-sticky-on"),s.addClass("fr-sticky-off"),s.css("top")&&"auto"!=s.data("top")&&a.top&&s.css("top",0),s.css("bottom")&&"auto"!=s.data("bottom")&&a.bottom&&s.css("bottom",0))}}/**
    * Test if browser supports sticky.
    * https://github.com/filamentgroup/fixed-sticky
    *
    * The MIT License (MIT)
    *
    * Copyright (c) 2013 Filament Group
    */
function c(){var e=document.createElement("test"),i=e.style;return i.cssText="position:"+["-webkit-","-moz-","-ms-","-o-",""].join("sticky; position:")+" sticky;",-1!==i.position.indexOf("sticky")&&!t.helpers.isIOS()&&!t.helpers.isAndroid()}function d(){if(!c())if(t._stickyElements=[],t.helpers.isIOS()){var i=function(){t.helpers.requestAnimationFrame()(i);for(var e=0;e<t._stickyElements.length;e++)a(t._stickyElements[e])};i(),t.events.$on(e(t.o_win),"scroll",function(){if(t.core.hasFocus())for(var i=0;i<t._stickyElements.length;i++){var n=e(t._stickyElements[i]),r=n.parent(),s=e(window).scrollTop();n.outerHeight()<s-r.offset().top&&(n.addClass("fr-opacity-0"),n.data("sticky-top",-1),n.data("sticky-scheduled",-1))}},!0)}else t.events.$on(e("body"==t.opts.scrollableContainer?t.o_win:t.opts.scrollableContainer),"scroll",u,!0),t.events.$on(e(t.o_win),"resize",u,!0),t.events.on("initialized",u),t.events.on("focus",u),t.events.$on(e(t.o_win),"resize","textarea",u,!0);t.events.on("destroy",function(){t._stickyElements=[]})}function u(){for(var e=0;e<t._stickyElements.length;e++)l(t._stickyElements[e])}function h(e){e.addClass("fr-sticky"),t.helpers.isIOS()&&e.addClass("fr-sticky-ios"),c()||t._stickyElements.push(e.get(0))}function p(){d()}return{_init:p,forSelection:s,addSticky:h,refresh:u,at:o,getBoundingRect:i}},e.FE.MODULES.refresh=function(t){function i(e){e.toggleClass("fr-disabled",!t.undo.canDo())}function n(e){e.toggleClass("fr-disabled",!t.undo.canRedo())}function r(e){if(e.hasClass("fr-no-refresh"))return!1;for(var i=t.selection.blocks(),n=0;n<i.length;n++){for(var r=i[n].previousSibling;r&&r.nodeType==Node.TEXT_NODE&&0===r.textContent.length;)r=r.previousSibling;if("LI"!=i[n].tagName||r)return e.removeClass("fr-disabled"),!0;e.addClass("fr-disabled")}}function s(i){if(i.hasClass("fr-no-refresh"))return!1;for(var n=t.selection.blocks(),r=0;r<n.length;r++){var s="rtl"==t.opts.direction||"rtl"==e(n[r]).css("direction")?"margin-right":"margin-left";if("LI"==n[r].tagName||"LI"==n[r].parentNode.tagName)return i.removeClass("fr-disabled"),!0;if(t.helpers.getPX(e(n[r]).css(s))>0)return i.removeClass("fr-disabled"),!0}i.addClass("fr-disabled")}return{undo:i,redo:n,outdent:s,indent:r}},e.extend(e.FE.DEFAULTS,{editInPopup:!1}),e.FE.MODULES.textEdit=function(t){function i(){var e='<div id="fr-text-edit-'+t.id+'" class="fr-layer fr-text-edit-layer"><div class="fr-input-line"><input type="text" placeholder="'+t.language.translate("Text")+'" tabIndex="1"></div><div class="fr-action-buttons"><button type="button" class="fr-command fr-submit" data-cmd="updateText" tabIndex="2">'+t.language.translate("Update")+"</button></div></div>",i={edit:e};t.popups.create("text.edit",i)}function n(){var i,n=t.popups.get("text.edit");i="INPUT"===t.$el.prop("tagName")?t.$el.attr("placeholder"):t.$el.text(),n.find("input").val(i).trigger("change"),t.popups.setContainer("text.edit",e("body")),t.popups.show("text.edit",t.$el.offset().left+t.$el.outerWidth()/2,t.$el.offset().top+t.$el.outerHeight(),t.$el.outerHeight())}function r(){t.events.$on(t.$el,t._mouseup,function(){setTimeout(function(){n()},10)})}function s(){var e=t.popups.get("text.edit"),i=e.find("input").val();0==i.length&&(i=t.opts.placeholderText),"INPUT"===t.$el.prop("tagName")?t.$el.attr("placeholder",i):t.$el.text(i),t.events.trigger("contentChanged"),t.popups.hide("text.edit")}function o(){t.opts.editInPopup&&(i(),r())}return{_init:o,update:s}},e.FE.RegisterCommand("updateText",{focus:!1,undo:!1,callback:function(){this.textEdit.update()}}),e.extend(e.FE.DEFAULTS,{toolbarBottom:!1,toolbarButtons:["fullscreen","bold","italic","underline","strikeThrough","subscript","superscript","fontFamily","fontSize","|","color","emoticons","inlineStyle","paragraphStyle","|","paragraphFormat","align","formatOL","formatUL","outdent","indent","quote","insertHR","-","insertLink","insertImage","insertVideo","insertFile","insertTable","undo","redo","clearFormatting","selectAll","html","applyFormat","removeFormat"],toolbarButtonsXS:["bold","italic","fontFamily","fontSize","|","undo","redo"],toolbarButtonsSM:["bold","italic","underline","|","fontFamily","fontSize","insertLink","insertImage","table","|","undo","redo"],toolbarButtonsMD:["fullscreen","bold","italic","underline","fontFamily","fontSize","color","paragraphStyle","paragraphFormat","align","formatOL","formatUL","outdent","indent","quote","insertHR","-","insertLink","insertImage","insertVideo","insertFile","insertTable","undo","redo","clearFormatting"],toolbarContainer:null,toolbarInline:!1,toolbarSticky:!0,toolbarStickyOffset:0,toolbarVisibleWithoutSelection:!1}),e.FE.MODULES.toolbar=function(t){function i(e,t){for(var i=0;i<t.length;i++)"-"!=t[i]&&"|"!=t[i]&&e.indexOf(t[i])<0&&e.push(t[i])}function n(){var n=e.merge([],r());i(n,t.opts.toolbarButtonsXS||[]),i(n,t.opts.toolbarButtonsSM||[]),i(n,t.opts.toolbarButtonsMD||[]),i(n,t.opts.toolbarButtons);for(var s=n.length-1;s>=0;s--)"-"!=n[s]&&"|"!=n[s]&&n.indexOf(n[s])<s&&n.splice(s,1);var o=t.button.buildList(n,r());t.$tb.append(o),t.button.bindCommands(t.$tb)}function r(){var e=t.helpers.screenSize();return b[e]}function s(){var e=r();t.$tb.find(".fr-separator").remove(),t.$tb.find("> .fr-command").addClass("fr-hidden");for(var i=0;i<e.length;i++)if("|"==e[i]||"-"==e[i])t.$tb.append(t.button.buildList([e[i]]));else{var n=t.$tb.find('> .fr-command[data-cmd="'+e[i]+'"]'),s=null;n.next().hasClass("fr-dropdown-menu")&&(s=n.next()),n.removeClass("fr-hidden").appendTo(t.$tb),s&&s.appendTo(t.$tb)}}function o(){t.events.$on(e(t.o_win),"resize",s),t.events.$on(e(t.o_win),"orientationchange",s)}function a(i,n){setTimeout(function(){if(i&&i.which==e.FE.KEYCODE.ESC);else if(t.selection.inEditor()&&t.core.hasFocus()&&!t.popups.areVisible()&&(t.opts.toolbarVisibleWithoutSelection&&i&&"keyup"!=i.type||!t.selection.isCollapsed()&&!t.keys.isIME()||n)){if(t.$tb.data("instance",t),0==t.events.trigger("toolbar.show",[i]))return!1;t.opts.toolbarContainer||t.position.forSelection(t.$tb),t.$tb.show()}},0)}function l(){var i=e(".fr-dropdown.fr-active");return i.next().find(t.o_doc.activeElement).length?!0:(t.events.trigger("toolbar.hide")!==!1&&t.$tb.hide(),void 0)}function c(){return 0==t.events.trigger("toolbar.show")?!1:(t.$tb.show(),void 0)}function d(){t.events.on("window.mousedown",l),t.events.on("keydown",l),t.events.on("blur",l),t.events.on("window.mouseup",a),t.helpers.isMobile()?t.helpers.isIOS()||(t.events.on("window.touchend",a),t.browser.mozilla&&setInterval(a,200)):t.events.on("window.keyup",a),t.events.on("keydown",function(t){t&&t.which==e.FE.KEYCODE.ESC&&l()}),t.events.$on(t.$wp,"scroll.toolbar",a),t.events.on("commands.after",a),t.helpers.isMobile()&&(t.events.$on(t.$doc,"selectionchange",a),t.events.$on(t.$doc,"orientationchange",a))}function u(){t.opts.toolbarInline?(e(t.opts.scrollableContainer).append(t.$tb),t.$tb.data("container",e(t.opts.scrollableContainer)),t.$tb.addClass("fr-inline"),t.$tb.prepend('<span class="fr-arrow"></span>'),d(),t.opts.toolbarBottom=!1):(t.opts.toolbarBottom&&!t.helpers.isIOS()?(t.$box.append(t.$tb),t.$tb.addClass("fr-bottom"),t.$box.addClass("fr-bottom")):(t.opts.toolbarBottom=!1,t.$box.prepend(t.$tb),t.$tb.addClass("fr-top"),t.$box.addClass("fr-top")),t.$tb.addClass("fr-basic"),t.opts.toolbarSticky&&(t.opts.toolbarStickyOffset&&(t.opts.toolbarBottom?t.$tb.css("bottom",t.opts.toolbarStickyOffset):t.$tb.css("top",t.opts.toolbarStickyOffset)),t.position.addSticky(t.$tb)))}function h(){t.$tb.html("").removeData().remove(),t.$tb=null}function p(){t.$box.removeClass("fr-top fr-bottom fr-inline fr-basic"),t.$box.find(".fr-sticky-dummy").remove()}function f(){t.opts.theme&&t.$tb.addClass(t.opts.theme+"-theme"),t.opts.zIndex>1&&t.$tb.css("z-index",t.opts.zIndex+1),"auto"!=t.opts.direction&&t.$tb.removeClass("fr-ltr fr-rtl").addClass("fr-"+t.opts.direction),t.helpers.isMobile()?t.$tb.addClass("fr-mobile"):t.$tb.addClass("fr-desktop"),t.opts.toolbarContainer?(t.opts.toolbarInline&&(d(),l()),t.opts.toolbarBottom?t.$tb.addClass("fr-bottom"):t.$tb.addClass("fr-top")):u(),_=t.$tb.get(0).ownerDocument,y="defaultView"in _?_.defaultView:_.parentWindow,n(),o(),t.events.$on(t.$tb,t._mousedown+" "+t._mouseup,function(e){var i=e.originalEvent?e.originalEvent.target||e.originalEvent.originalTarget:null;return i&&"INPUT"!=i.tagName&&!t.edit.isDisabled()?(e.stopPropagation(),e.preventDefault(),!1):void 0},!0)}function m(){return t.$wp?(t.opts.toolbarContainer?(t.shared.$tb?(t.$tb=t.shared.$tb,t.opts.toolbarInline&&d()):(t.shared.$tb=e('<div class="fr-toolbar"></div>'),t.$tb=t.shared.$tb,e(t.opts.toolbarContainer).append(t.$tb),f(),t.$tb.data("instance",t)),t.opts.toolbarInline?t.$box.addClass("fr-inline"):t.$box.addClass("fr-basic"),t.events.on("focus",function(){t.$tb.data("instance",t)},!0),t.opts.toolbarInline=!1):t.opts.toolbarInline?(t.$box.addClass("fr-inline"),t.shared.$tb?(t.$tb=t.shared.$tb,d()):(t.shared.$tb=e('<div class="fr-toolbar"></div>'),t.$tb=t.shared.$tb,f())):(t.$box.addClass("fr-basic"),t.$tb=e('<div class="fr-toolbar"></div>'),f(),t.$tb.data("instance",t)),t.events.on("destroy",p,!0),t.events.on(t.opts.toolbarInline?"shared.destroy":"destroy",h,!0),void 0):!1}function g(){!w&&t.$tb&&(t.$tb.find("> .fr-command").addClass("fr-disabled fr-no-refresh"),w=!0)}function v(){w&&t.$tb&&(t.$tb.find("> .fr-command").removeClass("fr-disabled fr-no-refresh"),w=!1),t.button.bulkRefresh()}var _,y,b=[];b[e.FE.XS]=t.opts.toolbarButtonsXS||t.opts.toolbarButtons,b[e.FE.SM]=t.opts.toolbarButtonsSM||t.opts.toolbarButtons,b[e.FE.MD]=t.opts.toolbarButtonsMD||t.opts.toolbarButtons,b[e.FE.LG]=t.opts.toolbarButtons;var w=!1;return{_init:m,hide:l,show:c,showInline:a,disable:g,enable:v}}}),// CodeMirror, copyright (c) by Marijn Haverbeke and others
function(e){if("object"==typeof exports&&"object"==typeof module)module.exports=e();else{if("function"==typeof define&&define.amd)return define([],e);(this||window).CodeMirror=e()}}(function(){"use strict";function e(i,n){if(!(this instanceof e))return new e(i,n);this.options=n=n?Ps(n):{},Ps(ea,n,!1),p(n);var r=n.value;"string"==typeof r&&(r=new xa(r,n.mode,null,n.lineSeparator)),this.doc=r;var s=new e.inputStyles[n.inputStyle](this),o=this.display=new t(i,r,s);o.wrapper.CodeMirror=this,c(this),a(this),n.lineWrapping&&(this.display.wrapper.className+=" CodeMirror-wrap"),n.autofocus&&!No&&o.input.focus(),v(this),this.state={keyMaps:[],overlays:[],modeGen:0,overwrite:!1,delayingBlurEvent:!1,focused:!1,suppressEdits:!1,pasteIncoming:!1,cutIncoming:!1,selectingText:!1,draggingText:!1,highlight:new Es,keySeq:null,specialChars:null};var l=this;yo&&11>bo&&setTimeout(function(){l.display.input.reset(!0)},20),Bi(this),Gs(),bi(this),this.curOp.forceUpdate=!0,Yr(this,r),n.autofocus&&!No||l.hasFocus()?setTimeout(Fs(vn,this),20):_n(this);for(var d in ta)ta.hasOwnProperty(d)&&ta[d](this,n[d],ia);k(this),n.finishInit&&n.finishInit(this);for(var u=0;u<oa.length;++u)oa[u](this);ki(this),wo&&n.lineWrapping&&"optimizelegibility"==getComputedStyle(o.lineDiv).textRendering&&(o.lineDiv.style.textRendering="auto")}function t(e,t,i){var n=this;this.input=i,n.scrollbarFiller=Bs("div",null,"CodeMirror-scrollbar-filler"),n.scrollbarFiller.setAttribute("cm-not-content","true"),n.gutterFiller=Bs("div",null,"CodeMirror-gutter-filler"),n.gutterFiller.setAttribute("cm-not-content","true"),n.lineDiv=Bs("div",null,"CodeMirror-code"),n.selectionDiv=Bs("div",null,null,"position: relative; z-index: 1"),n.cursorDiv=Bs("div",null,"CodeMirror-cursors"),n.measure=Bs("div",null,"CodeMirror-measure"),n.lineMeasure=Bs("div",null,"CodeMirror-measure"),n.lineSpace=Bs("div",[n.measure,n.lineMeasure,n.selectionDiv,n.cursorDiv,n.lineDiv],null,"position: relative; outline: none"),n.mover=Bs("div",[Bs("div",[n.lineSpace],"CodeMirror-lines")],null,"position: relative"),n.sizer=Bs("div",[n.mover],"CodeMirror-sizer"),n.sizerWidth=null,n.heightForcer=Bs("div",null,null,"position: absolute; height: "+Ia+"px; width: 1px;"),n.gutters=Bs("div",null,"CodeMirror-gutters"),n.lineGutter=null,n.scroller=Bs("div",[n.sizer,n.heightForcer,n.gutters],"CodeMirror-scroll"),n.scroller.setAttribute("tabIndex","-1"),n.wrapper=Bs("div",[n.scrollbarFiller,n.gutterFiller,n.scroller],"CodeMirror"),yo&&8>bo&&(n.gutters.style.zIndex=-1,n.scroller.style.paddingRight=0),wo||go&&No||(n.scroller.draggable=!0),e&&(e.appendChild?e.appendChild(n.wrapper):e(n.wrapper)),n.viewFrom=n.viewTo=t.first,n.reportedViewFrom=n.reportedViewTo=t.first,n.view=[],n.renderedView=null,n.externalMeasured=null,n.viewOffset=0,n.lastWrapHeight=n.lastWrapWidth=0,n.updateLineNumbers=null,n.nativeBarWidth=n.barHeight=n.barWidth=0,n.scrollbarsClipped=!1,n.lineNumWidth=n.lineNumInnerWidth=n.lineNumChars=null,n.alignWidgets=!1,n.cachedCharWidth=n.cachedTextHeight=n.cachedPaddingH=null,n.maxLine=null,n.maxLineLength=0,n.maxLineChanged=!1,n.wheelDX=n.wheelDY=n.wheelStartX=n.wheelStartY=null,n.shift=!1,n.selForContextMenu=null,n.activeTouch=null,i.init(n)}function i(t){t.doc.mode=e.getMode(t.options,t.doc.modeOption),n(t)}function n(e){e.doc.iter(function(e){e.stateAfter&&(e.stateAfter=null),e.styles&&(e.styles=null)}),e.doc.frontier=e.doc.first,zt(e,100),e.state.modeGen++,e.curOp&&Ii(e)}function r(e){e.options.lineWrapping?(Ja(e.display.wrapper,"CodeMirror-wrap"),e.display.sizer.style.minWidth="",e.display.sizerWidth=null):(Ka(e.display.wrapper,"CodeMirror-wrap"),h(e)),o(e),Ii(e),ai(e),setTimeout(function(){_(e)},100)}function s(e){var t=_i(e.display),i=e.options.lineWrapping,n=i&&Math.max(5,e.display.scroller.clientWidth/yi(e.display)-3);return function(r){if(kr(e.doc,r))return 0;var s=0;if(r.widgets)for(var o=0;o<r.widgets.length;o++)r.widgets[o].height&&(s+=r.widgets[o].height);return i?s+(Math.ceil(r.text.length/n)||1)*t:s+t}}function o(e){var t=e.doc,i=s(e);t.iter(function(e){var t=i(e);t!=e.height&&es(e,t)})}function a(e){e.display.wrapper.className=e.display.wrapper.className.replace(/\s*cm-s-\S+/g,"")+e.options.theme.replace(/(^|\s)\s*/g," cm-s-"),ai(e)}function l(e){c(e),Ii(e),setTimeout(function(){w(e)},20)}function c(e){var t=e.display.gutters,i=e.options.gutters;Ws(t);for(var n=0;n<i.length;++n){var r=i[n],s=t.appendChild(Bs("div",null,"CodeMirror-gutter "+r));"CodeMirror-linenumbers"==r&&(e.display.lineGutter=s,s.style.width=(e.display.lineNumWidth||1)+"px")}t.style.display=n?"":"none",d(e)}function d(e){var t=e.display.gutters.offsetWidth;e.display.sizer.style.marginLeft=t+"px"}function u(e){if(0==e.height)return 0;for(var t,i=e.text.length,n=e;t=mr(n);){var r=t.find(0,!0);n=r.from.line,i+=r.from.ch-r.to.ch}for(n=e;t=gr(n);){var r=t.find(0,!0);i-=n.text.length-r.from.ch,n=r.to.line,i+=n.text.length-r.to.ch}return i}function h(e){var t=e.display,i=e.doc;t.maxLine=Kr(i,i.first),t.maxLineLength=u(t.maxLine),t.maxLineChanged=!0,i.iter(function(e){var i=u(e);i>t.maxLineLength&&(t.maxLineLength=i,t.maxLine=e)})}function p(e){var t=Rs(e.gutters,"CodeMirror-linenumbers");-1==t&&e.lineNumbers?e.gutters=e.gutters.concat(["CodeMirror-linenumbers"]):t>-1&&!e.lineNumbers&&(e.gutters=e.gutters.slice(0),e.gutters.splice(t,1))}function f(e){var t=e.display,i=t.gutters.offsetWidth,n=Math.round(e.doc.height+qt(e.display));return{clientHeight:t.scroller.clientHeight,viewHeight:t.wrapper.clientHeight,scrollWidth:t.scroller.scrollWidth,clientWidth:t.scroller.clientWidth,viewWidth:t.wrapper.clientWidth,barLeft:e.options.fixedGutter?i:0,docHeight:n,scrollHeight:n+Ut(e)+t.barHeight,nativeBarWidth:t.nativeBarWidth,gutterWidth:i}}function m(e,t,i){this.cm=i;var n=this.vert=Bs("div",[Bs("div",null,null,"min-width: 1px")],"CodeMirror-vscrollbar"),r=this.horiz=Bs("div",[Bs("div",null,null,"height: 100%; min-height: 1px")],"CodeMirror-hscrollbar");e(n),e(r),Ea(n,"scroll",function(){n.clientHeight&&t(n.scrollTop,"vertical")}),Ea(r,"scroll",function(){r.clientWidth&&t(r.scrollLeft,"horizontal")}),this.checkedZeroWidth=!1,yo&&8>bo&&(this.horiz.style.minHeight=this.vert.style.minWidth="18px")}function g(){}function v(t){t.display.scrollbars&&(t.display.scrollbars.clear(),t.display.scrollbars.addClass&&Ka(t.display.wrapper,t.display.scrollbars.addClass)),t.display.scrollbars=new e.scrollbarModel[t.options.scrollbarStyle](function(e){t.display.wrapper.insertBefore(e,t.display.scrollbarFiller),Ea(e,"mousedown",function(){t.state.focused&&setTimeout(function(){t.display.input.focus()},0)}),e.setAttribute("cm-not-content","true")},function(e,i){"horizontal"==i?sn(t,e):rn(t,e)},t),t.display.scrollbars.addClass&&Ja(t.display.wrapper,t.display.scrollbars.addClass)}function _(e,t){t||(t=f(e));var i=e.display.barWidth,n=e.display.barHeight;y(e,t);for(var r=0;4>r&&i!=e.display.barWidth||n!=e.display.barHeight;r++)i!=e.display.barWidth&&e.options.lineWrapping&&D(e),y(e,f(e)),i=e.display.barWidth,n=e.display.barHeight}function y(e,t){var i=e.display,n=i.scrollbars.update(t);i.sizer.style.paddingRight=(i.barWidth=n.right)+"px",i.sizer.style.paddingBottom=(i.barHeight=n.bottom)+"px",i.heightForcer.style.borderBottom=n.bottom+"px solid transparent",n.right&&n.bottom?(i.scrollbarFiller.style.display="block",i.scrollbarFiller.style.height=n.bottom+"px",i.scrollbarFiller.style.width=n.right+"px"):i.scrollbarFiller.style.display="",n.bottom&&e.options.coverGutterNextToScrollbar&&e.options.fixedGutter?(i.gutterFiller.style.display="block",i.gutterFiller.style.height=n.bottom+"px",i.gutterFiller.style.width=t.gutterWidth+"px"):i.gutterFiller.style.display=""}function b(e,t,i){var n=i&&null!=i.top?Math.max(0,i.top):e.scroller.scrollTop;n=Math.floor(n-Wt(e));var r=i&&null!=i.bottom?i.bottom:n+e.wrapper.clientHeight,s=is(t,n),o=is(t,r);if(i&&i.ensure){var a=i.ensure.from.line,l=i.ensure.to.line;s>a?(s=a,o=is(t,ns(Kr(t,a))+e.wrapper.clientHeight)):Math.min(l,t.lastLine())>=o&&(s=is(t,ns(Kr(t,l))-e.wrapper.clientHeight),o=l)}return{from:s,to:Math.max(o,s+1)}}function w(e){var t=e.display,i=t.view;if(t.alignWidgets||t.gutters.firstChild&&e.options.fixedGutter){for(var n=x(t)-t.scroller.scrollLeft+e.doc.scrollLeft,r=t.gutters.offsetWidth,s=n+"px",o=0;o<i.length;o++)if(!i[o].hidden){e.options.fixedGutter&&i[o].gutter&&(i[o].gutter.style.left=s);var a=i[o].alignable;if(a)for(var l=0;l<a.length;l++)a[l].style.left=s}e.options.fixedGutter&&(t.gutters.style.left=n+r+"px")}}function k(e){if(!e.options.lineNumbers)return!1;var t=e.doc,i=C(e.options,t.first+t.size-1),n=e.display;if(i.length!=n.lineNumChars){var r=n.measure.appendChild(Bs("div",[Bs("div",i)],"CodeMirror-linenumber CodeMirror-gutter-elt")),s=r.firstChild.offsetWidth,o=r.offsetWidth-s;return n.lineGutter.style.width="",n.lineNumInnerWidth=Math.max(s,n.lineGutter.offsetWidth-o)+1,n.lineNumWidth=n.lineNumInnerWidth+o,n.lineNumChars=n.lineNumInnerWidth?i.length:-1,n.lineGutter.style.width=n.lineNumWidth+"px",d(e),!0}return!1}function C(e,t){return String(e.lineNumberFormatter(t+e.firstLineNumber))}function x(e){return e.scroller.getBoundingClientRect().left-e.sizer.getBoundingClientRect().left}function A(e,t,i){var n=e.display;this.viewport=t,this.visible=b(n,e.doc,t),this.editorIsHidden=!n.wrapper.offsetWidth,this.wrapperHeight=n.wrapper.clientHeight,this.wrapperWidth=n.wrapper.clientWidth,this.oldDisplayWidth=Xt(e),this.force=i,this.dims=R(e),this.events=[]}function T(e){var t=e.display;!t.scrollbarsClipped&&t.scroller.offsetWidth&&(t.nativeBarWidth=t.scroller.offsetWidth-t.scroller.clientWidth,t.heightForcer.style.height=Ut(e)+"px",t.sizer.style.marginBottom=-t.nativeBarWidth+"px",t.sizer.style.borderRightWidth=Ut(e)+"px",t.scrollbarsClipped=!0)}function S(e,t){var i=e.display,n=e.doc;if(t.editorIsHidden)return Pi(e),!1;if(!t.force&&t.visible.from>=i.viewFrom&&t.visible.to<=i.viewTo&&(null==i.updateLineNumbers||i.updateLineNumbers>=i.viewTo)&&i.renderedView==i.view&&0==Hi(e))return!1;k(e)&&(Pi(e),t.dims=R(e));var r=n.first+n.size,s=Math.max(t.visible.from-e.options.viewportMargin,n.first),o=Math.min(r,t.visible.to+e.options.viewportMargin);i.viewFrom<s&&s-i.viewFrom<20&&(s=Math.max(n.first,i.viewFrom)),i.viewTo>o&&i.viewTo-o<20&&(o=Math.min(r,i.viewTo)),Po&&(s=br(e.doc,s),o=wr(e.doc,o));var a=s!=i.viewFrom||o!=i.viewTo||i.lastWrapHeight!=t.wrapperHeight||i.lastWrapWidth!=t.wrapperWidth;$i(e,s,o),i.viewOffset=ns(Kr(e.doc,i.viewFrom)),e.display.mover.style.top=i.viewOffset+"px";var l=Hi(e);if(!a&&0==l&&!t.force&&i.renderedView==i.view&&(null==i.updateLineNumbers||i.updateLineNumbers>=i.viewTo))return!1;var c=Qs();return l>4&&(i.lineDiv.style.display="none"),L(e,i.updateLineNumbers,t.dims),l>4&&(i.lineDiv.style.display=""),i.renderedView=i.view,c&&Qs()!=c&&c.offsetHeight&&c.focus(),Ws(i.cursorDiv),Ws(i.selectionDiv),i.gutters.style.height=i.sizer.style.minHeight=0,a&&(i.lastWrapHeight=t.wrapperHeight,i.lastWrapWidth=t.wrapperWidth,zt(e,400)),i.updateLineNumbers=null,!0}function M(e,t){for(var i=t.viewport,n=!0;(n&&e.options.lineWrapping&&t.oldDisplayWidth!=Xt(e)||(i&&null!=i.top&&(i={top:Math.min(e.doc.height+qt(e.display)-Vt(e),i.top)}),t.visible=b(e.display,e.doc,i),!(t.visible.from>=e.display.viewFrom&&t.visible.to<=e.display.viewTo)))&&S(e,t);n=!1){D(e);var r=f(e);Lt(e),_(e,r),E(e,r)}t.signal(e,"update",e),(e.display.viewFrom!=e.display.reportedViewFrom||e.display.viewTo!=e.display.reportedViewTo)&&(t.signal(e,"viewportChange",e,e.display.viewFrom,e.display.viewTo),e.display.reportedViewFrom=e.display.viewFrom,e.display.reportedViewTo=e.display.viewTo)}function N(e,t){var i=new A(e,t);if(S(e,i)){D(e),M(e,i);var n=f(e);Lt(e),_(e,n),E(e,n),i.finish()}}function E(e,t){e.display.sizer.style.minHeight=t.docHeight+"px",e.display.heightForcer.style.top=t.docHeight+"px",e.display.gutters.style.height=t.docHeight+e.display.barHeight+Ut(e)+"px"}function D(e){for(var t=e.display,i=t.lineDiv.offsetTop,n=0;n<t.view.length;n++){var r,s=t.view[n];if(!s.hidden){if(yo&&8>bo){var o=s.node.offsetTop+s.node.offsetHeight;r=o-i,i=o}else{var a=s.node.getBoundingClientRect();r=a.bottom-a.top}var l=s.line.height-r;if(2>r&&(r=_i(t)),(l>.001||-.001>l)&&(es(s.line,r),O(s.line),s.rest))for(var c=0;c<s.rest.length;c++)O(s.rest[c])}}}function O(e){if(e.widgets)for(var t=0;t<e.widgets.length;++t)e.widgets[t].height=e.widgets[t].node.parentNode.offsetHeight}function R(e){for(var t=e.display,i={},n={},r=t.gutters.clientLeft,s=t.gutters.firstChild,o=0;s;s=s.nextSibling,++o)i[e.options.gutters[o]]=s.offsetLeft+s.clientLeft+r,n[e.options.gutters[o]]=s.clientWidth;return{fixedPos:x(t),gutterTotalWidth:t.gutters.offsetWidth,gutterLeft:i,gutterWidth:n,wrapperWidth:t.wrapper.clientWidth}}function L(e,t,i){function n(t){var i=t.nextSibling;return wo&&Eo&&e.display.currentWheelTarget==t?t.style.display="none":t.parentNode.removeChild(t),i}for(var r=e.display,s=e.options.lineNumbers,o=r.lineDiv,a=o.firstChild,l=r.view,c=r.viewFrom,d=0;d<l.length;d++){var u=l[d];if(u.hidden);else if(u.node&&u.node.parentNode==o){for(;a!=u.node;)a=n(a);var h=s&&null!=t&&c>=t&&u.lineNumber;u.changes&&(Rs(u.changes,"gutter")>-1&&(h=!1),I(e,u,c,i)),h&&(Ws(u.lineNumber),u.lineNumber.appendChild(document.createTextNode(C(e.options,c)))),a=u.node.nextSibling}else{var p=W(e,u,c,i);o.insertBefore(p,a)}c+=u.size}for(;a;)a=n(a)}function I(e,t,i,n){for(var r=0;r<t.changes.length;r++){var s=t.changes[r];"text"==s?z(e,t):"gutter"==s?H(e,t,i,n):"class"==s?$(t):"widget"==s&&B(e,t,n)}t.changes=null}function j(e){return e.node==e.text&&(e.node=Bs("div",null,null,"position: relative"),e.text.parentNode&&e.text.parentNode.replaceChild(e.node,e.text),e.node.appendChild(e.text),yo&&8>bo&&(e.node.style.zIndex=2)),e.node}function P(e){var t=e.bgClass?e.bgClass+" "+(e.line.bgClass||""):e.line.bgClass;if(t&&(t+=" CodeMirror-linebackground"),e.background)t?e.background.className=t:(e.background.parentNode.removeChild(e.background),e.background=null);else if(t){var i=j(e);e.background=i.insertBefore(Bs("div",null,t),i.firstChild)}}function F(e,t){var i=e.display.externalMeasured;return i&&i.line==t.line?(e.display.externalMeasured=null,t.measure=i.measure,i.built):Fr(e,t)}function z(e,t){var i=t.text.className,n=F(e,t);t.text==t.node&&(t.node=n.pre),t.text.parentNode.replaceChild(n.pre,t.text),t.text=n.pre,n.bgClass!=t.bgClass||n.textClass!=t.textClass?(t.bgClass=n.bgClass,t.textClass=n.textClass,$(t)):i&&(t.text.className=i)}function $(e){P(e),e.line.wrapClass?j(e).className=e.line.wrapClass:e.node!=e.text&&(e.node.className="");var t=e.textClass?e.textClass+" "+(e.line.textClass||""):e.line.textClass;e.text.className=t||""}function H(e,t,i,n){if(t.gutter&&(t.node.removeChild(t.gutter),t.gutter=null),t.gutterBackground&&(t.node.removeChild(t.gutterBackground),t.gutterBackground=null),t.line.gutterClass){var r=j(t);t.gutterBackground=Bs("div",null,"CodeMirror-gutter-background "+t.line.gutterClass,"left: "+(e.options.fixedGutter?n.fixedPos:-n.gutterTotalWidth)+"px; width: "+n.gutterTotalWidth+"px"),r.insertBefore(t.gutterBackground,t.text)}var s=t.line.gutterMarkers;if(e.options.lineNumbers||s){var r=j(t),o=t.gutter=Bs("div",null,"CodeMirror-gutter-wrapper","left: "+(e.options.fixedGutter?n.fixedPos:-n.gutterTotalWidth)+"px");if(e.display.input.setUneditable(o),r.insertBefore(o,t.text),t.line.gutterClass&&(o.className+=" "+t.line.gutterClass),!e.options.lineNumbers||s&&s["CodeMirror-linenumbers"]||(t.lineNumber=o.appendChild(Bs("div",C(e.options,i),"CodeMirror-linenumber CodeMirror-gutter-elt","left: "+n.gutterLeft["CodeMirror-linenumbers"]+"px; width: "+e.display.lineNumInnerWidth+"px"))),s)for(var a=0;a<e.options.gutters.length;++a){var l=e.options.gutters[a],c=s.hasOwnProperty(l)&&s[l];c&&o.appendChild(Bs("div",[c],"CodeMirror-gutter-elt","left: "+n.gutterLeft[l]+"px; width: "+n.gutterWidth[l]+"px"))}}}function B(e,t,i){t.alignable&&(t.alignable=null);for(var n,r=t.node.firstChild;r;r=n){var n=r.nextSibling;"CodeMirror-linewidget"==r.className&&t.node.removeChild(r)}q(e,t,i)}function W(e,t,i,n){var r=F(e,t);return t.text=t.node=r.pre,r.bgClass&&(t.bgClass=r.bgClass),r.textClass&&(t.textClass=r.textClass),$(t),H(e,t,i,n),q(e,t,n),t.node}function q(e,t,i){if(Q(e,t.line,t,i,!0),t.rest)for(var n=0;n<t.rest.length;n++)Q(e,t.rest[n],t,i,!1)}function Q(e,t,i,n,r){if(t.widgets)for(var s=j(i),o=0,a=t.widgets;o<a.length;++o){var l=a[o],c=Bs("div",[l.node],"CodeMirror-linewidget");l.handleMouseEvents||c.setAttribute("cm-ignore-events","true"),U(l,c,i,n),e.display.input.setUneditable(c),r&&l.above?s.insertBefore(c,i.gutter||i.text):s.appendChild(c),xs(l,"redraw")}}function U(e,t,i,n){if(e.noHScroll){(i.alignable||(i.alignable=[])).push(t);var r=n.wrapperWidth;t.style.left=n.fixedPos+"px",e.coverGutter||(r-=n.gutterTotalWidth,t.style.paddingLeft=n.gutterTotalWidth+"px"),t.style.width=r+"px"}e.coverGutter&&(t.style.zIndex=5,t.style.position="relative",e.noHScroll||(t.style.marginLeft=-n.gutterTotalWidth+"px"))}function X(e){return Fo(e.line,e.ch)}function V(e,t){return zo(e,t)<0?t:e}function G(e,t){return zo(e,t)<0?e:t}function Y(e){e.state.focused||(e.display.input.focus(),vn(e))}function K(e,t,i,n,r){var s=e.doc;e.display.shift=!1,n||(n=s.sel);var o=e.state.pasteIncoming||"paste"==r,a=s.splitLines(t),l=null;if(o&&n.ranges.length>1)if($o&&$o.text.join("\n")==t){if(0==n.ranges.length%$o.text.length){l=[];for(var c=0;c<$o.text.length;c++)l.push(s.splitLines($o.text[c]))}}else a.length==n.ranges.length&&(l=Ls(a,function(e){return[e]}));for(var c=n.ranges.length-1;c>=0;c--){var d=n.ranges[c],u=d.from(),h=d.to();d.empty()&&(i&&i>0?u=Fo(u.line,u.ch-i):e.state.overwrite&&!o?h=Fo(h.line,Math.min(Kr(s,h.line).text.length,h.ch+Os(a).length)):$o&&$o.lineWise&&$o.text.join("\n")==t&&(u=h=Fo(u.line,0)));var p=e.curOp.updateInput,f={from:u,to:h,text:l?l[c%l.length]:a,origin:r||(o?"paste":e.state.cutIncoming?"cut":"+input")};Tn(e.doc,f),xs(e,"inputRead",e,f)}t&&!o&&Z(e,t),Fn(e),e.curOp.updateInput=p,e.curOp.typing=!0,e.state.pasteIncoming=e.state.cutIncoming=!1}function J(e,t){var i=e.clipboardData&&e.clipboardData.getData("text/plain");return i?(e.preventDefault(),t.isReadOnly()||t.options.disableInput||Ni(t,function(){K(t,i,0,null,"paste")}),!0):void 0}function Z(e,t){if(e.options.electricChars&&e.options.smartIndent)for(var i=e.doc.sel,n=i.ranges.length-1;n>=0;n--){var r=i.ranges[n];if(!(r.head.ch>100||n&&i.ranges[n-1].head.line==r.head.line)){var s=e.getModeAt(r.head),o=!1;if(s.electricChars){for(var a=0;a<s.electricChars.length;a++)if(t.indexOf(s.electricChars.charAt(a))>-1){o=$n(e,r.head.line,"smart");break}}else s.electricInput&&s.electricInput.test(Kr(e.doc,r.head.line).text.slice(0,r.head.ch))&&(o=$n(e,r.head.line,"smart"));o&&xs(e,"electricInput",e,r.head.line)}}}function et(e){for(var t=[],i=[],n=0;n<e.doc.sel.ranges.length;n++){var r=e.doc.sel.ranges[n].head.line,s={anchor:Fo(r,0),head:Fo(r+1,0)};i.push(s),t.push(e.getRange(s.anchor,s.head))}return{text:t,ranges:i}}function tt(e){e.setAttribute("autocorrect","off"),e.setAttribute("autocapitalize","off"),e.setAttribute("spellcheck","false")}function it(e){this.cm=e,this.prevInput="",this.pollingFast=!1,this.polling=new Es,this.inaccurateSelection=!1,this.hasSelection=!1,this.composing=null}function nt(){var e=Bs("textarea",null,null,"position: absolute; padding: 0; width: 1px; height: 1em; outline: none"),t=Bs("div",[e],null,"overflow: hidden; position: relative; width: 3px; height: 0px;");return wo?e.style.width="1000px":e.setAttribute("wrap","off"),Mo&&(e.style.border="1px solid black"),tt(e),t}function rt(e){this.cm=e,this.lastAnchorNode=this.lastAnchorOffset=this.lastFocusNode=this.lastFocusOffset=null,this.polling=new Es,this.gracePeriod=!1}function st(e,t){var i=Zt(e,t.line);if(!i||i.hidden)return null;var n=Kr(e.doc,t.line),r=Yt(i,n,t.line),s=rs(n),o="left";if(s){var a=co(s,t.ch);o=a%2?"right":"left"}var l=ii(r.map,t.ch,o);return l.offset="right"==l.collapse?l.end:l.start,l}function ot(e,t){return t&&(e.bad=!0),e}function at(e,t,i){var n;if(t==e.display.lineDiv){if(n=e.display.lineDiv.childNodes[i],!n)return ot(e.clipPos(Fo(e.display.viewTo-1)),!0);t=null,i=0}else for(n=t;;n=n.parentNode){if(!n||n==e.display.lineDiv)return null;if(n.parentNode&&n.parentNode==e.display.lineDiv)break}for(var r=0;r<e.display.view.length;r++){var s=e.display.view[r];if(s.node==n)return lt(s,t,i)}}function lt(e,t,i){function n(t,i,n){for(var r=-1;r<(d?d.length:0);r++)for(var s=0>r?c.map:d[r],o=0;o<s.length;o+=3){var a=s[o+2];if(a==t||a==i){var l=ts(0>r?e.line:e.rest[r]),u=s[o]+n;return(0>n||a!=t)&&(u=s[o+(n?1:0)]),Fo(l,u)}}}var r=e.text.firstChild,s=!1;if(!t||!Va(r,t))return ot(Fo(ts(e.line),0),!0);if(t==r&&(s=!0,t=r.childNodes[i],i=0,!t)){var o=e.rest?Os(e.rest):e.line;return ot(Fo(ts(o),o.text.length),s)}var a=3==t.nodeType?t:null,l=t;for(a||1!=t.childNodes.length||3!=t.firstChild.nodeType||(a=t.firstChild,i&&(i=a.nodeValue.length));l.parentNode!=r;)l=l.parentNode;var c=e.measure,d=c.maps,u=n(a,l,i);if(u)return ot(u,s);for(var h=l.nextSibling,p=a?a.nodeValue.length-i:0;h;h=h.nextSibling){if(u=n(h,h.firstChild,0))return ot(Fo(u.line,u.ch-p),s);p+=h.textContent.length}for(var f=l.previousSibling,p=i;f;f=f.previousSibling){if(u=n(f,f.firstChild,-1))return ot(Fo(u.line,u.ch+p),s);p+=h.textContent.length}}function ct(e,t,i,n,r){function s(e){return function(t){return t.id==e}}function o(t){if(1==t.nodeType){var i=t.getAttribute("cm-text");if(null!=i)return""==i&&(i=t.textContent.replace(/\u200b/g,"")),a+=i,void 0;var d,u=t.getAttribute("cm-marker");if(u){var h=e.findMarks(Fo(n,0),Fo(r+1,0),s(+u));return h.length&&(d=h[0].find())&&(a+=Jr(e.doc,d.from,d.to).join(c)),void 0}if("false"==t.getAttribute("contenteditable"))return;for(var p=0;p<t.childNodes.length;p++)o(t.childNodes[p]);/^(pre|div|p)$/i.test(t.nodeName)&&(l=!0)}else if(3==t.nodeType){var f=t.nodeValue;if(!f)return;l&&(a+=c,l=!1),a+=f}}for(var a="",l=!1,c=e.doc.lineSeparator();o(t),t!=i;)t=t.nextSibling;return a}function dt(e,t){this.ranges=e,this.primIndex=t}function ut(e,t){this.anchor=e,this.head=t}function ht(e,t){var i=e[t];e.sort(function(e,t){return zo(e.from(),t.from())}),t=Rs(e,i);for(var n=1;n<e.length;n++){var r=e[n],s=e[n-1];if(zo(s.to(),r.from())>=0){var o=G(s.from(),r.from()),a=V(s.to(),r.to()),l=s.empty()?r.from()==r.head:s.from()==s.head;t>=n&&--t,e.splice(--n,2,new ut(l?a:o,l?o:a))}}return new dt(e,t)}function pt(e,t){return new dt([new ut(e,t||e)],0)}function ft(e,t){return Math.max(e.first,Math.min(t,e.first+e.size-1))}function mt(e,t){if(t.line<e.first)return Fo(e.first,0);var i=e.first+e.size-1;return t.line>i?Fo(i,Kr(e,i).text.length):gt(t,Kr(e,t.line).text.length)}function gt(e,t){var i=e.ch;return null==i||i>t?Fo(e.line,t):0>i?Fo(e.line,0):e}function vt(e,t){return t>=e.first&&t<e.first+e.size}function _t(e,t){for(var i=[],n=0;n<t.length;n++)i[n]=mt(e,t[n]);return i}function yt(e,t,i,n){if(e.cm&&e.cm.display.shift||e.extend){var r=t.anchor;if(n){var s=zo(i,r)<0;s!=zo(n,r)<0?(r=i,i=n):s!=zo(i,n)<0&&(i=n)}return new ut(r,i)}return new ut(n||i,i)}function bt(e,t,i,n){Tt(e,new dt([yt(e,e.sel.primary(),t,i)],0),n)}function wt(e,t,i){for(var n=[],r=0;r<e.sel.ranges.length;r++)n[r]=yt(e,e.sel.ranges[r],t[r],null);var s=ht(n,e.sel.primIndex);Tt(e,s,i)}function kt(e,t,i,n){var r=e.sel.ranges.slice(0);r[t]=i,Tt(e,ht(r,e.sel.primIndex),n)}function Ct(e,t,i,n){Tt(e,pt(t,i),n)}function xt(e,t,i){var n={ranges:t.ranges,update:function(t){this.ranges=[];for(var i=0;i<t.length;i++)this.ranges[i]=new ut(mt(e,t[i].anchor),mt(e,t[i].head))},origin:i&&i.origin};return Ra(e,"beforeSelectionChange",e,n),e.cm&&Ra(e.cm,"beforeSelectionChange",e.cm,n),n.ranges!=t.ranges?ht(n.ranges,n.ranges.length-1):t}function At(e,t,i){var n=e.history.done,r=Os(n);r&&r.ranges?(n[n.length-1]=t,St(e,t,i)):Tt(e,t,i)}function Tt(e,t,i){St(e,t,i),us(e,e.sel,e.cm?e.cm.curOp.id:0/0,i)}function St(e,t,i){(Ms(e,"beforeSelectionChange")||e.cm&&Ms(e.cm,"beforeSelectionChange"))&&(t=xt(e,t,i));var n=i&&i.bias||(zo(t.primary().head,e.sel.primary().head)<0?-1:1);Mt(e,Et(e,t,n,!0)),i&&i.scroll===!1||!e.cm||Fn(e.cm)}function Mt(e,t){t.equals(e.sel)||(e.sel=t,e.cm&&(e.cm.curOp.updateInput=e.cm.curOp.selectionChanged=!0,Ss(e.cm)),xs(e,"cursorActivity",e))}function Nt(e){Mt(e,Et(e,e.sel,null,!1),Pa)}function Et(e,t,i,n){for(var r,s=0;s<t.ranges.length;s++){var o=t.ranges[s],a=t.ranges.length==e.sel.ranges.length&&e.sel.ranges[s],l=Ot(e,o.anchor,a&&a.anchor,i,n),c=Ot(e,o.head,a&&a.head,i,n);(r||l!=o.anchor||c!=o.head)&&(r||(r=t.ranges.slice(0,s)),r[s]=new ut(l,c))}return r?ht(r,t.primIndex):t}function Dt(e,t,i,n,r){var s=Kr(e,t.line);if(s.markedSpans)for(var o=0;o<s.markedSpans.length;++o){var a=s.markedSpans[o],l=a.marker;if((null==a.from||(l.inclusiveLeft?a.from<=t.ch:a.from<t.ch))&&(null==a.to||(l.inclusiveRight?a.to>=t.ch:a.to>t.ch))){if(r&&(Ra(l,"beforeCursorEnter"),l.explicitlyCleared)){if(s.markedSpans){--o;continue}break}if(!l.atomic)continue;if(i){var c,d=l.find(0>n?1:-1);if((0>n?l.inclusiveRight:l.inclusiveLeft)&&(d=Rt(e,d,-n,d&&d.line==t.line?s:null)),d&&d.line==t.line&&(c=zo(d,i))&&(0>n?0>c:c>0))return Dt(e,d,t,n,r)}var u=l.find(0>n?-1:1);return(0>n?l.inclusiveLeft:l.inclusiveRight)&&(u=Rt(e,u,n,u.line==t.line?s:null)),u?Dt(e,u,t,n,r):null}}return t}function Ot(e,t,i,n,r){var s=n||1,o=Dt(e,t,i,s,r)||!r&&Dt(e,t,i,s,!0)||Dt(e,t,i,-s,r)||!r&&Dt(e,t,i,-s,!0);return o?o:(e.cantEdit=!0,Fo(e.first,0))}function Rt(e,t,i,n){return 0>i&&0==t.ch?t.line>e.first?mt(e,Fo(t.line-1)):null:i>0&&t.ch==(n||Kr(e,t.line)).text.length?t.line<e.first+e.size-1?Fo(t.line+1,0):null:new Fo(t.line,t.ch+i)}function Lt(e){e.display.input.showSelection(e.display.input.prepareSelection())}function It(e,t){for(var i=e.doc,n={},r=n.cursors=document.createDocumentFragment(),s=n.selection=document.createDocumentFragment(),o=0;o<i.sel.ranges.length;o++)if(t!==!1||o!=i.sel.primIndex){var a=i.sel.ranges[o];if(!(a.from().line>=e.display.viewTo||a.to().line<e.display.viewFrom)){var l=a.empty();(l||e.options.showCursorWhenSelecting)&&jt(e,a.head,r),l||Pt(e,a,s)}}return n}function jt(e,t,i){var n=pi(e,t,"div",null,null,!e.options.singleCursorHeightPerLine),r=i.appendChild(Bs("div"," ","CodeMirror-cursor"));if(r.style.left=n.left+"px",r.style.top=n.top+"px",r.style.height=Math.max(0,n.bottom-n.top)*e.options.cursorHeight+"px",n.other){var s=i.appendChild(Bs("div"," ","CodeMirror-cursor CodeMirror-secondarycursor"));s.style.display="",s.style.left=n.other.left+"px",s.style.top=n.other.top+"px",s.style.height=.85*(n.other.bottom-n.other.top)+"px"}}function Pt(e,t,i){function n(e,t,i,n){0>t&&(t=0),t=Math.round(t),n=Math.round(n),a.appendChild(Bs("div",null,"CodeMirror-selected","position: absolute; left: "+e+"px; top: "+t+"px; width: "+(null==i?d-e:i)+"px; height: "+(n-t)+"px"))}function r(t,i,r){function s(i,n){return hi(e,Fo(t,i),"div",u,n)}var a,l,u=Kr(o,t),h=u.text.length;return eo(rs(u),i||0,null==r?h:r,function(e,t,o){var u,p,f,m=s(e,"left");if(e==t)u=m,p=f=m.left;else{if(u=s(t-1,"right"),"rtl"==o){var g=m;m=u,u=g}p=m.left,f=u.right}null==i&&0==e&&(p=c),u.top-m.top>3&&(n(p,m.top,null,m.bottom),p=c,m.bottom<u.top&&n(p,m.bottom,null,u.top)),null==r&&t==h&&(f=d),(!a||m.top<a.top||m.top==a.top&&m.left<a.left)&&(a=m),(!l||u.bottom>l.bottom||u.bottom==l.bottom&&u.right>l.right)&&(l=u),c+1>p&&(p=c),n(p,u.top,f-p,u.bottom)}),{start:a,end:l}}var s=e.display,o=e.doc,a=document.createDocumentFragment(),l=Qt(e.display),c=l.left,d=Math.max(s.sizerWidth,Xt(e)-s.sizer.offsetLeft)-l.right,u=t.from(),h=t.to();if(u.line==h.line)r(u.line,u.ch,h.ch);else{var p=Kr(o,u.line),f=Kr(o,h.line),m=_r(p)==_r(f),g=r(u.line,u.ch,m?p.text.length+1:null).end,v=r(h.line,m?0:null,h.ch).start;m&&(g.top<v.top-2?(n(g.right,g.top,null,g.bottom),n(c,v.top,v.left,v.bottom)):n(g.right,g.top,v.left-g.right,g.bottom)),g.bottom<v.top&&n(c,g.bottom,null,v.top)}i.appendChild(a)}function Ft(e){if(e.state.focused){var t=e.display;clearInterval(t.blinker);var i=!0;t.cursorDiv.style.visibility="",e.options.cursorBlinkRate>0?t.blinker=setInterval(function(){t.cursorDiv.style.visibility=(i=!i)?"":"hidden"},e.options.cursorBlinkRate):e.options.cursorBlinkRate<0&&(t.cursorDiv.style.visibility="hidden")}}function zt(e,t){e.doc.mode.startState&&e.doc.frontier<e.display.viewTo&&e.state.highlight.set(t,Fs($t,e))}function $t(e){var t=e.doc;if(t.frontier<t.first&&(t.frontier=t.first),!(t.frontier>=e.display.viewTo)){var i=+new Date+e.options.workTime,n=la(t.mode,Bt(e,t.frontier)),r=[];t.iter(t.frontier,Math.min(t.first+t.size,e.display.viewTo+500),function(s){if(t.frontier>=e.display.viewFrom){var o=s.styles,a=s.text.length>e.options.maxHighlightLength,l=Lr(e,s,a?la(t.mode,n):n,!0);s.styles=l.styles;var c=s.styleClasses,d=l.classes;d?s.styleClasses=d:c&&(s.styleClasses=null);for(var u=!o||o.length!=s.styles.length||c!=d&&(!c||!d||c.bgClass!=d.bgClass||c.textClass!=d.textClass),h=0;!u&&h<o.length;++h)u=o[h]!=s.styles[h];u&&r.push(t.frontier),s.stateAfter=a?n:la(t.mode,n)}else s.text.length<=e.options.maxHighlightLength&&jr(e,s.text,n),s.stateAfter=0==t.frontier%5?la(t.mode,n):null;return++t.frontier,+new Date>i?(zt(e,e.options.workDelay),!0):void 0}),r.length&&Ni(e,function(){for(var t=0;t<r.length;t++)ji(e,r[t],"text")})}}function Ht(e,t,i){for(var n,r,s=e.doc,o=i?-1:t-(e.doc.mode.innerMode?1e3:100),a=t;a>o;--a){if(a<=s.first)return s.first;var l=Kr(s,a-1);if(l.stateAfter&&(!i||a<=s.frontier))return a;var c=$a(l.text,null,e.options.tabSize);(null==r||n>c)&&(r=a-1,n=c)}return r}function Bt(e,t,i){var n=e.doc,r=e.display;if(!n.mode.startState)return!0;var s=Ht(e,t,i),o=s>n.first&&Kr(n,s-1).stateAfter;return o=o?la(n.mode,o):ca(n.mode),n.iter(s,t,function(i){jr(e,i.text,o);var a=s==t-1||0==s%5||s>=r.viewFrom&&s<r.viewTo;i.stateAfter=a?la(n.mode,o):null,++s}),i&&(n.frontier=s),o}function Wt(e){return e.lineSpace.offsetTop}function qt(e){return e.mover.offsetHeight-e.lineSpace.offsetHeight}function Qt(e){if(e.cachedPaddingH)return e.cachedPaddingH;var t=qs(e.measure,Bs("pre","x")),i=window.getComputedStyle?window.getComputedStyle(t):t.currentStyle,n={left:parseInt(i.paddingLeft),right:parseInt(i.paddingRight)};return isNaN(n.left)||isNaN(n.right)||(e.cachedPaddingH=n),n}function Ut(e){return Ia-e.display.nativeBarWidth}function Xt(e){return e.display.scroller.clientWidth-Ut(e)-e.display.barWidth}function Vt(e){return e.display.scroller.clientHeight-Ut(e)-e.display.barHeight}function Gt(e,t,i){var n=e.options.lineWrapping,r=n&&Xt(e);if(!t.measure.heights||n&&t.measure.width!=r){var s=t.measure.heights=[];if(n){t.measure.width=r;for(var o=t.text.firstChild.getClientRects(),a=0;a<o.length-1;a++){var l=o[a],c=o[a+1];Math.abs(l.bottom-c.bottom)>2&&s.push((l.bottom+c.top)/2-i.top)}}s.push(i.bottom-i.top)}}function Yt(e,t,i){if(e.line==t)return{map:e.measure.map,cache:e.measure.cache};for(var n=0;n<e.rest.length;n++)if(e.rest[n]==t)return{map:e.measure.maps[n],cache:e.measure.caches[n]};for(var n=0;n<e.rest.length;n++)if(ts(e.rest[n])>i)return{map:e.measure.maps[n],cache:e.measure.caches[n],before:!0}}function Kt(e,t){t=_r(t);var i=ts(t),n=e.display.externalMeasured=new Ri(e.doc,t,i);n.lineN=i;var r=n.built=Fr(e,n);return n.text=r.pre,qs(e.display.lineMeasure,r.pre),n}function Jt(e,t,i,n){return ti(e,ei(e,t),i,n)}function Zt(e,t){if(t>=e.display.viewFrom&&t<e.display.viewTo)return e.display.view[Fi(e,t)];var i=e.display.externalMeasured;return i&&t>=i.lineN&&t<i.lineN+i.size?i:void 0}function ei(e,t){var i=ts(t),n=Zt(e,i);n&&!n.text?n=null:n&&n.changes&&(I(e,n,i,R(e)),e.curOp.forceUpdate=!0),n||(n=Kt(e,t));var r=Yt(n,t,i);return{line:t,view:n,rect:null,map:r.map,cache:r.cache,before:r.before,hasHeights:!1}}function ti(e,t,i,n,r){t.before&&(i=-1);var s,o=i+(n||"");return t.cache.hasOwnProperty(o)?s=t.cache[o]:(t.rect||(t.rect=t.view.text.getBoundingClientRect()),t.hasHeights||(Gt(e,t.view,t.rect),t.hasHeights=!0),s=ni(e,t,i,n),s.bogus||(t.cache[o]=s)),{left:s.left,right:s.right,top:r?s.rtop:s.top,bottom:r?s.rbottom:s.bottom}}function ii(e,t,i){for(var n,r,s,o,a=0;a<e.length;a+=3){var l=e[a],c=e[a+1];if(l>t?(r=0,s=1,o="left"):c>t?(r=t-l,s=r+1):(a==e.length-3||t==c&&e[a+3]>t)&&(s=c-l,r=s-1,t>=c&&(o="right")),null!=r){if(n=e[a+2],l==c&&i==(n.insertLeft?"left":"right")&&(o=i),"left"==i&&0==r)for(;a&&e[a-2]==e[a-3]&&e[a-1].insertLeft;)n=e[(a-=3)+2],o="left";if("right"==i&&r==c-l)for(;a<e.length-3&&e[a+3]==e[a+4]&&!e[a+5].insertLeft;)n=e[(a+=3)+2],o="right";break}}return{node:n,start:r,end:s,collapse:o,coverStart:l,coverEnd:c}}function ni(e,t,i,n){var r,s=ii(t.map,i,n),o=s.node,a=s.start,l=s.end,c=s.collapse;if(3==o.nodeType){for(var d=0;4>d;d++){for(;a&&Hs(t.line.text.charAt(s.coverStart+a));)--a;for(;s.coverStart+l<s.coverEnd&&Hs(t.line.text.charAt(s.coverStart+l));)++l;if(yo&&9>bo&&0==a&&l==s.coverEnd-s.coverStart)r=o.parentNode.getBoundingClientRect();else if(yo&&e.options.lineWrapping){var u=qa(o,a,l).getClientRects();
r=u.length?u["right"==n?u.length-1:0]:qo}else r=qa(o,a,l).getBoundingClientRect()||qo;if(r.left||r.right||0==a)break;l=a,a-=1,c="right"}yo&&11>bo&&(r=ri(e.display.measure,r))}else{a>0&&(c=n="right");var u;r=e.options.lineWrapping&&(u=o.getClientRects()).length>1?u["right"==n?u.length-1:0]:o.getBoundingClientRect()}if(yo&&9>bo&&!a&&(!r||!r.left&&!r.right)){var h=o.parentNode.getClientRects()[0];r=h?{left:h.left,right:h.left+yi(e.display),top:h.top,bottom:h.bottom}:qo}for(var p=r.top-t.rect.top,f=r.bottom-t.rect.top,m=(p+f)/2,g=t.view.measure.heights,d=0;d<g.length-1&&!(m<g[d]);d++);var v=d?g[d-1]:0,_=g[d],y={left:("right"==c?r.right:r.left)-t.rect.left,right:("left"==c?r.left:r.right)-t.rect.left,top:v,bottom:_};return r.left||r.right||(y.bogus=!0),e.options.singleCursorHeightPerLine||(y.rtop=p,y.rbottom=f),y}function ri(e,t){if(!window.screen||null==screen.logicalXDPI||screen.logicalXDPI==screen.deviceXDPI||!Zs(e))return t;var i=screen.logicalXDPI/screen.deviceXDPI,n=screen.logicalYDPI/screen.deviceYDPI;return{left:t.left*i,right:t.right*i,top:t.top*n,bottom:t.bottom*n}}function si(e){if(e.measure&&(e.measure.cache={},e.measure.heights=null,e.rest))for(var t=0;t<e.rest.length;t++)e.measure.caches[t]={}}function oi(e){e.display.externalMeasure=null,Ws(e.display.lineMeasure);for(var t=0;t<e.display.view.length;t++)si(e.display.view[t])}function ai(e){oi(e),e.display.cachedCharWidth=e.display.cachedTextHeight=e.display.cachedPaddingH=null,e.options.lineWrapping||(e.display.maxLineChanged=!0),e.display.lineNumChars=null}function li(){return window.pageXOffset||(document.documentElement||document.body).scrollLeft}function ci(){return window.pageYOffset||(document.documentElement||document.body).scrollTop}function di(e,t,i,n){if(t.widgets)for(var r=0;r<t.widgets.length;++r)if(t.widgets[r].above){var s=Ar(t.widgets[r]);i.top+=s,i.bottom+=s}if("line"==n)return i;n||(n="local");var o=ns(t);if("local"==n?o+=Wt(e.display):o-=e.display.viewOffset,"page"==n||"window"==n){var a=e.display.lineSpace.getBoundingClientRect();o+=a.top+("window"==n?0:ci());var l=a.left+("window"==n?0:li());i.left+=l,i.right+=l}return i.top+=o,i.bottom+=o,i}function ui(e,t,i){if("div"==i)return t;var n=t.left,r=t.top;if("page"==i)n-=li(),r-=ci();else if("local"==i||!i){var s=e.display.sizer.getBoundingClientRect();n+=s.left,r+=s.top}var o=e.display.lineSpace.getBoundingClientRect();return{left:n-o.left,top:r-o.top}}function hi(e,t,i,n,r){return n||(n=Kr(e.doc,t.line)),di(e,n,Jt(e,n,t.ch,r),i)}function pi(e,t,i,n,r,s){function o(t,o){var a=ti(e,r,t,o?"right":"left",s);return o?a.left=a.right:a.right=a.left,di(e,n,a,i)}function a(e,t){var i=l[t],n=i.level%2;return e==to(i)&&t&&i.level<l[t-1].level?(i=l[--t],e=io(i)-(i.level%2?0:1),n=!0):e==io(i)&&t<l.length-1&&i.level<l[t+1].level&&(i=l[++t],e=to(i)-i.level%2,n=!1),n&&e==i.to&&e>i.from?o(e-1):o(e,n)}n=n||Kr(e.doc,t.line),r||(r=ei(e,n));var l=rs(n),c=t.ch;if(!l)return o(c);var d=co(l,c),u=a(c,d);return null!=ol&&(u.other=a(c,ol)),u}function fi(e,t){var i=0,t=mt(e.doc,t);e.options.lineWrapping||(i=yi(e.display)*t.ch);var n=Kr(e.doc,t.line),r=ns(n)+Wt(e.display);return{left:i,right:i,top:r,bottom:r+n.height}}function mi(e,t,i,n){var r=Fo(e,t);return r.xRel=n,i&&(r.outside=!0),r}function gi(e,t,i){var n=e.doc;if(i+=e.display.viewOffset,0>i)return mi(n.first,0,!0,-1);var r=is(n,i),s=n.first+n.size-1;if(r>s)return mi(n.first+n.size-1,Kr(n,s).text.length,!0,1);0>t&&(t=0);for(var o=Kr(n,r);;){var a=vi(e,o,r,t,i),l=gr(o),c=l&&l.find(0,!0);if(!l||!(a.ch>c.from.ch||a.ch==c.from.ch&&a.xRel>0))return a;r=ts(o=c.to.line)}}function vi(e,t,i,n,r){function s(n){var r=pi(e,Fo(i,n),"line",t,c);return a=!0,o>r.bottom?r.left-l:o<r.top?r.left+l:(a=!1,r.left)}var o=r-ns(t),a=!1,l=2*e.display.wrapper.clientWidth,c=ei(e,t),d=rs(t),u=t.text.length,h=no(t),p=ro(t),f=s(h),m=a,g=s(p),v=a;if(n>g)return mi(i,p,v,1);for(;;){if(d?p==h||p==ho(t,h,1):1>=p-h){var _=f>n||g-n>=n-f?h:p,y=_==h?m:v,b=n-(_==h?f:g);if(v&&!d&&!/\s/.test(t.text.charAt(_))&&b>0&&_<t.text.length&&c.view.measure.heights.length>1){var w=ti(e,c,_,"right");o<=w.bottom&&o>=w.top&&Math.abs(n-w.right)<b&&(y=!1,_++,b=n-w.right)}for(;Hs(t.text.charAt(_));)++_;var k=mi(i,_,y,-1>b?-1:b>1?1:0);return k}var C=Math.ceil(u/2),x=h+C;if(d){x=h;for(var A=0;C>A;++A)x=ho(t,x,1)}var T=s(x);T>n?(p=x,g=T,(v=a)&&(g+=1e3),u=C):(h=x,f=T,m=a,u-=C)}}function _i(e){if(null!=e.cachedTextHeight)return e.cachedTextHeight;if(null==Ho){Ho=Bs("pre");for(var t=0;49>t;++t)Ho.appendChild(document.createTextNode("x")),Ho.appendChild(Bs("br"));Ho.appendChild(document.createTextNode("x"))}qs(e.measure,Ho);var i=Ho.offsetHeight/50;return i>3&&(e.cachedTextHeight=i),Ws(e.measure),i||1}function yi(e){if(null!=e.cachedCharWidth)return e.cachedCharWidth;var t=Bs("span","xxxxxxxxxx"),i=Bs("pre",[t]);qs(e.measure,i);var n=t.getBoundingClientRect(),r=(n.right-n.left)/10;return r>2&&(e.cachedCharWidth=r),r||10}function bi(e){e.curOp={cm:e,viewChanged:!1,startHeight:e.doc.height,forceUpdate:!1,updateInput:null,typing:!1,changeObjs:null,cursorActivityHandlers:null,cursorActivityCalled:0,selectionChanged:!1,updateMaxLine:!1,scrollLeft:null,scrollTop:null,scrollToPos:null,focus:!1,id:++Uo},Qo?Qo.ops.push(e.curOp):e.curOp.ownsGroup=Qo={ops:[e.curOp],delayedCallbacks:[]}}function wi(e){var t=e.delayedCallbacks,i=0;do{for(;i<t.length;i++)t[i].call(null);for(var n=0;n<e.ops.length;n++){var r=e.ops[n];if(r.cursorActivityHandlers)for(;r.cursorActivityCalled<r.cursorActivityHandlers.length;)r.cursorActivityHandlers[r.cursorActivityCalled++].call(null,r.cm)}}while(i<t.length)}function ki(e){var t=e.curOp,i=t.ownsGroup;if(i)try{wi(i)}finally{Qo=null;for(var n=0;n<i.ops.length;n++)i.ops[n].cm.curOp=null;Ci(i)}}function Ci(e){for(var t=e.ops,i=0;i<t.length;i++)xi(t[i]);for(var i=0;i<t.length;i++)Ai(t[i]);for(var i=0;i<t.length;i++)Ti(t[i]);for(var i=0;i<t.length;i++)Si(t[i]);for(var i=0;i<t.length;i++)Mi(t[i])}function xi(e){var t=e.cm,i=t.display;T(t),e.updateMaxLine&&h(t),e.mustUpdate=e.viewChanged||e.forceUpdate||null!=e.scrollTop||e.scrollToPos&&(e.scrollToPos.from.line<i.viewFrom||e.scrollToPos.to.line>=i.viewTo)||i.maxLineChanged&&t.options.lineWrapping,e.update=e.mustUpdate&&new A(t,e.mustUpdate&&{top:e.scrollTop,ensure:e.scrollToPos},e.forceUpdate)}function Ai(e){e.updatedDisplay=e.mustUpdate&&S(e.cm,e.update)}function Ti(e){var t=e.cm,i=t.display;e.updatedDisplay&&D(t),e.barMeasure=f(t),i.maxLineChanged&&!t.options.lineWrapping&&(e.adjustWidthTo=Jt(t,i.maxLine,i.maxLine.text.length).left+3,t.display.sizerWidth=e.adjustWidthTo,e.barMeasure.scrollWidth=Math.max(i.scroller.clientWidth,i.sizer.offsetLeft+e.adjustWidthTo+Ut(t)+t.display.barWidth),e.maxScrollLeft=Math.max(0,i.sizer.offsetLeft+e.adjustWidthTo-Xt(t))),(e.updatedDisplay||e.selectionChanged)&&(e.preparedSelection=i.input.prepareSelection(e.focus))}function Si(e){var t=e.cm;null!=e.adjustWidthTo&&(t.display.sizer.style.minWidth=e.adjustWidthTo+"px",e.maxScrollLeft<t.doc.scrollLeft&&sn(t,Math.min(t.display.scroller.scrollLeft,e.maxScrollLeft),!0),t.display.maxLineChanged=!1);var i=e.focus&&e.focus==Qs()&&(!document.hasFocus||document.hasFocus());e.preparedSelection&&t.display.input.showSelection(e.preparedSelection,i),(e.updatedDisplay||e.startHeight!=t.doc.height)&&_(t,e.barMeasure),e.updatedDisplay&&E(t,e.barMeasure),e.selectionChanged&&Ft(t),t.state.focused&&e.updateInput&&t.display.input.reset(e.typing),i&&Y(e.cm)}function Mi(e){var t=e.cm,i=t.display,n=t.doc;if(e.updatedDisplay&&M(t,e.update),null==i.wheelStartX||null==e.scrollTop&&null==e.scrollLeft&&!e.scrollToPos||(i.wheelStartX=i.wheelStartY=null),null==e.scrollTop||i.scroller.scrollTop==e.scrollTop&&!e.forceScroll||(n.scrollTop=Math.max(0,Math.min(i.scroller.scrollHeight-i.scroller.clientHeight,e.scrollTop)),i.scrollbars.setScrollTop(n.scrollTop),i.scroller.scrollTop=n.scrollTop),null==e.scrollLeft||i.scroller.scrollLeft==e.scrollLeft&&!e.forceScroll||(n.scrollLeft=Math.max(0,Math.min(i.scroller.scrollWidth-i.scroller.clientWidth,e.scrollLeft)),i.scrollbars.setScrollLeft(n.scrollLeft),i.scroller.scrollLeft=n.scrollLeft,w(t)),e.scrollToPos){var r=Ln(t,mt(n,e.scrollToPos.from),mt(n,e.scrollToPos.to),e.scrollToPos.margin);e.scrollToPos.isCursor&&t.state.focused&&Rn(t,r)}var s=e.maybeHiddenMarkers,o=e.maybeUnhiddenMarkers;if(s)for(var a=0;a<s.length;++a)s[a].lines.length||Ra(s[a],"hide");if(o)for(var a=0;a<o.length;++a)o[a].lines.length&&Ra(o[a],"unhide");i.wrapper.offsetHeight&&(n.scrollTop=t.display.scroller.scrollTop),e.changeObjs&&Ra(t,"changes",t,e.changeObjs),e.update&&e.update.finish()}function Ni(e,t){if(e.curOp)return t();bi(e);try{return t()}finally{ki(e)}}function Ei(e,t){return function(){if(e.curOp)return t.apply(e,arguments);bi(e);try{return t.apply(e,arguments)}finally{ki(e)}}}function Di(e){return function(){if(this.curOp)return e.apply(this,arguments);bi(this);try{return e.apply(this,arguments)}finally{ki(this)}}}function Oi(e){return function(){var t=this.cm;if(!t||t.curOp)return e.apply(this,arguments);bi(t);try{return e.apply(this,arguments)}finally{ki(t)}}}function Ri(e,t,i){this.line=t,this.rest=yr(t),this.size=this.rest?ts(Os(this.rest))-i+1:1,this.node=this.text=null,this.hidden=kr(e,t)}function Li(e,t,i){for(var n,r=[],s=t;i>s;s=n){var o=new Ri(e.doc,Kr(e.doc,s),s);n=s+o.size,r.push(o)}return r}function Ii(e,t,i,n){null==t&&(t=e.doc.first),null==i&&(i=e.doc.first+e.doc.size),n||(n=0);var r=e.display;if(n&&i<r.viewTo&&(null==r.updateLineNumbers||r.updateLineNumbers>t)&&(r.updateLineNumbers=t),e.curOp.viewChanged=!0,t>=r.viewTo)Po&&br(e.doc,t)<r.viewTo&&Pi(e);else if(i<=r.viewFrom)Po&&wr(e.doc,i+n)>r.viewFrom?Pi(e):(r.viewFrom+=n,r.viewTo+=n);else if(t<=r.viewFrom&&i>=r.viewTo)Pi(e);else if(t<=r.viewFrom){var s=zi(e,i,i+n,1);s?(r.view=r.view.slice(s.index),r.viewFrom=s.lineN,r.viewTo+=n):Pi(e)}else if(i>=r.viewTo){var s=zi(e,t,t,-1);s?(r.view=r.view.slice(0,s.index),r.viewTo=s.lineN):Pi(e)}else{var o=zi(e,t,t,-1),a=zi(e,i,i+n,1);o&&a?(r.view=r.view.slice(0,o.index).concat(Li(e,o.lineN,a.lineN)).concat(r.view.slice(a.index)),r.viewTo+=n):Pi(e)}var l=r.externalMeasured;l&&(i<l.lineN?l.lineN+=n:t<l.lineN+l.size&&(r.externalMeasured=null))}function ji(e,t,i){e.curOp.viewChanged=!0;var n=e.display,r=e.display.externalMeasured;if(r&&t>=r.lineN&&t<r.lineN+r.size&&(n.externalMeasured=null),!(t<n.viewFrom||t>=n.viewTo)){var s=n.view[Fi(e,t)];if(null!=s.node){var o=s.changes||(s.changes=[]);-1==Rs(o,i)&&o.push(i)}}}function Pi(e){e.display.viewFrom=e.display.viewTo=e.doc.first,e.display.view=[],e.display.viewOffset=0}function Fi(e,t){if(t>=e.display.viewTo)return null;if(t-=e.display.viewFrom,0>t)return null;for(var i=e.display.view,n=0;n<i.length;n++)if(t-=i[n].size,0>t)return n}function zi(e,t,i,n){var r,s=Fi(e,t),o=e.display.view;if(!Po||i==e.doc.first+e.doc.size)return{index:s,lineN:i};for(var a=0,l=e.display.viewFrom;s>a;a++)l+=o[a].size;if(l!=t){if(n>0){if(s==o.length-1)return null;r=l+o[s].size-t,s++}else r=l-t;t+=r,i+=r}for(;br(e.doc,i)!=i;){if(s==(0>n?0:o.length-1))return null;i+=n*o[s-(0>n?1:0)].size,s+=n}return{index:s,lineN:i}}function $i(e,t,i){var n=e.display,r=n.view;0==r.length||t>=n.viewTo||i<=n.viewFrom?(n.view=Li(e,t,i),n.viewFrom=t):(n.viewFrom>t?n.view=Li(e,t,n.viewFrom).concat(n.view):n.viewFrom<t&&(n.view=n.view.slice(Fi(e,t))),n.viewFrom=t,n.viewTo<i?n.view=n.view.concat(Li(e,n.viewTo,i)):n.viewTo>i&&(n.view=n.view.slice(0,Fi(e,i)))),n.viewTo=i}function Hi(e){for(var t=e.display.view,i=0,n=0;n<t.length;n++){var r=t[n];r.hidden||r.node&&!r.changes||++i}return i}function Bi(e){function t(){r.activeTouch&&(s=setTimeout(function(){r.activeTouch=null},1e3),o=r.activeTouch,o.end=+new Date)}function i(e){if(1!=e.touches.length)return!1;var t=e.touches[0];return t.radiusX<=1&&t.radiusY<=1}function n(e,t){if(null==t.left)return!0;var i=t.left-e.left,n=t.top-e.top;return i*i+n*n>400}var r=e.display;Ea(r.scroller,"mousedown",Ei(e,Xi)),yo&&11>bo?Ea(r.scroller,"dblclick",Ei(e,function(t){if(!Ts(e,t)){var i=Ui(e,t);if(i&&!Ji(e,t)&&!Qi(e.display,t)){Sa(t);var n=e.findWordAt(i);bt(e.doc,n.anchor,n.head)}}})):Ea(r.scroller,"dblclick",function(t){Ts(e,t)||Sa(t)}),Io||Ea(r.scroller,"contextmenu",function(t){yn(e,t)});var s,o={end:0};Ea(r.scroller,"touchstart",function(t){if(!Ts(e,t)&&!i(t)){clearTimeout(s);var n=+new Date;r.activeTouch={start:n,moved:!1,prev:n-o.end<=300?o:null},1==t.touches.length&&(r.activeTouch.left=t.touches[0].pageX,r.activeTouch.top=t.touches[0].pageY)}}),Ea(r.scroller,"touchmove",function(){r.activeTouch&&(r.activeTouch.moved=!0)}),Ea(r.scroller,"touchend",function(i){var s=r.activeTouch;if(s&&!Qi(r,i)&&null!=s.left&&!s.moved&&new Date-s.start<300){var o,a=e.coordsChar(r.activeTouch,"page");o=!s.prev||n(s,s.prev)?new ut(a,a):!s.prev.prev||n(s,s.prev.prev)?e.findWordAt(a):new ut(Fo(a.line,0),mt(e.doc,Fo(a.line+1,0))),e.setSelection(o.anchor,o.head),e.focus(),Sa(i)}t()}),Ea(r.scroller,"touchcancel",t),Ea(r.scroller,"scroll",function(){r.scroller.clientHeight&&(rn(e,r.scroller.scrollTop),sn(e,r.scroller.scrollLeft,!0),Ra(e,"scroll",e))}),Ea(r.scroller,"mousewheel",function(t){on(e,t)}),Ea(r.scroller,"DOMMouseScroll",function(t){on(e,t)}),Ea(r.wrapper,"scroll",function(){r.wrapper.scrollTop=r.wrapper.scrollLeft=0}),r.dragFunctions={enter:function(t){Ts(e,t)||Na(t)},over:function(t){Ts(e,t)||(tn(e,t),Na(t))},start:function(t){en(e,t)},drop:Ei(e,Zi),leave:function(t){Ts(e,t)||nn(e)}};var a=r.input.getField();Ea(a,"keyup",function(t){fn.call(e,t)}),Ea(a,"keydown",Ei(e,hn)),Ea(a,"keypress",Ei(e,mn)),Ea(a,"focus",Fs(vn,e)),Ea(a,"blur",Fs(_n,e))}function Wi(t,i,n){var r=n&&n!=e.Init;if(!i!=!r){var s=t.display.dragFunctions,o=i?Ea:Oa;o(t.display.scroller,"dragstart",s.start),o(t.display.scroller,"dragenter",s.enter),o(t.display.scroller,"dragover",s.over),o(t.display.scroller,"dragleave",s.leave),o(t.display.scroller,"drop",s.drop)}}function qi(e){var t=e.display;(t.lastWrapHeight!=t.wrapper.clientHeight||t.lastWrapWidth!=t.wrapper.clientWidth)&&(t.cachedCharWidth=t.cachedTextHeight=t.cachedPaddingH=null,t.scrollbarsClipped=!1,e.setSize())}function Qi(e,t){for(var i=ws(t);i!=e.wrapper;i=i.parentNode)if(!i||1==i.nodeType&&"true"==i.getAttribute("cm-ignore-events")||i.parentNode==e.sizer&&i!=e.mover)return!0}function Ui(e,t,i,n){var r=e.display;if(!i&&"true"==ws(t).getAttribute("cm-not-content"))return null;var s,o,a=r.lineSpace.getBoundingClientRect();try{s=t.clientX-a.left,o=t.clientY-a.top}catch(t){return null}var l,c=gi(e,s,o);if(n&&1==c.xRel&&(l=Kr(e.doc,c.line).text).length==c.ch){var d=$a(l,l.length,e.options.tabSize)-l.length;c=Fo(c.line,Math.max(0,Math.round((s-Qt(e.display).left)/yi(e.display))-d))}return c}function Xi(e){var t=this,i=t.display;if(!(Ts(t,e)||i.activeTouch&&i.input.supportsTouch())){if(i.shift=e.shiftKey,Qi(i,e))return wo||(i.scroller.draggable=!1,setTimeout(function(){i.scroller.draggable=!0},100)),void 0;if(!Ji(t,e)){var n=Ui(t,e);switch(window.focus(),ks(e)){case 1:t.state.selectingText?t.state.selectingText(e):n?Vi(t,e,n):ws(e)==i.scroller&&Sa(e);break;case 2:wo&&(t.state.lastMiddleDown=+new Date),n&&bt(t.doc,n),setTimeout(function(){i.input.focus()},20),Sa(e);break;case 3:Io?yn(t,e):gn(t)}}}}function Vi(e,t,i){yo?setTimeout(Fs(Y,e),0):e.curOp.focus=Qs();var n,r=+new Date;Wo&&Wo.time>r-400&&0==zo(Wo.pos,i)?n="triple":Bo&&Bo.time>r-400&&0==zo(Bo.pos,i)?(n="double",Wo={time:r,pos:i}):(n="single",Bo={time:r,pos:i});var s,o=e.doc.sel,a=Eo?t.metaKey:t.ctrlKey;e.options.dragDrop&&el&&!e.isReadOnly()&&"single"==n&&(s=o.contains(i))>-1&&(zo((s=o.ranges[s]).from(),i)<0||i.xRel>0)&&(zo(s.to(),i)>0||i.xRel<0)?Gi(e,t,i,a):Yi(e,t,i,n,a)}function Gi(e,t,i,n){var r=e.display,s=+new Date,o=Ei(e,function(a){wo&&(r.scroller.draggable=!1),e.state.draggingText=!1,Oa(document,"mouseup",o),Oa(r.scroller,"drop",o),Math.abs(t.clientX-a.clientX)+Math.abs(t.clientY-a.clientY)<10&&(Sa(a),!n&&+new Date-200<s&&bt(e.doc,i),wo||yo&&9==bo?setTimeout(function(){document.body.focus(),r.input.focus()},20):r.input.focus())});wo&&(r.scroller.draggable=!0),e.state.draggingText=o,o.copy=Eo?t.altKey:t.ctrlKey,r.scroller.dragDrop&&r.scroller.dragDrop(),Ea(document,"mouseup",o),Ea(r.scroller,"drop",o)}function Yi(e,t,i,n,r){function s(t){if(0!=zo(g,t))if(g=t,"rect"==n){for(var r=[],s=e.options.tabSize,o=$a(Kr(c,i.line).text,i.ch,s),a=$a(Kr(c,t.line).text,t.ch,s),l=Math.min(o,a),p=Math.max(o,a),f=Math.min(i.line,t.line),m=Math.min(e.lastLine(),Math.max(i.line,t.line));m>=f;f++){var v=Kr(c,f).text,_=Ha(v,l,s);l==p?r.push(new ut(Fo(f,_),Fo(f,_))):v.length>_&&r.push(new ut(Fo(f,_),Fo(f,Ha(v,p,s))))}r.length||r.push(new ut(i,i)),Tt(c,ht(h.ranges.slice(0,u).concat(r),u),{origin:"*mouse",scroll:!1}),e.scrollIntoView(t)}else{var y=d,b=y.anchor,w=t;if("single"!=n){if("double"==n)var k=e.findWordAt(t);else var k=new ut(Fo(t.line,0),mt(c,Fo(t.line+1,0)));zo(k.anchor,b)>0?(w=k.head,b=G(y.from(),k.anchor)):(w=k.anchor,b=V(y.to(),k.head))}var r=h.ranges.slice(0);r[u]=new ut(mt(c,b),w),Tt(c,ht(r,u),Fa)}}function o(t){var i=++_,r=Ui(e,t,!0,"rect"==n);if(r)if(0!=zo(r,g)){e.curOp.focus=Qs(),s(r);var a=b(l,c);(r.line>=a.to||r.line<a.from)&&setTimeout(Ei(e,function(){_==i&&o(t)}),150)}else{var d=t.clientY<v.top?-20:t.clientY>v.bottom?20:0;d&&setTimeout(Ei(e,function(){_==i&&(l.scroller.scrollTop+=d,o(t))}),50)}}function a(t){e.state.selectingText=!1,_=1/0,Sa(t),l.input.focus(),Oa(document,"mousemove",y),Oa(document,"mouseup",w),c.history.lastSelOrigin=null}var l=e.display,c=e.doc;Sa(t);var d,u,h=c.sel,p=h.ranges;if(r&&!t.shiftKey?(u=c.sel.contains(i),d=u>-1?p[u]:new ut(i,i)):(d=c.sel.primary(),u=c.sel.primIndex),Do?t.shiftKey&&t.metaKey:t.altKey)n="rect",r||(d=new ut(i,i)),i=Ui(e,t,!0,!0),u=-1;else if("double"==n){var f=e.findWordAt(i);d=e.display.shift||c.extend?yt(c,d,f.anchor,f.head):f}else if("triple"==n){var m=new ut(Fo(i.line,0),mt(c,Fo(i.line+1,0)));d=e.display.shift||c.extend?yt(c,d,m.anchor,m.head):m}else d=yt(c,d,i);r?-1==u?(u=p.length,Tt(c,ht(p.concat([d]),u),{scroll:!1,origin:"*mouse"})):p.length>1&&p[u].empty()&&"single"==n&&!t.shiftKey?(Tt(c,ht(p.slice(0,u).concat(p.slice(u+1)),0),{scroll:!1,origin:"*mouse"}),h=c.sel):kt(c,u,d,Fa):(u=0,Tt(c,new dt([d],0),Fa),h=c.sel);var g=i,v=l.wrapper.getBoundingClientRect(),_=0,y=Ei(e,function(e){ks(e)?o(e):a(e)}),w=Ei(e,a);e.state.selectingText=w,Ea(document,"mousemove",y),Ea(document,"mouseup",w)}function Ki(e,t,i,n){try{var r=t.clientX,s=t.clientY}catch(t){return!1}if(r>=Math.floor(e.display.gutters.getBoundingClientRect().right))return!1;n&&Sa(t);var o=e.display,a=o.lineDiv.getBoundingClientRect();if(s>a.bottom||!Ms(e,i))return bs(t);s-=a.top-o.viewOffset;for(var l=0;l<e.options.gutters.length;++l){var c=o.gutters.childNodes[l];if(c&&c.getBoundingClientRect().right>=r){var d=is(e.doc,s),u=e.options.gutters[l];return Ra(e,i,e,d,u,t),bs(t)}}}function Ji(e,t){return Ki(e,t,"gutterClick",!0)}function Zi(e){var t=this;if(nn(t),!Ts(t,e)&&!Qi(t.display,e)){Sa(e),yo&&(Xo=+new Date);var i=Ui(t,e,!0),n=e.dataTransfer.files;if(i&&!t.isReadOnly())if(n&&n.length&&window.FileReader&&window.File)for(var r=n.length,s=Array(r),o=0,a=function(e,n){if(!t.options.allowDropFileTypes||-1!=Rs(t.options.allowDropFileTypes,e.type)){var a=new FileReader;a.onload=Ei(t,function(){var e=a.result;if(/[\x00-\x08\x0e-\x1f]{2}/.test(e)&&(e=""),s[n]=e,++o==r){i=mt(t.doc,i);var l={from:i,to:i,text:t.doc.splitLines(s.join(t.doc.lineSeparator())),origin:"paste"};Tn(t.doc,l),At(t.doc,pt(i,Zo(l)))}}),a.readAsText(e)}},l=0;r>l;++l)a(n[l],l);else{if(t.state.draggingText&&t.doc.sel.contains(i)>-1)return t.state.draggingText(e),setTimeout(function(){t.display.input.focus()},20),void 0;try{var s=e.dataTransfer.getData("Text");if(s){if(t.state.draggingText&&!t.state.draggingText.copy)var c=t.listSelections();if(St(t.doc,pt(i,i)),c)for(var l=0;l<c.length;++l)On(t.doc,"",c[l].anchor,c[l].head,"drag");t.replaceSelection(s,"around","paste"),t.display.input.focus()}}catch(e){}}}}function en(e,t){if(yo&&(!e.state.draggingText||+new Date-Xo<100))return Na(t),void 0;if(!Ts(e,t)&&!Qi(e.display,t)&&(t.dataTransfer.setData("Text",e.getSelection()),t.dataTransfer.effectAllowed="copyMove",t.dataTransfer.setDragImage&&!Ao)){var i=Bs("img",null,null,"position: fixed; left: 0; top: 0;");i.src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==",xo&&(i.width=i.height=1,e.display.wrapper.appendChild(i),i._top=i.offsetTop),t.dataTransfer.setDragImage(i,0,0),xo&&i.parentNode.removeChild(i)}}function tn(e,t){var i=Ui(e,t);if(i){var n=document.createDocumentFragment();jt(e,i,n),e.display.dragCursor||(e.display.dragCursor=Bs("div",null,"CodeMirror-cursors CodeMirror-dragcursors"),e.display.lineSpace.insertBefore(e.display.dragCursor,e.display.cursorDiv)),qs(e.display.dragCursor,n)}}function nn(e){e.display.dragCursor&&(e.display.lineSpace.removeChild(e.display.dragCursor),e.display.dragCursor=null)}function rn(e,t){Math.abs(e.doc.scrollTop-t)<2||(e.doc.scrollTop=t,go||N(e,{top:t}),e.display.scroller.scrollTop!=t&&(e.display.scroller.scrollTop=t),e.display.scrollbars.setScrollTop(t),go&&N(e),zt(e,100))}function sn(e,t,i){(i?t==e.doc.scrollLeft:Math.abs(e.doc.scrollLeft-t)<2)||(t=Math.min(t,e.display.scroller.scrollWidth-e.display.scroller.clientWidth),e.doc.scrollLeft=t,w(e),e.display.scroller.scrollLeft!=t&&(e.display.scroller.scrollLeft=t),e.display.scrollbars.setScrollLeft(t))}function on(e,t){var i=Yo(t),n=i.x,r=i.y,s=e.display,o=s.scroller,a=o.scrollWidth>o.clientWidth,l=o.scrollHeight>o.clientHeight;if(n&&a||r&&l){if(r&&Eo&&wo)e:for(var c=t.target,d=s.view;c!=o;c=c.parentNode)for(var u=0;u<d.length;u++)if(d[u].node==c){e.display.currentWheelTarget=c;break e}if(n&&!go&&!xo&&null!=Go)return r&&l&&rn(e,Math.max(0,Math.min(o.scrollTop+r*Go,o.scrollHeight-o.clientHeight))),sn(e,Math.max(0,Math.min(o.scrollLeft+n*Go,o.scrollWidth-o.clientWidth))),(!r||r&&l)&&Sa(t),s.wheelStartX=null,void 0;if(r&&null!=Go){var h=r*Go,p=e.doc.scrollTop,f=p+s.wrapper.clientHeight;0>h?p=Math.max(0,p+h-50):f=Math.min(e.doc.height,f+h+50),N(e,{top:p,bottom:f})}20>Vo&&(null==s.wheelStartX?(s.wheelStartX=o.scrollLeft,s.wheelStartY=o.scrollTop,s.wheelDX=n,s.wheelDY=r,setTimeout(function(){if(null!=s.wheelStartX){var e=o.scrollLeft-s.wheelStartX,t=o.scrollTop-s.wheelStartY,i=t&&s.wheelDY&&t/s.wheelDY||e&&s.wheelDX&&e/s.wheelDX;s.wheelStartX=s.wheelStartY=null,i&&(Go=(Go*Vo+i)/(Vo+1),++Vo)}},200)):(s.wheelDX+=n,s.wheelDY+=r))}}function an(e,t,i){if("string"==typeof t&&(t=da[t],!t))return!1;e.display.input.ensurePolled();var n=e.display.shift,r=!1;try{e.isReadOnly()&&(e.state.suppressEdits=!0),i&&(e.display.shift=!1),r=t(e)!=ja}finally{e.display.shift=n,e.state.suppressEdits=!1}return r}function ln(e,t,i){for(var n=0;n<e.state.keyMaps.length;n++){var r=ha(t,e.state.keyMaps[n],i,e);if(r)return r}return e.options.extraKeys&&ha(t,e.options.extraKeys,i,e)||ha(t,e.options.keyMap,i,e)}function cn(e,t,i,n){var r=e.state.keySeq;if(r){if(pa(t))return"handled";Ko.set(50,function(){e.state.keySeq==r&&(e.state.keySeq=null,e.display.input.reset())}),t=r+" "+t}var s=ln(e,t,n);return"multi"==s&&(e.state.keySeq=t),"handled"==s&&xs(e,"keyHandled",e,t,i),("handled"==s||"multi"==s)&&(Sa(i),Ft(e)),r&&!s&&/\'$/.test(t)?(Sa(i),!0):!!s}function dn(e,t){var i=fa(t,!0);return i?t.shiftKey&&!e.state.keySeq?cn(e,"Shift-"+i,t,function(t){return an(e,t,!0)})||cn(e,i,t,function(t){return("string"==typeof t?/^go[A-Z]/.test(t):t.motion)?an(e,t):void 0}):cn(e,i,t,function(t){return an(e,t)}):!1}function un(e,t,i){return cn(e,"'"+i+"'",t,function(t){return an(e,t,!0)})}function hn(e){var t=this;if(t.curOp.focus=Qs(),!Ts(t,e)){yo&&11>bo&&27==e.keyCode&&(e.returnValue=!1);var i=e.keyCode;t.display.shift=16==i||e.shiftKey;var n=dn(t,e);xo&&(Jo=n?i:null,!n&&88==i&&!nl&&(Eo?e.metaKey:e.ctrlKey)&&t.replaceSelection("",null,"cut")),18!=i||/\bCodeMirror-crosshair\b/.test(t.display.lineDiv.className)||pn(t)}}function pn(e){function t(e){18!=e.keyCode&&e.altKey||(Ka(i,"CodeMirror-crosshair"),Oa(document,"keyup",t),Oa(document,"mouseover",t))}var i=e.display.lineDiv;Ja(i,"CodeMirror-crosshair"),Ea(document,"keyup",t),Ea(document,"mouseover",t)}function fn(e){16==e.keyCode&&(this.doc.sel.shift=!1),Ts(this,e)}function mn(e){var t=this;if(!(Qi(t.display,e)||Ts(t,e)||e.ctrlKey&&!e.altKey||Eo&&e.metaKey)){var i=e.keyCode,n=e.charCode;if(xo&&i==Jo)return Jo=null,Sa(e),void 0;if(!xo||e.which&&!(e.which<10)||!dn(t,e)){var r=String.fromCharCode(null==n?i:n);un(t,e,r)||t.display.input.onKeyPress(e)}}}function gn(e){e.state.delayingBlurEvent=!0,setTimeout(function(){e.state.delayingBlurEvent&&(e.state.delayingBlurEvent=!1,_n(e))},100)}function vn(e){e.state.delayingBlurEvent&&(e.state.delayingBlurEvent=!1),"nocursor"!=e.options.readOnly&&(e.state.focused||(Ra(e,"focus",e),e.state.focused=!0,Ja(e.display.wrapper,"CodeMirror-focused"),e.curOp||e.display.selForContextMenu==e.doc.sel||(e.display.input.reset(),wo&&setTimeout(function(){e.display.input.reset(!0)},20)),e.display.input.receivedFocus()),Ft(e))}function _n(e){e.state.delayingBlurEvent||(e.state.focused&&(Ra(e,"blur",e),e.state.focused=!1,Ka(e.display.wrapper,"CodeMirror-focused")),clearInterval(e.display.blinker),setTimeout(function(){e.state.focused||(e.display.shift=!1)},150))}function yn(e,t){Qi(e.display,t)||bn(e,t)||Ts(e,t,"contextmenu")||e.display.input.onContextMenu(t)}function bn(e,t){return Ms(e,"gutterContextMenu")?Ki(e,t,"gutterContextMenu",!1):!1}function wn(e,t){if(zo(e,t.from)<0)return e;if(zo(e,t.to)<=0)return Zo(t);var i=e.line+t.text.length-(t.to.line-t.from.line)-1,n=e.ch;return e.line==t.to.line&&(n+=Zo(t).ch-t.to.ch),Fo(i,n)}function kn(e,t){for(var i=[],n=0;n<e.sel.ranges.length;n++){var r=e.sel.ranges[n];i.push(new ut(wn(r.anchor,t),wn(r.head,t)))}return ht(i,e.sel.primIndex)}function Cn(e,t,i){return e.line==t.line?Fo(i.line,e.ch-t.ch+i.ch):Fo(i.line+(e.line-t.line),e.ch)}function xn(e,t,i){for(var n=[],r=Fo(e.first,0),s=r,o=0;o<t.length;o++){var a=t[o],l=Cn(a.from,r,s),c=Cn(Zo(a),r,s);if(r=a.to,s=c,"around"==i){var d=e.sel.ranges[o],u=zo(d.head,d.anchor)<0;n[o]=new ut(u?c:l,u?l:c)}else n[o]=new ut(l,l)}return new dt(n,e.sel.primIndex)}function An(e,t,i){var n={canceled:!1,from:t.from,to:t.to,text:t.text,origin:t.origin,cancel:function(){this.canceled=!0}};return i&&(n.update=function(t,i,n,r){t&&(this.from=mt(e,t)),i&&(this.to=mt(e,i)),n&&(this.text=n),void 0!==r&&(this.origin=r)}),Ra(e,"beforeChange",e,n),e.cm&&Ra(e.cm,"beforeChange",e.cm,n),n.canceled?null:{from:n.from,to:n.to,text:n.text,origin:n.origin}}function Tn(e,t,i){if(e.cm){if(!e.cm.curOp)return Ei(e.cm,Tn)(e,t,i);if(e.cm.state.suppressEdits)return}if(!(Ms(e,"beforeChange")||e.cm&&Ms(e.cm,"beforeChange"))||(t=An(e,t,!0))){var n=jo&&!i&&lr(e,t.from,t.to);if(n)for(var r=n.length-1;r>=0;--r)Sn(e,{from:n[r].from,to:n[r].to,text:r?[""]:t.text});else Sn(e,t)}}function Sn(e,t){if(1!=t.text.length||""!=t.text[0]||0!=zo(t.from,t.to)){var i=kn(e,t);cs(e,t,i,e.cm?e.cm.curOp.id:0/0),En(e,t,i,sr(e,t));var n=[];Gr(e,function(e,i){i||-1!=Rs(n,e.history)||(ys(e.history,t),n.push(e.history)),En(e,t,null,sr(e,t))})}}function Mn(e,t,i){if(!e.cm||!e.cm.state.suppressEdits){for(var n,r=e.history,s=e.sel,o="undo"==t?r.done:r.undone,a="undo"==t?r.undone:r.done,l=0;l<o.length&&(n=o[l],i?!n.ranges||n.equals(e.sel):n.ranges);l++);if(l!=o.length){for(r.lastOrigin=r.lastSelOrigin=null;n=o.pop(),n.ranges;){if(hs(n,a),i&&!n.equals(e.sel))return Tt(e,n,{clearRedo:!1}),void 0;s=n}var c=[];hs(s,a),a.push({changes:c,generation:r.generation}),r.generation=n.generation||++r.maxGeneration;for(var d=Ms(e,"beforeChange")||e.cm&&Ms(e.cm,"beforeChange"),l=n.changes.length-1;l>=0;--l){var u=n.changes[l];if(u.origin=t,d&&!An(e,u,!1))return o.length=0,void 0;c.push(os(e,u));var h=l?kn(e,u):Os(o);En(e,u,h,ar(e,u)),!l&&e.cm&&e.cm.scrollIntoView({from:u.from,to:Zo(u)});var p=[];Gr(e,function(e,t){t||-1!=Rs(p,e.history)||(ys(e.history,u),p.push(e.history)),En(e,u,null,ar(e,u))})}}}}function Nn(e,t){if(0!=t&&(e.first+=t,e.sel=new dt(Ls(e.sel.ranges,function(e){return new ut(Fo(e.anchor.line+t,e.anchor.ch),Fo(e.head.line+t,e.head.ch))}),e.sel.primIndex),e.cm)){Ii(e.cm,e.first,e.first-t,t);for(var i=e.cm.display,n=i.viewFrom;n<i.viewTo;n++)ji(e.cm,n,"gutter")}}function En(e,t,i,n){if(e.cm&&!e.cm.curOp)return Ei(e.cm,En)(e,t,i,n);if(t.to.line<e.first)return Nn(e,t.text.length-1-(t.to.line-t.from.line)),void 0;if(!(t.from.line>e.lastLine())){if(t.from.line<e.first){var r=t.text.length-1-(e.first-t.from.line);Nn(e,r),t={from:Fo(e.first,0),to:Fo(t.to.line+r,t.to.ch),text:[Os(t.text)],origin:t.origin}}var s=e.lastLine();t.to.line>s&&(t={from:t.from,to:Fo(s,Kr(e,s).text.length),text:[t.text[0]],origin:t.origin}),t.removed=Jr(e,t.from,t.to),i||(i=kn(e,t)),e.cm?Dn(e.cm,t,n):Ur(e,t,n),St(e,i,Pa)}}function Dn(e,t,i){var n=e.doc,r=e.display,o=t.from,a=t.to,l=!1,c=o.line;e.options.lineWrapping||(c=ts(_r(Kr(n,o.line))),n.iter(c,a.line+1,function(e){return e==r.maxLine?(l=!0,!0):void 0})),n.sel.contains(t.from,t.to)>-1&&Ss(e),Ur(n,t,i,s(e)),e.options.lineWrapping||(n.iter(c,o.line+t.text.length,function(e){var t=u(e);t>r.maxLineLength&&(r.maxLine=e,r.maxLineLength=t,r.maxLineChanged=!0,l=!1)}),l&&(e.curOp.updateMaxLine=!0)),n.frontier=Math.min(n.frontier,o.line),zt(e,400);var d=t.text.length-(a.line-o.line)-1;t.full?Ii(e):o.line!=a.line||1!=t.text.length||Qr(e.doc,t)?Ii(e,o.line,a.line+1,d):ji(e,o.line,"text");var h=Ms(e,"changes"),p=Ms(e,"change");if(p||h){var f={from:o,to:a,text:t.text,removed:t.removed,origin:t.origin};p&&xs(e,"change",e,f),h&&(e.curOp.changeObjs||(e.curOp.changeObjs=[])).push(f)}e.display.selForContextMenu=null}function On(e,t,i,n,r){if(n||(n=i),zo(n,i)<0){var s=n;n=i,i=s}"string"==typeof t&&(t=e.splitLines(t)),Tn(e,{from:i,to:n,text:t,origin:r})}function Rn(e,t){if(!Ts(e,"scrollCursorIntoView")){var i=e.display,n=i.sizer.getBoundingClientRect(),r=null;if(t.top+n.top<0?r=!0:t.bottom+n.top>(window.innerHeight||document.documentElement.clientHeight)&&(r=!1),null!=r&&!So){var s=Bs("div","​",null,"position: absolute; top: "+(t.top-i.viewOffset-Wt(e.display))+"px; height: "+(t.bottom-t.top+Ut(e)+i.barHeight)+"px; left: "+t.left+"px; width: 2px;");e.display.lineSpace.appendChild(s),s.scrollIntoView(r),e.display.lineSpace.removeChild(s)}}}function Ln(e,t,i,n){null==n&&(n=0);for(var r=0;5>r;r++){var s=!1,o=pi(e,t),a=i&&i!=t?pi(e,i):o,l=jn(e,Math.min(o.left,a.left),Math.min(o.top,a.top)-n,Math.max(o.left,a.left),Math.max(o.bottom,a.bottom)+n),c=e.doc.scrollTop,d=e.doc.scrollLeft;if(null!=l.scrollTop&&(rn(e,l.scrollTop),Math.abs(e.doc.scrollTop-c)>1&&(s=!0)),null!=l.scrollLeft&&(sn(e,l.scrollLeft),Math.abs(e.doc.scrollLeft-d)>1&&(s=!0)),!s)break}return o}function In(e,t,i,n,r){var s=jn(e,t,i,n,r);null!=s.scrollTop&&rn(e,s.scrollTop),null!=s.scrollLeft&&sn(e,s.scrollLeft)}function jn(e,t,i,n,r){var s=e.display,o=_i(e.display);0>i&&(i=0);var a=e.curOp&&null!=e.curOp.scrollTop?e.curOp.scrollTop:s.scroller.scrollTop,l=Vt(e),c={};r-i>l&&(r=i+l);var d=e.doc.height+qt(s),u=o>i,h=r>d-o;if(a>i)c.scrollTop=u?0:i;else if(r>a+l){var p=Math.min(i,(h?d:r)-l);p!=a&&(c.scrollTop=p)}var f=e.curOp&&null!=e.curOp.scrollLeft?e.curOp.scrollLeft:s.scroller.scrollLeft,m=Xt(e)-(e.options.fixedGutter?s.gutters.offsetWidth:0),g=n-t>m;return g&&(n=t+m),10>t?c.scrollLeft=0:f>t?c.scrollLeft=Math.max(0,t-(g?0:10)):n>m+f-3&&(c.scrollLeft=n+(g?0:10)-m),c}function Pn(e,t,i){(null!=t||null!=i)&&zn(e),null!=t&&(e.curOp.scrollLeft=(null==e.curOp.scrollLeft?e.doc.scrollLeft:e.curOp.scrollLeft)+t),null!=i&&(e.curOp.scrollTop=(null==e.curOp.scrollTop?e.doc.scrollTop:e.curOp.scrollTop)+i)}function Fn(e){zn(e);var t=e.getCursor(),i=t,n=t;e.options.lineWrapping||(i=t.ch?Fo(t.line,t.ch-1):t,n=Fo(t.line,t.ch+1)),e.curOp.scrollToPos={from:i,to:n,margin:e.options.cursorScrollMargin,isCursor:!0}}function zn(e){var t=e.curOp.scrollToPos;if(t){e.curOp.scrollToPos=null;var i=fi(e,t.from),n=fi(e,t.to),r=jn(e,Math.min(i.left,n.left),Math.min(i.top,n.top)-t.margin,Math.max(i.right,n.right),Math.max(i.bottom,n.bottom)+t.margin);e.scrollTo(r.scrollLeft,r.scrollTop)}}function $n(e,t,i,n){var r,s=e.doc;null==i&&(i="add"),"smart"==i&&(s.mode.indent?r=Bt(e,t):i="prev");var o=e.options.tabSize,a=Kr(s,t),l=$a(a.text,null,o);a.stateAfter&&(a.stateAfter=null);var c,d=a.text.match(/^\s*/)[0];if(n||/\S/.test(a.text)){if("smart"==i&&(c=s.mode.indent(r,a.text.slice(d.length),a.text),c==ja||c>150)){if(!n)return;i="prev"}}else c=0,i="not";"prev"==i?c=t>s.first?$a(Kr(s,t-1).text,null,o):0:"add"==i?c=l+e.options.indentUnit:"subtract"==i?c=l-e.options.indentUnit:"number"==typeof i&&(c=l+i),c=Math.max(0,c);var u="",h=0;if(e.options.indentWithTabs)for(var p=Math.floor(c/o);p;--p)h+=o,u+="	";if(c>h&&(u+=Ds(c-h)),u!=d)return On(s,u,Fo(t,0),Fo(t,d.length),"+input"),a.stateAfter=null,!0;for(var p=0;p<s.sel.ranges.length;p++){var f=s.sel.ranges[p];if(f.head.line==t&&f.head.ch<d.length){var h=Fo(t,d.length);
kt(s,p,new ut(h,h));break}}}function Hn(e,t,i,n){var r=t,s=t;return"number"==typeof t?s=Kr(e,ft(e,t)):r=ts(t),null==r?null:(n(s,r)&&e.cm&&ji(e.cm,r,i),s)}function Bn(e,t){for(var i=e.doc.sel.ranges,n=[],r=0;r<i.length;r++){for(var s=t(i[r]);n.length&&zo(s.from,Os(n).to)<=0;){var o=n.pop();if(zo(o.from,s.from)<0){s.from=o.from;break}}n.push(s)}Ni(e,function(){for(var t=n.length-1;t>=0;t--)On(e.doc,"",n[t].from,n[t].to,"+delete");Fn(e)})}function Wn(e,t,i,n,r){function s(){var t=a+i;return t<e.first||t>=e.first+e.size?!1:(a=t,d=Kr(e,t))}function o(e){var t=(r?ho:po)(d,l,i,!0);if(null==t){if(e||!s())return!1;l=r?(0>i?ro:no)(d):0>i?d.text.length:0}else l=t;return!0}var a=t.line,l=t.ch,c=i,d=Kr(e,a);if("char"==n)o();else if("column"==n)o(!0);else if("word"==n||"group"==n)for(var u=null,h="group"==n,p=e.cm&&e.cm.getHelper(t,"wordChars"),f=!0;!(0>i)||o(!f);f=!1){var m=d.text.charAt(l)||"\n",g=zs(m,p)?"w":h&&"\n"==m?"n":!h||/\s/.test(m)?null:"p";if(!h||f||g||(g="s"),u&&u!=g){0>i&&(i=1,o());break}if(g&&(u=g),i>0&&!o(!f))break}var v=Ot(e,Fo(a,l),t,c,!0);return zo(t,v)||(v.hitSide=!0),v}function qn(e,t,i,n){var r,s=e.doc,o=t.left;if("page"==n){var a=Math.min(e.display.wrapper.clientHeight,window.innerHeight||document.documentElement.clientHeight);r=t.top+i*(a-(0>i?1.5:.5)*_i(e.display))}else"line"==n&&(r=i>0?t.bottom+3:t.top-3);for(;;){var l=gi(e,o,r);if(!l.outside)break;if(0>i?0>=r:r>=s.height){l.hitSide=!0;break}r+=5*i}return l}function Qn(t,i,n,r){e.defaults[t]=i,n&&(ta[t]=r?function(e,t,i){i!=ia&&n(e,t,i)}:n)}function Un(e){for(var t,i,n,r,s=e.split(/-(?!$)/),e=s[s.length-1],o=0;o<s.length-1;o++){var a=s[o];if(/^(cmd|meta|m)$/i.test(a))r=!0;else if(/^a(lt)?$/i.test(a))t=!0;else if(/^(c|ctrl|control)$/i.test(a))i=!0;else{if(!/^s(hift)$/i.test(a))throw new Error("Unrecognized modifier name: "+a);n=!0}}return t&&(e="Alt-"+e),i&&(e="Ctrl-"+e),r&&(e="Cmd-"+e),n&&(e="Shift-"+e),e}function Xn(e){return"string"==typeof e?ua[e]:e}function Vn(e,t,i,n,r){if(n&&n.shared)return Gn(e,t,i,n,r);if(e.cm&&!e.cm.curOp)return Ei(e.cm,Vn)(e,t,i,n,r);var s=new va(e,r),o=zo(t,i);if(n&&Ps(n,s,!1),o>0||0==o&&s.clearWhenEmpty!==!1)return s;if(s.replacedWith&&(s.collapsed=!0,s.widgetNode=Bs("span",[s.replacedWith],"CodeMirror-widget"),n.handleMouseEvents||s.widgetNode.setAttribute("cm-ignore-events","true"),n.insertLeft&&(s.widgetNode.insertLeft=!0)),s.collapsed){if(vr(e,t.line,t,i,s)||t.line!=i.line&&vr(e,i.line,t,i,s))throw new Error("Inserting collapsed marker partially overlapping an existing one");Po=!0}s.addToHistory&&cs(e,{from:t,to:i,origin:"markText"},e.sel,0/0);var a,l=t.line,c=e.cm;if(e.iter(l,i.line+1,function(e){c&&s.collapsed&&!c.options.lineWrapping&&_r(e)==c.display.maxLine&&(a=!0),s.collapsed&&l!=t.line&&es(e,0),ir(e,new Zn(s,l==t.line?t.ch:null,l==i.line?i.ch:null)),++l}),s.collapsed&&e.iter(t.line,i.line+1,function(t){kr(e,t)&&es(t,0)}),s.clearOnEnter&&Ea(s,"beforeCursorEnter",function(){s.clear()}),s.readOnly&&(jo=!0,(e.history.done.length||e.history.undone.length)&&e.clearHistory()),s.collapsed&&(s.id=++ga,s.atomic=!0),c){if(a&&(c.curOp.updateMaxLine=!0),s.collapsed)Ii(c,t.line,i.line+1);else if(s.className||s.title||s.startStyle||s.endStyle||s.css)for(var d=t.line;d<=i.line;d++)ji(c,d,"text");s.atomic&&Nt(c.doc),xs(c,"markerAdded",c,s)}return s}function Gn(e,t,i,n,r){n=Ps(n),n.shared=!1;var s=[Vn(e,t,i,n,r)],o=s[0],a=n.widgetNode;return Gr(e,function(e){a&&(n.widgetNode=a.cloneNode(!0)),s.push(Vn(e,mt(e,t),mt(e,i),n,r));for(var l=0;l<e.linked.length;++l)if(e.linked[l].isParent)return;o=Os(s)}),new _a(s,o)}function Yn(e){return e.findMarks(Fo(e.first,0),e.clipPos(Fo(e.lastLine())),function(e){return e.parent})}function Kn(e,t){for(var i=0;i<t.length;i++){var n=t[i],r=n.find(),s=e.clipPos(r.from),o=e.clipPos(r.to);if(zo(s,o)){var a=Vn(e,s,o,n.primary,n.primary.type);n.markers.push(a),a.parent=n}}}function Jn(e){for(var t=0;t<e.length;t++){var i=e[t],n=[i.primary.doc];Gr(i.primary.doc,function(e){n.push(e)});for(var r=0;r<i.markers.length;r++){var s=i.markers[r];-1==Rs(n,s.doc)&&(s.parent=null,i.markers.splice(r--,1))}}}function Zn(e,t,i){this.marker=e,this.from=t,this.to=i}function er(e,t){if(e)for(var i=0;i<e.length;++i){var n=e[i];if(n.marker==t)return n}}function tr(e,t){for(var i,n=0;n<e.length;++n)e[n]!=t&&(i||(i=[])).push(e[n]);return i}function ir(e,t){e.markedSpans=e.markedSpans?e.markedSpans.concat([t]):[t],t.marker.attachLine(e)}function nr(e,t,i){if(e)for(var n,r=0;r<e.length;++r){var s=e[r],o=s.marker,a=null==s.from||(o.inclusiveLeft?s.from<=t:s.from<t);if(a||s.from==t&&"bookmark"==o.type&&(!i||!s.marker.insertLeft)){var l=null==s.to||(o.inclusiveRight?s.to>=t:s.to>t);(n||(n=[])).push(new Zn(o,s.from,l?null:s.to))}}return n}function rr(e,t,i){if(e)for(var n,r=0;r<e.length;++r){var s=e[r],o=s.marker,a=null==s.to||(o.inclusiveRight?s.to>=t:s.to>t);if(a||s.from==t&&"bookmark"==o.type&&(!i||s.marker.insertLeft)){var l=null==s.from||(o.inclusiveLeft?s.from<=t:s.from<t);(n||(n=[])).push(new Zn(o,l?null:s.from-t,null==s.to?null:s.to-t))}}return n}function sr(e,t){if(t.full)return null;var i=vt(e,t.from.line)&&Kr(e,t.from.line).markedSpans,n=vt(e,t.to.line)&&Kr(e,t.to.line).markedSpans;if(!i&&!n)return null;var r=t.from.ch,s=t.to.ch,o=0==zo(t.from,t.to),a=nr(i,r,o),l=rr(n,s,o),c=1==t.text.length,d=Os(t.text).length+(c?r:0);if(a)for(var u=0;u<a.length;++u){var h=a[u];if(null==h.to){var p=er(l,h.marker);p?c&&(h.to=null==p.to?null:p.to+d):h.to=r}}if(l)for(var u=0;u<l.length;++u){var h=l[u];if(null!=h.to&&(h.to+=d),null==h.from){var p=er(a,h.marker);p||(h.from=d,c&&(a||(a=[])).push(h))}else h.from+=d,c&&(a||(a=[])).push(h)}a&&(a=or(a)),l&&l!=a&&(l=or(l));var f=[a];if(!c){var m,g=t.text.length-2;if(g>0&&a)for(var u=0;u<a.length;++u)null==a[u].to&&(m||(m=[])).push(new Zn(a[u].marker,null,null));for(var u=0;g>u;++u)f.push(m);f.push(l)}return f}function or(e){for(var t=0;t<e.length;++t){var i=e[t];null!=i.from&&i.from==i.to&&i.marker.clearWhenEmpty!==!1&&e.splice(t--,1)}return e.length?e:null}function ar(e,t){var i=ms(e,t),n=sr(e,t);if(!i)return n;if(!n)return i;for(var r=0;r<i.length;++r){var s=i[r],o=n[r];if(s&&o)e:for(var a=0;a<o.length;++a){for(var l=o[a],c=0;c<s.length;++c)if(s[c].marker==l.marker)continue e;s.push(l)}else o&&(i[r]=o)}return i}function lr(e,t,i){var n=null;if(e.iter(t.line,i.line+1,function(e){if(e.markedSpans)for(var t=0;t<e.markedSpans.length;++t){var i=e.markedSpans[t].marker;!i.readOnly||n&&-1!=Rs(n,i)||(n||(n=[])).push(i)}}),!n)return null;for(var r=[{from:t,to:i}],s=0;s<n.length;++s)for(var o=n[s],a=o.find(0),l=0;l<r.length;++l){var c=r[l];if(!(zo(c.to,a.from)<0||zo(c.from,a.to)>0)){var d=[l,1],u=zo(c.from,a.from),h=zo(c.to,a.to);(0>u||!o.inclusiveLeft&&!u)&&d.push({from:c.from,to:a.from}),(h>0||!o.inclusiveRight&&!h)&&d.push({from:a.to,to:c.to}),r.splice.apply(r,d),l+=d.length-1}}return r}function cr(e){var t=e.markedSpans;if(t){for(var i=0;i<t.length;++i)t[i].marker.detachLine(e);e.markedSpans=null}}function dr(e,t){if(t){for(var i=0;i<t.length;++i)t[i].marker.attachLine(e);e.markedSpans=t}}function ur(e){return e.inclusiveLeft?-1:0}function hr(e){return e.inclusiveRight?1:0}function pr(e,t){var i=e.lines.length-t.lines.length;if(0!=i)return i;var n=e.find(),r=t.find(),s=zo(n.from,r.from)||ur(e)-ur(t);if(s)return-s;var o=zo(n.to,r.to)||hr(e)-hr(t);return o?o:t.id-e.id}function fr(e,t){var i,n=Po&&e.markedSpans;if(n)for(var r,s=0;s<n.length;++s)r=n[s],r.marker.collapsed&&null==(t?r.from:r.to)&&(!i||pr(i,r.marker)<0)&&(i=r.marker);return i}function mr(e){return fr(e,!0)}function gr(e){return fr(e,!1)}function vr(e,t,i,n,r){var s=Kr(e,t),o=Po&&s.markedSpans;if(o)for(var a=0;a<o.length;++a){var l=o[a];if(l.marker.collapsed){var c=l.marker.find(0),d=zo(c.from,i)||ur(l.marker)-ur(r),u=zo(c.to,n)||hr(l.marker)-hr(r);if(!(d>=0&&0>=u||0>=d&&u>=0)&&(0>=d&&(l.marker.inclusiveRight&&r.inclusiveLeft?zo(c.to,i)>=0:zo(c.to,i)>0)||d>=0&&(l.marker.inclusiveRight&&r.inclusiveLeft?zo(c.from,n)<=0:zo(c.from,n)<0)))return!0}}}function _r(e){for(var t;t=mr(e);)e=t.find(-1,!0).line;return e}function yr(e){for(var t,i;t=gr(e);)e=t.find(1,!0).line,(i||(i=[])).push(e);return i}function br(e,t){var i=Kr(e,t),n=_r(i);return i==n?t:ts(n)}function wr(e,t){if(t>e.lastLine())return t;var i,n=Kr(e,t);if(!kr(e,n))return t;for(;i=gr(n);)n=i.find(1,!0).line;return ts(n)+1}function kr(e,t){var i=Po&&t.markedSpans;if(i)for(var n,r=0;r<i.length;++r)if(n=i[r],n.marker.collapsed){if(null==n.from)return!0;if(!n.marker.widgetNode&&0==n.from&&n.marker.inclusiveLeft&&Cr(e,t,n))return!0}}function Cr(e,t,i){if(null==i.to){var n=i.marker.find(1,!0);return Cr(e,n.line,er(n.line.markedSpans,i.marker))}if(i.marker.inclusiveRight&&i.to==t.text.length)return!0;for(var r,s=0;s<t.markedSpans.length;++s)if(r=t.markedSpans[s],r.marker.collapsed&&!r.marker.widgetNode&&r.from==i.to&&(null==r.to||r.to!=i.from)&&(r.marker.inclusiveLeft||i.marker.inclusiveRight)&&Cr(e,t,r))return!0}function xr(e,t,i){ns(t)<(e.curOp&&e.curOp.scrollTop||e.doc.scrollTop)&&Pn(e,null,i)}function Ar(e){if(null!=e.height)return e.height;var t=e.doc.cm;if(!t)return 0;if(!Va(document.body,e.node)){var i="position: relative;";e.coverGutter&&(i+="margin-left: -"+t.display.gutters.offsetWidth+"px;"),e.noHScroll&&(i+="width: "+t.display.wrapper.clientWidth+"px;"),qs(t.display.measure,Bs("div",[e.node],null,i))}return e.height=e.node.parentNode.offsetHeight}function Tr(e,t,i,n){var r=new ya(e,i,n),s=e.cm;return s&&r.noHScroll&&(s.display.alignWidgets=!0),Hn(e,t,"widget",function(t){var i=t.widgets||(t.widgets=[]);if(null==r.insertAt?i.push(r):i.splice(Math.min(i.length-1,Math.max(0,r.insertAt)),0,r),r.line=t,s&&!kr(e,t)){var n=ns(t)<e.scrollTop;es(t,t.height+Ar(r)),n&&Pn(s,null,r.height),s.curOp.forceUpdate=!0}return!0}),r}function Sr(e,t,i,n){e.text=t,e.stateAfter&&(e.stateAfter=null),e.styles&&(e.styles=null),null!=e.order&&(e.order=null),cr(e),dr(e,i);var r=n?n(e):1;r!=e.height&&es(e,r)}function Mr(e){e.parent=null,cr(e)}function Nr(e,t){if(e)for(;;){var i=e.match(/(?:^|\s+)line-(background-)?(\S+)/);if(!i)break;e=e.slice(0,i.index)+e.slice(i.index+i[0].length);var n=i[1]?"bgClass":"textClass";null==t[n]?t[n]=i[2]:new RegExp("(?:^|s)"+i[2]+"(?:$|s)").test(t[n])||(t[n]+=" "+i[2])}return e}function Er(t,i){if(t.blankLine)return t.blankLine(i);if(t.innerMode){var n=e.innerMode(t,i);return n.mode.blankLine?n.mode.blankLine(n.state):void 0}}function Dr(t,i,n,r){for(var s=0;10>s;s++){r&&(r[0]=e.innerMode(t,n).mode);var o=t.token(i,n);if(i.pos>i.start)return o}throw new Error("Mode "+t.name+" failed to advance stream.")}function Or(e,t,i,n){function r(e){return{start:u.start,end:u.pos,string:u.current(),type:s||null,state:e?la(o.mode,d):d}}var s,o=e.doc,a=o.mode;t=mt(o,t);var l,c=Kr(o,t.line),d=Bt(e,t.line,i),u=new ma(c.text,e.options.tabSize);for(n&&(l=[]);(n||u.pos<t.ch)&&!u.eol();)u.start=u.pos,s=Dr(a,u,d),n&&l.push(r(!0));return n?l:r()}function Rr(e,t,i,n,r,s,o){var a=i.flattenSpans;null==a&&(a=e.options.flattenSpans);var l,c=0,d=null,u=new ma(t,e.options.tabSize),h=e.options.addModeClass&&[null];for(""==t&&Nr(Er(i,n),s);!u.eol();){if(u.pos>e.options.maxHighlightLength?(a=!1,o&&jr(e,t,n,u.pos),u.pos=t.length,l=null):l=Nr(Dr(i,u,n,h),s),h){var p=h[0].name;p&&(l="m-"+(l?p+" "+l:p))}if(!a||d!=l){for(;c<u.start;)c=Math.min(u.start,c+5e4),r(c,d);d=l}u.start=u.pos}for(;c<u.pos;){var f=Math.min(u.pos,c+5e4);r(f,d),c=f}}function Lr(e,t,i,n){var r=[e.state.modeGen],s={};Rr(e,t.text,e.doc.mode,i,function(e,t){r.push(e,t)},s,n);for(var o=0;o<e.state.overlays.length;++o){var a=e.state.overlays[o],l=1,c=0;Rr(e,t.text,a.mode,!0,function(e,t){for(var i=l;e>c;){var n=r[l];n>e&&r.splice(l,1,e,r[l+1],n),l+=2,c=Math.min(e,n)}if(t)if(a.opaque)r.splice(i,l-i,e,"cm-overlay "+t),l=i+2;else for(;l>i;i+=2){var s=r[i+1];r[i+1]=(s?s+" ":"")+"cm-overlay "+t}},s)}return{styles:r,classes:s.bgClass||s.textClass?s:null}}function Ir(e,t,i){if(!t.styles||t.styles[0]!=e.state.modeGen){var n=Bt(e,ts(t)),r=Lr(e,t,t.text.length>e.options.maxHighlightLength?la(e.doc.mode,n):n);t.stateAfter=n,t.styles=r.styles,r.classes?t.styleClasses=r.classes:t.styleClasses&&(t.styleClasses=null),i===e.doc.frontier&&e.doc.frontier++}return t.styles}function jr(e,t,i,n){var r=e.doc.mode,s=new ma(t,e.options.tabSize);for(s.start=s.pos=n||0,""==t&&Er(r,i);!s.eol();)Dr(r,s,i),s.start=s.pos}function Pr(e,t){if(!e||/^\s*$/.test(e))return null;var i=t.addModeClass?ka:wa;return i[e]||(i[e]=e.replace(/\S+/g,"cm-$&"))}function Fr(e,t){var i=Bs("span",null,null,wo?"padding-right: .1px":null),n={pre:Bs("pre",[i],"CodeMirror-line"),content:i,col:0,pos:0,cm:e,splitSpaces:(yo||wo)&&e.getOption("lineWrapping")};t.measure={};for(var r=0;r<=(t.rest?t.rest.length:0);r++){var s,o=r?t.rest[r-1]:t.line;n.pos=0,n.addToken=$r,Js(e.display.measure)&&(s=rs(o))&&(n.addToken=Br(n.addToken,s)),n.map=[];var a=t!=e.display.externalMeasured&&ts(o);qr(o,n,Ir(e,o,a)),o.styleClasses&&(o.styleClasses.bgClass&&(n.bgClass=Xs(o.styleClasses.bgClass,n.bgClass||"")),o.styleClasses.textClass&&(n.textClass=Xs(o.styleClasses.textClass,n.textClass||""))),0==n.map.length&&n.map.push(0,0,n.content.appendChild(Ks(e.display.measure))),0==r?(t.measure.map=n.map,t.measure.cache={}):((t.measure.maps||(t.measure.maps=[])).push(n.map),(t.measure.caches||(t.measure.caches=[])).push({}))}if(wo){var l=n.content.lastChild;(/\bcm-tab\b/.test(l.className)||l.querySelector&&l.querySelector(".cm-tab"))&&(n.content.className="cm-tab-wrap-hack")}return Ra(e,"renderLine",e,t.line,n.pre),n.pre.className&&(n.textClass=Xs(n.pre.className,n.textClass||"")),n}function zr(e){var t=Bs("span","•","cm-invalidchar");return t.title="\\u"+e.charCodeAt(0).toString(16),t.setAttribute("aria-label",t.title),t}function $r(e,t,i,n,r,s,o){if(t){var a=e.splitSpaces?t.replace(/ {3,}/g,Hr):t,l=e.cm.state.specialChars,c=!1;if(l.test(t))for(var d=document.createDocumentFragment(),u=0;;){l.lastIndex=u;var h=l.exec(t),p=h?h.index-u:t.length-u;if(p){var f=document.createTextNode(a.slice(u,u+p));yo&&9>bo?d.appendChild(Bs("span",[f])):d.appendChild(f),e.map.push(e.pos,e.pos+p,f),e.col+=p,e.pos+=p}if(!h)break;if(u+=p+1,"	"==h[0]){var m=e.cm.options.tabSize,g=m-e.col%m,f=d.appendChild(Bs("span",Ds(g),"cm-tab"));f.setAttribute("role","presentation"),f.setAttribute("cm-text","	"),e.col+=g}else if("\r"==h[0]||"\n"==h[0]){var f=d.appendChild(Bs("span","\r"==h[0]?"␍":"␤","cm-invalidchar"));f.setAttribute("cm-text",h[0]),e.col+=1}else{var f=e.cm.options.specialCharPlaceholder(h[0]);f.setAttribute("cm-text",h[0]),yo&&9>bo?d.appendChild(Bs("span",[f])):d.appendChild(f),e.col+=1}e.map.push(e.pos,e.pos+1,f),e.pos++}else{e.col+=t.length;var d=document.createTextNode(a);e.map.push(e.pos,e.pos+t.length,d),yo&&9>bo&&(c=!0),e.pos+=t.length}if(i||n||r||c||o){var v=i||"";n&&(v+=n),r&&(v+=r);var _=Bs("span",[d],v,o);return s&&(_.title=s),e.content.appendChild(_)}e.content.appendChild(d)}}function Hr(e){for(var t=" ",i=0;i<e.length-2;++i)t+=i%2?" ":" ";return t+=" "}function Br(e,t){return function(i,n,r,s,o,a,l){r=r?r+" cm-force-border":"cm-force-border";for(var c=i.pos,d=c+n.length;;){for(var u=0;u<t.length;u++){var h=t[u];if(h.to>c&&h.from<=c)break}if(h.to>=d)return e(i,n,r,s,o,a,l);e(i,n.slice(0,h.to-c),r,s,null,a,l),s=null,n=n.slice(h.to-c),c=h.to}}}function Wr(e,t,i,n){var r=!n&&i.widgetNode;r&&e.map.push(e.pos,e.pos+t,r),!n&&e.cm.display.input.needsContentAttribute&&(r||(r=e.content.appendChild(document.createElement("span"))),r.setAttribute("cm-marker",i.id)),r&&(e.cm.display.input.setUneditable(r),e.content.appendChild(r)),e.pos+=t}function qr(e,t,i){var n=e.markedSpans,r=e.text,s=0;if(n)for(var o,a,l,c,d,u,h,p=r.length,f=0,m=1,g="",v=0;;){if(v==f){l=c=d=u=a="",h=null,v=1/0;for(var _,y=[],b=0;b<n.length;++b){var w=n[b],k=w.marker;"bookmark"==k.type&&w.from==f&&k.widgetNode?y.push(k):w.from<=f&&(null==w.to||w.to>f||k.collapsed&&w.to==f&&w.from==f)?(null!=w.to&&w.to!=f&&v>w.to&&(v=w.to,c=""),k.className&&(l+=" "+k.className),k.css&&(a=(a?a+";":"")+k.css),k.startStyle&&w.from==f&&(d+=" "+k.startStyle),k.endStyle&&w.to==v&&(_||(_=[])).push(k.endStyle,w.to),k.title&&!u&&(u=k.title),k.collapsed&&(!h||pr(h.marker,k)<0)&&(h=w)):w.from>f&&v>w.from&&(v=w.from)}if(_)for(var b=0;b<_.length;b+=2)_[b+1]==v&&(c+=" "+_[b]);if(!h||h.from==f)for(var b=0;b<y.length;++b)Wr(t,0,y[b]);if(h&&(h.from||0)==f){if(Wr(t,(null==h.to?p+1:h.to)-f,h.marker,null==h.from),null==h.to)return;h.to==f&&(h=!1)}}if(f>=p)break;for(var C=Math.min(p,v);;){if(g){var x=f+g.length;if(!h){var A=x>C?g.slice(0,C-f):g;t.addToken(t,A,o?o+l:l,d,f+A.length==v?c:"",u,a)}if(x>=C){g=g.slice(C-f),f=C;break}f=x,d=""}g=r.slice(s,s=i[m++]),o=Pr(i[m++],t.cm.options)}}else for(var m=1;m<i.length;m+=2)t.addToken(t,r.slice(s,s=i[m]),Pr(i[m+1],t.cm.options))}function Qr(e,t){return 0==t.from.ch&&0==t.to.ch&&""==Os(t.text)&&(!e.cm||e.cm.options.wholeLineUpdateBefore)}function Ur(e,t,i,n){function r(e){return i?i[e]:null}function s(e,i,r){Sr(e,i,r,n),xs(e,"change",e,t)}function o(e,t){for(var i=e,s=[];t>i;++i)s.push(new ba(c[i],r(i),n));return s}var a=t.from,l=t.to,c=t.text,d=Kr(e,a.line),u=Kr(e,l.line),h=Os(c),p=r(c.length-1),f=l.line-a.line;if(t.full)e.insert(0,o(0,c.length)),e.remove(c.length,e.size-c.length);else if(Qr(e,t)){var m=o(0,c.length-1);s(u,u.text,p),f&&e.remove(a.line,f),m.length&&e.insert(a.line,m)}else if(d==u)if(1==c.length)s(d,d.text.slice(0,a.ch)+h+d.text.slice(l.ch),p);else{var m=o(1,c.length-1);m.push(new ba(h+d.text.slice(l.ch),p,n)),s(d,d.text.slice(0,a.ch)+c[0],r(0)),e.insert(a.line+1,m)}else if(1==c.length)s(d,d.text.slice(0,a.ch)+c[0]+u.text.slice(l.ch),r(0)),e.remove(a.line+1,f);else{s(d,d.text.slice(0,a.ch)+c[0],r(0)),s(u,h+u.text.slice(l.ch),p);var m=o(1,c.length-1);f>1&&e.remove(a.line+1,f-1),e.insert(a.line+1,m)}xs(e,"change",e,t)}function Xr(e){this.lines=e,this.parent=null;for(var t=0,i=0;t<e.length;++t)e[t].parent=this,i+=e[t].height;this.height=i}function Vr(e){this.children=e;for(var t=0,i=0,n=0;n<e.length;++n){var r=e[n];t+=r.chunkSize(),i+=r.height,r.parent=this}this.size=t,this.height=i,this.parent=null}function Gr(e,t,i){function n(e,r,s){if(e.linked)for(var o=0;o<e.linked.length;++o){var a=e.linked[o];if(a.doc!=r){var l=s&&a.sharedHist;(!i||l)&&(t(a.doc,l),n(a.doc,e,l))}}}n(e,null,!0)}function Yr(e,t){if(t.cm)throw new Error("This document is already in use.");e.doc=t,t.cm=e,o(e),i(e),e.options.lineWrapping||h(e),e.options.mode=t.modeOption,Ii(e)}function Kr(e,t){if(t-=e.first,0>t||t>=e.size)throw new Error("There is no line "+(t+e.first)+" in the document.");for(var i=e;!i.lines;)for(var n=0;;++n){var r=i.children[n],s=r.chunkSize();if(s>t){i=r;break}t-=s}return i.lines[t]}function Jr(e,t,i){var n=[],r=t.line;return e.iter(t.line,i.line+1,function(e){var s=e.text;r==i.line&&(s=s.slice(0,i.ch)),r==t.line&&(s=s.slice(t.ch)),n.push(s),++r}),n}function Zr(e,t,i){var n=[];return e.iter(t,i,function(e){n.push(e.text)}),n}function es(e,t){var i=t-e.height;if(i)for(var n=e;n;n=n.parent)n.height+=i}function ts(e){if(null==e.parent)return null;for(var t=e.parent,i=Rs(t.lines,e),n=t.parent;n;t=n,n=n.parent)for(var r=0;n.children[r]!=t;++r)i+=n.children[r].chunkSize();return i+t.first}function is(e,t){var i=e.first;e:do{for(var n=0;n<e.children.length;++n){var r=e.children[n],s=r.height;if(s>t){e=r;continue e}t-=s,i+=r.chunkSize()}return i}while(!e.lines);for(var n=0;n<e.lines.length;++n){var o=e.lines[n],a=o.height;if(a>t)break;t-=a}return i+n}function ns(e){e=_r(e);for(var t=0,i=e.parent,n=0;n<i.lines.length;++n){var r=i.lines[n];if(r==e)break;t+=r.height}for(var s=i.parent;s;i=s,s=i.parent)for(var n=0;n<s.children.length;++n){var o=s.children[n];if(o==i)break;t+=o.height}return t}function rs(e){var t=e.order;return null==t&&(t=e.order=al(e.text)),t}function ss(e){this.done=[],this.undone=[],this.undoDepth=1/0,this.lastModTime=this.lastSelTime=0,this.lastOp=this.lastSelOp=null,this.lastOrigin=this.lastSelOrigin=null,this.generation=this.maxGeneration=e||1}function os(e,t){var i={from:X(t.from),to:Zo(t),text:Jr(e,t.from,t.to)};return ps(e,i,t.from.line,t.to.line+1),Gr(e,function(e){ps(e,i,t.from.line,t.to.line+1)},!0),i}function as(e){for(;e.length;){var t=Os(e);if(!t.ranges)break;e.pop()}}function ls(e,t){return t?(as(e.done),Os(e.done)):e.done.length&&!Os(e.done).ranges?Os(e.done):e.done.length>1&&!e.done[e.done.length-2].ranges?(e.done.pop(),Os(e.done)):void 0}function cs(e,t,i,n){var r=e.history;r.undone.length=0;var s,o=+new Date;if((r.lastOp==n||r.lastOrigin==t.origin&&t.origin&&("+"==t.origin.charAt(0)&&e.cm&&r.lastModTime>o-e.cm.options.historyEventDelay||"*"==t.origin.charAt(0)))&&(s=ls(r,r.lastOp==n))){var a=Os(s.changes);0==zo(t.from,t.to)&&0==zo(t.from,a.to)?a.to=Zo(t):s.changes.push(os(e,t))}else{var l=Os(r.done);for(l&&l.ranges||hs(e.sel,r.done),s={changes:[os(e,t)],generation:r.generation},r.done.push(s);r.done.length>r.undoDepth;)r.done.shift(),r.done[0].ranges||r.done.shift()}r.done.push(i),r.generation=++r.maxGeneration,r.lastModTime=r.lastSelTime=o,r.lastOp=r.lastSelOp=n,r.lastOrigin=r.lastSelOrigin=t.origin,a||Ra(e,"historyAdded")}function ds(e,t,i,n){var r=t.charAt(0);return"*"==r||"+"==r&&i.ranges.length==n.ranges.length&&i.somethingSelected()==n.somethingSelected()&&new Date-e.history.lastSelTime<=(e.cm?e.cm.options.historyEventDelay:500)}function us(e,t,i,n){var r=e.history,s=n&&n.origin;i==r.lastSelOp||s&&r.lastSelOrigin==s&&(r.lastModTime==r.lastSelTime&&r.lastOrigin==s||ds(e,s,Os(r.done),t))?r.done[r.done.length-1]=t:hs(t,r.done),r.lastSelTime=+new Date,r.lastSelOrigin=s,r.lastSelOp=i,n&&n.clearRedo!==!1&&as(r.undone)}function hs(e,t){var i=Os(t);i&&i.ranges&&i.equals(e)||t.push(e)}function ps(e,t,i,n){var r=t["spans_"+e.id],s=0;e.iter(Math.max(e.first,i),Math.min(e.first+e.size,n),function(i){i.markedSpans&&((r||(r=t["spans_"+e.id]={}))[s]=i.markedSpans),++s})}function fs(e){if(!e)return null;for(var t,i=0;i<e.length;++i)e[i].marker.explicitlyCleared?t||(t=e.slice(0,i)):t&&t.push(e[i]);return t?t.length?t:null:e}function ms(e,t){var i=t["spans_"+e.id];if(!i)return null;for(var n=0,r=[];n<t.text.length;++n)r.push(fs(i[n]));return r}function gs(e,t,i){for(var n=0,r=[];n<e.length;++n){var s=e[n];if(s.ranges)r.push(i?dt.prototype.deepCopy.call(s):s);else{var o=s.changes,a=[];r.push({changes:a});for(var l=0;l<o.length;++l){var c,d=o[l];if(a.push({from:d.from,to:d.to,text:d.text}),t)for(var u in d)(c=u.match(/^spans_(\d+)$/))&&Rs(t,Number(c[1]))>-1&&(Os(a)[u]=d[u],delete d[u])}}}return r}function vs(e,t,i,n){i<e.line?e.line+=n:t<e.line&&(e.line=t,e.ch=0)}function _s(e,t,i,n){for(var r=0;r<e.length;++r){var s=e[r],o=!0;if(s.ranges){s.copied||(s=e[r]=s.deepCopy(),s.copied=!0);for(var a=0;a<s.ranges.length;a++)vs(s.ranges[a].anchor,t,i,n),vs(s.ranges[a].head,t,i,n)}else{for(var a=0;a<s.changes.length;++a){var l=s.changes[a];if(i<l.from.line)l.from=Fo(l.from.line+n,l.from.ch),l.to=Fo(l.to.line+n,l.to.ch);else if(t<=l.to.line){o=!1;break}}o||(e.splice(0,r+1),r=0)}}}function ys(e,t){var i=t.from.line,n=t.to.line,r=t.text.length-(n-i)-1;_s(e.done,i,n,r),_s(e.undone,i,n,r)}function bs(e){return null!=e.defaultPrevented?e.defaultPrevented:0==e.returnValue}function ws(e){return e.target||e.srcElement}function ks(e){var t=e.which;return null==t&&(1&e.button?t=1:2&e.button?t=3:4&e.button&&(t=2)),Eo&&e.ctrlKey&&1==t&&(t=3),t}function Cs(e,t,i){var n=e._handlers&&e._handlers[t];return i?n&&n.length>0?n.slice():Da:n||Da}function xs(e,t){function i(e){return function(){e.apply(null,s)}}var n=Cs(e,t,!1);if(n.length){var r,s=Array.prototype.slice.call(arguments,2);Qo?r=Qo.delayedCallbacks:La?r=La:(r=La=[],setTimeout(As,0));for(var o=0;o<n.length;++o)r.push(i(n[o]))}}function As(){var e=La;La=null;for(var t=0;t<e.length;++t)e[t]()}function Ts(e,t,i){return"string"==typeof t&&(t={type:t,preventDefault:function(){this.defaultPrevented=!0}}),Ra(e,i||t.type,e,t),bs(t)||t.codemirrorIgnore}function Ss(e){var t=e._handlers&&e._handlers.cursorActivity;if(t)for(var i=e.curOp.cursorActivityHandlers||(e.curOp.cursorActivityHandlers=[]),n=0;n<t.length;++n)-1==Rs(i,t[n])&&i.push(t[n])}function Ms(e,t){return Cs(e,t).length>0}function Ns(e){e.prototype.on=function(e,t){Ea(this,e,t)},e.prototype.off=function(e,t){Oa(this,e,t)}}function Es(){this.id=null}function Ds(e){for(;Ba.length<=e;)Ba.push(Os(Ba)+" ");return Ba[e]}function Os(e){return e[e.length-1]}function Rs(e,t){for(var i=0;i<e.length;++i)if(e[i]==t)return i;return-1}function Ls(e,t){for(var i=[],n=0;n<e.length;n++)i[n]=t(e[n],n);return i}function Is(){}function js(e,t){var i;return Object.create?i=Object.create(e):(Is.prototype=e,i=new Is),t&&Ps(t,i),i}function Ps(e,t,i){t||(t={});for(var n in e)!e.hasOwnProperty(n)||i===!1&&t.hasOwnProperty(n)||(t[n]=e[n]);return t}function Fs(e){var t=Array.prototype.slice.call(arguments,1);return function(){return e.apply(null,t)}}function zs(e,t){return t?t.source.indexOf("\\w")>-1&&Ua(e)?!0:t.test(e):Ua(e)}function $s(e){for(var t in e)if(e.hasOwnProperty(t)&&e[t])return!1;return!0}function Hs(e){return e.charCodeAt(0)>=768&&Xa.test(e)}function Bs(e,t,i,n){var r=document.createElement(e);if(i&&(r.className=i),n&&(r.style.cssText=n),"string"==typeof t)r.appendChild(document.createTextNode(t));else if(t)for(var s=0;s<t.length;++s)r.appendChild(t[s]);return r}function Ws(e){for(var t=e.childNodes.length;t>0;--t)e.removeChild(e.firstChild);return e}function qs(e,t){return Ws(e).appendChild(t)}function Qs(){for(var e=document.activeElement;e&&e.root&&e.root.activeElement;)e=e.root.activeElement;return e}function Us(e){return new RegExp("(^|\\s)"+e+"(?:$|\\s)\\s*")}function Xs(e,t){for(var i=e.split(" "),n=0;n<i.length;n++)i[n]&&!Us(i[n]).test(t)&&(t+=" "+i[n]);return t}function Vs(e){if(document.body.getElementsByClassName)for(var t=document.body.getElementsByClassName("CodeMirror"),i=0;i<t.length;i++){var n=t[i].CodeMirror;n&&e(n)}}function Gs(){Za||(Ys(),Za=!0)}function Ys(){var e;Ea(window,"resize",function(){null==e&&(e=setTimeout(function(){e=null,Vs(qi)},100))}),Ea(window,"blur",function(){Vs(_n)})}function Ks(e){if(null==Ga){var t=Bs("span","​");qs(e,Bs("span",[t,document.createTextNode("x")])),0!=e.firstChild.offsetHeight&&(Ga=t.offsetWidth<=1&&t.offsetHeight>2&&!(yo&&8>bo))}var i=Ga?Bs("span","​"):Bs("span"," ",null,"display: inline-block; width: 1px; margin-right: -1px");return i.setAttribute("cm-text",""),i}function Js(e){if(null!=Ya)return Ya;var t=qs(e,document.createTextNode("AخA")),i=qa(t,0,1).getBoundingClientRect();if(!i||i.left==i.right)return!1;var n=qa(t,1,2).getBoundingClientRect();return Ya=n.right-i.right<3}function Zs(e){if(null!=rl)return rl;var t=qs(e,Bs("span","x")),i=t.getBoundingClientRect(),n=qa(t,0,1).getBoundingClientRect();return rl=Math.abs(i.left-n.left)>1}function eo(e,t,i,n){if(!e)return n(t,i,"ltr");for(var r=!1,s=0;s<e.length;++s){var o=e[s];(o.from<i&&o.to>t||t==i&&o.to==t)&&(n(Math.max(o.from,t),Math.min(o.to,i),1==o.level?"rtl":"ltr"),r=!0)}r||n(t,i,"ltr")}function to(e){return e.level%2?e.to:e.from}function io(e){return e.level%2?e.from:e.to}function no(e){var t=rs(e);return t?to(t[0]):0}function ro(e){var t=rs(e);return t?io(Os(t)):e.text.length}function so(e,t){var i=Kr(e.doc,t),n=_r(i);n!=i&&(t=ts(n));var r=rs(n),s=r?r[0].level%2?ro(n):no(n):0;return Fo(t,s)}function oo(e,t){for(var i,n=Kr(e.doc,t);i=gr(n);)n=i.find(1,!0).line,t=null;var r=rs(n),s=r?r[0].level%2?no(n):ro(n):n.text.length;return Fo(null==t?ts(n):t,s)}function ao(e,t){var i=so(e,t.line),n=Kr(e.doc,i.line),r=rs(n);if(!r||0==r[0].level){var s=Math.max(0,n.text.search(/\S/)),o=t.line==i.line&&t.ch<=s&&t.ch;return Fo(i.line,o?0:s)}return i}function lo(e,t,i){var n=e[0].level;return t==n?!0:i==n?!1:i>t}function co(e,t){ol=null;for(var i,n=0;n<e.length;++n){var r=e[n];if(r.from<t&&r.to>t)return n;if(r.from==t||r.to==t){if(null!=i)return lo(e,r.level,e[i].level)?(r.from!=r.to&&(ol=i),n):(r.from!=r.to&&(ol=n),i);i=n}}return i}function uo(e,t,i,n){if(!n)return t+i;do t+=i;while(t>0&&Hs(e.text.charAt(t)));return t}function ho(e,t,i,n){var r=rs(e);if(!r)return po(e,t,i,n);for(var s=co(r,t),o=r[s],a=uo(e,t,o.level%2?-i:i,n);;){if(a>o.from&&a<o.to)return a;if(a==o.from||a==o.to)return co(r,a)==s?a:(o=r[s+=i],i>0==o.level%2?o.to:o.from);if(o=r[s+=i],!o)return null;a=i>0==o.level%2?uo(e,o.to,-1,n):uo(e,o.from,1,n)}}function po(e,t,i,n){var r=t+i;if(n)for(;r>0&&Hs(e.text.charAt(r));)r+=i;return 0>r||r>e.text.length?null:r}var fo=navigator.userAgent,mo=navigator.platform,go=/gecko\/\d/i.test(fo),vo=/MSIE \d/.test(fo),_o=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(fo),yo=vo||_o,bo=yo&&(vo?document.documentMode||6:_o[1]),wo=/WebKit\//.test(fo),ko=wo&&/Qt\/\d+\.\d+/.test(fo),Co=/Chrome\//.test(fo),xo=/Opera\//.test(fo),Ao=/Apple Computer/.test(navigator.vendor),To=/Mac OS X 1\d\D([8-9]|\d\d)\D/.test(fo),So=/PhantomJS/.test(fo),Mo=/AppleWebKit/.test(fo)&&/Mobile\/\w+/.test(fo),No=Mo||/Android|webOS|BlackBerry|Opera Mini|Opera Mobi|IEMobile/i.test(fo),Eo=Mo||/Mac/.test(mo),Do=/\bCrOS\b/.test(fo),Oo=/win/i.test(mo),Ro=xo&&fo.match(/Version\/(\d*\.\d*)/);Ro&&(Ro=Number(Ro[1])),Ro&&Ro>=15&&(xo=!1,wo=!0);var Lo=Eo&&(ko||xo&&(null==Ro||12.11>Ro)),Io=go||yo&&bo>=9,jo=!1,Po=!1;m.prototype=Ps({update:function(e){var t=e.scrollWidth>e.clientWidth+1,i=e.scrollHeight>e.clientHeight+1,n=e.nativeBarWidth;if(i){this.vert.style.display="block",this.vert.style.bottom=t?n+"px":"0";var r=e.viewHeight-(t?n:0);this.vert.firstChild.style.height=Math.max(0,e.scrollHeight-e.clientHeight+r)+"px"}else this.vert.style.display="",this.vert.firstChild.style.height="0";if(t){this.horiz.style.display="block",this.horiz.style.right=i?n+"px":"0",this.horiz.style.left=e.barLeft+"px";var s=e.viewWidth-e.barLeft-(i?n:0);this.horiz.firstChild.style.width=e.scrollWidth-e.clientWidth+s+"px"}else this.horiz.style.display="",this.horiz.firstChild.style.width="0";return!this.checkedZeroWidth&&e.clientHeight>0&&(0==n&&this.zeroWidthHack(),this.checkedZeroWidth=!0),{right:i?n:0,bottom:t?n:0}},setScrollLeft:function(e){this.horiz.scrollLeft!=e&&(this.horiz.scrollLeft=e),this.disableHoriz&&this.enableZeroWidthBar(this.horiz,this.disableHoriz)},setScrollTop:function(e){this.vert.scrollTop!=e&&(this.vert.scrollTop=e),this.disableVert&&this.enableZeroWidthBar(this.vert,this.disableVert)},zeroWidthHack:function(){var e=Eo&&!To?"12px":"18px";this.horiz.style.height=this.vert.style.width=e,this.horiz.style.pointerEvents=this.vert.style.pointerEvents="none",this.disableHoriz=new Es,this.disableVert=new Es},enableZeroWidthBar:function(e,t){function i(){var n=e.getBoundingClientRect(),r=document.elementFromPoint(n.left+1,n.bottom-1);r!=e?e.style.pointerEvents="none":t.set(1e3,i)}e.style.pointerEvents="auto",t.set(1e3,i)},clear:function(){var e=this.horiz.parentNode;e.removeChild(this.horiz),e.removeChild(this.vert)}},m.prototype),g.prototype=Ps({update:function(){return{bottom:0,right:0}},setScrollLeft:function(){},setScrollTop:function(){},clear:function(){}},g.prototype),e.scrollbarModel={"native":m,"null":g},A.prototype.signal=function(e,t){Ms(e,t)&&this.events.push(arguments)},A.prototype.finish=function(){for(var e=0;e<this.events.length;e++)Ra.apply(null,this.events[e])};var Fo=e.Pos=function(e,t){return this instanceof Fo?(this.line=e,this.ch=t,void 0):new Fo(e,t)},zo=e.cmpPos=function(e,t){return e.line-t.line||e.ch-t.ch},$o=null;it.prototype=Ps({init:function(e){function t(e){if(!Ts(n,e)){if(n.somethingSelected())$o={lineWise:!1,text:n.getSelections()},i.inaccurateSelection&&(i.prevInput="",i.inaccurateSelection=!1,s.value=$o.text.join("\n"),Wa(s));else{if(!n.options.lineWiseCopyCut)return;var t=et(n);$o={lineWise:!0,text:t.text},"cut"==e.type?n.setSelections(t.ranges,null,Pa):(i.prevInput="",s.value=t.text.join("\n"),Wa(s))}"cut"==e.type&&(n.state.cutIncoming=!0)}}var i=this,n=this.cm,r=this.wrapper=nt(),s=this.textarea=r.firstChild;e.wrapper.insertBefore(r,e.wrapper.firstChild),Mo&&(s.style.width="0px"),Ea(s,"input",function(){yo&&bo>=9&&i.hasSelection&&(i.hasSelection=null),i.poll()}),Ea(s,"paste",function(e){Ts(n,e)||J(e,n)||(n.state.pasteIncoming=!0,i.fastPoll())}),Ea(s,"cut",t),Ea(s,"copy",t),Ea(e.scroller,"paste",function(t){Qi(e,t)||Ts(n,t)||(n.state.pasteIncoming=!0,i.focus())}),Ea(e.lineSpace,"selectstart",function(t){Qi(e,t)||Sa(t)}),Ea(s,"compositionstart",function(){var e=n.getCursor("from");i.composing&&i.composing.range.clear(),i.composing={start:e,range:n.markText(e,n.getCursor("to"),{className:"CodeMirror-composing"})}}),Ea(s,"compositionend",function(){i.composing&&(i.poll(),i.composing.range.clear(),i.composing=null)})},prepareSelection:function(){var e=this.cm,t=e.display,i=e.doc,n=It(e);if(e.options.moveInputWithCursor){var r=pi(e,i.sel.primary().head,"div"),s=t.wrapper.getBoundingClientRect(),o=t.lineDiv.getBoundingClientRect();n.teTop=Math.max(0,Math.min(t.wrapper.clientHeight-10,r.top+o.top-s.top)),n.teLeft=Math.max(0,Math.min(t.wrapper.clientWidth-10,r.left+o.left-s.left))
}return n},showSelection:function(e){var t=this.cm,i=t.display;qs(i.cursorDiv,e.cursors),qs(i.selectionDiv,e.selection),null!=e.teTop&&(this.wrapper.style.top=e.teTop+"px",this.wrapper.style.left=e.teLeft+"px")},reset:function(e){if(!this.contextMenuPending){var t,i,n=this.cm,r=n.doc;if(n.somethingSelected()){this.prevInput="";var s=r.sel.primary();t=nl&&(s.to().line-s.from().line>100||(i=n.getSelection()).length>1e3);var o=t?"-":i||n.getSelection();this.textarea.value=o,n.state.focused&&Wa(this.textarea),yo&&bo>=9&&(this.hasSelection=o)}else e||(this.prevInput=this.textarea.value="",yo&&bo>=9&&(this.hasSelection=null));this.inaccurateSelection=t}},getField:function(){return this.textarea},supportsTouch:function(){return!1},focus:function(){if("nocursor"!=this.cm.options.readOnly&&(!No||Qs()!=this.textarea))try{this.textarea.focus()}catch(e){}},blur:function(){this.textarea.blur()},resetPosition:function(){this.wrapper.style.top=this.wrapper.style.left=0},receivedFocus:function(){this.slowPoll()},slowPoll:function(){var e=this;e.pollingFast||e.polling.set(this.cm.options.pollInterval,function(){e.poll(),e.cm.state.focused&&e.slowPoll()})},fastPoll:function(){function e(){var n=i.poll();n||t?(i.pollingFast=!1,i.slowPoll()):(t=!0,i.polling.set(60,e))}var t=!1,i=this;i.pollingFast=!0,i.polling.set(20,e)},poll:function(){var e=this.cm,t=this.textarea,i=this.prevInput;if(this.contextMenuPending||!e.state.focused||il(t)&&!i&&!this.composing||e.isReadOnly()||e.options.disableInput||e.state.keySeq)return!1;var n=t.value;if(n==i&&!e.somethingSelected())return!1;if(yo&&bo>=9&&this.hasSelection===n||Eo&&/[\uf700-\uf7ff]/.test(n))return e.display.input.reset(),!1;if(e.doc.sel==e.display.selForContextMenu){var r=n.charCodeAt(0);if(8203!=r||i||(i="​"),8666==r)return this.reset(),this.cm.execCommand("undo")}for(var s=0,o=Math.min(i.length,n.length);o>s&&i.charCodeAt(s)==n.charCodeAt(s);)++s;var a=this;return Ni(e,function(){K(e,n.slice(s),i.length-s,null,a.composing?"*compose":null),n.length>1e3||n.indexOf("\n")>-1?t.value=a.prevInput="":a.prevInput=n,a.composing&&(a.composing.range.clear(),a.composing.range=e.markText(a.composing.start,e.getCursor("to"),{className:"CodeMirror-composing"}))}),!0},ensurePolled:function(){this.pollingFast&&this.poll()&&(this.pollingFast=!1)},onKeyPress:function(){yo&&bo>=9&&(this.hasSelection=null),this.fastPoll()},onContextMenu:function(e){function t(){if(null!=o.selectionStart){var e=r.somethingSelected(),t="​"+(e?o.value:"");o.value="⇚",o.value=t,n.prevInput=e?"":"​",o.selectionStart=1,o.selectionEnd=t.length,s.selForContextMenu=r.doc.sel}}function i(){if(n.contextMenuPending=!1,n.wrapper.style.cssText=u,o.style.cssText=d,yo&&9>bo&&s.scrollbars.setScrollTop(s.scroller.scrollTop=l),null!=o.selectionStart){(!yo||yo&&9>bo)&&t();var e=0,i=function(){s.selForContextMenu==r.doc.sel&&0==o.selectionStart&&o.selectionEnd>0&&"​"==n.prevInput?Ei(r,da.selectAll)(r):e++<10?s.detectingSelectAll=setTimeout(i,500):s.input.reset()};s.detectingSelectAll=setTimeout(i,200)}}var n=this,r=n.cm,s=r.display,o=n.textarea,a=Ui(r,e),l=s.scroller.scrollTop;if(a&&!xo){var c=r.options.resetSelectionOnContextMenu;c&&-1==r.doc.sel.contains(a)&&Ei(r,Tt)(r.doc,pt(a),Pa);var d=o.style.cssText,u=n.wrapper.style.cssText;n.wrapper.style.cssText="position: absolute";var h=n.wrapper.getBoundingClientRect();if(o.style.cssText="position: absolute; width: 30px; height: 30px; top: "+(e.clientY-h.top-5)+"px; left: "+(e.clientX-h.left-5)+"px; z-index: 1000; background: "+(yo?"rgba(255, 255, 255, .05)":"transparent")+"; outline: none; border-width: 0; outline: none; overflow: hidden; opacity: .05; filter: alpha(opacity=5);",wo)var p=window.scrollY;if(s.input.focus(),wo&&window.scrollTo(null,p),s.input.reset(),r.somethingSelected()||(o.value=n.prevInput=" "),n.contextMenuPending=!0,s.selForContextMenu=r.doc.sel,clearTimeout(s.detectingSelectAll),yo&&bo>=9&&t(),Io){Na(e);var f=function(){Oa(window,"mouseup",f),setTimeout(i,20)};Ea(window,"mouseup",f)}else setTimeout(i,50)}},readOnlyChanged:function(e){e||this.reset()},setUneditable:Is,needsContentAttribute:!1},it.prototype),rt.prototype=Ps({init:function(e){function t(e){if(!Ts(n,e)){if(n.somethingSelected())$o={lineWise:!1,text:n.getSelections()},"cut"==e.type&&n.replaceSelection("",null,"cut");else{if(!n.options.lineWiseCopyCut)return;var t=et(n);$o={lineWise:!0,text:t.text},"cut"==e.type&&n.operation(function(){n.setSelections(t.ranges,0,Pa),n.replaceSelection("",null,"cut")})}if(e.clipboardData&&!Mo)e.preventDefault(),e.clipboardData.clearData(),e.clipboardData.setData("text/plain",$o.text.join("\n"));else{var i=nt(),r=i.firstChild;n.display.lineSpace.insertBefore(i,n.display.lineSpace.firstChild),r.value=$o.text.join("\n");var s=document.activeElement;Wa(r),setTimeout(function(){n.display.lineSpace.removeChild(i),s.focus()},50)}}}var i=this,n=i.cm,r=i.div=e.lineDiv;tt(r),Ea(r,"paste",function(e){Ts(n,e)||J(e,n)}),Ea(r,"compositionstart",function(e){var t=e.data;if(i.composing={sel:n.doc.sel,data:t,startData:t},t){var r=n.doc.sel.primary(),s=n.getLine(r.head.line),o=s.indexOf(t,Math.max(0,r.head.ch-t.length));o>-1&&o<=r.head.ch&&(i.composing.sel=pt(Fo(r.head.line,o),Fo(r.head.line,o+t.length)))}}),Ea(r,"compositionupdate",function(e){i.composing.data=e.data}),Ea(r,"compositionend",function(e){var t=i.composing;t&&(e.data==t.startData||/\u200b/.test(e.data)||(t.data=e.data),setTimeout(function(){t.handled||i.applyComposition(t),i.composing==t&&(i.composing=null)},50))}),Ea(r,"touchstart",function(){i.forceCompositionEnd()}),Ea(r,"input",function(){i.composing||(n.isReadOnly()||!i.pollContent())&&Ni(i.cm,function(){Ii(n)})}),Ea(r,"copy",t),Ea(r,"cut",t)},prepareSelection:function(){var e=It(this.cm,!1);return e.focus=this.cm.state.focused,e},showSelection:function(e,t){e&&this.cm.display.view.length&&((e.focus||t)&&this.showPrimarySelection(),this.showMultipleSelections(e))},showPrimarySelection:function(){var e=window.getSelection(),t=this.cm.doc.sel.primary(),i=at(this.cm,e.anchorNode,e.anchorOffset),n=at(this.cm,e.focusNode,e.focusOffset);if(!i||i.bad||!n||n.bad||0!=zo(G(i,n),t.from())||0!=zo(V(i,n),t.to())){var r=st(this.cm,t.from()),s=st(this.cm,t.to());if(r||s){var o=this.cm.display.view,a=e.rangeCount&&e.getRangeAt(0);if(r){if(!s){var l=o[o.length-1].measure,c=l.maps?l.maps[l.maps.length-1]:l.map;s={node:c[c.length-1],offset:c[c.length-2]-c[c.length-3]}}}else r={node:o[0].measure.map[2],offset:0};try{var d=qa(r.node,r.offset,s.offset,s.node)}catch(u){}d&&(!go&&this.cm.state.focused?(e.collapse(r.node,r.offset),d.collapsed||e.addRange(d)):(e.removeAllRanges(),e.addRange(d)),a&&null==e.anchorNode?e.addRange(a):go&&this.startGracePeriod()),this.rememberSelection()}}},startGracePeriod:function(){var e=this;clearTimeout(this.gracePeriod),this.gracePeriod=setTimeout(function(){e.gracePeriod=!1,e.selectionChanged()&&e.cm.operation(function(){e.cm.curOp.selectionChanged=!0})},20)},showMultipleSelections:function(e){qs(this.cm.display.cursorDiv,e.cursors),qs(this.cm.display.selectionDiv,e.selection)},rememberSelection:function(){var e=window.getSelection();this.lastAnchorNode=e.anchorNode,this.lastAnchorOffset=e.anchorOffset,this.lastFocusNode=e.focusNode,this.lastFocusOffset=e.focusOffset},selectionInEditor:function(){var e=window.getSelection();if(!e.rangeCount)return!1;var t=e.getRangeAt(0).commonAncestorContainer;return Va(this.div,t)},focus:function(){"nocursor"!=this.cm.options.readOnly&&this.div.focus()},blur:function(){this.div.blur()},getField:function(){return this.div},supportsTouch:function(){return!0},receivedFocus:function(){function e(){t.cm.state.focused&&(t.pollSelection(),t.polling.set(t.cm.options.pollInterval,e))}var t=this;this.selectionInEditor()?this.pollSelection():Ni(this.cm,function(){t.cm.curOp.selectionChanged=!0}),this.polling.set(this.cm.options.pollInterval,e)},selectionChanged:function(){var e=window.getSelection();return e.anchorNode!=this.lastAnchorNode||e.anchorOffset!=this.lastAnchorOffset||e.focusNode!=this.lastFocusNode||e.focusOffset!=this.lastFocusOffset},pollSelection:function(){if(!this.composing&&!this.gracePeriod&&this.selectionChanged()){var e=window.getSelection(),t=this.cm;this.rememberSelection();var i=at(t,e.anchorNode,e.anchorOffset),n=at(t,e.focusNode,e.focusOffset);i&&n&&Ni(t,function(){Tt(t.doc,pt(i,n),Pa),(i.bad||n.bad)&&(t.curOp.selectionChanged=!0)})}},pollContent:function(){var e=this.cm,t=e.display,i=e.doc.sel.primary(),n=i.from(),r=i.to();if(n.line<t.viewFrom||r.line>t.viewTo-1)return!1;var s;if(n.line==t.viewFrom||0==(s=Fi(e,n.line)))var o=ts(t.view[0].line),a=t.view[0].node;else var o=ts(t.view[s].line),a=t.view[s-1].node.nextSibling;var l=Fi(e,r.line);if(l==t.view.length-1)var c=t.viewTo-1,d=t.lineDiv.lastChild;else var c=ts(t.view[l+1].line)-1,d=t.view[l+1].node.previousSibling;for(var u=e.doc.splitLines(ct(e,a,d,o,c)),h=Jr(e.doc,Fo(o,0),Fo(c,Kr(e.doc,c).text.length));u.length>1&&h.length>1;)if(Os(u)==Os(h))u.pop(),h.pop(),c--;else{if(u[0]!=h[0])break;u.shift(),h.shift(),o++}for(var p=0,f=0,m=u[0],g=h[0],v=Math.min(m.length,g.length);v>p&&m.charCodeAt(p)==g.charCodeAt(p);)++p;for(var _=Os(u),y=Os(h),b=Math.min(_.length-(1==u.length?p:0),y.length-(1==h.length?p:0));b>f&&_.charCodeAt(_.length-f-1)==y.charCodeAt(y.length-f-1);)++f;u[u.length-1]=_.slice(0,_.length-f),u[0]=u[0].slice(p);var w=Fo(o,p),k=Fo(c,h.length?Os(h).length-f:0);return u.length>1||u[0]||zo(w,k)?(On(e.doc,u,w,k,"+input"),!0):void 0},ensurePolled:function(){this.forceCompositionEnd()},reset:function(){this.forceCompositionEnd()},forceCompositionEnd:function(){this.composing&&!this.composing.handled&&(this.applyComposition(this.composing),this.composing.handled=!0,this.div.blur(),this.div.focus())},applyComposition:function(e){this.cm.isReadOnly()?Ei(this.cm,Ii)(this.cm):e.data&&e.data!=e.startData&&Ei(this.cm,K)(this.cm,e.data,0,e.sel)},setUneditable:function(e){e.contentEditable="false"},onKeyPress:function(e){e.preventDefault(),this.cm.isReadOnly()||Ei(this.cm,K)(this.cm,String.fromCharCode(null==e.charCode?e.keyCode:e.charCode),0)},readOnlyChanged:function(e){this.div.contentEditable=String("nocursor"!=e)},onContextMenu:Is,resetPosition:Is,needsContentAttribute:!0},rt.prototype),e.inputStyles={textarea:it,contenteditable:rt},dt.prototype={primary:function(){return this.ranges[this.primIndex]},equals:function(e){if(e==this)return!0;if(e.primIndex!=this.primIndex||e.ranges.length!=this.ranges.length)return!1;for(var t=0;t<this.ranges.length;t++){var i=this.ranges[t],n=e.ranges[t];if(0!=zo(i.anchor,n.anchor)||0!=zo(i.head,n.head))return!1}return!0},deepCopy:function(){for(var e=[],t=0;t<this.ranges.length;t++)e[t]=new ut(X(this.ranges[t].anchor),X(this.ranges[t].head));return new dt(e,this.primIndex)},somethingSelected:function(){for(var e=0;e<this.ranges.length;e++)if(!this.ranges[e].empty())return!0;return!1},contains:function(e,t){t||(t=e);for(var i=0;i<this.ranges.length;i++){var n=this.ranges[i];if(zo(t,n.from())>=0&&zo(e,n.to())<=0)return i}return-1}},ut.prototype={from:function(){return G(this.anchor,this.head)},to:function(){return V(this.anchor,this.head)},empty:function(){return this.head.line==this.anchor.line&&this.head.ch==this.anchor.ch}};var Ho,Bo,Wo,qo={left:0,right:0,top:0,bottom:0},Qo=null,Uo=0,Xo=0,Vo=0,Go=null;yo?Go=-.53:go?Go=15:Co?Go=-.7:Ao&&(Go=-1/3);var Yo=function(e){var t=e.wheelDeltaX,i=e.wheelDeltaY;return null==t&&e.detail&&e.axis==e.HORIZONTAL_AXIS&&(t=e.detail),null==i&&e.detail&&e.axis==e.VERTICAL_AXIS?i=e.detail:null==i&&(i=e.wheelDelta),{x:t,y:i}};e.wheelEventPixels=function(e){var t=Yo(e);return t.x*=Go,t.y*=Go,t};var Ko=new Es,Jo=null,Zo=e.changeEnd=function(e){return e.text?Fo(e.from.line+e.text.length-1,Os(e.text).length+(1==e.text.length?e.from.ch:0)):e.to};e.prototype={constructor:e,focus:function(){window.focus(),this.display.input.focus()},setOption:function(e,t){var i=this.options,n=i[e];(i[e]!=t||"mode"==e)&&(i[e]=t,ta.hasOwnProperty(e)&&Ei(this,ta[e])(this,t,n))},getOption:function(e){return this.options[e]},getDoc:function(){return this.doc},addKeyMap:function(e,t){this.state.keyMaps[t?"push":"unshift"](Xn(e))},removeKeyMap:function(e){for(var t=this.state.keyMaps,i=0;i<t.length;++i)if(t[i]==e||t[i].name==e)return t.splice(i,1),!0},addOverlay:Di(function(t,i){var n=t.token?t:e.getMode(this.options,t);if(n.startState)throw new Error("Overlays may not be stateful.");this.state.overlays.push({mode:n,modeSpec:t,opaque:i&&i.opaque}),this.state.modeGen++,Ii(this)}),removeOverlay:Di(function(e){for(var t=this.state.overlays,i=0;i<t.length;++i){var n=t[i].modeSpec;if(n==e||"string"==typeof e&&n.name==e)return t.splice(i,1),this.state.modeGen++,Ii(this),void 0}}),indentLine:Di(function(e,t,i){"string"!=typeof t&&"number"!=typeof t&&(t=null==t?this.options.smartIndent?"smart":"prev":t?"add":"subtract"),vt(this.doc,e)&&$n(this,e,t,i)}),indentSelection:Di(function(e){for(var t=this.doc.sel.ranges,i=-1,n=0;n<t.length;n++){var r=t[n];if(r.empty())r.head.line>i&&($n(this,r.head.line,e,!0),i=r.head.line,n==this.doc.sel.primIndex&&Fn(this));else{var s=r.from(),o=r.to(),a=Math.max(i,s.line);i=Math.min(this.lastLine(),o.line-(o.ch?0:1))+1;for(var l=a;i>l;++l)$n(this,l,e);var c=this.doc.sel.ranges;0==s.ch&&t.length==c.length&&c[n].from().ch>0&&kt(this.doc,n,new ut(s,c[n].to()),Pa)}}}),getTokenAt:function(e,t){return Or(this,e,t)},getLineTokens:function(e,t){return Or(this,Fo(e),t,!0)},getTokenTypeAt:function(e){e=mt(this.doc,e);var t,i=Ir(this,Kr(this.doc,e.line)),n=0,r=(i.length-1)/2,s=e.ch;if(0==s)t=i[2];else for(;;){var o=n+r>>1;if((o?i[2*o-1]:0)>=s)r=o;else{if(!(i[2*o+1]<s)){t=i[2*o+2];break}n=o+1}}var a=t?t.indexOf("cm-overlay "):-1;return 0>a?t:0==a?null:t.slice(0,a-1)},getModeAt:function(t){var i=this.doc.mode;return i.innerMode?e.innerMode(i,this.getTokenAt(t).state).mode:i},getHelper:function(e,t){return this.getHelpers(e,t)[0]},getHelpers:function(e,t){var i=[];if(!aa.hasOwnProperty(t))return i;var n=aa[t],r=this.getModeAt(e);if("string"==typeof r[t])n[r[t]]&&i.push(n[r[t]]);else if(r[t])for(var s=0;s<r[t].length;s++){var o=n[r[t][s]];o&&i.push(o)}else r.helperType&&n[r.helperType]?i.push(n[r.helperType]):n[r.name]&&i.push(n[r.name]);for(var s=0;s<n._global.length;s++){var a=n._global[s];a.pred(r,this)&&-1==Rs(i,a.val)&&i.push(a.val)}return i},getStateAfter:function(e,t){var i=this.doc;return e=ft(i,null==e?i.first+i.size-1:e),Bt(this,e+1,t)},cursorCoords:function(e,t){var i,n=this.doc.sel.primary();return i=null==e?n.head:"object"==typeof e?mt(this.doc,e):e?n.from():n.to(),pi(this,i,t||"page")},charCoords:function(e,t){return hi(this,mt(this.doc,e),t||"page")},coordsChar:function(e,t){return e=ui(this,e,t||"page"),gi(this,e.left,e.top)},lineAtHeight:function(e,t){return e=ui(this,{top:e,left:0},t||"page").top,is(this.doc,e+this.display.viewOffset)},heightAtLine:function(e,t){var i,n=!1;if("number"==typeof e){var r=this.doc.first+this.doc.size-1;e<this.doc.first?e=this.doc.first:e>r&&(e=r,n=!0),i=Kr(this.doc,e)}else i=e;return di(this,i,{top:0,left:0},t||"page").top+(n?this.doc.height-ns(i):0)},defaultTextHeight:function(){return _i(this.display)},defaultCharWidth:function(){return yi(this.display)},setGutterMarker:Di(function(e,t,i){return Hn(this.doc,e,"gutter",function(e){var n=e.gutterMarkers||(e.gutterMarkers={});return n[t]=i,!i&&$s(n)&&(e.gutterMarkers=null),!0})}),clearGutter:Di(function(e){var t=this,i=t.doc,n=i.first;i.iter(function(i){i.gutterMarkers&&i.gutterMarkers[e]&&(i.gutterMarkers[e]=null,ji(t,n,"gutter"),$s(i.gutterMarkers)&&(i.gutterMarkers=null)),++n})}),lineInfo:function(e){if("number"==typeof e){if(!vt(this.doc,e))return null;var t=e;if(e=Kr(this.doc,e),!e)return null}else{var t=ts(e);if(null==t)return null}return{line:t,handle:e,text:e.text,gutterMarkers:e.gutterMarkers,textClass:e.textClass,bgClass:e.bgClass,wrapClass:e.wrapClass,widgets:e.widgets}},getViewport:function(){return{from:this.display.viewFrom,to:this.display.viewTo}},addWidget:function(e,t,i,n,r){var s=this.display;e=pi(this,mt(this.doc,e));var o=e.bottom,a=e.left;if(t.style.position="absolute",t.setAttribute("cm-ignore-events","true"),this.display.input.setUneditable(t),s.sizer.appendChild(t),"over"==n)o=e.top;else if("above"==n||"near"==n){var l=Math.max(s.wrapper.clientHeight,this.doc.height),c=Math.max(s.sizer.clientWidth,s.lineSpace.clientWidth);("above"==n||e.bottom+t.offsetHeight>l)&&e.top>t.offsetHeight?o=e.top-t.offsetHeight:e.bottom+t.offsetHeight<=l&&(o=e.bottom),a+t.offsetWidth>c&&(a=c-t.offsetWidth)}t.style.top=o+"px",t.style.left=t.style.right="","right"==r?(a=s.sizer.clientWidth-t.offsetWidth,t.style.right="0px"):("left"==r?a=0:"middle"==r&&(a=(s.sizer.clientWidth-t.offsetWidth)/2),t.style.left=a+"px"),i&&In(this,a,o,a+t.offsetWidth,o+t.offsetHeight)},triggerOnKeyDown:Di(hn),triggerOnKeyPress:Di(mn),triggerOnKeyUp:fn,execCommand:function(e){return da.hasOwnProperty(e)?da[e].call(null,this):void 0},triggerElectric:Di(function(e){Z(this,e)}),findPosH:function(e,t,i,n){var r=1;0>t&&(r=-1,t=-t);for(var s=0,o=mt(this.doc,e);t>s&&(o=Wn(this.doc,o,r,i,n),!o.hitSide);++s);return o},moveH:Di(function(e,t){var i=this;i.extendSelectionsBy(function(n){return i.display.shift||i.doc.extend||n.empty()?Wn(i.doc,n.head,e,t,i.options.rtlMoveVisually):0>e?n.from():n.to()},za)}),deleteH:Di(function(e,t){var i=this.doc.sel,n=this.doc;i.somethingSelected()?n.replaceSelection("",null,"+delete"):Bn(this,function(i){var r=Wn(n,i.head,e,t,!1);return 0>e?{from:r,to:i.head}:{from:i.head,to:r}})}),findPosV:function(e,t,i,n){var r=1,s=n;0>t&&(r=-1,t=-t);for(var o=0,a=mt(this.doc,e);t>o;++o){var l=pi(this,a,"div");if(null==s?s=l.left:l.left=s,a=qn(this,l,r,i),a.hitSide)break}return a},moveV:Di(function(e,t){var i=this,n=this.doc,r=[],s=!i.display.shift&&!n.extend&&n.sel.somethingSelected();if(n.extendSelectionsBy(function(o){if(s)return 0>e?o.from():o.to();var a=pi(i,o.head,"div");null!=o.goalColumn&&(a.left=o.goalColumn),r.push(a.left);var l=qn(i,a,e,t);return"page"==t&&o==n.sel.primary()&&Pn(i,null,hi(i,l,"div").top-a.top),l},za),r.length)for(var o=0;o<n.sel.ranges.length;o++)n.sel.ranges[o].goalColumn=r[o]}),findWordAt:function(e){var t=this.doc,i=Kr(t,e.line).text,n=e.ch,r=e.ch;if(i){var s=this.getHelper(e,"wordChars");(e.xRel<0||r==i.length)&&n?--n:++r;for(var o=i.charAt(n),a=zs(o,s)?function(e){return zs(e,s)}:/\s/.test(o)?function(e){return/\s/.test(e)}:function(e){return!/\s/.test(e)&&!zs(e)};n>0&&a(i.charAt(n-1));)--n;for(;r<i.length&&a(i.charAt(r));)++r}return new ut(Fo(e.line,n),Fo(e.line,r))},toggleOverwrite:function(e){(null==e||e!=this.state.overwrite)&&((this.state.overwrite=!this.state.overwrite)?Ja(this.display.cursorDiv,"CodeMirror-overwrite"):Ka(this.display.cursorDiv,"CodeMirror-overwrite"),Ra(this,"overwriteToggle",this,this.state.overwrite))},hasFocus:function(){return this.display.input.getField()==Qs()},isReadOnly:function(){return!(!this.options.readOnly&&!this.doc.cantEdit)},scrollTo:Di(function(e,t){(null!=e||null!=t)&&zn(this),null!=e&&(this.curOp.scrollLeft=e),null!=t&&(this.curOp.scrollTop=t)}),getScrollInfo:function(){var e=this.display.scroller;return{left:e.scrollLeft,top:e.scrollTop,height:e.scrollHeight-Ut(this)-this.display.barHeight,width:e.scrollWidth-Ut(this)-this.display.barWidth,clientHeight:Vt(this),clientWidth:Xt(this)}},scrollIntoView:Di(function(e,t){if(null==e?(e={from:this.doc.sel.primary().head,to:null},null==t&&(t=this.options.cursorScrollMargin)):"number"==typeof e?e={from:Fo(e,0),to:null}:null==e.from&&(e={from:e,to:null}),e.to||(e.to=e.from),e.margin=t||0,null!=e.from.line)zn(this),this.curOp.scrollToPos=e;else{var i=jn(this,Math.min(e.from.left,e.to.left),Math.min(e.from.top,e.to.top)-e.margin,Math.max(e.from.right,e.to.right),Math.max(e.from.bottom,e.to.bottom)+e.margin);this.scrollTo(i.scrollLeft,i.scrollTop)}}),setSize:Di(function(e,t){function i(e){return"number"==typeof e||/^\d+$/.test(String(e))?e+"px":e}var n=this;null!=e&&(n.display.wrapper.style.width=i(e)),null!=t&&(n.display.wrapper.style.height=i(t)),n.options.lineWrapping&&oi(this);var r=n.display.viewFrom;n.doc.iter(r,n.display.viewTo,function(e){if(e.widgets)for(var t=0;t<e.widgets.length;t++)if(e.widgets[t].noHScroll){ji(n,r,"widget");break}++r}),n.curOp.forceUpdate=!0,Ra(n,"refresh",this)}),operation:function(e){return Ni(this,e)},refresh:Di(function(){var e=this.display.cachedTextHeight;Ii(this),this.curOp.forceUpdate=!0,ai(this),this.scrollTo(this.doc.scrollLeft,this.doc.scrollTop),d(this),(null==e||Math.abs(e-_i(this.display))>.5)&&o(this),Ra(this,"refresh",this)}),swapDoc:Di(function(e){var t=this.doc;return t.cm=null,Yr(this,e),ai(this),this.display.input.reset(),this.scrollTo(e.scrollLeft,e.scrollTop),this.curOp.forceScroll=!0,xs(this,"swapDoc",this,t),t}),getInputField:function(){return this.display.input.getField()},getWrapperElement:function(){return this.display.wrapper},getScrollerElement:function(){return this.display.scroller},getGutterElement:function(){return this.display.gutters}},Ns(e);var ea=e.defaults={},ta=e.optionHandlers={},ia=e.Init={toString:function(){return"CodeMirror.Init"}};Qn("value","",function(e,t){e.setValue(t)},!0),Qn("mode",null,function(e,t){e.doc.modeOption=t,i(e)},!0),Qn("indentUnit",2,i,!0),Qn("indentWithTabs",!1),Qn("smartIndent",!0),Qn("tabSize",4,function(e){n(e),ai(e),Ii(e)},!0),Qn("lineSeparator",null,function(e,t){if(e.doc.lineSep=t,t){var i=[],n=e.doc.first;e.doc.iter(function(e){for(var r=0;;){var s=e.text.indexOf(t,r);if(-1==s)break;r=s+t.length,i.push(Fo(n,s))}n++});for(var r=i.length-1;r>=0;r--)On(e.doc,t,i[r],Fo(i[r].line,i[r].ch+t.length))}}),Qn("specialChars",/[\u0000-\u001f\u007f\u00ad\u200b-\u200f\u2028\u2029\ufeff]/g,function(t,i,n){t.state.specialChars=new RegExp(i.source+(i.test("	")?"":"|	"),"g"),n!=e.Init&&t.refresh()}),Qn("specialCharPlaceholder",zr,function(e){e.refresh()},!0),Qn("electricChars",!0),Qn("inputStyle",No?"contenteditable":"textarea",function(){throw new Error("inputStyle can not (yet) be changed in a running editor")},!0),Qn("rtlMoveVisually",!Oo),Qn("wholeLineUpdateBefore",!0),Qn("theme","default",function(e){a(e),l(e)},!0),Qn("keyMap","default",function(t,i,n){var r=Xn(i),s=n!=e.Init&&Xn(n);s&&s.detach&&s.detach(t,r),r.attach&&r.attach(t,s||null)}),Qn("extraKeys",null),Qn("lineWrapping",!1,r,!0),Qn("gutters",[],function(e){p(e.options),l(e)},!0),Qn("fixedGutter",!0,function(e,t){e.display.gutters.style.left=t?x(e.display)+"px":"0",e.refresh()},!0),Qn("coverGutterNextToScrollbar",!1,function(e){_(e)},!0),Qn("scrollbarStyle","native",function(e){v(e),_(e),e.display.scrollbars.setScrollTop(e.doc.scrollTop),e.display.scrollbars.setScrollLeft(e.doc.scrollLeft)},!0),Qn("lineNumbers",!1,function(e){p(e.options),l(e)},!0),Qn("firstLineNumber",1,l,!0),Qn("lineNumberFormatter",function(e){return e},l,!0),Qn("showCursorWhenSelecting",!1,Lt,!0),Qn("resetSelectionOnContextMenu",!0),Qn("lineWiseCopyCut",!0),Qn("readOnly",!1,function(e,t){"nocursor"==t?(_n(e),e.display.input.blur(),e.display.disabled=!0):e.display.disabled=!1,e.display.input.readOnlyChanged(t)}),Qn("disableInput",!1,function(e,t){t||e.display.input.reset()},!0),Qn("dragDrop",!0,Wi),Qn("allowDropFileTypes",null),Qn("cursorBlinkRate",530),Qn("cursorScrollMargin",0),Qn("cursorHeight",1,Lt,!0),Qn("singleCursorHeightPerLine",!0,Lt,!0),Qn("workTime",100),Qn("workDelay",100),Qn("flattenSpans",!0,n,!0),Qn("addModeClass",!1,n,!0),Qn("pollInterval",100),Qn("undoDepth",200,function(e,t){e.doc.history.undoDepth=t}),Qn("historyEventDelay",1250),Qn("viewportMargin",10,function(e){e.refresh()},!0),Qn("maxHighlightLength",1e4,n,!0),Qn("moveInputWithCursor",!0,function(e,t){t||e.display.input.resetPosition()}),Qn("tabindex",null,function(e,t){e.display.input.getField().tabIndex=t||""}),Qn("autofocus",null);var na=e.modes={},ra=e.mimeModes={};e.defineMode=function(t,i){e.defaults.mode||"null"==t||(e.defaults.mode=t),arguments.length>2&&(i.dependencies=Array.prototype.slice.call(arguments,2)),na[t]=i},e.defineMIME=function(e,t){ra[e]=t},e.resolveMode=function(t){if("string"==typeof t&&ra.hasOwnProperty(t))t=ra[t];else if(t&&"string"==typeof t.name&&ra.hasOwnProperty(t.name)){var i=ra[t.name];"string"==typeof i&&(i={name:i}),t=js(i,t),t.name=i.name}else if("string"==typeof t&&/^[\w\-]+\/[\w\-]+\+xml$/.test(t))return e.resolveMode("application/xml");return"string"==typeof t?{name:t}:t||{name:"null"}},e.getMode=function(t,i){var i=e.resolveMode(i),n=na[i.name];if(!n)return e.getMode(t,"text/plain");var r=n(t,i);if(sa.hasOwnProperty(i.name)){var s=sa[i.name];for(var o in s)s.hasOwnProperty(o)&&(r.hasOwnProperty(o)&&(r["_"+o]=r[o]),r[o]=s[o])}if(r.name=i.name,i.helperType&&(r.helperType=i.helperType),i.modeProps)for(var o in i.modeProps)r[o]=i.modeProps[o];return r},e.defineMode("null",function(){return{token:function(e){e.skipToEnd()}}}),e.defineMIME("text/plain","null");var sa=e.modeExtensions={};e.extendMode=function(e,t){var i=sa.hasOwnProperty(e)?sa[e]:sa[e]={};Ps(t,i)},e.defineExtension=function(t,i){e.prototype[t]=i},e.defineDocExtension=function(e,t){xa.prototype[e]=t},e.defineOption=Qn;var oa=[];e.defineInitHook=function(e){oa.push(e)};var aa=e.helpers={};e.registerHelper=function(t,i,n){aa.hasOwnProperty(t)||(aa[t]=e[t]={_global:[]}),aa[t][i]=n},e.registerGlobalHelper=function(t,i,n,r){e.registerHelper(t,i,r),aa[t]._global.push({pred:n,val:r})};var la=e.copyState=function(e,t){if(t===!0)return t;if(e.copyState)return e.copyState(t);var i={};for(var n in t){var r=t[n];r instanceof Array&&(r=r.concat([])),i[n]=r}return i},ca=e.startState=function(e,t,i){return e.startState?e.startState(t,i):!0};e.innerMode=function(e,t){for(;e.innerMode;){var i=e.innerMode(t);if(!i||i.mode==e)break;t=i.state,e=i.mode}return i||{mode:e,state:t}};var da=e.commands={selectAll:function(e){e.setSelection(Fo(e.firstLine(),0),Fo(e.lastLine()),Pa)},singleSelection:function(e){e.setSelection(e.getCursor("anchor"),e.getCursor("head"),Pa)},killLine:function(e){Bn(e,function(t){if(t.empty()){var i=Kr(e.doc,t.head.line).text.length;return t.head.ch==i&&t.head.line<e.lastLine()?{from:t.head,to:Fo(t.head.line+1,0)}:{from:t.head,to:Fo(t.head.line,i)}}return{from:t.from(),to:t.to()}})},deleteLine:function(e){Bn(e,function(t){return{from:Fo(t.from().line,0),to:mt(e.doc,Fo(t.to().line+1,0))}})},delLineLeft:function(e){Bn(e,function(e){return{from:Fo(e.from().line,0),to:e.from()}})},delWrappedLineLeft:function(e){Bn(e,function(t){var i=e.charCoords(t.head,"div").top+5,n=e.coordsChar({left:0,top:i},"div");return{from:n,to:t.from()}})},delWrappedLineRight:function(e){Bn(e,function(t){var i=e.charCoords(t.head,"div").top+5,n=e.coordsChar({left:e.display.lineDiv.offsetWidth+100,top:i},"div");return{from:t.from(),to:n}})},undo:function(e){e.undo()},redo:function(e){e.redo()},undoSelection:function(e){e.undoSelection()},redoSelection:function(e){e.redoSelection()},goDocStart:function(e){e.extendSelection(Fo(e.firstLine(),0))},goDocEnd:function(e){e.extendSelection(Fo(e.lastLine()))},goLineStart:function(e){e.extendSelectionsBy(function(t){return so(e,t.head.line)},{origin:"+move",bias:1})},goLineStartSmart:function(e){e.extendSelectionsBy(function(t){return ao(e,t.head)},{origin:"+move",bias:1})},goLineEnd:function(e){e.extendSelectionsBy(function(t){return oo(e,t.head.line)},{origin:"+move",bias:-1})},goLineRight:function(e){e.extendSelectionsBy(function(t){var i=e.charCoords(t.head,"div").top+5;return e.coordsChar({left:e.display.lineDiv.offsetWidth+100,top:i},"div")},za)},goLineLeft:function(e){e.extendSelectionsBy(function(t){var i=e.charCoords(t.head,"div").top+5;return e.coordsChar({left:0,top:i},"div")},za)},goLineLeftSmart:function(e){e.extendSelectionsBy(function(t){var i=e.charCoords(t.head,"div").top+5,n=e.coordsChar({left:0,top:i},"div");return n.ch<e.getLine(n.line).search(/\S/)?ao(e,t.head):n},za)},goLineUp:function(e){e.moveV(-1,"line")},goLineDown:function(e){e.moveV(1,"line")},goPageUp:function(e){e.moveV(-1,"page")},goPageDown:function(e){e.moveV(1,"page")},goCharLeft:function(e){e.moveH(-1,"char")},goCharRight:function(e){e.moveH(1,"char")},goColumnLeft:function(e){e.moveH(-1,"column")},goColumnRight:function(e){e.moveH(1,"column")},goWordLeft:function(e){e.moveH(-1,"word")},goGroupRight:function(e){e.moveH(1,"group")},goGroupLeft:function(e){e.moveH(-1,"group")},goWordRight:function(e){e.moveH(1,"word")},delCharBefore:function(e){e.deleteH(-1,"char")},delCharAfter:function(e){e.deleteH(1,"char")},delWordBefore:function(e){e.deleteH(-1,"word")},delWordAfter:function(e){e.deleteH(1,"word")},delGroupBefore:function(e){e.deleteH(-1,"group")},delGroupAfter:function(e){e.deleteH(1,"group")},indentAuto:function(e){e.indentSelection("smart")},indentMore:function(e){e.indentSelection("add")},indentLess:function(e){e.indentSelection("subtract")},insertTab:function(e){e.replaceSelection("	")},insertSoftTab:function(e){for(var t=[],i=e.listSelections(),n=e.options.tabSize,r=0;r<i.length;r++){var s=i[r].from(),o=$a(e.getLine(s.line),s.ch,n);t.push(Ds(n-o%n))}e.replaceSelections(t)},defaultTab:function(e){e.somethingSelected()?e.indentSelection("add"):e.execCommand("insertTab")},transposeChars:function(e){Ni(e,function(){for(var t=e.listSelections(),i=[],n=0;n<t.length;n++){var r=t[n].head,s=Kr(e.doc,r.line).text;if(s)if(r.ch==s.length&&(r=new Fo(r.line,r.ch-1)),r.ch>0)r=new Fo(r.line,r.ch+1),e.replaceRange(s.charAt(r.ch-1)+s.charAt(r.ch-2),Fo(r.line,r.ch-2),r,"+transpose");else if(r.line>e.doc.first){var o=Kr(e.doc,r.line-1).text;o&&e.replaceRange(s.charAt(0)+e.doc.lineSeparator()+o.charAt(o.length-1),Fo(r.line-1,o.length-1),Fo(r.line,1),"+transpose")}i.push(new ut(r,r))}e.setSelections(i)})},newlineAndIndent:function(e){Ni(e,function(){for(var t=e.listSelections().length,i=0;t>i;i++){var n=e.listSelections()[i];e.replaceRange(e.doc.lineSeparator(),n.anchor,n.head,"+input"),e.indentLine(n.from().line+1,null,!0)}Fn(e)})},openLine:function(e){e.replaceSelection("\n","start")},toggleOverwrite:function(e){e.toggleOverwrite()}},ua=e.keyMap={};ua.basic={Left:"goCharLeft",Right:"goCharRight",Up:"goLineUp",Down:"goLineDown",End:"goLineEnd",Home:"goLineStartSmart",PageUp:"goPageUp",PageDown:"goPageDown",Delete:"delCharAfter",Backspace:"delCharBefore","Shift-Backspace":"delCharBefore",Tab:"defaultTab","Shift-Tab":"indentAuto",Enter:"newlineAndIndent",Insert:"toggleOverwrite",Esc:"singleSelection"},ua.pcDefault={"Ctrl-A":"selectAll","Ctrl-D":"deleteLine","Ctrl-Z":"undo","Shift-Ctrl-Z":"redo","Ctrl-Y":"redo","Ctrl-Home":"goDocStart","Ctrl-End":"goDocEnd","Ctrl-Up":"goLineUp","Ctrl-Down":"goLineDown","Ctrl-Left":"goGroupLeft","Ctrl-Right":"goGroupRight","Alt-Left":"goLineStart","Alt-Right":"goLineEnd","Ctrl-Backspace":"delGroupBefore","Ctrl-Delete":"delGroupAfter","Ctrl-S":"save","Ctrl-F":"find","Ctrl-G":"findNext","Shift-Ctrl-G":"findPrev","Shift-Ctrl-F":"replace","Shift-Ctrl-R":"replaceAll","Ctrl-[":"indentLess","Ctrl-]":"indentMore","Ctrl-U":"undoSelection","Shift-Ctrl-U":"redoSelection","Alt-U":"redoSelection",fallthrough:"basic"},ua.emacsy={"Ctrl-F":"goCharRight","Ctrl-B":"goCharLeft","Ctrl-P":"goLineUp","Ctrl-N":"goLineDown","Alt-F":"goWordRight","Alt-B":"goWordLeft","Ctrl-A":"goLineStart","Ctrl-E":"goLineEnd","Ctrl-V":"goPageDown","Shift-Ctrl-V":"goPageUp","Ctrl-D":"delCharAfter","Ctrl-H":"delCharBefore","Alt-D":"delWordAfter","Alt-Backspace":"delWordBefore","Ctrl-K":"killLine","Ctrl-T":"transposeChars","Ctrl-O":"openLine"},ua.macDefault={"Cmd-A":"selectAll","Cmd-D":"deleteLine","Cmd-Z":"undo","Shift-Cmd-Z":"redo","Cmd-Y":"redo","Cmd-Home":"goDocStart","Cmd-Up":"goDocStart","Cmd-End":"goDocEnd","Cmd-Down":"goDocEnd","Alt-Left":"goGroupLeft","Alt-Right":"goGroupRight","Cmd-Left":"goLineLeft","Cmd-Right":"goLineRight","Alt-Backspace":"delGroupBefore","Ctrl-Alt-Backspace":"delGroupAfter","Alt-Delete":"delGroupAfter","Cmd-S":"save","Cmd-F":"find","Cmd-G":"findNext","Shift-Cmd-G":"findPrev","Cmd-Alt-F":"replace","Shift-Cmd-Alt-F":"replaceAll","Cmd-[":"indentLess","Cmd-]":"indentMore","Cmd-Backspace":"delWrappedLineLeft","Cmd-Delete":"delWrappedLineRight","Cmd-U":"undoSelection","Shift-Cmd-U":"redoSelection","Ctrl-Up":"goDocStart","Ctrl-Down":"goDocEnd",fallthrough:["basic","emacsy"]},ua["default"]=Eo?ua.macDefault:ua.pcDefault,e.normalizeKeyMap=function(e){var t={};for(var i in e)if(e.hasOwnProperty(i)){var n=e[i];if(/^(name|fallthrough|(de|at)tach)$/.test(i))continue;if("..."==n){delete e[i];continue}for(var r=Ls(i.split(" "),Un),s=0;s<r.length;s++){var o,a;s==r.length-1?(a=r.join(" "),o=n):(a=r.slice(0,s+1).join(" "),o="...");var l=t[a];if(l){if(l!=o)throw new Error("Inconsistent bindings for "+a)}else t[a]=o}delete e[i]}for(var c in t)e[c]=t[c];return e};var ha=e.lookupKey=function(e,t,i,n){t=Xn(t);var r=t.call?t.call(e,n):t[e];if(r===!1)return"nothing";if("..."===r)return"multi";if(null!=r&&i(r))return"handled";
if(t.fallthrough){if("[object Array]"!=Object.prototype.toString.call(t.fallthrough))return ha(e,t.fallthrough,i,n);for(var s=0;s<t.fallthrough.length;s++){var o=ha(e,t.fallthrough[s],i,n);if(o)return o}}},pa=e.isModifierKey=function(e){var t="string"==typeof e?e:sl[e.keyCode];return"Ctrl"==t||"Alt"==t||"Shift"==t||"Mod"==t},fa=e.keyName=function(e,t){if(xo&&34==e.keyCode&&e["char"])return!1;var i=sl[e.keyCode],n=i;return null==n||e.altGraphKey?!1:(e.altKey&&"Alt"!=i&&(n="Alt-"+n),(Lo?e.metaKey:e.ctrlKey)&&"Ctrl"!=i&&(n="Ctrl-"+n),(Lo?e.ctrlKey:e.metaKey)&&"Cmd"!=i&&(n="Cmd-"+n),!t&&e.shiftKey&&"Shift"!=i&&(n="Shift-"+n),n)};e.fromTextArea=function(t,i){function n(){t.value=c.getValue()}if(i=i?Ps(i):{},i.value=t.value,!i.tabindex&&t.tabIndex&&(i.tabindex=t.tabIndex),!i.placeholder&&t.placeholder&&(i.placeholder=t.placeholder),null==i.autofocus){var r=Qs();i.autofocus=r==t||null!=t.getAttribute("autofocus")&&r==document.body}if(t.form&&(Ea(t.form,"submit",n),!i.leaveSubmitMethodAlone)){var s=t.form,o=s.submit;try{var a=s.submit=function(){n(),s.submit=o,s.submit(),s.submit=a}}catch(l){}}i.finishInit=function(e){e.save=n,e.getTextArea=function(){return t},e.toTextArea=function(){e.toTextArea=isNaN,n(),t.parentNode.removeChild(e.getWrapperElement()),t.style.display="",t.form&&(Oa(t.form,"submit",n),"function"==typeof t.form.submit&&(t.form.submit=o))}},t.style.display="none";var c=e(function(e){t.parentNode.insertBefore(e,t.nextSibling)},i);return c};var ma=e.StringStream=function(e,t){this.pos=this.start=0,this.string=e,this.tabSize=t||8,this.lastColumnPos=this.lastColumnValue=0,this.lineStart=0};ma.prototype={eol:function(){return this.pos>=this.string.length},sol:function(){return this.pos==this.lineStart},peek:function(){return this.string.charAt(this.pos)||void 0},next:function(){return this.pos<this.string.length?this.string.charAt(this.pos++):void 0},eat:function(e){var t=this.string.charAt(this.pos);if("string"==typeof e)var i=t==e;else var i=t&&(e.test?e.test(t):e(t));return i?(++this.pos,t):void 0},eatWhile:function(e){for(var t=this.pos;this.eat(e););return this.pos>t},eatSpace:function(){for(var e=this.pos;/[\s\u00a0]/.test(this.string.charAt(this.pos));)++this.pos;return this.pos>e},skipToEnd:function(){this.pos=this.string.length},skipTo:function(e){var t=this.string.indexOf(e,this.pos);return t>-1?(this.pos=t,!0):void 0},backUp:function(e){this.pos-=e},column:function(){return this.lastColumnPos<this.start&&(this.lastColumnValue=$a(this.string,this.start,this.tabSize,this.lastColumnPos,this.lastColumnValue),this.lastColumnPos=this.start),this.lastColumnValue-(this.lineStart?$a(this.string,this.lineStart,this.tabSize):0)},indentation:function(){return $a(this.string,null,this.tabSize)-(this.lineStart?$a(this.string,this.lineStart,this.tabSize):0)},match:function(e,t,i){if("string"!=typeof e){var n=this.string.slice(this.pos).match(e);return n&&n.index>0?null:(n&&t!==!1&&(this.pos+=n[0].length),n)}var r=function(e){return i?e.toLowerCase():e},s=this.string.substr(this.pos,e.length);return r(s)==r(e)?(t!==!1&&(this.pos+=e.length),!0):void 0},current:function(){return this.string.slice(this.start,this.pos)},hideFirstChars:function(e,t){this.lineStart+=e;try{return t()}finally{this.lineStart-=e}}};var ga=0,va=e.TextMarker=function(e,t){this.lines=[],this.type=t,this.doc=e,this.id=++ga};Ns(va),va.prototype.clear=function(){if(!this.explicitlyCleared){var e=this.doc.cm,t=e&&!e.curOp;if(t&&bi(e),Ms(this,"clear")){var i=this.find();i&&xs(this,"clear",i.from,i.to)}for(var n=null,r=null,s=0;s<this.lines.length;++s){var o=this.lines[s],a=er(o.markedSpans,this);e&&!this.collapsed?ji(e,ts(o),"text"):e&&(null!=a.to&&(r=ts(o)),null!=a.from&&(n=ts(o))),o.markedSpans=tr(o.markedSpans,a),null==a.from&&this.collapsed&&!kr(this.doc,o)&&e&&es(o,_i(e.display))}if(e&&this.collapsed&&!e.options.lineWrapping)for(var s=0;s<this.lines.length;++s){var l=_r(this.lines[s]),c=u(l);c>e.display.maxLineLength&&(e.display.maxLine=l,e.display.maxLineLength=c,e.display.maxLineChanged=!0)}null!=n&&e&&this.collapsed&&Ii(e,n,r+1),this.lines.length=0,this.explicitlyCleared=!0,this.atomic&&this.doc.cantEdit&&(this.doc.cantEdit=!1,e&&Nt(e.doc)),e&&xs(e,"markerCleared",e,this),t&&ki(e),this.parent&&this.parent.clear()}},va.prototype.find=function(e,t){null==e&&"bookmark"==this.type&&(e=1);for(var i,n,r=0;r<this.lines.length;++r){var s=this.lines[r],o=er(s.markedSpans,this);if(null!=o.from&&(i=Fo(t?s:ts(s),o.from),-1==e))return i;if(null!=o.to&&(n=Fo(t?s:ts(s),o.to),1==e))return n}return i&&{from:i,to:n}},va.prototype.changed=function(){var e=this.find(-1,!0),t=this,i=this.doc.cm;e&&i&&Ni(i,function(){var n=e.line,r=ts(e.line),s=Zt(i,r);if(s&&(si(s),i.curOp.selectionChanged=i.curOp.forceUpdate=!0),i.curOp.updateMaxLine=!0,!kr(t.doc,n)&&null!=t.height){var o=t.height;t.height=null;var a=Ar(t)-o;a&&es(n,n.height+a)}})},va.prototype.attachLine=function(e){if(!this.lines.length&&this.doc.cm){var t=this.doc.cm.curOp;t.maybeHiddenMarkers&&-1!=Rs(t.maybeHiddenMarkers,this)||(t.maybeUnhiddenMarkers||(t.maybeUnhiddenMarkers=[])).push(this)}this.lines.push(e)},va.prototype.detachLine=function(e){if(this.lines.splice(Rs(this.lines,e),1),!this.lines.length&&this.doc.cm){var t=this.doc.cm.curOp;(t.maybeHiddenMarkers||(t.maybeHiddenMarkers=[])).push(this)}};var ga=0,_a=e.SharedTextMarker=function(e,t){this.markers=e,this.primary=t;for(var i=0;i<e.length;++i)e[i].parent=this};Ns(_a),_a.prototype.clear=function(){if(!this.explicitlyCleared){this.explicitlyCleared=!0;for(var e=0;e<this.markers.length;++e)this.markers[e].clear();xs(this,"clear")}},_a.prototype.find=function(e,t){return this.primary.find(e,t)};var ya=e.LineWidget=function(e,t,i){if(i)for(var n in i)i.hasOwnProperty(n)&&(this[n]=i[n]);this.doc=e,this.node=t};Ns(ya),ya.prototype.clear=function(){var e=this.doc.cm,t=this.line.widgets,i=this.line,n=ts(i);if(null!=n&&t){for(var r=0;r<t.length;++r)t[r]==this&&t.splice(r--,1);t.length||(i.widgets=null);var s=Ar(this);es(i,Math.max(0,i.height-s)),e&&Ni(e,function(){xr(e,i,-s),ji(e,n,"widget")})}},ya.prototype.changed=function(){var e=this.height,t=this.doc.cm,i=this.line;this.height=null;var n=Ar(this)-e;n&&(es(i,i.height+n),t&&Ni(t,function(){t.curOp.forceUpdate=!0,xr(t,i,n)}))};var ba=e.Line=function(e,t,i){this.text=e,dr(this,t),this.height=i?i(this):1};Ns(ba),ba.prototype.lineNo=function(){return ts(this)};var wa={},ka={};Xr.prototype={chunkSize:function(){return this.lines.length},removeInner:function(e,t){for(var i=e,n=e+t;n>i;++i){var r=this.lines[i];this.height-=r.height,Mr(r),xs(r,"delete")}this.lines.splice(e,t)},collapse:function(e){e.push.apply(e,this.lines)},insertInner:function(e,t,i){this.height+=i,this.lines=this.lines.slice(0,e).concat(t).concat(this.lines.slice(e));for(var n=0;n<t.length;++n)t[n].parent=this},iterN:function(e,t,i){for(var n=e+t;n>e;++e)if(i(this.lines[e]))return!0}},Vr.prototype={chunkSize:function(){return this.size},removeInner:function(e,t){this.size-=t;for(var i=0;i<this.children.length;++i){var n=this.children[i],r=n.chunkSize();if(r>e){var s=Math.min(t,r-e),o=n.height;if(n.removeInner(e,s),this.height-=o-n.height,r==s&&(this.children.splice(i--,1),n.parent=null),0==(t-=s))break;e=0}else e-=r}if(this.size-t<25&&(this.children.length>1||!(this.children[0]instanceof Xr))){var a=[];this.collapse(a),this.children=[new Xr(a)],this.children[0].parent=this}},collapse:function(e){for(var t=0;t<this.children.length;++t)this.children[t].collapse(e)},insertInner:function(e,t,i){this.size+=t.length,this.height+=i;for(var n=0;n<this.children.length;++n){var r=this.children[n],s=r.chunkSize();if(s>=e){if(r.insertInner(e,t,i),r.lines&&r.lines.length>50){for(var o=r.lines.length%25+25,a=o;a<r.lines.length;){var l=new Xr(r.lines.slice(a,a+=25));r.height-=l.height,this.children.splice(++n,0,l),l.parent=this}r.lines=r.lines.slice(0,o),this.maybeSpill()}break}e-=s}},maybeSpill:function(){if(!(this.children.length<=10)){var e=this;do{var t=e.children.splice(e.children.length-5,5),i=new Vr(t);if(e.parent){e.size-=i.size,e.height-=i.height;var n=Rs(e.parent.children,e);e.parent.children.splice(n+1,0,i)}else{var r=new Vr(e.children);r.parent=e,e.children=[r,i],e=r}i.parent=e.parent}while(e.children.length>10);e.parent.maybeSpill()}},iterN:function(e,t,i){for(var n=0;n<this.children.length;++n){var r=this.children[n],s=r.chunkSize();if(s>e){var o=Math.min(t,s-e);if(r.iterN(e,o,i))return!0;if(0==(t-=o))break;e=0}else e-=s}}};var Ca=0,xa=e.Doc=function(e,t,i,n){if(!(this instanceof xa))return new xa(e,t,i,n);null==i&&(i=0),Vr.call(this,[new Xr([new ba("",null)])]),this.first=i,this.scrollTop=this.scrollLeft=0,this.cantEdit=!1,this.cleanGeneration=1,this.frontier=i;var r=Fo(i,0);this.sel=pt(r),this.history=new ss(null),this.id=++Ca,this.modeOption=t,this.lineSep=n,this.extend=!1,"string"==typeof e&&(e=this.splitLines(e)),Ur(this,{from:r,to:r,text:e}),Tt(this,pt(r),Pa)};xa.prototype=js(Vr.prototype,{constructor:xa,iter:function(e,t,i){i?this.iterN(e-this.first,t-e,i):this.iterN(this.first,this.first+this.size,e)},insert:function(e,t){for(var i=0,n=0;n<t.length;++n)i+=t[n].height;this.insertInner(e-this.first,t,i)},remove:function(e,t){this.removeInner(e-this.first,t)},getValue:function(e){var t=Zr(this,this.first,this.first+this.size);return e===!1?t:t.join(e||this.lineSeparator())},setValue:Oi(function(e){var t=Fo(this.first,0),i=this.first+this.size-1;Tn(this,{from:t,to:Fo(i,Kr(this,i).text.length),text:this.splitLines(e),origin:"setValue",full:!0},!0),Tt(this,pt(t))}),replaceRange:function(e,t,i,n){t=mt(this,t),i=i?mt(this,i):t,On(this,e,t,i,n)},getRange:function(e,t,i){var n=Jr(this,mt(this,e),mt(this,t));return i===!1?n:n.join(i||this.lineSeparator())},getLine:function(e){var t=this.getLineHandle(e);return t&&t.text},getLineHandle:function(e){return vt(this,e)?Kr(this,e):void 0},getLineNumber:function(e){return ts(e)},getLineHandleVisualStart:function(e){return"number"==typeof e&&(e=Kr(this,e)),_r(e)},lineCount:function(){return this.size},firstLine:function(){return this.first},lastLine:function(){return this.first+this.size-1},clipPos:function(e){return mt(this,e)},getCursor:function(e){var t,i=this.sel.primary();return t=null==e||"head"==e?i.head:"anchor"==e?i.anchor:"end"==e||"to"==e||e===!1?i.to():i.from()},listSelections:function(){return this.sel.ranges},somethingSelected:function(){return this.sel.somethingSelected()},setCursor:Oi(function(e,t,i){Ct(this,mt(this,"number"==typeof e?Fo(e,t||0):e),null,i)}),setSelection:Oi(function(e,t,i){Ct(this,mt(this,e),mt(this,t||e),i)}),extendSelection:Oi(function(e,t,i){bt(this,mt(this,e),t&&mt(this,t),i)}),extendSelections:Oi(function(e,t){wt(this,_t(this,e),t)}),extendSelectionsBy:Oi(function(e,t){var i=Ls(this.sel.ranges,e);wt(this,_t(this,i),t)}),setSelections:Oi(function(e,t,i){if(e.length){for(var n=0,r=[];n<e.length;n++)r[n]=new ut(mt(this,e[n].anchor),mt(this,e[n].head));null==t&&(t=Math.min(e.length-1,this.sel.primIndex)),Tt(this,ht(r,t),i)}}),addSelection:Oi(function(e,t,i){var n=this.sel.ranges.slice(0);n.push(new ut(mt(this,e),mt(this,t||e))),Tt(this,ht(n,n.length-1),i)}),getSelection:function(e){for(var t,i=this.sel.ranges,n=0;n<i.length;n++){var r=Jr(this,i[n].from(),i[n].to());t=t?t.concat(r):r}return e===!1?t:t.join(e||this.lineSeparator())},getSelections:function(e){for(var t=[],i=this.sel.ranges,n=0;n<i.length;n++){var r=Jr(this,i[n].from(),i[n].to());e!==!1&&(r=r.join(e||this.lineSeparator())),t[n]=r}return t},replaceSelection:function(e,t,i){for(var n=[],r=0;r<this.sel.ranges.length;r++)n[r]=e;this.replaceSelections(n,t,i||"+input")},replaceSelections:Oi(function(e,t,i){for(var n=[],r=this.sel,s=0;s<r.ranges.length;s++){var o=r.ranges[s];n[s]={from:o.from(),to:o.to(),text:this.splitLines(e[s]),origin:i}}for(var a=t&&"end"!=t&&xn(this,n,t),s=n.length-1;s>=0;s--)Tn(this,n[s]);a?At(this,a):this.cm&&Fn(this.cm)}),undo:Oi(function(){Mn(this,"undo")}),redo:Oi(function(){Mn(this,"redo")}),undoSelection:Oi(function(){Mn(this,"undo",!0)}),redoSelection:Oi(function(){Mn(this,"redo",!0)}),setExtending:function(e){this.extend=e},getExtending:function(){return this.extend},historySize:function(){for(var e=this.history,t=0,i=0,n=0;n<e.done.length;n++)e.done[n].ranges||++t;for(var n=0;n<e.undone.length;n++)e.undone[n].ranges||++i;return{undo:t,redo:i}},clearHistory:function(){this.history=new ss(this.history.maxGeneration)},markClean:function(){this.cleanGeneration=this.changeGeneration(!0)},changeGeneration:function(e){return e&&(this.history.lastOp=this.history.lastSelOp=this.history.lastOrigin=null),this.history.generation},isClean:function(e){return this.history.generation==(e||this.cleanGeneration)},getHistory:function(){return{done:gs(this.history.done),undone:gs(this.history.undone)}},setHistory:function(e){var t=this.history=new ss(this.history.maxGeneration);t.done=gs(e.done.slice(0),null,!0),t.undone=gs(e.undone.slice(0),null,!0)},addLineClass:Oi(function(e,t,i){return Hn(this,e,"gutter"==t?"gutter":"class",function(e){var n="text"==t?"textClass":"background"==t?"bgClass":"gutter"==t?"gutterClass":"wrapClass";if(e[n]){if(Us(i).test(e[n]))return!1;e[n]+=" "+i}else e[n]=i;return!0})}),removeLineClass:Oi(function(e,t,i){return Hn(this,e,"gutter"==t?"gutter":"class",function(e){var n="text"==t?"textClass":"background"==t?"bgClass":"gutter"==t?"gutterClass":"wrapClass",r=e[n];if(!r)return!1;if(null==i)e[n]=null;else{var s=r.match(Us(i));if(!s)return!1;var o=s.index+s[0].length;e[n]=r.slice(0,s.index)+(s.index&&o!=r.length?" ":"")+r.slice(o)||null}return!0})}),addLineWidget:Oi(function(e,t,i){return Tr(this,e,t,i)}),removeLineWidget:function(e){e.clear()},markText:function(e,t,i){return Vn(this,mt(this,e),mt(this,t),i,i&&i.type||"range")},setBookmark:function(e,t){var i={replacedWith:t&&(null==t.nodeType?t.widget:t),insertLeft:t&&t.insertLeft,clearWhenEmpty:!1,shared:t&&t.shared,handleMouseEvents:t&&t.handleMouseEvents};return e=mt(this,e),Vn(this,e,e,i,"bookmark")},findMarksAt:function(e){e=mt(this,e);var t=[],i=Kr(this,e.line).markedSpans;if(i)for(var n=0;n<i.length;++n){var r=i[n];(null==r.from||r.from<=e.ch)&&(null==r.to||r.to>=e.ch)&&t.push(r.marker.parent||r.marker)}return t},findMarks:function(e,t,i){e=mt(this,e),t=mt(this,t);var n=[],r=e.line;return this.iter(e.line,t.line+1,function(s){var o=s.markedSpans;if(o)for(var a=0;a<o.length;a++){var l=o[a];null!=l.to&&r==e.line&&e.ch>=l.to||null==l.from&&r!=e.line||null!=l.from&&r==t.line&&l.from>=t.ch||i&&!i(l.marker)||n.push(l.marker.parent||l.marker)}++r}),n},getAllMarks:function(){var e=[];return this.iter(function(t){var i=t.markedSpans;if(i)for(var n=0;n<i.length;++n)null!=i[n].from&&e.push(i[n].marker)}),e},posFromIndex:function(e){var t,i=this.first,n=this.lineSeparator().length;return this.iter(function(r){var s=r.text.length+n;return s>e?(t=e,!0):(e-=s,++i,void 0)}),mt(this,Fo(i,t))},indexFromPos:function(e){e=mt(this,e);var t=e.ch;if(e.line<this.first||e.ch<0)return 0;var i=this.lineSeparator().length;return this.iter(this.first,e.line,function(e){t+=e.text.length+i}),t},copy:function(e){var t=new xa(Zr(this,this.first,this.first+this.size),this.modeOption,this.first,this.lineSep);return t.scrollTop=this.scrollTop,t.scrollLeft=this.scrollLeft,t.sel=this.sel,t.extend=!1,e&&(t.history.undoDepth=this.history.undoDepth,t.setHistory(this.getHistory())),t},linkedDoc:function(e){e||(e={});var t=this.first,i=this.first+this.size;null!=e.from&&e.from>t&&(t=e.from),null!=e.to&&e.to<i&&(i=e.to);var n=new xa(Zr(this,t,i),e.mode||this.modeOption,t,this.lineSep);return e.sharedHist&&(n.history=this.history),(this.linked||(this.linked=[])).push({doc:n,sharedHist:e.sharedHist}),n.linked=[{doc:this,isParent:!0,sharedHist:e.sharedHist}],Kn(n,Yn(this)),n},unlinkDoc:function(t){if(t instanceof e&&(t=t.doc),this.linked)for(var i=0;i<this.linked.length;++i){var n=this.linked[i];if(n.doc==t){this.linked.splice(i,1),t.unlinkDoc(this),Jn(Yn(this));break}}if(t.history==this.history){var r=[t.id];Gr(t,function(e){r.push(e.id)},!0),t.history=new ss(null),t.history.done=gs(this.history.done,r),t.history.undone=gs(this.history.undone,r)}},iterLinkedDocs:function(e){Gr(this,e)},getMode:function(){return this.mode},getEditor:function(){return this.cm},splitLines:function(e){return this.lineSep?e.split(this.lineSep):tl(e)},lineSeparator:function(){return this.lineSep||"\n"}}),xa.prototype.eachLine=xa.prototype.iter;var Aa="iter insert remove copy getEditor constructor".split(" ");for(var Ta in xa.prototype)xa.prototype.hasOwnProperty(Ta)&&Rs(Aa,Ta)<0&&(e.prototype[Ta]=function(e){return function(){return e.apply(this.doc,arguments)}}(xa.prototype[Ta]));Ns(xa);var Sa=e.e_preventDefault=function(e){e.preventDefault?e.preventDefault():e.returnValue=!1},Ma=e.e_stopPropagation=function(e){e.stopPropagation?e.stopPropagation():e.cancelBubble=!0},Na=e.e_stop=function(e){Sa(e),Ma(e)},Ea=e.on=function(e,t,i){if(e.addEventListener)e.addEventListener(t,i,!1);else if(e.attachEvent)e.attachEvent("on"+t,i);else{var n=e._handlers||(e._handlers={}),r=n[t]||(n[t]=[]);r.push(i)}},Da=[],Oa=e.off=function(e,t,i){if(e.removeEventListener)e.removeEventListener(t,i,!1);else if(e.detachEvent)e.detachEvent("on"+t,i);else for(var n=Cs(e,t,!1),r=0;r<n.length;++r)if(n[r]==i){n.splice(r,1);break}},Ra=e.signal=function(e,t){var i=Cs(e,t,!0);if(i.length)for(var n=Array.prototype.slice.call(arguments,2),r=0;r<i.length;++r)i[r].apply(null,n)},La=null,Ia=30,ja=e.Pass={toString:function(){return"CodeMirror.Pass"}},Pa={scroll:!1},Fa={origin:"*mouse"},za={origin:"+move"};Es.prototype.set=function(e,t){clearTimeout(this.id),this.id=setTimeout(t,e)};var $a=e.countColumn=function(e,t,i,n,r){null==t&&(t=e.search(/[^\s\u00a0]/),-1==t&&(t=e.length));for(var s=n||0,o=r||0;;){var a=e.indexOf("	",s);if(0>a||a>=t)return o+(t-s);o+=a-s,o+=i-o%i,s=a+1}},Ha=e.findColumn=function(e,t,i){for(var n=0,r=0;;){var s=e.indexOf("	",n);-1==s&&(s=e.length);var o=s-n;if(s==e.length||r+o>=t)return n+Math.min(o,t-r);if(r+=s-n,r+=i-r%i,n=s+1,r>=t)return n}},Ba=[""],Wa=function(e){e.select()};Mo?Wa=function(e){e.selectionStart=0,e.selectionEnd=e.value.length}:yo&&(Wa=function(e){try{e.select()}catch(t){}});var qa,Qa=/[\u00df\u0587\u0590-\u05f4\u0600-\u06ff\u3040-\u309f\u30a0-\u30ff\u3400-\u4db5\u4e00-\u9fcc\uac00-\ud7af]/,Ua=e.isWordChar=function(e){return/\w/.test(e)||e>""&&(e.toUpperCase()!=e.toLowerCase()||Qa.test(e))},Xa=/[\u0300-\u036f\u0483-\u0489\u0591-\u05bd\u05bf\u05c1\u05c2\u05c4\u05c5\u05c7\u0610-\u061a\u064b-\u065e\u0670\u06d6-\u06dc\u06de-\u06e4\u06e7\u06e8\u06ea-\u06ed\u0711\u0730-\u074a\u07a6-\u07b0\u07eb-\u07f3\u0816-\u0819\u081b-\u0823\u0825-\u0827\u0829-\u082d\u0900-\u0902\u093c\u0941-\u0948\u094d\u0951-\u0955\u0962\u0963\u0981\u09bc\u09be\u09c1-\u09c4\u09cd\u09d7\u09e2\u09e3\u0a01\u0a02\u0a3c\u0a41\u0a42\u0a47\u0a48\u0a4b-\u0a4d\u0a51\u0a70\u0a71\u0a75\u0a81\u0a82\u0abc\u0ac1-\u0ac5\u0ac7\u0ac8\u0acd\u0ae2\u0ae3\u0b01\u0b3c\u0b3e\u0b3f\u0b41-\u0b44\u0b4d\u0b56\u0b57\u0b62\u0b63\u0b82\u0bbe\u0bc0\u0bcd\u0bd7\u0c3e-\u0c40\u0c46-\u0c48\u0c4a-\u0c4d\u0c55\u0c56\u0c62\u0c63\u0cbc\u0cbf\u0cc2\u0cc6\u0ccc\u0ccd\u0cd5\u0cd6\u0ce2\u0ce3\u0d3e\u0d41-\u0d44\u0d4d\u0d57\u0d62\u0d63\u0dca\u0dcf\u0dd2-\u0dd4\u0dd6\u0ddf\u0e31\u0e34-\u0e3a\u0e47-\u0e4e\u0eb1\u0eb4-\u0eb9\u0ebb\u0ebc\u0ec8-\u0ecd\u0f18\u0f19\u0f35\u0f37\u0f39\u0f71-\u0f7e\u0f80-\u0f84\u0f86\u0f87\u0f90-\u0f97\u0f99-\u0fbc\u0fc6\u102d-\u1030\u1032-\u1037\u1039\u103a\u103d\u103e\u1058\u1059\u105e-\u1060\u1071-\u1074\u1082\u1085\u1086\u108d\u109d\u135f\u1712-\u1714\u1732-\u1734\u1752\u1753\u1772\u1773\u17b7-\u17bd\u17c6\u17c9-\u17d3\u17dd\u180b-\u180d\u18a9\u1920-\u1922\u1927\u1928\u1932\u1939-\u193b\u1a17\u1a18\u1a56\u1a58-\u1a5e\u1a60\u1a62\u1a65-\u1a6c\u1a73-\u1a7c\u1a7f\u1b00-\u1b03\u1b34\u1b36-\u1b3a\u1b3c\u1b42\u1b6b-\u1b73\u1b80\u1b81\u1ba2-\u1ba5\u1ba8\u1ba9\u1c2c-\u1c33\u1c36\u1c37\u1cd0-\u1cd2\u1cd4-\u1ce0\u1ce2-\u1ce8\u1ced\u1dc0-\u1de6\u1dfd-\u1dff\u200c\u200d\u20d0-\u20f0\u2cef-\u2cf1\u2de0-\u2dff\u302a-\u302f\u3099\u309a\ua66f-\ua672\ua67c\ua67d\ua6f0\ua6f1\ua802\ua806\ua80b\ua825\ua826\ua8c4\ua8e0-\ua8f1\ua926-\ua92d\ua947-\ua951\ua980-\ua982\ua9b3\ua9b6-\ua9b9\ua9bc\uaa29-\uaa2e\uaa31\uaa32\uaa35\uaa36\uaa43\uaa4c\uaab0\uaab2-\uaab4\uaab7\uaab8\uaabe\uaabf\uaac1\uabe5\uabe8\uabed\udc00-\udfff\ufb1e\ufe00-\ufe0f\ufe20-\ufe26\uff9e\uff9f]/;qa=document.createRange?function(e,t,i,n){var r=document.createRange();return r.setEnd(n||e,i),r.setStart(e,t),r}:function(e,t,i){var n=document.body.createTextRange();try{n.moveToElementText(e.parentNode)}catch(r){return n}return n.collapse(!0),n.moveEnd("character",i),n.moveStart("character",t),n};var Va=e.contains=function(e,t){if(3==t.nodeType&&(t=t.parentNode),e.contains)return e.contains(t);do if(11==t.nodeType&&(t=t.host),t==e)return!0;while(t=t.parentNode)};yo&&11>bo&&(Qs=function(){try{return document.activeElement}catch(e){return document.body}});var Ga,Ya,Ka=e.rmClass=function(e,t){var i=e.className,n=Us(t).exec(i);if(n){var r=i.slice(n.index+n[0].length);e.className=i.slice(0,n.index)+(r?n[1]+r:"")}},Ja=e.addClass=function(e,t){var i=e.className;Us(t).test(i)||(e.className+=(i?" ":"")+t)},Za=!1,el=function(){if(yo&&9>bo)return!1;var e=Bs("div");return"draggable"in e||"dragDrop"in e}(),tl=e.splitLines=3!="\n\nb".split(/\n/).length?function(e){for(var t=0,i=[],n=e.length;n>=t;){var r=e.indexOf("\n",t);-1==r&&(r=e.length);var s=e.slice(t,"\r"==e.charAt(r-1)?r-1:r),o=s.indexOf("\r");-1!=o?(i.push(s.slice(0,o)),t+=o+1):(i.push(s),t=r+1)}return i}:function(e){return e.split(/\r\n?|\n/)},il=window.getSelection?function(e){try{return e.selectionStart!=e.selectionEnd}catch(t){return!1}}:function(e){try{var t=e.ownerDocument.selection.createRange()}catch(i){}return t&&t.parentElement()==e?0!=t.compareEndPoints("StartToEnd",t):!1},nl=function(){var e=Bs("div");return"oncopy"in e?!0:(e.setAttribute("oncopy","return;"),"function"==typeof e.oncopy)}(),rl=null,sl=e.keyNames={3:"Enter",8:"Backspace",9:"Tab",13:"Enter",16:"Shift",17:"Ctrl",18:"Alt",19:"Pause",20:"CapsLock",27:"Esc",32:"Space",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"Left",38:"Up",39:"Right",40:"Down",44:"PrintScrn",45:"Insert",46:"Delete",59:";",61:"=",91:"Mod",92:"Mod",93:"Mod",106:"*",107:"=",109:"-",110:".",111:"/",127:"Delete",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'",63232:"Up",63233:"Down",63234:"Left",63235:"Right",63272:"Delete",63273:"Home",63275:"End",63276:"PageUp",63277:"PageDown",63302:"Insert"};!function(){for(var e=0;10>e;e++)sl[e+48]=sl[e+96]=String(e);for(var e=65;90>=e;e++)sl[e]=String.fromCharCode(e);for(var e=1;12>=e;e++)sl[e+111]=sl[e+63235]="F"+e}();var ol,al=function(){function e(e){return 247>=e?i.charAt(e):e>=1424&&1524>=e?"R":e>=1536&&1773>=e?n.charAt(e-1536):e>=1774&&2220>=e?"r":e>=8192&&8203>=e?"w":8204==e?"b":"L"}function t(e,t,i){this.level=e,this.from=t,this.to=i}var i="bbbbbbbbbtstwsbbbbbbbbbbbbbbssstwNN%%%NNNNNN,N,N1111111111NNNNNNNLLLLLLLLLLLLLLLLLLLLLLLLLLNNNNNNLLLLLLLLLLLLLLLLLLLLLLLLLLNNNNbbbbbbsbbbbbbbbbbbbbbbbbbbbbbbbbb,N%%%%NNNNLNNNNN%%11NLNNN1LNNNNNLLLLLLLLLLLLLLLLLLLLLLLNLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLN",n="rrrrrrrrrrrr,rNNmmmmmmrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrmmmmmmmmmmmmmmrrrrrrrnnnnnnnnnn%nnrrrmrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrmmmmmmmmmmmmmmmmmmmNmmmm",r=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac]/,s=/[stwN]/,o=/[LRr]/,a=/[Lb1n]/,l=/[1n]/,c="L";return function(i){if(!r.test(i))return!1;for(var n,d=i.length,u=[],h=0;d>h;++h)u.push(n=e(i.charCodeAt(h)));for(var h=0,p=c;d>h;++h){var n=u[h];"m"==n?u[h]=p:p=n}for(var h=0,f=c;d>h;++h){var n=u[h];"1"==n&&"r"==f?u[h]="n":o.test(n)&&(f=n,"r"==n&&(u[h]="R"))}for(var h=1,p=u[0];d-1>h;++h){var n=u[h];"+"==n&&"1"==p&&"1"==u[h+1]?u[h]="1":","!=n||p!=u[h+1]||"1"!=p&&"n"!=p||(u[h]=p),p=n}for(var h=0;d>h;++h){var n=u[h];if(","==n)u[h]="N";else if("%"==n){for(var m=h+1;d>m&&"%"==u[m];++m);for(var g=h&&"!"==u[h-1]||d>m&&"1"==u[m]?"1":"N",v=h;m>v;++v)u[v]=g;h=m-1}}for(var h=0,f=c;d>h;++h){var n=u[h];"L"==f&&"1"==n?u[h]="L":o.test(n)&&(f=n)}for(var h=0;d>h;++h)if(s.test(u[h])){for(var m=h+1;d>m&&s.test(u[m]);++m);for(var _="L"==(h?u[h-1]:c),y="L"==(d>m?u[m]:c),g=_||y?"L":"R",v=h;m>v;++v)u[v]=g;h=m-1}for(var b,w=[],h=0;d>h;)if(a.test(u[h])){var k=h;for(++h;d>h&&a.test(u[h]);++h);w.push(new t(0,k,h))}else{var C=h,x=w.length;for(++h;d>h&&"L"!=u[h];++h);for(var v=C;h>v;)if(l.test(u[v])){v>C&&w.splice(x,0,new t(1,C,v));var A=v;for(++v;h>v&&l.test(u[v]);++v);w.splice(x,0,new t(2,A,v)),C=v}else++v;h>C&&w.splice(x,0,new t(1,C,h))}return 1==w[0].level&&(b=i.match(/^\s+/))&&(w[0].from=b[0].length,w.unshift(new t(0,0,b[0].length))),1==Os(w).level&&(b=i.match(/\s+$/))&&(Os(w).to-=b[0].length,w.push(new t(0,d-b[0].length,d))),2==w[0].level&&w.unshift(new t(1,w[0].to,w[0].to)),w[0].level!=Os(w).level&&w.push(new t(w[0].level,d,d)),w}}();return e.version="5.16.2",e}),// CodeMirror, copyright (c) by Marijn Haverbeke and others
function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],e):e(CodeMirror)}(function(e){function t(e,t,i){var n,r=e.getWrapperElement();return n=r.appendChild(document.createElement("div")),n.className=i?"CodeMirror-dialog CodeMirror-dialog-bottom":"CodeMirror-dialog CodeMirror-dialog-top","string"==typeof t?n.innerHTML=t:n.appendChild(t),n}function i(e,t){e.state.currentNotificationClose&&e.state.currentNotificationClose(),e.state.currentNotificationClose=t}e.defineExtension("openDialog",function(n,r,s){function o(e){if("string"==typeof e)u.value=e;else{if(c)return;c=!0,l.parentNode.removeChild(l),d.focus(),s.onClose&&s.onClose(l)}}s||(s={}),i(this,null);var a,l=t(this,n,s.bottom),c=!1,d=this,u=l.getElementsByTagName("input")[0];return u?(u.focus(),s.value&&(u.value=s.value,s.selectValueOnOpen!==!1&&u.select()),s.onInput&&e.on(u,"input",function(e){s.onInput(e,u.value,o)}),s.onKeyUp&&e.on(u,"keyup",function(e){s.onKeyUp(e,u.value,o)}),e.on(u,"keydown",function(t){s&&s.onKeyDown&&s.onKeyDown(t,u.value,o)||((27==t.keyCode||s.closeOnEnter!==!1&&13==t.keyCode)&&(u.blur(),e.e_stop(t),o()),13==t.keyCode&&r(u.value,t))}),s.closeOnBlur!==!1&&e.on(u,"blur",o)):(a=l.getElementsByTagName("button")[0])&&(e.on(a,"click",function(){o(),d.focus()}),s.closeOnBlur!==!1&&e.on(a,"blur",o),a.focus()),o}),e.defineExtension("openConfirm",function(n,r,s){function o(){c||(c=!0,a.parentNode.removeChild(a),d.focus())}i(this,null);var a=t(this,n,s&&s.bottom),l=a.getElementsByTagName("button"),c=!1,d=this,u=1;l[0].focus();for(var h=0;h<l.length;++h){var p=l[h];!function(t){e.on(p,"click",function(i){e.e_preventDefault(i),o(),t&&t(d)})}(r[h]),e.on(p,"blur",function(){--u,setTimeout(function(){0>=u&&o()},200)}),e.on(p,"focus",function(){++u})}}),e.defineExtension("openNotification",function(n,r){function s(){l||(l=!0,clearTimeout(o),a.parentNode.removeChild(a))}i(this,s);var o,a=t(this,n,r&&r.bottom),l=!1,c=r&&"undefined"!=typeof r.duration?r.duration:5e3;return e.on(a,"click",function(t){e.e_preventDefault(t),s()}),c&&(o=setTimeout(s,c)),s})}),// CodeMirror, copyright (c) by Marijn Haverbeke and others
function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror"),require("./searchcursor"),require("../dialog/dialog")):"function"==typeof define&&define.amd?define(["../../lib/codemirror","./searchcursor","../dialog/dialog"],e):e(CodeMirror)}(function(e){"use strict";function t(e,t){return"string"==typeof e?e=new RegExp(e.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&"),t?"gi":"g"):e.global||(e=new RegExp(e.source,e.ignoreCase?"gi":"g")),{token:function(t){e.lastIndex=t.pos;var i=e.exec(t.string);return i&&i.index==t.pos?(t.pos+=i[0].length||1,"searching"):(i?t.pos=i.index:t.skipToEnd(),void 0)}}}function i(){this.posFrom=this.posTo=this.lastQuery=this.query=null,this.overlay=null}function n(e){return e.state.search||(e.state.search=new i)}function r(e){return"string"==typeof e&&e==e.toLowerCase()}function s(e,t,i){return e.getSearchCursor(t,i,r(t))}function o(e,t,i,n,r){e.openDialog(t,n,{value:i,selectValueOnOpen:!0,closeOnEnter:!1,onClose:function(){f(e)},onKeyDown:r})}function a(e,t,i,n,r){e.openDialog?e.openDialog(t,r,{value:n,selectValueOnOpen:!0}):r(prompt(i,n))}function l(e,t,i,n){e.openConfirm?e.openConfirm(t,n):confirm(i)&&n[0]()}function c(e){return e.replace(/\\(.)/g,function(e,t){return"n"==t?"\n":"r"==t?"\r":t})}function d(e){var t=e.match(/^\/(.*)\/([a-z]*)$/);if(t)try{e=new RegExp(t[1],-1==t[2].indexOf("i")?"":"i")}catch(i){}else e=c(e);return("string"==typeof e?""==e:e.test(""))&&(e=/x^/),e}function u(e,i,n){i.queryText=n,i.query=d(n),e.removeOverlay(i.overlay,r(i.query)),i.overlay=t(i.query,r(i.query)),e.addOverlay(i.overlay),e.showMatchesOnScrollbar&&(i.annotate&&(i.annotate.clear(),i.annotate=null),i.annotate=e.showMatchesOnScrollbar(i.query,r(i.query)))}function h(t,i,r,s){var l=n(t);if(l.query)return p(t,i);var c=t.getSelection()||l.lastQuery;if(r&&t.openDialog){var d=null,h=function(i,n){e.e_stop(n),i&&(i!=l.queryText&&(u(t,l,i),l.posFrom=l.posTo=t.getCursor()),d&&(d.style.opacity=1),p(t,n.shiftKey,function(e,i){var n;i.line<3&&document.querySelector&&(n=t.display.wrapper.querySelector(".CodeMirror-dialog"))&&n.getBoundingClientRect().bottom-4>t.cursorCoords(i,"window").top&&((d=n).style.opacity=.4)}))};o(t,v,c,h,function(i,r){var s=e.keyMap[t.getOption("keyMap")][e.keyName(i)];"findNext"==s||"findPrev"==s?(e.e_stop(i),u(t,n(t),r),t.execCommand(s)):("find"==s||"findPersistent"==s)&&(e.e_stop(i),h(r,i))}),s&&(u(t,l,c),p(t,i))}else a(t,v,"Search for:",c,function(e){e&&!l.query&&t.operation(function(){u(t,l,e),l.posFrom=l.posTo=t.getCursor(),p(t,i)})})}function p(t,i,r){t.operation(function(){var o=n(t),a=s(t,o.query,i?o.posFrom:o.posTo);(a.find(i)||(a=s(t,o.query,i?e.Pos(t.lastLine()):e.Pos(t.firstLine(),0)),a.find(i)))&&(t.setSelection(a.from(),a.to()),t.scrollIntoView({from:a.from(),to:a.to()},20),o.posFrom=a.from(),o.posTo=a.to(),r&&r(a.from(),a.to()))})}function f(e){e.operation(function(){var t=n(e);t.lastQuery=t.query,t.query&&(t.query=t.queryText=null,e.removeOverlay(t.overlay),t.annotate&&(t.annotate.clear(),t.annotate=null))})}function m(e,t,i){e.operation(function(){for(var n=s(e,t);n.findNext();)if("string"!=typeof t){var r=e.getRange(n.from(),n.to()).match(t);n.replace(i.replace(/\$(\d)/g,function(e,t){return r[t]}))}else n.replace(i)})}function g(e,t){if(!e.getOption("readOnly")){var i=e.getSelection()||n(e).lastQuery,r=t?"Replace all:":"Replace:";a(e,r+_,r,i,function(i){i&&(i=d(i),a(e,y,"Replace with:","",function(n){if(n=c(n),t)m(e,i,n);else{f(e);var r=s(e,i,e.getCursor("from")),o=function(){var t,c=r.from();!(t=r.findNext())&&(r=s(e,i),!(t=r.findNext())||c&&r.from().line==c.line&&r.from().ch==c.ch)||(e.setSelection(r.from(),r.to()),e.scrollIntoView({from:r.from(),to:r.to()}),l(e,b,"Replace?",[function(){a(t)},o,function(){m(e,i,n)}]))},a=function(e){r.replace("string"==typeof i?n:n.replace(/\$(\d)/g,function(t,i){return e[i]})),o()};o()}}))})}}var v='Search: <input type="text" style="width: 10em" class="CodeMirror-search-field"/> <span style="color: #888" class="CodeMirror-search-hint">(Use /re/ syntax for regexp search)</span>',_=' <input type="text" style="width: 10em" class="CodeMirror-search-field"/> <span style="color: #888" class="CodeMirror-search-hint">(Use /re/ syntax for regexp search)</span>',y='With: <input type="text" style="width: 10em" class="CodeMirror-search-field"/>',b="Replace? <button>Yes</button> <button>No</button> <button>All</button> <button>Stop</button>";e.commands.find=function(e){f(e),h(e)},e.commands.findPersistent=function(e){f(e),h(e,!1,!0)},e.commands.findPersistentNext=function(e){h(e,!1,!0,!0)},e.commands.findPersistentPrev=function(e){h(e,!0,!0,!0)},e.commands.findNext=h,e.commands.findPrev=function(e){h(e,!0)},e.commands.clearSearch=f,e.commands.replace=g,e.commands.replaceAll=function(e){g(e,!0)}}),// CodeMirror, copyright (c) by Marijn Haverbeke and others
function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],e):e(CodeMirror)}(function(e){"use strict";function t(e,t,r,s){if(this.atOccurrence=!1,this.doc=e,null==s&&"string"==typeof t&&(s=!1),r=r?e.clipPos(r):n(0,0),this.pos={from:r,to:r},"string"!=typeof t)t.global||(t=new RegExp(t.source,t.ignoreCase?"ig":"g")),this.matches=function(i,r){if(i){t.lastIndex=0;for(var s,o,a=e.getLine(r.line).slice(0,r.ch),l=0;;){t.lastIndex=l;var c=t.exec(a);if(!c)break;if(s=c,o=s.index,l=s.index+(s[0].length||1),l==a.length)break}var d=s&&s[0].length||0;d||(0==o&&0==a.length?s=void 0:o!=e.getLine(r.line).length&&d++)}else{t.lastIndex=r.ch;var a=e.getLine(r.line),s=t.exec(a),d=s&&s[0].length||0,o=s&&s.index;o+d==a.length||d||(d=1)}return s&&d?{from:n(r.line,o),to:n(r.line,o+d),match:s}:void 0};else{var o=t;s&&(t=t.toLowerCase());var a=s?function(e){return e.toLowerCase()}:function(e){return e},l=t.split("\n");if(1==l.length)this.matches=t.length?function(r,s){if(r){var l=e.getLine(s.line).slice(0,s.ch),c=a(l),d=c.lastIndexOf(t);if(d>-1)return d=i(l,c,d),{from:n(s.line,d),to:n(s.line,d+o.length)}}else{var l=e.getLine(s.line).slice(s.ch),c=a(l),d=c.indexOf(t);if(d>-1)return d=i(l,c,d)+s.ch,{from:n(s.line,d),to:n(s.line,d+o.length)}}}:function(){};else{var c=o.split("\n");this.matches=function(t,i){var r=l.length-1;if(t){if(i.line-(l.length-1)<e.firstLine())return;if(a(e.getLine(i.line).slice(0,c[r].length))!=l[l.length-1])return;for(var s=n(i.line,c[r].length),o=i.line-1,d=r-1;d>=1;--d,--o)if(l[d]!=a(e.getLine(o)))return;var u=e.getLine(o),h=u.length-c[0].length;if(a(u.slice(h))!=l[0])return;return{from:n(o,h),to:s}}if(!(i.line+(l.length-1)>e.lastLine())){var u=e.getLine(i.line),h=u.length-c[0].length;if(a(u.slice(h))==l[0]){for(var p=n(i.line,h),o=i.line+1,d=1;r>d;++d,++o)if(l[d]!=a(e.getLine(o)))return;if(a(e.getLine(o).slice(0,c[r].length))==l[r])return{from:p,to:n(o,c[r].length)}}}}}}}function i(e,t,i){if(e.length==t.length)return i;for(var n=Math.min(i,e.length);;){var r=e.slice(0,n).toLowerCase().length;if(i>r)++n;else{if(!(r>i))return n;--n}}}var n=e.Pos;t.prototype={findNext:function(){return this.find(!1)},findPrevious:function(){return this.find(!0)},find:function(e){function t(e){var t=n(e,0);return i.pos={from:t,to:t},i.atOccurrence=!1,!1}for(var i=this,r=this.doc.clipPos(e?this.pos.from:this.pos.to);;){if(this.pos=this.matches(e,r))return this.atOccurrence=!0,this.pos.match||!0;if(e){if(!r.line)return t(0);r=n(r.line-1,this.doc.getLine(r.line-1).length)}else{var s=this.doc.lineCount();if(r.line==s-1)return t(s);r=n(r.line+1,0)}}},from:function(){return this.atOccurrence?this.pos.from:void 0},to:function(){return this.atOccurrence?this.pos.to:void 0},replace:function(t,i){if(this.atOccurrence){var r=e.splitLines(t);this.doc.replaceRange(r,this.pos.from,this.pos.to,i),this.pos.to=n(this.pos.from.line+r.length-1,r[r.length-1].length+(1==r.length?this.pos.from.ch:0))}}},e.defineExtension("getSearchCursor",function(e,i,n){return new t(this.doc,e,i,n)}),e.defineDocExtension("getSearchCursor",function(e,i,n){return new t(this,e,i,n)}),e.defineExtension("selectMatches",function(t,i){for(var n=[],r=this.getSearchCursor(t,this.getCursor("from"),i);r.findNext()&&!(e.cmpPos(r.to(),this.getCursor("to"))>0);)n.push({anchor:r.from(),head:r.to()});n.length&&this.setSelections(n,0)})}),!function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],e):e(CodeMirror)}(function(e){"use strict";e.defineMode("xml",function(t,i){function n(e,t){function i(i){return t.tokenize=i,i(e,t)}var n=e.next();if("<"==n)return e.eat("!")?e.eat("[")?e.match("CDATA[")?i(o("atom","]]>")):null:e.match("--")?i(o("comment","-->")):e.match("DOCTYPE",!0,!0)?(e.eatWhile(/[\w\._\-]/),i(a(1))):null:e.eat("?")?(e.eatWhile(/[\w\._\-]/),t.tokenize=o("meta","?>"),"meta"):(C=e.eat("/")?"closeTag":"openTag",t.tokenize=r,"tag bracket");if("&"==n){var s;return s=e.eat("#")?e.eat("x")?e.eatWhile(/[a-fA-F\d]/)&&e.eat(";"):e.eatWhile(/[\d]/)&&e.eat(";"):e.eatWhile(/[\w\.\-:]/)&&e.eat(";"),s?"atom":"error"}return e.eatWhile(/[^&<]/),null}function r(e,t){var i=e.next();if(">"==i||"/"==i&&e.eat(">"))return t.tokenize=n,C=">"==i?"endTag":"selfcloseTag","tag bracket";if("="==i)return C="equals",null;if("<"==i){t.tokenize=n,t.state=u,t.tagName=t.tagStart=null;var r=t.tokenize(e,t);return r?r+" tag error":"tag error"}return/[\'\"]/.test(i)?(t.tokenize=s(i),t.stringStartCol=e.column(),t.tokenize(e,t)):(e.match(/^[^\s\u00a0=<>\"\']*[^\s\u00a0=<>\"\'\/]/),"word")}function s(e){var t=function(t,i){for(;!t.eol();)if(t.next()==e){i.tokenize=r;break}return"string"};return t.isInAttribute=!0,t}function o(e,t){return function(i,r){for(;!i.eol();){if(i.match(t)){r.tokenize=n;break}i.next()}return e}}function a(e){return function(t,i){for(var r;null!=(r=t.next());){if("<"==r)return i.tokenize=a(e+1),i.tokenize(t,i);if(">"==r){if(1==e){i.tokenize=n;break}return i.tokenize=a(e-1),i.tokenize(t,i)}}return"meta"}}function l(e,t,i){this.prev=e.context,this.tagName=t,this.indent=e.indented,this.startOfLine=i,(A.doNotIndent.hasOwnProperty(t)||e.context&&e.context.noIndent)&&(this.noIndent=!0)}function c(e){e.context&&(e.context=e.context.prev)}function d(e,t){for(var i;;){if(!e.context)return;if(i=e.context.tagName,!A.contextGrabbers.hasOwnProperty(i)||!A.contextGrabbers[i].hasOwnProperty(t))return;c(e)}}function u(e,t,i){return"openTag"==e?(i.tagStart=t.column(),h):"closeTag"==e?p:u}function h(e,t,i){return"word"==e?(i.tagName=t.current(),x="tag",g):(x="error",h)}function p(e,t,i){if("word"==e){var n=t.current();return i.context&&i.context.tagName!=n&&A.implicitlyClosed.hasOwnProperty(i.context.tagName)&&c(i),i.context&&i.context.tagName==n?(x="tag",f):(x="tag error",m)}return x="error",m}function f(e,t,i){return"endTag"!=e?(x="error",f):(c(i),u)}function m(e,t,i){return x="error",f(e,t,i)}function g(e,t,i){if("word"==e)return x="attribute",v;if("endTag"==e||"selfcloseTag"==e){var n=i.tagName,r=i.tagStart;return i.tagName=i.tagStart=null,"selfcloseTag"==e||A.autoSelfClosers.hasOwnProperty(n)?d(i,n):(d(i,n),i.context=new l(i,n,r==i.indented)),u}return x="error",g}function v(e,t,i){return"equals"==e?_:(A.allowMissing||(x="error"),g(e,t,i))}function _(e,t,i){return"string"==e?y:"word"==e&&A.allowUnquoted?(x="string",g):(x="error",g(e,t,i))}function y(e,t,i){return"string"==e?y:g(e,t,i)}var b=t.indentUnit,w=i.multilineTagIndentFactor||1,k=i.multilineTagIndentPastTag;null==k&&(k=!0);var C,x,A=i.htmlMode?{autoSelfClosers:{area:!0,base:!0,br:!0,col:!0,command:!0,embed:!0,frame:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0,menuitem:!0},implicitlyClosed:{dd:!0,li:!0,optgroup:!0,option:!0,p:!0,rp:!0,rt:!0,tbody:!0,td:!0,tfoot:!0,th:!0,tr:!0},contextGrabbers:{dd:{dd:!0,dt:!0},dt:{dd:!0,dt:!0},li:{li:!0},option:{option:!0,optgroup:!0},optgroup:{optgroup:!0},p:{address:!0,article:!0,aside:!0,blockquote:!0,dir:!0,div:!0,dl:!0,fieldset:!0,footer:!0,form:!0,h1:!0,h2:!0,h3:!0,h4:!0,h5:!0,h6:!0,header:!0,hgroup:!0,hr:!0,menu:!0,nav:!0,ol:!0,p:!0,pre:!0,section:!0,table:!0,ul:!0},rp:{rp:!0,rt:!0},rt:{rp:!0,rt:!0},tbody:{tbody:!0,tfoot:!0},td:{td:!0,th:!0},tfoot:{tbody:!0},th:{td:!0,th:!0},thead:{tbody:!0,tfoot:!0},tr:{tr:!0}},doNotIndent:{pre:!0},allowUnquoted:!0,allowMissing:!0,caseFold:!0}:{autoSelfClosers:{},implicitlyClosed:{},contextGrabbers:{},doNotIndent:{},allowUnquoted:!1,allowMissing:!1,caseFold:!1},T=i.alignCDATA;return{startState:function(){return{tokenize:n,state:u,indented:0,tagName:null,tagStart:null,context:null}},token:function(e,t){if(!t.tagName&&e.sol()&&(t.indented=e.indentation()),e.eatSpace())return null;C=null;var i=t.tokenize(e,t);return(i||C)&&"comment"!=i&&(x=null,t.state=t.state(C||i,e,t),x&&(i="error"==x?i+" error":x)),i},indent:function(t,i,s){var o=t.context;if(t.tokenize.isInAttribute)return t.tagStart==t.indented?t.stringStartCol+1:t.indented+b;if(o&&o.noIndent)return e.Pass;if(t.tokenize!=r&&t.tokenize!=n)return s?s.match(/^(\s*)/)[0].length:0;if(t.tagName)return k?t.tagStart+t.tagName.length+2:t.tagStart+b*w;if(T&&/<!\[CDATA\[/.test(i))return 0;var a=i&&/^<(\/)?([\w_:\.-]*)/.exec(i);if(a&&a[1])for(;o;){if(o.tagName==a[2]){o=o.prev;break}if(!A.implicitlyClosed.hasOwnProperty(o.tagName))break;o=o.prev}else if(a)for(;o;){var l=A.contextGrabbers[o.tagName];if(!l||!l.hasOwnProperty(a[2]))break;o=o.prev}for(;o&&!o.startOfLine;)o=o.prev;return o?o.indent+b:0},electricInput:/<\/[\s\w:]+>$/,blockCommentStart:"<!--",blockCommentEnd:"-->",configuration:i.htmlMode?"html":"xml",helperType:i.htmlMode?"html":"xml"}}),e.defineMIME("text/xml","xml"),e.defineMIME("application/xml","xml"),e.mimeModes.hasOwnProperty("text/html")||e.defineMIME("text/html",{name:"xml",htmlMode:!0})}),window.Sanitizer=window.Sanitizer||{},function(){"use strict";Sanitizer={cleanMicrosoftContent:function(e){e=this.onPasteFromWord(e),e=this.onPasteFromExcel(e);var t=e.match(/<body(.*?) ([\w\W]*?)<\/body>/g);return e=null!=t?t[0]:e},onPasteFromWord:function(e){return e=e.replace(/<!--[\s\S]*?-->/gi,""),e=e.replace(/<style[^>]*>[\s\S]*?<\/style>/gi,""),/(class=\"?Mso|style=\"[^\"]*\bmso\-|w:WordDocument)/.test(e)&&(e=e.replace(/<img(.*?)v:shapes=(.*?)>/gi,""),e=e.replace(/src="file\:\/\/(.*?)"/,'src=""'),e=e.replace(/(\n|\r| class=(")?Mso[a-zA-Z0-9]+(")?)/gi," "),e=e.replace(/<!--[\s\S]*?-->/gi,""),e=e.replace(/<o:p(.*?)>([\w\W]*?)<\/o:p>/gi,"$2"),e=e.replace(/\>\s+\</g,"><"),e=e.replace(/<div(.*?)><p(.*?)>((?:[\w\W]*?))<\/p><\/div>/g,"<p $1>$3</p>")),e},onPasteFromExcel:function(e){return/(microsoft-com|schemas-microsoft-com:office:excel|content=Excel.Sheet)/.test(e)&&(e=e.replace(/<table(.*?)border=0/,"<table$1 border=1")),e}}}(window.jQuery),window.Normalize=window.Normalize||{},function(e){"use strict";Normalize={removeStyleAttr:["margin-top","margin-right","word-spacing","float","outline","font-style","vertical-align","line-height","text-rendering","font-variant","letter-spacing","orphans","text-transform","white-space","widows","-webkit-text-stroke-width","display","position","overflow","text-overflow","text-decoration","font-variant-ligatures","font-variant-caps"],tagProperties:{TABLE:"border-collapse:collapse; border:1px solid #afafaf;"},allowedStylesCallbacks:{"mso-highlight":function(e,t){e.css("background-color",t)},"font-family":function(e,t){"inherit"!=t&&e.css("font-family",t)},"font-size":function(e,t){"inherit"!=t&&e.css("font-size",t)},"font-weight":function(e,t){"normal"!=t&&"inherit"!=t&&e.css("font-weight",t)},background:function(t,i){var n=e.browser.msie||e.browser.mozilla,r=n?"background-color":"background";t.css(r,i)},"text-align":function(t,i){e.browser.mozilla?(t.attr("align",i),t.css("text-align","")):t.css("text-align",i)},"text-indent":function(e,t){e.css("text-indent",Math.abs(parseInt(t))+"px")},"margin-left":function(e,t){parseInt(t)>0&&e.css("margin-left",parseInt(t)+"px")},"background-color":function(e,t){"SPAN"==e.prop("tagName")&&e.css("background-color",t)}},normalizeContent:function(t,i){var n=e("<div></div>").html(i),r=this;return n.find("*").each(function(i,n){var s=e(n);r.normalizeAttributes(t,s)}),n.find("p span:only-child").each(function(){jQuery.trim(jQuery(this).text()).length||jQuery(this).html("&nbsp;")}),n.html()},normalizeAttributes:function(e,t){return t.removeAttr("class"),this.filterDomProperty(e,t,"style"),this.filterDomProperty(e,t,"align"),this.resetAttributes(e,t),t},filterDomProperty:function(e,t,i){var n=t.attr(i),r=this;if(n)switch(t.removeAttr(i),i){case"align":t.css("text-align",n);break;case"style":r.normalizeStyleAttribute(e,t,n)}},resetAttributes:function(e,t){var i=this.tagProperties[t.prop("tagName")];i&&t.attr("inline-styles",i)},normalizeStyleAttribute:function(t,i,n){var r=n.split(/[;]/),s=this;e.each(r,function(n,r){var o=r.split(":").map(e.trim),a=o[0].toLowerCase(),l=o[1],c=s.allowedStylesCallbacks[a];-1==e.inArray(a,s.removeStyleAttr)&&("undefined"!=typeof c?c(i,l,t.opts):i.css(a,l))})}}}(window.jQuery),/*!
 * froala_editor v2.3.5 (https://www.froala.com/wysiwyg-editor)
 * License https://froala.com/wysiwyg-editor/terms/
 * Copyright 2014-2016 Froala Labs
 */
function(e){"function"==typeof define&&define.amd?define(["jquery"],e):"object"==typeof module&&module.exports?module.exports=function(t,i){return void 0===i&&(i="undefined"!=typeof window?require("jquery"):require("jquery")(t)),e(i),i}:e(jQuery)}(function(e){"use strict";e.FE.PLUGINS.align=function(t){function i(i){t.selection.save(),t.html.wrap(!0,!0,!0,!0),t.selection.restore();for(var n=t.selection.blocks(),r=0;r<n.length;r++)e(n[r]).css("text-align",i).removeClass("fr-temp-div"),""===e(n[r]).attr("class")&&e(n[r]).removeAttr("class");t.selection.save(),t.html.unwrap(),t.selection.restore()}function n(i){var n=t.selection.blocks();if(n.length){var r=t.helpers.getAlignment(e(n[0]));i.find("> *:first").replaceWith(t.icon.create("align-"+r))}}function r(i,n){var r=t.selection.blocks();if(r.length){var s=t.helpers.getAlignment(e(r[0]));n.find('a.fr-command[data-param1="'+s+'"]').addClass("fr-active")}}return{apply:i,refresh:n,refreshOnShow:r}},e.FE.DefineIcon("align",{NAME:"align-left"}),e.FE.DefineIcon("align-left",{NAME:"align-left"}),e.FE.DefineIcon("align-right",{NAME:"align-right"}),e.FE.DefineIcon("align-center",{NAME:"align-center"}),e.FE.DefineIcon("align-justify",{NAME:"align-justify"}),e.FE.RegisterCommand("align",{type:"dropdown",title:"Align",options:{left:"Align Left",center:"Align Center",right:"Align Right",justify:"Align Justify"},html:function(){var t='<ul class="fr-dropdown-list">',i=e.FE.COMMANDS.align.options;for(var n in i)i.hasOwnProperty(n)&&(t+='<li><a class="fr-command fr-title" data-cmd="align" data-param1="'+n+'" title="'+this.language.translate(i[n])+'">'+this.icon.create("align-"+n)+"</a></li>");return t+="</ul>"},callback:function(e,t){this.align.apply(t)},refresh:function(e){this.align.refresh(e)},refreshOnShow:function(e,t){this.align.refreshOnShow(e,t)},plugin:"align"})}),/*!
 * froala_editor v2.3.5 (https://www.froala.com/wysiwyg-editor)
 * License https://froala.com/wysiwyg-editor/terms/
 * Copyright 2014-2016 Froala Labs
 */
function(e){"function"==typeof define&&define.amd?define(["jquery"],e):"object"==typeof module&&module.exports?module.exports=function(t,i){return void 0===i&&(i="undefined"!=typeof window?require("jquery"):require("jquery")(t)),e(i),i}:e(jQuery)}(function(e){"use strict";e.extend(e.FE.DEFAULTS,{charCounterMax:-1,charCounterCount:!0}),e.FE.PLUGINS.charCounter=function(t){function i(){return t.$el.text().length}function n(e){if(t.opts.charCounterMax<0)return!0;if(i()<t.opts.charCounterMax)return!0;var n=e.which;return!t.keys.ctrlKey(e)&&t.keys.isCharacter(n)?(e.preventDefault(),e.stopPropagation(),t.events.trigger("charCounter.exceeded"),!1):!0}function r(n){if(t.opts.charCounterMax<0)return n;var r=e("<div>").html(n).text().length;return r+i()<=t.opts.charCounterMax?n:(t.events.trigger("charCounter.exceeded"),"")}function s(){if(t.opts.charCounterCount){var e=i()+(t.opts.charCounterMax>0?"/"+t.opts.charCounterMax:"");a.text(e),t.opts.toolbarBottom&&a.css("margin-bottom",t.$tb.outerHeight(!0));var n=t.$wp.get(0).offsetWidth-t.$wp.get(0).clientWidth;n>=0&&("rtl"==t.opts.direction?a.css("margin-left",n):a.css("margin-right",n))}}function o(){return t.$wp?t.opts.charCounterCount?(a=e('<span class="fr-counter"></span>'),a.css("bottom",t.$wp.css("border-bottom-width")),t.$box.append(a),t.events.on("keydown",n,!0),t.events.on("paste.afterCleanup",r),t.events.on("keyup contentChanged",function(){t.events.trigger("charCounter.update")}),t.events.on("charCounter.update",s),t.events.trigger("charCounter.update"),t.events.on("destroy",function(){e(t.o_win).off("resize.char"+t.id),a.removeData().remove(),a=null}),void 0):!1:!1}var a;return{_init:o,count:i}}}),/*!
 * froala_editor v2.3.5 (https://www.froala.com/wysiwyg-editor)
 * License https://froala.com/wysiwyg-editor/terms/
 * Copyright 2014-2016 Froala Labs
 */
function(e){"function"==typeof define&&define.amd?define(["jquery"],e):"object"==typeof module&&module.exports?module.exports=function(t,i){return void 0===i&&(i="undefined"!=typeof window?require("jquery"):require("jquery")(t)),e(i),i}:e(jQuery)}(function(e){"use strict";e.FE.PLUGINS.codeBeautifier=function(){function e(e,i){function n(e){return e.replace(/^\s+/g,"")}function r(e){return e.replace(/\s+$/g,"")}function o(){return this.pos=0,this.token="",this.current_mode="CONTENT",this.tags={parent:"parent1",parentcount:1,parent1:""},this.tag_type="",this.token_text=this.last_token=this.last_text=this.token_type="",this.newlines=0,this.indent_content=l,this.Utils={whitespace:"\n\r	 ".split(""),single_token:"br,input,link,meta,source,!doctype,basefont,base,area,hr,wbr,param,img,isindex,embed".split(","),extra_liners:b,in_array:function(e,t){for(var i=0;i<t.length;i++)if(e==t[i])return!0;return!1}},this.is_whitespace=function(e){for(var t=0;t<e.length;e++)if(!this.Utils.in_array(e.charAt(t),this.Utils.whitespace))return!1;return!0},this.traverse_whitespace=function(){var e="";if(e=this.input.charAt(this.pos),this.Utils.in_array(e,this.Utils.whitespace)){for(this.newlines=0;this.Utils.in_array(e,this.Utils.whitespace);)f&&"\n"==e&&this.newlines<=m&&(this.newlines+=1),this.pos++,e=this.input.charAt(this.pos);return!0}return!1},this.space_or_wrap=function(e){this.line_char_count>=this.wrap_line_length?(this.print_newline(!1,e),this.print_indentation(e)):(this.line_char_count++,e.push(" "))},this.get_content=function(){for(var e="",t=[];"<"!=this.input.charAt(this.pos);){if(this.pos>=this.input.length)return t.length?t.join(""):["","TK_EOF"];if(this.traverse_whitespace())this.space_or_wrap(t);else{if(g){var i=this.input.substr(this.pos,3);if("{{#"==i||"{{/"==i)break;if("{{!"==i)return[this.get_tag(),"TK_TAG_HANDLEBARS_COMMENT"];if("{{"==this.input.substr(this.pos,2)&&"{{else}}"==this.get_tag(!0))break}e=this.input.charAt(this.pos),this.pos++,this.line_char_count++,t.push(e)}}return t.length?t.join(""):""},this.get_contents_to=function(e){if(this.pos==this.input.length)return["","TK_EOF"];var t="",i=new RegExp("</"+e+"\\s*>","igm");i.lastIndex=this.pos;var n=i.exec(this.input),r=n?n.index:this.input.length;return this.pos<r&&(t=this.input.substring(this.pos,r),this.pos=r),t},this.record_tag=function(e){this.tags[e+"count"]?(this.tags[e+"count"]++,this.tags[e+this.tags[e+"count"]]=this.indent_level):(this.tags[e+"count"]=1,this.tags[e+this.tags[e+"count"]]=this.indent_level),this.tags[e+this.tags[e+"count"]+"parent"]=this.tags.parent,this.tags.parent=e+this.tags[e+"count"]},this.retrieve_tag=function(e){if(this.tags[e+"count"]){for(var t=this.tags.parent;t&&e+this.tags[e+"count"]!=t;)t=this.tags[t+"parent"];t&&(this.indent_level=this.tags[e+this.tags[e+"count"]],this.tags.parent=this.tags[t+"parent"]),delete this.tags[e+this.tags[e+"count"]+"parent"],delete this.tags[e+this.tags[e+"count"]],1==this.tags[e+"count"]?delete this.tags[e+"count"]:this.tags[e+"count"]--}},this.indent_to_tag=function(e){if(this.tags[e+"count"]){for(var t=this.tags.parent;t&&e+this.tags[e+"count"]!=t;)t=this.tags[t+"parent"];t&&(this.indent_level=this.tags[e+this.tags[e+"count"]])}},this.get_tag=function(e){var t,i,n,r="",s=[],o="",a=!1,l=!0,c=this.pos,u=this.line_char_count;e=void 0!==e?e:!1;do{if(this.pos>=this.input.length)return e&&(this.pos=c,this.line_char_count=u),s.length?s.join(""):["","TK_EOF"];if(r=this.input.charAt(this.pos),this.pos++,this.Utils.in_array(r,this.Utils.whitespace))a=!0;else{if(("'"==r||'"'==r)&&(r+=this.get_unformatted(r),a=!0),"="==r&&(a=!1),s.length&&"="!=s[s.length-1]&&">"!=r&&a){if(this.space_or_wrap(s),a=!1,!l&&"force"==v&&"/"!=r){this.print_newline(!0,s),this.print_indentation(s);for(var h=0;_>h;h++)s.push(d)}for(var f=0;f<s.length;f++)if(" "==s[f]){l=!1;break}}if(g&&"<"==n&&"{{"==r+this.input.charAt(this.pos)&&(r+=this.get_unformatted("}}"),s.length&&" "!=s[s.length-1]&&"<"!=s[s.length-1]&&(r=" "+r),a=!0),"<"!=r||n||(t=this.pos-1,n="<"),g&&!n&&s.length>=2&&"{"==s[s.length-1]&&"{"==s[s.length-2]&&(t="#"==r||"/"==r||"!"==r?this.pos-3:this.pos-2,n="{"),this.line_char_count++,s.push(r),s[1]&&("!"==s[1]||"?"==s[1]||"%"==s[1])){s=[this.get_comment(t)];break}if(g&&s[1]&&"{"==s[1]&&s[2]&&"!"==s[2]){s=[this.get_comment(t)];break}if(g&&"{"==n&&s.length>2&&"}"==s[s.length-2]&&"}"==s[s.length-1])break}}while(">"!=r);var m,y,b=s.join("");m=-1!=b.indexOf(" ")?b.indexOf(" "):"{"==b[0]?b.indexOf("}"):b.indexOf(">"),y="<"!=b[0]&&g?"#"==b[2]?3:2:1;var w=b.substring(y,m).toLowerCase();return"/"==b.charAt(b.length-2)||this.Utils.in_array(w,this.Utils.single_token)?e||(this.tag_type="SINGLE"):g&&"{"==b[0]&&"else"==w?e||(this.indent_to_tag("if"),this.tag_type="HANDLEBARS_ELSE",this.indent_content=!0,this.traverse_whitespace()):this.is_unformatted(w,p)?(o=this.get_unformatted("</"+w+">",b),s.push(o),i=this.pos-1,this.tag_type="SINGLE"):"script"==w&&(-1==b.search("type")||b.search("type")>-1&&b.search(/\b(text|application)\/(x-)?(javascript|ecmascript|jscript|livescript)/)>-1)?e||(this.record_tag(w),this.tag_type="SCRIPT"):"style"==w&&(-1==b.search("type")||b.search("type")>-1&&b.search("text/css")>-1)?e||(this.record_tag(w),this.tag_type="STYLE"):"!"==w.charAt(0)?e||(this.tag_type="SINGLE",this.traverse_whitespace()):e||("/"==w.charAt(0)?(this.retrieve_tag(w.substring(1)),this.tag_type="END"):(this.record_tag(w),"html"!=w.toLowerCase()&&(this.indent_content=!0),this.tag_type="START"),this.traverse_whitespace()&&this.space_or_wrap(s),this.Utils.in_array(w,this.Utils.extra_liners)&&(this.print_newline(!1,this.output),this.output.length&&"\n"!=this.output[this.output.length-2]&&this.print_newline(!0,this.output))),e&&(this.pos=c,this.line_char_count=u),s.join("")},this.get_comment=function(e){var t="",i=">",n=!1;this.pos=e;var r=this.input.charAt(this.pos);for(this.pos++;this.pos<=this.input.length&&(t+=r,t[t.length-1]!=i[i.length-1]||-1==t.indexOf(i));)!n&&t.length<10&&(0===t.indexOf("<![if")?(i="<![endif]>",n=!0):0===t.indexOf("<![cdata[")?(i="]]>",n=!0):0===t.indexOf("<![")?(i="]>",n=!0):0===t.indexOf("<!--")?(i="-->",n=!0):0===t.indexOf("{{!")?(i="}}",n=!0):0===t.indexOf("<?")?(i="?>",n=!0):0===t.indexOf("<%")&&(i="%>",n=!0)),r=this.input.charAt(this.pos),this.pos++;return t},this.get_unformatted=function(e,t){if(t&&-1!=t.toLowerCase().indexOf(e))return"";var i="",n="",r=0,s=!0;do{if(this.pos>=this.input.length)return n;if(i=this.input.charAt(this.pos),this.pos++,this.Utils.in_array(i,this.Utils.whitespace)){if(!s){this.line_char_count--;continue}if("\n"==i||"\r"==i){n+="\n",this.line_char_count=0;continue}}n+=i,this.line_char_count++,s=!0,g&&"{"==i&&n.length&&"{"==n[n.length-2]&&(n+=this.get_unformatted("}}"),r=n.length)}while(-1==n.toLowerCase().indexOf(e,r));return n},this.get_token=function(){var e;if("TK_TAG_SCRIPT"==this.last_token||"TK_TAG_STYLE"==this.last_token){var t=this.last_token.substr(7);return e=this.get_contents_to(t),"string"!=typeof e?e:[e,"TK_"+t]}if("CONTENT"==this.current_mode)return e=this.get_content(),"string"!=typeof e?e:[e,"TK_CONTENT"];if("TAG"==this.current_mode){if(e=this.get_tag(),"string"!=typeof e)return e;var i="TK_TAG_"+this.tag_type;return[e,i]}},this.get_full_indent=function(e){return e=this.indent_level+e||0,1>e?"":new Array(e+1).join(this.indent_string)},this.is_unformatted=function(e,t){if(!this.Utils.in_array(e,t))return!1;if("a"!=e.toLowerCase()||!this.Utils.in_array("a",t))return!0;var i=this.get_tag(!0),n=(i||"").match(/^\s*<\s*\/?([a-z]*)\s*[^>]*>\s*$/);return!n||this.Utils.in_array(n,t)?!0:!1},this.printer=function(e,t,i,s,o){this.input=e||"",this.output=[],this.indent_character=t,this.indent_string="",this.indent_size=i,this.brace_style=o,this.indent_level=0,this.wrap_line_length=s,this.line_char_count=0;for(var a=0;a<this.indent_size;a++)this.indent_string+=this.indent_character;this.print_newline=function(e,t){this.line_char_count=0,t&&t.length&&(e||"\n"!=t[t.length-1])&&("\n"!=t[t.length-1]&&(t[t.length-1]=r(t[t.length-1])),t.push("\n"))},this.print_indentation=function(e){for(var t=0;t<this.indent_level;t++)e.push(this.indent_string),this.line_char_count+=this.indent_string.length},this.print_token=function(e){(!this.is_whitespace(e)||this.output.length)&&((e||""!==e)&&this.output.length&&"\n"==this.output[this.output.length-1]&&(this.print_indentation(this.output),e=n(e)),this.print_token_raw(e))},this.print_token_raw=function(e){this.newlines>0&&(e=r(e)),e&&""!==e&&(e.length>1&&"\n"==e[e.length-1]?(this.output.push(e.slice(0,-1)),this.print_newline(!1,this.output)):this.output.push(e));for(var t=0;t<this.newlines;t++)this.print_newline(t>0,this.output);this.newlines=0},this.indent=function(){this.indent_level++},this.unindent=function(){this.indent_level>0&&this.indent_level--}},this}var a,l,c,d,u,h,p,f,m,g,v,_,y,b;for(i=i||{},void 0!==i.wrap_line_length&&0!==parseInt(i.wrap_line_length,10)||void 0===i.max_char||0===parseInt(i.max_char,10)||(i.wrap_line_length=i.max_char),l=void 0===i.indent_inner_html?!1:i.indent_inner_html,c=void 0===i.indent_size?4:parseInt(i.indent_size,10),d=void 0===i.indent_char?" ":i.indent_char,h=void 0===i.brace_style?"collapse":i.brace_style,u=0===parseInt(i.wrap_line_length,10)?32786:parseInt(i.wrap_line_length||250,10),p=i.unformatted||["a","span","img","bdo","em","strong","dfn","code","samp","kbd","var","cite","abbr","acronym","q","sub","sup","tt","i","b","big","small","u","s","strike","font","ins","del","address","pre"],f=void 0===i.preserve_newlines?!0:i.preserve_newlines,m=f?isNaN(parseInt(i.max_preserve_newlines,10))?32786:parseInt(i.max_preserve_newlines,10):0,g=void 0===i.indent_handlebars?!1:i.indent_handlebars,v=void 0===i.wrap_attributes?"auto":i.wrap_attributes,_=void 0===i.wrap_attributes_indent_size?c:parseInt(i.wrap_attributes_indent_size,10)||c,y=void 0===i.end_with_newline?!1:i.end_with_newline,b=Array.isArray(i.extra_liners)?i.extra_liners.concat():"string"==typeof i.extra_liners?i.extra_liners.split(","):"head,body,/html".split(","),i.indent_with_tabs&&(d="	",c=1),a=new o,a.printer(e,d,c,u,h);;){var w=a.get_token();if(a.token_text=w[0],a.token_type=w[1],"TK_EOF"==a.token_type)break;switch(a.token_type){case"TK_TAG_START":a.print_newline(!1,a.output),a.print_token(a.token_text),a.indent_content&&(a.indent(),a.indent_content=!1),a.current_mode="CONTENT";break;case"TK_TAG_STYLE":case"TK_TAG_SCRIPT":a.print_newline(!1,a.output),a.print_token(a.token_text),a.current_mode="CONTENT";break;case"TK_TAG_END":if("TK_CONTENT"==a.last_token&&""===a.last_text){var k=a.token_text.match(/\w+/)[0],C=null;a.output.length&&(C=a.output[a.output.length-1].match(/(?:<|{{#)\s*(\w+)/)),(null==C||C[1]!=k&&!a.Utils.in_array(C[1],p))&&a.print_newline(!1,a.output)}a.print_token(a.token_text),a.current_mode="CONTENT";break;case"TK_TAG_SINGLE":var x=a.token_text.match(/^\s*<([a-z-]+)/i);x&&a.Utils.in_array(x[1],p)||a.print_newline(!1,a.output),a.print_token(a.token_text),a.current_mode="CONTENT";break;case"TK_TAG_HANDLEBARS_ELSE":a.print_token(a.token_text),a.indent_content&&(a.indent(),a.indent_content=!1),a.current_mode="CONTENT";break;case"TK_TAG_HANDLEBARS_COMMENT":a.print_token(a.token_text),a.current_mode="TAG";break;case"TK_CONTENT":a.print_token(a.token_text),a.current_mode="TAG";break;case"TK_STYLE":case"TK_SCRIPT":if(""!==a.token_text){a.print_newline(!1,a.output);var A,T=a.token_text,S=1;"TK_SCRIPT"==a.token_type?A="function"==typeof s&&s:"TK_STYLE"==a.token_type&&(A="function"==typeof t&&t),"keep"==i.indent_scripts?S=0:"separate"==i.indent_scripts&&(S=-a.indent_level);var M=a.get_full_indent(S);if(A)T=A(T.replace(/^\s*/,M),i);else{var N=T.match(/^\s*/)[0],E=N.match(/[^\n\r]*$/)[0].split(a.indent_string).length-1,D=a.get_full_indent(S-E);T=T.replace(/^\s*/,M).replace(/\r\n|\r|\n/g,"\n"+D).replace(/\s+$/,"")}T&&(a.print_token_raw(T),a.print_newline(!0,a.output))}a.current_mode="TAG";break;default:""!==a.token_text&&a.print_token(a.token_text)}a.last_token=a.token_type,a.last_text=a.token_text}var O=a.output.join("").replace(/[\r\n\t ]+$/,"");return y&&(O+="\n"),O}function t(e,t){function i(){return w=e.charAt(++C),w||""}function n(t){var n="",r=C;return t&&o(),n=e.charAt(C+1)||"",C=r-1,i(),n}function r(t){for(var n=C;i();)if("\\"===w)i();else{if(-1!==t.indexOf(w))break;if("\n"===w)break}return e.substring(n,C+1)}function s(e){var t=C,n=r(e);return C=t-1,i(),n}function o(){for(var e="";k.test(n());)i(),e+=w;return e}function a(){var e="";for(w&&k.test(w)&&(e=w);k.test(i());)e+=w;return e}function l(t){var r=C;for(t="/"===n(),i();i();){if(!t&&"*"===w&&"/"===n()){i();break}if(t&&"\n"===w)return e.substring(r,C)}return e.substring(r,C)+w}function c(t){return e.substring(C-t.length,C).toLowerCase()===t}function d(){for(var t=0,i=C+1;i<e.length;i++){var n=e.charAt(i);if("{"===n)return!0;if("("===n)t+=1;else if(")"===n){if(0==t)return!1;t-=1}else if(";"===n||"}"===n)return!1}return!1}function u(){S++,A+=T}function h(){S--,A=A.slice(0,-m)}var p={"@page":!0,"@font-face":!0,"@keyframes":!0,"@media":!0,"@supports":!0,"@document":!0},f={"@media":!0,"@supports":!0,"@document":!0};t=t||{},e=e||"",e=e.replace(/\r\n|[\r\u2028\u2029]/g,"\n");var m=t.indent_size||4,g=t.indent_char||" ",v=void 0===t.selector_separator_newline?!0:t.selector_separator_newline,_=void 0===t.end_with_newline?!1:t.end_with_newline,y=void 0===t.newline_between_rules?!0:t.newline_between_rules,b=t.eol?t.eol:"\n";"string"==typeof m&&(m=parseInt(m,10)),t.indent_with_tabs&&(g="	",m=1),b=b.replace(/\\r/,"\r").replace(/\\n/,"\n");var w,k=/^\s+$/,C=-1,x=0,A=e.match(/^[\t ]*/)[0],T=new Array(m+1).join(g),S=0,M=0,N={};N["{"]=function(e){N.singleSpace(),E.push(e),N.newLine()},N["}"]=function(e){N.newLine(),E.push(e),N.newLine()},N._lastCharWhitespace=function(){return k.test(E[E.length-1])},N.newLine=function(e){E.length&&(e||"\n"===E[E.length-1]||N.trim(),E.push("\n"),A&&E.push(A))},N.singleSpace=function(){E.length&&!N._lastCharWhitespace()&&E.push(" ")},N.preserveSingleSpace=function(){P&&N.singleSpace()},N.trim=function(){for(;N._lastCharWhitespace();)E.pop()};for(var E=[],D=!1,O=!1,R=!1,L="",I="";;){var j=a(),P=""!==j,F=-1!==j.indexOf("\n");if(I=L,L=w,!w)break;if("/"===w&&"*"===n()){var z=0===S;(F||z)&&N.newLine(),E.push(l()),N.newLine(),z&&N.newLine(!0)}else if("/"===w&&"/"===n())F||"{"===I||N.trim(),N.singleSpace(),E.push(l()),N.newLine();else if("@"===w){N.preserveSingleSpace(),E.push(w);var $=s(": ,;{}()[]/='\"");$.match(/[ :]$/)&&(i(),$=r(": ").replace(/\s$/,""),E.push($),N.singleSpace()),$=$.replace(/\s$/,""),$ in p&&(M+=1,$ in f&&(R=!0))}else"#"===w&&"{"===n()?(N.preserveSingleSpace(),E.push(r("}"))):"{"===w?"}"===n(!0)?(o(),i(),N.singleSpace(),E.push("{}"),N.newLine(),y&&0===S&&N.newLine(!0)):(u(),N["{"](w),R?(R=!1,D=S>M):D=S>=M):"}"===w?(h(),N["}"](w),D=!1,O=!1,M&&M--,y&&0===S&&N.newLine(!0)):":"===w?(o(),!D&&!R||c("&")||d()?":"===n()?(i(),E.push("::")):E.push(":"):(O=!0,E.push(":"),N.singleSpace())):'"'===w||"'"===w?(N.preserveSingleSpace(),E.push(r(w))):";"===w?(O=!1,E.push(w),N.newLine()):"("===w?c("url")?(E.push(w),o(),i()&&(")"!==w&&'"'!==w&&"'"!==w?E.push(r(")")):C--)):(x++,N.preserveSingleSpace(),E.push(w),o()):")"===w?(E.push(w),x--):","===w?(E.push(w),o(),v&&!O&&1>x?N.newLine():N.singleSpace()):"]"===w?E.push(w):"["===w?(N.preserveSingleSpace(),E.push(w)):"="===w?(o(),w="=",E.push(w)):(N.preserveSingleSpace(),E.push(w))}var H="";return A&&(H+=A),H+=E.join("").replace(/[\r\n\t ]+$/,""),_&&(H+="\n"),"\n"!=b&&(H=H.replace(/[\n]/g,b)),H}function i(e,t){for(var i=0;i<t.length;i+=1)if(t[i]===e)return!0;return!1}function n(e){return e.replace(/^\s+|\s+$/g,"")}function r(e){return e.replace(/^\s+/g,"")}function s(e,t){var i=new o(e,t);return i.beautify()}function o(e,t){function s(e,t){var i=0;e&&(i=e.indentation_level,!W.just_added_newline()&&e.line_indent_level>i&&(i=e.line_indent_level));var n={mode:t,parent:e,last_text:e?e.last_text:"",last_word:e?e.last_word:"",declaration_statement:!1,declaration_assignment:!1,multiline_frame:!1,if_block:!1,else_block:!1,do_block:!1,do_while:!1,in_case_statement:!1,in_case:!1,case_body:!1,indentation_level:i,line_indent_level:e?e.line_indent_level:i,start_line_index:W.get_line_number(),ternary_depth:0};return n}function o(e){var t=e.newlines,i=tt.keep_array_indentation&&y(Y.mode);if(i)for(n=0;t>n;n+=1)p(n>0);else if(tt.max_preserve_newlines&&t>tt.max_preserve_newlines&&(t=tt.max_preserve_newlines),tt.preserve_newlines&&e.newlines>1){p();for(var n=1;t>n;n+=1)p(!0)}U=e,et[U.type]()}function a(e){e=e.replace(/\x0d/g,"");for(var t=[],i=e.indexOf("\n");-1!==i;)t.push(e.substring(0,i)),e=e.substring(i+1),i=e.indexOf("\n");return e.length&&t.push(e),t}function h(e){if(e=void 0===e?!1:e,!W.just_added_newline())if(tt.preserve_newlines&&U.wanted_newline||e)p(!1,!0);else if(tt.wrap_line_length){var t=W.current_line.get_character_count()+U.text.length+(W.space_before_token?1:0);t>=tt.wrap_line_length&&p(!1,!0)}}function p(e,t){if(!t&&";"!==Y.last_text&&","!==Y.last_text&&"="!==Y.last_text&&"TK_OPERATOR"!==X)for(;Y.mode===u.Statement&&!Y.if_block&&!Y.do_block;)w();W.add_new_line(e)&&(Y.multiline_frame=!0)}function f(){W.just_added_newline()&&(tt.keep_array_indentation&&y(Y.mode)&&U.wanted_newline?(W.current_line.push(U.whitespace_before),W.space_before_token=!1):W.set_indent(Y.indentation_level)&&(Y.line_indent_level=Y.indentation_level))}function m(e){return W.raw?(W.add_raw_token(U),void 0):(tt.comma_first&&"TK_COMMA"===X&&W.just_added_newline()&&","===W.previous_line.last()&&(W.previous_line.pop(),f(),W.add_token(","),W.space_before_token=!0),e=e||U.text,f(),W.add_token(e),void 0)}function g(){Y.indentation_level+=1}function v(){Y.indentation_level>0&&(!Y.parent||Y.indentation_level>Y.parent.indentation_level)&&(Y.indentation_level-=1)}function _(e){Y?(J.push(Y),K=Y):K=s(null,e),Y=s(K,e)}function y(e){return e===u.ArrayLiteral}function b(e){return i(e,[u.Expression,u.ForInitializer,u.Conditional])}function w(){J.length>0&&(K=Y,Y=J.pop(),K.mode===u.Statement&&W.remove_redundant_indentation(K))}function k(){return Y.parent.mode===u.ObjectLiteral&&Y.mode===u.Statement&&(":"===Y.last_text&&0===Y.ternary_depth||"TK_RESERVED"===X&&i(Y.last_text,["get","set"]))}function C(){return"TK_RESERVED"===X&&i(Y.last_text,["var","let","const"])&&"TK_WORD"===U.type||"TK_RESERVED"===X&&"do"===Y.last_text||"TK_RESERVED"===X&&"return"===Y.last_text&&!U.wanted_newline||"TK_RESERVED"===X&&"else"===Y.last_text&&("TK_RESERVED"!==U.type||"if"!==U.text)||"TK_END_EXPR"===X&&(K.mode===u.ForInitializer||K.mode===u.Conditional)||"TK_WORD"===X&&Y.mode===u.BlockStatement&&!Y.in_case&&"--"!==U.text&&"++"!==U.text&&"function"!==V&&"TK_WORD"!==U.type&&"TK_RESERVED"!==U.type||Y.mode===u.ObjectLiteral&&(":"===Y.last_text&&0===Y.ternary_depth||"TK_RESERVED"===X&&i(Y.last_text,["get","set"]))?(_(u.Statement),g(),"TK_RESERVED"===X&&i(Y.last_text,["var","let","const"])&&"TK_WORD"===U.type&&(Y.declaration_statement=!0),k()||h("TK_RESERVED"===U.type&&i(U.text,["do","for","if","while"])),!0):!1}function x(e,t){for(var i=0;i<e.length;i++){var r=n(e[i]);if(r.charAt(0)!==t)return!1}return!0}function A(e,t){for(var i,n=0,r=e.length;r>n;n++)if(i=e[n],i&&0!==i.indexOf(t))return!1;return!0}function T(e){return i(e,["case","return","do","if","throw","else"])}function S(e){var t=q+(e||0);return 0>t||t>=it.length?null:it[t]}function M(){C();var e=u.Expression;if("["===U.text){if("TK_WORD"===X||")"===Y.last_text)return"TK_RESERVED"===X&&i(Y.last_text,Q.line_starters)&&(W.space_before_token=!0),_(e),m(),g(),tt.space_in_paren&&(W.space_before_token=!0),void 0;e=u.ArrayLiteral,y(Y.mode)&&("["===Y.last_text||","===Y.last_text&&("]"===V||"}"===V))&&(tt.keep_array_indentation||p())}else"TK_RESERVED"===X&&"for"===Y.last_text?e=u.ForInitializer:"TK_RESERVED"===X&&i(Y.last_text,["if","while"])&&(e=u.Conditional);";"===Y.last_text||"TK_START_BLOCK"===X?p():"TK_END_EXPR"===X||"TK_START_EXPR"===X||"TK_END_BLOCK"===X||"."===Y.last_text?h(U.wanted_newline):"TK_RESERVED"===X&&"("===U.text||"TK_WORD"===X||"TK_OPERATOR"===X?"TK_RESERVED"===X&&("function"===Y.last_word||"typeof"===Y.last_word)||"*"===Y.last_text&&"function"===V?tt.space_after_anon_function&&(W.space_before_token=!0):"TK_RESERVED"!==X||!i(Y.last_text,Q.line_starters)&&"catch"!==Y.last_text||tt.space_before_conditional&&(W.space_before_token=!0):W.space_before_token=!0,"("===U.text&&"TK_RESERVED"===X&&"await"===Y.last_word&&(W.space_before_token=!0),"("===U.text&&("TK_EQUALS"===X||"TK_OPERATOR"===X)&&(k()||h()),_(e),m(),tt.space_in_paren&&(W.space_before_token=!0),g()}function N(){for(;Y.mode===u.Statement;)w();Y.multiline_frame&&h("]"===U.text&&y(Y.mode)&&!tt.keep_array_indentation),tt.space_in_paren&&("TK_START_EXPR"!==X||tt.space_in_empty_paren?W.space_before_token=!0:(W.trim(),W.space_before_token=!1)),"]"===U.text&&tt.keep_array_indentation?(m(),w()):(w(),m()),W.remove_redundant_indentation(K),Y.do_while&&K.mode===u.Conditional&&(K.mode=u.Expression,Y.do_block=!1,Y.do_while=!1)}function E(){var e=S(1),t=S(2);t&&(":"===t.text&&i(e.type,["TK_STRING","TK_WORD","TK_RESERVED"])||i(e.text,["get","set"])&&i(t.type,["TK_WORD","TK_RESERVED"]))?i(V,["class","interface"])?_(u.BlockStatement):_(u.ObjectLiteral):_(u.BlockStatement);var n=!e.comments_before.length&&"}"===e.text,r=n&&"function"===Y.last_word&&"TK_END_EXPR"===X;"expand"===tt.brace_style||"none"===tt.brace_style&&U.wanted_newline?"TK_OPERATOR"!==X&&(r||"TK_EQUALS"===X||"TK_RESERVED"===X&&T(Y.last_text)&&"else"!==Y.last_text)?W.space_before_token=!0:p(!1,!0):"TK_OPERATOR"!==X&&"TK_START_EXPR"!==X?"TK_START_BLOCK"===X?p():W.space_before_token=!0:y(K.mode)&&","===Y.last_text&&("}"===V?W.space_before_token=!0:p()),m(),g()}function D(){for(;Y.mode===u.Statement;)w();var e="TK_START_BLOCK"===X;"expand"===tt.brace_style?e||p():e||(y(Y.mode)&&tt.keep_array_indentation?(tt.keep_array_indentation=!1,p(),tt.keep_array_indentation=!0):p()),w(),m()}function O(){if("TK_RESERVED"===U.type&&Y.mode!==u.ObjectLiteral&&i(U.text,["set","get"])&&(U.type="TK_WORD"),"TK_RESERVED"===U.type&&Y.mode===u.ObjectLiteral){var e=S(1);":"==e.text&&(U.type="TK_WORD")}if(C()||!U.wanted_newline||b(Y.mode)||"TK_OPERATOR"===X&&"--"!==Y.last_text&&"++"!==Y.last_text||"TK_EQUALS"===X||!tt.preserve_newlines&&"TK_RESERVED"===X&&i(Y.last_text,["var","let","const","set","get"])||p(),Y.do_block&&!Y.do_while){if("TK_RESERVED"===U.type&&"while"===U.text)return W.space_before_token=!0,m(),W.space_before_token=!0,Y.do_while=!0,void 0;p(),Y.do_block=!1}if(Y.if_block)if(Y.else_block||"TK_RESERVED"!==U.type||"else"!==U.text){for(;Y.mode===u.Statement;)w();Y.if_block=!1,Y.else_block=!1}else Y.else_block=!0;if("TK_RESERVED"===U.type&&("case"===U.text||"default"===U.text&&Y.in_case_statement))return p(),(Y.case_body||tt.jslint_happy)&&(v(),Y.case_body=!1),m(),Y.in_case=!0,Y.in_case_statement=!0,void 0;if("TK_RESERVED"===U.type&&"function"===U.text&&((i(Y.last_text,["}",";"])||W.just_added_newline()&&!i(Y.last_text,["[","{",":","=",","]))&&(W.just_added_blankline()||U.comments_before.length||(p(),p(!0))),"TK_RESERVED"===X||"TK_WORD"===X?"TK_RESERVED"===X&&i(Y.last_text,["get","set","new","return","export","async"])?W.space_before_token=!0:"TK_RESERVED"===X&&"default"===Y.last_text&&"export"===V?W.space_before_token=!0:p():"TK_OPERATOR"===X||"="===Y.last_text?W.space_before_token=!0:(Y.multiline_frame||!b(Y.mode)&&!y(Y.mode))&&p()),("TK_COMMA"===X||"TK_START_EXPR"===X||"TK_EQUALS"===X||"TK_OPERATOR"===X)&&(k()||h()),"TK_RESERVED"===U.type&&i(U.text,["function","get","set"]))return m(),Y.last_word=U.text,void 0;if(Z="NONE","TK_END_BLOCK"===X?"TK_RESERVED"===U.type&&i(U.text,["else","catch","finally"])?"expand"===tt.brace_style||"end-expand"===tt.brace_style||"none"===tt.brace_style&&U.wanted_newline?Z="NEWLINE":(Z="SPACE",W.space_before_token=!0):Z="NEWLINE":"TK_SEMICOLON"===X&&Y.mode===u.BlockStatement?Z="NEWLINE":"TK_SEMICOLON"===X&&b(Y.mode)?Z="SPACE":"TK_STRING"===X?Z="NEWLINE":"TK_RESERVED"===X||"TK_WORD"===X||"*"===Y.last_text&&"function"===V?Z="SPACE":"TK_START_BLOCK"===X?Z="NEWLINE":"TK_END_EXPR"===X&&(W.space_before_token=!0,Z="NEWLINE"),"TK_RESERVED"===U.type&&i(U.text,Q.line_starters)&&")"!==Y.last_text&&(Z="else"===Y.last_text||"export"===Y.last_text?"SPACE":"NEWLINE"),"TK_RESERVED"===U.type&&i(U.text,["else","catch","finally"]))if("TK_END_BLOCK"!==X||"expand"===tt.brace_style||"end-expand"===tt.brace_style||"none"===tt.brace_style&&U.wanted_newline)p();else{W.trim(!0);var t=W.current_line;"}"!==t.last()&&p(),W.space_before_token=!0}else"NEWLINE"===Z?"TK_RESERVED"===X&&T(Y.last_text)?W.space_before_token=!0:"TK_END_EXPR"!==X?"TK_START_EXPR"===X&&"TK_RESERVED"===U.type&&i(U.text,["var","let","const"])||":"===Y.last_text||("TK_RESERVED"===U.type&&"if"===U.text&&"else"===Y.last_text?W.space_before_token=!0:p()):"TK_RESERVED"===U.type&&i(U.text,Q.line_starters)&&")"!==Y.last_text&&p():Y.multiline_frame&&y(Y.mode)&&","===Y.last_text&&"}"===V?p():"SPACE"===Z&&(W.space_before_token=!0);m(),Y.last_word=U.text,"TK_RESERVED"===U.type&&"do"===U.text&&(Y.do_block=!0),"TK_RESERVED"===U.type&&"if"===U.text&&(Y.if_block=!0)}function R(){for(C()&&(W.space_before_token=!1);Y.mode===u.Statement&&!Y.if_block&&!Y.do_block;)w();m()}function L(){C()?W.space_before_token=!0:"TK_RESERVED"===X||"TK_WORD"===X?W.space_before_token=!0:"TK_COMMA"===X||"TK_START_EXPR"===X||"TK_EQUALS"===X||"TK_OPERATOR"===X?k()||h():p(),m()}function I(){C(),Y.declaration_statement&&(Y.declaration_assignment=!0),W.space_before_token=!0,m(),W.space_before_token=!0}function j(){return Y.declaration_statement?(b(Y.parent.mode)&&(Y.declaration_assignment=!1),m(),Y.declaration_assignment?(Y.declaration_assignment=!1,p(!1,!0)):(W.space_before_token=!0,tt.comma_first&&h()),void 0):(m(),Y.mode===u.ObjectLiteral||Y.mode===u.Statement&&Y.parent.mode===u.ObjectLiteral?(Y.mode===u.Statement&&w(),p()):(W.space_before_token=!0,tt.comma_first&&h()),void 0)}function P(){if(C(),"TK_RESERVED"===X&&T(Y.last_text))return W.space_before_token=!0,m(),void 0;if("*"===U.text&&"TK_DOT"===X)return m(),void 0;if(":"===U.text&&Y.in_case)return Y.case_body=!0,g(),m(),p(),Y.in_case=!1,void 0;if("::"===U.text)return m(),void 0;"TK_OPERATOR"===X&&h();var e=!0,t=!0;i(U.text,["--","++","!","~"])||i(U.text,["-","+"])&&(i(X,["TK_START_BLOCK","TK_START_EXPR","TK_EQUALS","TK_OPERATOR"])||i(Y.last_text,Q.line_starters)||","===Y.last_text)?(e=!1,t=!1,!U.wanted_newline||"--"!==U.text&&"++"!==U.text||p(!1,!0),";"===Y.last_text&&b(Y.mode)&&(e=!0),"TK_RESERVED"===X?e=!0:"TK_END_EXPR"===X?e=!("]"===Y.last_text&&("--"===U.text||"++"===U.text)):"TK_OPERATOR"===X&&(e=i(U.text,["--","-","++","+"])&&i(Y.last_text,["--","-","++","+"]),i(U.text,["+","-"])&&i(Y.last_text,["--","++"])&&(t=!0)),Y.mode!==u.BlockStatement&&Y.mode!==u.Statement||"{"!==Y.last_text&&";"!==Y.last_text||p()):":"===U.text?0===Y.ternary_depth?e=!1:Y.ternary_depth-=1:"?"===U.text?Y.ternary_depth+=1:"*"===U.text&&"TK_RESERVED"===X&&"function"===Y.last_text&&(e=!1,t=!1),W.space_before_token=W.space_before_token||e,m(),W.space_before_token=t}function F(){if(W.raw)return W.add_raw_token(U),U.directives&&"end"===U.directives.preserve&&(tt.test_output_raw||(W.raw=!1)),void 0;if(U.directives)return p(!1,!0),m(),"start"===U.directives.preserve&&(W.raw=!0),p(!1,!0),void 0;if(!d.newline.test(U.text)&&!U.wanted_newline)return W.space_before_token=!0,m(),W.space_before_token=!0,void 0;var e,t=a(U.text),i=!1,n=!1,s=U.whitespace_before,o=s.length;for(p(!1,!0),t.length>1&&(x(t.slice(1),"*")?i=!0:A(t.slice(1),s)&&(n=!0)),m(t[0]),e=1;e<t.length;e++)p(!1,!0),i?m(" "+r(t[e])):n&&t[e].length>o?m(t[e].substring(o)):W.add_token(t[e]);p(!1,!0)}function z(){U.wanted_newline?p(!1,!0):W.trim(!0),W.space_before_token=!0,m(),p(!1,!0)}function $(){C(),"TK_RESERVED"===X&&T(Y.last_text)?W.space_before_token=!0:h(")"===Y.last_text&&tt.break_chained_methods),m()}function H(){m(),"\n"===U.text[U.text.length-1]&&p()}function B(){for(;Y.mode===u.Statement;)w()}var W,q,Q,U,X,V,G,Y,K,J,Z,et,tt,it=[],nt="";for(et={TK_START_EXPR:M,TK_END_EXPR:N,TK_START_BLOCK:E,TK_END_BLOCK:D,TK_WORD:O,TK_RESERVED:O,TK_SEMICOLON:R,TK_STRING:L,TK_EQUALS:I,TK_OPERATOR:P,TK_COMMA:j,TK_BLOCK_COMMENT:F,TK_COMMENT:z,TK_DOT:$,TK_UNKNOWN:H,TK_EOF:B},t=t?t:{},tt={},void 0!==t.braces_on_own_line&&(tt.brace_style=t.braces_on_own_line?"expand":"collapse"),tt.brace_style=t.brace_style?t.brace_style:tt.brace_style?tt.brace_style:"collapse","expand-strict"===tt.brace_style&&(tt.brace_style="expand"),tt.indent_size=t.indent_size?parseInt(t.indent_size,10):4,tt.indent_char=t.indent_char?t.indent_char:" ",tt.eol=t.eol?t.eol:"\n",tt.preserve_newlines=void 0===t.preserve_newlines?!0:t.preserve_newlines,tt.break_chained_methods=void 0===t.break_chained_methods?!1:t.break_chained_methods,tt.max_preserve_newlines=void 0===t.max_preserve_newlines?0:parseInt(t.max_preserve_newlines,10),tt.space_in_paren=void 0===t.space_in_paren?!1:t.space_in_paren,tt.space_in_empty_paren=void 0===t.space_in_empty_paren?!1:t.space_in_empty_paren,tt.jslint_happy=void 0===t.jslint_happy?!1:t.jslint_happy,tt.space_after_anon_function=void 0===t.space_after_anon_function?!1:t.space_after_anon_function,tt.keep_array_indentation=void 0===t.keep_array_indentation?!1:t.keep_array_indentation,tt.space_before_conditional=void 0===t.space_before_conditional?!0:t.space_before_conditional,tt.unescape_strings=void 0===t.unescape_strings?!1:t.unescape_strings,tt.wrap_line_length=void 0===t.wrap_line_length?0:parseInt(t.wrap_line_length,10),tt.e4x=void 0===t.e4x?!1:t.e4x,tt.end_with_newline=void 0===t.end_with_newline?!1:t.end_with_newline,tt.comma_first=void 0===t.comma_first?!1:t.comma_first,tt.test_output_raw=void 0===t.test_output_raw?!1:t.test_output_raw,tt.jslint_happy&&(tt.space_after_anon_function=!0),t.indent_with_tabs&&(tt.indent_char="	",tt.indent_size=1),tt.eol=tt.eol.replace(/\\r/,"\r").replace(/\\n/,"\n"),G="";tt.indent_size>0;)G+=tt.indent_char,tt.indent_size-=1;var rt=0;if(e&&e.length){for(;" "===e.charAt(rt)||"	"===e.charAt(rt);)nt+=e.charAt(rt),rt+=1;e=e.substring(rt)}X="TK_START_BLOCK",V="",W=new l(G,nt),W.raw=tt.test_output_raw,J=[],_(u.BlockStatement),this.beautify=function(){var t,i;for(Q=new c(e,tt,G),it=Q.tokenize(),q=0;t=S();){for(var n=0;n<t.comments_before.length;n++)o(t.comments_before[n]);o(t),V=Y.last_text,X=t.type,Y.last_text=t.text,q+=1}return i=W.get_code(),tt.end_with_newline&&(i+="\n"),"\n"!=tt.eol&&(i=i.replace(/[\n]/g,tt.eol)),i}}function a(e){var t=0,i=-1,n=[],r=!0;this.set_indent=function(n){t=e.baseIndentLength+n*e.indent_length,i=n},this.get_character_count=function(){return t},this.is_empty=function(){return r},this.last=function(){return this._empty?null:n[n.length-1]},this.push=function(e){n.push(e),t+=e.length,r=!1},this.pop=function(){var e=null;return r||(e=n.pop(),t-=e.length,r=0===n.length),e},this.remove_indent=function(){i>0&&(i-=1,t-=e.indent_length)},this.trim=function(){for(;" "===this.last();)n.pop(),t-=1;r=0===n.length},this.toString=function(){var t="";return this._empty||(i>=0&&(t=e.indent_cache[i]),t+=n.join("")),t}}function l(e,t){t=t||"",this.indent_cache=[t],this.baseIndentLength=t.length,this.indent_length=e.length,this.raw=!1;var i=[];this.baseIndentString=t,this.indent_string=e,this.previous_line=null,this.current_line=null,this.space_before_token=!1,this.add_outputline=function(){this.previous_line=this.current_line,this.current_line=new a(this),i.push(this.current_line)},this.add_outputline(),this.get_line_number=function(){return i.length},this.add_new_line=function(e){return 1===this.get_line_number()&&this.just_added_newline()?!1:e||!this.just_added_newline()?(this.raw||this.add_outputline(),!0):!1},this.get_code=function(){var e=i.join("\n").replace(/[\r\n\t ]+$/,"");return e},this.set_indent=function(e){if(i.length>1){for(;e>=this.indent_cache.length;)this.indent_cache.push(this.indent_cache[this.indent_cache.length-1]+this.indent_string);return this.current_line.set_indent(e),!0}return this.current_line.set_indent(0),!1},this.add_raw_token=function(e){for(var t=0;t<e.newlines;t++)this.add_outputline();this.current_line.push(e.whitespace_before),this.current_line.push(e.text),this.space_before_token=!1},this.add_token=function(e){this.add_space_before_token(),this.current_line.push(e)},this.add_space_before_token=function(){this.space_before_token&&!this.just_added_newline()&&this.current_line.push(" "),this.space_before_token=!1},this.remove_redundant_indentation=function(e){if(!e.multiline_frame&&e.mode!==u.ForInitializer&&e.mode!==u.Conditional)for(var t=e.start_line_index,n=i.length;n>t;)i[t].remove_indent(),t++},this.trim=function(n){for(n=void 0===n?!1:n,this.current_line.trim(e,t);n&&i.length>1&&this.current_line.is_empty();)i.pop(),this.current_line=i[i.length-1],this.current_line.trim();this.previous_line=i.length>1?i[i.length-2]:null},this.just_added_newline=function(){return this.current_line.is_empty()
},this.just_added_blankline=function(){if(this.just_added_newline()){if(1===i.length)return!0;var e=i[i.length-2];return e.is_empty()}return!1}}function c(e,t){function r(e){if(!e.match(C))return null;var t={};x.lastIndex=0;for(var i=x.exec(e);i;)t[i[1]]=i[2],i=x.exec(e);return t}function s(){var s,C=[];if(f=0,m="",_>=y)return["","TK_EOF"];var x;x=v.length?v[v.length-1]:new h("TK_START_BLOCK","{");var S=e.charAt(_);for(_+=1;i(S,a);){if(d.newline.test(S)?("\n"!==S||"\r"!==e.charAt(_-2))&&(f+=1,C=[]):C.push(S),_>=y)return["","TK_EOF"];S=e.charAt(_),_+=1}if(C.length&&(m=C.join("")),l.test(S)){var M=!0,N=!0,E=l;for("0"===S&&y>_&&/[Xxo]/.test(e.charAt(_))?(M=!1,N=!1,S+=e.charAt(_),_+=1,E=/[o]/.test(e.charAt(_))?c:u):(S="",_-=1);y>_&&E.test(e.charAt(_));)S+=e.charAt(_),_+=1,M&&y>_&&"."===e.charAt(_)&&(S+=e.charAt(_),_+=1,M=!1),N&&y>_&&/[Ee]/.test(e.charAt(_))&&(S+=e.charAt(_),_+=1,y>_&&/[+-]/.test(e.charAt(_))&&(S+=e.charAt(_),_+=1),N=!1,M=!1);return[S,"TK_WORD"]}if(d.isIdentifierStart(e.charCodeAt(_-1))){if(y>_)for(;d.isIdentifierChar(e.charCodeAt(_))&&(S+=e.charAt(_),_+=1,_!==y););return"TK_DOT"===x.type||"TK_RESERVED"===x.type&&i(x.text,["set","get"])||!i(S,b)?[S,"TK_WORD"]:"in"===S?[S,"TK_OPERATOR"]:[S,"TK_RESERVED"]}if("("===S||"["===S)return[S,"TK_START_EXPR"];if(")"===S||"]"===S)return[S,"TK_END_EXPR"];if("{"===S)return[S,"TK_START_BLOCK"];if("}"===S)return[S,"TK_END_BLOCK"];if(";"===S)return[S,"TK_SEMICOLON"];if("/"===S){var D="";if("*"===e.charAt(_)){_+=1,w.lastIndex=_;var O=w.exec(e);D="/*"+O[0],_+=O[0].length;var R=r(D);return R&&"start"===R.ignore&&(A.lastIndex=_,O=A.exec(e),D+=O[0],_+=O[0].length),D=D.replace(d.lineBreak,"\n"),[D,"TK_BLOCK_COMMENT",R]}if("/"===e.charAt(_)){_+=1,k.lastIndex=_;var O=k.exec(e);return D="//"+O[0],_+=O[0].length,[D,"TK_COMMENT"]}}if("`"===S||"'"===S||'"'===S||("/"===S||t.e4x&&"<"===S&&e.slice(_-1).match(/^<([-a-zA-Z:0-9_.]+|{[^{}]*}|!\[CDATA\[[\s\S]*?\]\])(\s+[-a-zA-Z:0-9_.]+\s*=\s*('[^']*'|"[^"]*"|{.*?}))*\s*(\/?)\s*>/))&&("TK_RESERVED"===x.type&&i(x.text,["return","case","throw","else","do","typeof","yield"])||"TK_END_EXPR"===x.type&&")"===x.text&&x.parent&&"TK_RESERVED"===x.parent.type&&i(x.parent.text,["if","while","for"])||i(x.type,["TK_COMMENT","TK_START_EXPR","TK_START_BLOCK","TK_END_BLOCK","TK_OPERATOR","TK_EQUALS","TK_EOF","TK_SEMICOLON","TK_COMMA"]))){var L=S,I=!1,j=!1;if(s=S,"/"===L)for(var P=!1;y>_&&(I||P||e.charAt(_)!==L)&&!d.newline.test(e.charAt(_));)s+=e.charAt(_),I?I=!1:(I="\\"===e.charAt(_),"["===e.charAt(_)?P=!0:"]"===e.charAt(_)&&(P=!1)),_+=1;else if(t.e4x&&"<"===L){var F=/<(\/?)([-a-zA-Z:0-9_.]+|{[^{}]*}|!\[CDATA\[[\s\S]*?\]\])(\s+[-a-zA-Z:0-9_.]+\s*=\s*('[^']*'|"[^"]*"|{.*?}))*\s*(\/?)\s*>/g,z=e.slice(_-1),$=F.exec(z);if($&&0===$.index){for(var H=$[2],B=0;$;){var W=!!$[1],q=$[2],Q=!!$[$.length-1]||"![CDATA["===q.slice(0,8);if(q!==H||Q||(W?--B:++B),0>=B)break;$=F.exec(z)}var U=$?$.index+$[0].length:z.length;return z=z.slice(0,U),_+=U-1,z=z.replace(d.lineBreak,"\n"),[z,"TK_STRING"]}}else for(;y>_&&(I||e.charAt(_)!==L&&("`"===L||!d.newline.test(e.charAt(_))));)(I||"`"===L)&&d.newline.test(e.charAt(_))?("\r"===e.charAt(_)&&"\n"===e.charAt(_+1)&&(_+=1),s+="\n"):s+=e.charAt(_),I?(("x"===e.charAt(_)||"u"===e.charAt(_))&&(j=!0),I=!1):I="\\"===e.charAt(_),_+=1;if(j&&t.unescape_strings&&(s=o(s)),y>_&&e.charAt(_)===L&&(s+=L,_+=1,"/"===L))for(;y>_&&d.isIdentifierStart(e.charCodeAt(_));)s+=e.charAt(_),_+=1;return[s,"TK_STRING"]}if("#"===S){if(0===v.length&&"!"===e.charAt(_)){for(s=S;y>_&&"\n"!==S;)S=e.charAt(_),s+=S,_+=1;return[n(s)+"\n","TK_UNKNOWN"]}var X="#";if(y>_&&l.test(e.charAt(_))){do S=e.charAt(_),X+=S,_+=1;while(y>_&&"#"!==S&&"="!==S);return"#"===S||("["===e.charAt(_)&&"]"===e.charAt(_+1)?(X+="[]",_+=2):"{"===e.charAt(_)&&"}"===e.charAt(_+1)&&(X+="{}",_+=2)),[X,"TK_WORD"]}}if("<"===S&&("?"===e.charAt(_)||"%"===e.charAt(_))){T.lastIndex=_-1;var V=T.exec(e);if(V)return S=V[0],_+=S.length-1,S=S.replace(d.lineBreak,"\n"),[S,"TK_STRING"]}if("<"===S&&"<!--"===e.substring(_-1,_+3)){for(_+=3,S="<!--";!d.newline.test(e.charAt(_))&&y>_;)S+=e.charAt(_),_++;return g=!0,[S,"TK_COMMENT"]}if("-"===S&&g&&"-->"===e.substring(_-1,_+2))return g=!1,_+=2,["-->","TK_COMMENT"];if("."===S)return[S,"TK_DOT"];if(i(S,p)){for(;y>_&&i(S+e.charAt(_),p)&&(S+=e.charAt(_),_+=1,!(_>=y)););return","===S?[S,"TK_COMMA"]:"="===S?[S,"TK_EQUALS"]:[S,"TK_OPERATOR"]}return[S,"TK_UNKNOWN"]}function o(e){for(var t,i=!1,n="",r=0,s="",o=0;i||r<e.length;)if(t=e.charAt(r),r++,i){if(i=!1,"x"===t)s=e.substr(r,2),r+=2;else{if("u"!==t){n+="\\"+t;continue}s=e.substr(r,4),r+=4}if(!s.match(/^[0123456789abcdefABCDEF]+$/))return e;if(o=parseInt(s,16),o>=0&&32>o){n+="x"===t?"\\x"+s:"\\u"+s;continue}if(34===o||39===o||92===o)n+="\\"+String.fromCharCode(o);else{if("x"===t&&o>126&&255>=o)return e;n+=String.fromCharCode(o)}}else"\\"===t?i=!0:n+=t;return n}var a="\n\r	 ".split(""),l=/[0-9]/,c=/[01234567]/,u=/[0123456789abcdefABCDEF]/,p="+ - * / % & ++ -- = += -= *= /= %= == === != !== > < >= <= >> << >>> >>>= >>= <<= && &= | || ! ~ , : ? ^ ^= |= :: =>".split(" ");this.line_starters="continue,try,throw,return,var,let,const,if,switch,case,default,for,while,break,function,import,export".split(",");var f,m,g,v,_,y,b=this.line_starters.concat(["do","in","else","get","set","new","catch","finally","typeof","yield","async","await"]),w=/([\s\S]*?)((?:\*\/)|$)/g,k=/([^\n\r\u2028\u2029]*)/g,C=/\/\* beautify( \w+[:]\w+)+ \*\//g,x=/ (\w+)[:](\w+)/g,A=/([\s\S]*?)((?:\/\*\sbeautify\signore:end\s\*\/)|$)/g,T=/((<\?php|<\?=)[\s\S]*?\?>)|(<%[\s\S]*?%>)/g;this.tokenize=function(){y=e.length,_=0,g=!1,v=[];for(var t,i,n,r=null,o=[],a=[];!i||"TK_EOF"!==i.type;){for(n=s(),t=new h(n[1],n[0],f,m);"TK_COMMENT"===t.type||"TK_BLOCK_COMMENT"===t.type||"TK_UNKNOWN"===t.type;)"TK_BLOCK_COMMENT"===t.type&&(t.directives=n[2]),a.push(t),n=s(),t=new h(n[1],n[0],f,m);a.length&&(t.comments_before=a,a=[]),"TK_START_BLOCK"===t.type||"TK_START_EXPR"===t.type?(t.parent=i,o.push(r),r=t):("TK_END_BLOCK"===t.type||"TK_END_EXPR"===t.type)&&r&&("]"===t.text&&"["===r.text||")"===t.text&&"("===r.text||"}"===t.text&&"{"===r.text)&&(t.parent=r.parent,r=o.pop()),v.push(t),i=t}return v}}var d={};!function(e){var t="ªµºÀ-ÖØ-öø-ˁˆ-ˑˠ-ˤˬˮͰ-ʹͶͷͺ-ͽΆΈ-ΊΌΎ-ΡΣ-ϵϷ-ҁҊ-ԧԱ-Ֆՙա-ևא-תװ-ײؠ-يٮٯٱ-ۓەۥۦۮۯۺ-ۼۿܐܒ-ܯݍ-ޥޱߊ-ߪߴߵߺࠀ-ࠕࠚࠤࠨࡀ-ࡘࢠࢢ-ࢬऄ-हऽॐक़-ॡॱ-ॷॹ-ॿঅ-ঌএঐও-নপ-রলশ-হঽৎড়ঢ়য়-ৡৰৱਅ-ਊਏਐਓ-ਨਪ-ਰਲਲ਼ਵਸ਼ਸਹਖ਼-ੜਫ਼ੲ-ੴઅ-ઍએ-ઑઓ-નપ-રલળવ-હઽૐૠૡଅ-ଌଏଐଓ-ନପ-ରଲଳଵ-ହଽଡ଼ଢ଼ୟ-ୡୱஃஅ-ஊஎ-ஐஒ-கஙசஜஞடணதந-பம-ஹௐఅ-ఌఎ-ఐఒ-నప-ళవ-హఽౘౙౠౡಅ-ಌಎ-ಐಒ-ನಪ-ಳವ-ಹಽೞೠೡೱೲഅ-ഌഎ-ഐഒ-ഺഽൎൠൡൺ-ൿඅ-ඖක-නඳ-රලව-ෆก-ะาำเ-ๆກຂຄງຈຊຍດ-ທນ-ຟມ-ຣລວສຫອ-ະາຳຽເ-ໄໆໜ-ໟༀཀ-ཇཉ-ཬྈ-ྌက-ဪဿၐ-ၕၚ-ၝၡၥၦၮ-ၰၵ-ႁႎႠ-ჅჇჍა-ჺჼ-ቈቊ-ቍቐ-ቖቘቚ-ቝበ-ኈኊ-ኍነ-ኰኲ-ኵኸ-ኾዀዂ-ዅወ-ዖዘ-ጐጒ-ጕጘ-ፚᎀ-ᎏᎠ-Ᏼᐁ-ᙬᙯ-ᙿᚁ-ᚚᚠ-ᛪᛮ-ᛰᜀ-ᜌᜎ-ᜑᜠ-ᜱᝀ-ᝑᝠ-ᝬᝮ-ᝰក-ឳៗៜᠠ-ᡷᢀ-ᢨᢪᢰ-ᣵᤀ-ᤜᥐ-ᥭᥰ-ᥴᦀ-ᦫᧁ-ᧇᨀ-ᨖᨠ-ᩔᪧᬅ-ᬳᭅ-ᭋᮃ-ᮠᮮᮯᮺ-ᯥᰀ-ᰣᱍ-ᱏᱚ-ᱽᳩ-ᳬᳮ-ᳱᳵᳶᴀ-ᶿḀ-ἕἘ-Ἕἠ-ὅὈ-Ὅὐ-ὗὙὛὝὟ-ώᾀ-ᾴᾶ-ᾼιῂ-ῄῆ-ῌῐ-ΐῖ-Ίῠ-Ῥῲ-ῴῶ-ῼⁱⁿₐ-ₜℂℇℊ-ℓℕℙ-ℝℤΩℨK-ℭℯ-ℹℼ-ℿⅅ-ⅉⅎⅠ-ↈⰀ-Ⱞⰰ-ⱞⱠ-ⳤⳫ-ⳮⳲⳳⴀ-ⴥⴧⴭⴰ-ⵧⵯⶀ-ⶖⶠ-ⶦⶨ-ⶮⶰ-ⶶⶸ-ⶾⷀ-ⷆⷈ-ⷎⷐ-ⷖⷘ-ⷞⸯ々-〇〡-〩〱-〵〸-〼ぁ-ゖゝ-ゟァ-ヺー-ヿㄅ-ㄭㄱ-ㆎㆠ-ㆺㇰ-ㇿ㐀-䶵一-鿌ꀀ-ꒌꓐ-ꓽꔀ-ꘌꘐ-ꘟꘪꘫꙀ-ꙮꙿ-ꚗꚠ-ꛯꜗ-ꜟꜢ-ꞈꞋ-ꞎꞐ-ꞓꞠ-Ɦꟸ-ꠁꠃ-ꠅꠇ-ꠊꠌ-ꠢꡀ-ꡳꢂ-ꢳꣲ-ꣷꣻꤊ-ꤥꤰ-ꥆꥠ-ꥼꦄ-ꦲꧏꨀ-ꨨꩀ-ꩂꩄ-ꩋꩠ-ꩶꩺꪀ-ꪯꪱꪵꪶꪹ-ꪽꫀꫂꫛ-ꫝꫠ-ꫪꫲ-ꫴꬁ-ꬆꬉ-ꬎꬑ-ꬖꬠ-ꬦꬨ-ꬮꯀ-ꯢ가-힣ힰ-ퟆퟋ-ퟻ豈-舘並-龎ﬀ-ﬆﬓ-ﬗיִײַ-ﬨשׁ-זּטּ-לּמּנּסּףּפּצּ-ﮱﯓ-ﴽﵐ-ﶏﶒ-ﷇﷰ-ﷻﹰ-ﹴﹶ-ﻼＡ-Ｚａ-ｚｦ-ﾾￂ-ￇￊ-ￏￒ-ￗￚ-ￜ",i="̀-ͯ҃-֑҇-ׇֽֿׁׂׅׄؐ-ؚؠ-ىٲ-ۓۧ-ۨۻ-ۼܰ-݊ࠀ-ࠔࠛ-ࠣࠥ-ࠧࠩ-࠭ࡀ-ࡗࣤ-ࣾऀ-ःऺ-़ा-ॏ॑-ॗॢ-ॣ०-९ঁ-ঃ়া-ৄেৈৗয়-ৠਁ-ਃ਼ਾ-ੂੇੈੋ-੍ੑ੦-ੱੵઁ-ઃ઼ા-ૅે-ૉો-્ૢ-ૣ૦-૯ଁ-ଃ଼ା-ୄେୈୋ-୍ୖୗୟ-ୠ୦-୯ஂா-ூெ-ைொ-்ௗ௦-௯ఁ-ఃె-ైొ-్ౕౖౢ-ౣ౦-౯ಂಃ಼ಾ-ೄೆ-ೈೊ-್ೕೖೢ-ೣ೦-೯ംഃെ-ൈൗൢ-ൣ൦-൯ංඃ්ා-ුූෘ-ෟෲෳิ-ฺเ-ๅ๐-๙ິ-ູ່-ໍ໐-໙༘༙༠-༩༹༵༷ཁ-ཇཱ-྄྆-྇ྍ-ྗྙ-ྼ࿆က-ဩ၀-၉ၧ-ၭၱ-ၴႂ-ႍႏ-ႝ፝-፟ᜎ-ᜐᜠ-ᜰᝀ-ᝐᝲᝳក-ឲ៝០-៩᠋-᠍᠐-᠙ᤠ-ᤫᤰ-᤻ᥑ-ᥭᦰ-ᧀᧈ-ᧉ᧐-᧙ᨀ-ᨕᨠ-ᩓ᩠-᩿᩼-᪉᪐-᪙ᭆ-ᭋ᭐-᭙᭫-᭳᮰-᮹᯦-᯳ᰀ-ᰢ᱀-᱉ᱛ-ᱽ᳐-᳒ᴀ-ᶾḁ-ἕ‌‍‿⁀⁔⃐-⃥⃜⃡-⃰ⶁ-ⶖⷠ-ⷿ〡-〨゙゚Ꙁ-ꙭꙴ-꙽ꚟ꛰-꛱ꟸ-ꠀ꠆ꠋꠣ-ꠧꢀ-ꢁꢴ-꣄꣐-꣙ꣳ-ꣷ꤀-꤉ꤦ-꤭ꤰ-ꥅꦀ-ꦃ꦳-꧀ꨀ-ꨧꩀ-ꩁꩌ-ꩍ꩐-꩙ꩻꫠ-ꫩꫲ-ꫳꯀ-ꯡ꯬꯭꯰-꯹ﬠ-ﬨ︀-️︠-︦︳︴﹍-﹏０-９＿",n=new RegExp("["+t+"]"),r=new RegExp("["+t+i+"]");e.newline=/[\n\r\u2028\u2029]/,e.lineBreak=new RegExp("\r\n|"+e.newline.source),e.allLineBreaks=new RegExp(e.lineBreak.source,"g"),e.isIdentifierStart=function(e){return 65>e?36===e||64===e:91>e?!0:97>e?95===e:123>e?!0:e>=170&&n.test(String.fromCharCode(e))},e.isIdentifierChar=function(e){return 48>e?36===e:58>e?!0:65>e?!1:91>e?!0:97>e?95===e:123>e?!0:e>=170&&r.test(String.fromCharCode(e))}}(d);var u={BlockStatement:"BlockStatement",Statement:"Statement",ObjectLiteral:"ObjectLiteral",ArrayLiteral:"ArrayLiteral",ForInitializer:"ForInitializer",Conditional:"Conditional",Expression:"Expression"},h=function(e,t,i,n){this.type=e,this.text=t,this.comments_before=[],this.newlines=i||0,this.wanted_newline=i>0,this.whitespace_before=n||"",this.parent=null,this.directives=null};return{run:e}}}),/*!
 * froala_editor v2.3.5 (https://www.froala.com/wysiwyg-editor)
 * License https://froala.com/wysiwyg-editor/terms/
 * Copyright 2014-2016 Froala Labs
 */
function(e){"function"==typeof define&&define.amd?define(["jquery"],e):"object"==typeof module&&module.exports?module.exports=function(t,i){return void 0===i&&(i="undefined"!=typeof window?require("jquery"):require("jquery")(t)),e(i),i}:e(jQuery)}(function(e){"use strict";e.extend(e.FE.DEFAULTS,{codeMirror:!0,codeMirrorOptions:{lineNumbers:!0,tabMode:"indent",indentWithTabs:!0,lineWrapping:!0,mode:"text/html",tabSize:2},codeBeautifierOptions:{end_with_newline:!0,indent_inner_html:!0,extra_liners:["p","h1","h2","h3","h4","h5","h6","blockquote","pre","ul","ol","table","dl"],brace_style:"expand",indent_char:"	",indent_size:1,wrap_line_length:0}}),e.FE.PLUGINS.codeView=function(t){function i(){return t.$box.hasClass("fr-code-view")}function n(){return u?u.getValue():d.val()}function r(e){var i=n();t.html.set(i),t.$el.blur(),t.$tb.find(" > .fr-command").not(e).removeClass("fr-disabled"),e.removeClass("fr-active"),t.events.focus(!0),t.placeholder.refresh(),t.undo.saveStep()}function s(i){d||(l(),!u&&t.opts.codeMirror&&"undefined"!=typeof CodeMirror?u=CodeMirror.fromTextArea(d.get(0),t.opts.codeMirrorOptions):t.events.$on(d,"keydown keyup change input",function(){if(t.opts.height)this.rows=null;else if(this.rows||(this.rows=1),0===this.value.length)this.rows=1;else{for(this.style.height="auto";this.rows>1&&this.scrollHeight<=this.offsetHeight;)this.rows-=1;for(;this.scrollHeight>this.offsetHeight&&(!t.opts.heightMax||this.offsetHeight<t.opts.heightMax);)this.rows+=1}})),t.undo.saveStep(),t.html.cleanEmptyTags(),t.html.cleanWhiteTags(!0),t.core.hasFocus()&&(t.core.isEmpty()||(t.selection.save(),t.$el.find('.fr-marker[data-type="true"]:first').replaceWith('<span class="fr-tmp fr-sm">F</span>'),t.$el.find('.fr-marker[data-type="false"]:last').replaceWith('<span class="fr-tmp fr-em">F</span>')));var n=t.html.get(!1,!0);t.$el.find("span.fr-tmp").remove(),t.$box.toggleClass("fr-code-view",!0),t.core.hasFocus()&&t.$el.blur(),n=n.replace(/<span class="fr-tmp fr-sm">F<\/span>/,"FROALA-SM"),n=n.replace(/<span class="fr-tmp fr-em">F<\/span>/,"FROALA-EM"),t.codeBeautifier&&(n=t.codeBeautifier.run(n,t.opts.codeBeautifierOptions));var r,s;if(u){r=n.indexOf("FROALA-SM"),s=n.indexOf("FROALA-EM"),r>s?r=s:s-=9,n=n.replace(/FROALA-SM/g,"").replace(/FROALA-EM/g,"");var o=n.substring(0,r).length-n.substring(0,r).replace(/\n/g,"").length,a=n.substring(0,s).length-n.substring(0,s).replace(/\n/g,"").length;r=n.substring(0,r).length-n.substring(0,n.substring(0,r).lastIndexOf("\n")+1).length,s=n.substring(0,s).length-n.substring(0,n.substring(0,s).lastIndexOf("\n")+1).length,u.setSize(null,t.opts.height?t.opts.height:"auto"),t.opts.heightMin&&t.$box.find(".CodeMirror-scroll").css("min-height",t.opts.heightMin),u.setValue(n),u.focus(),u.setSelection({line:o,ch:r},{line:a,ch:s}),u.refresh(),u.clearHistory()}else{r=n.indexOf("FROALA-SM"),s=n.indexOf("FROALA-EM")-9,t.opts.heightMin&&d.css("min-height",t.opts.heightMin),t.opts.height&&d.css("height",t.opts.height),t.opts.heightMax&&d.css("max-height",t.opts.height||t.opts.heightMax),d.val(n.replace(/FROALA-SM/g,"").replace(/FROALA-EM/g,"")).trigger("change");var c=e(t.o_doc).scrollTop();d.focus(),d.get(0).setSelectionRange(r,s),e(t.o_doc).scrollTop(c)}t.$tb.find(" > .fr-command").not(i).addClass("fr-disabled"),i.addClass("fr-active"),!t.helpers.isMobile()&&t.opts.toolbarInline&&t.toolbar.hide()}function o(e){"undefined"==typeof e&&(e=!i());var n=t.$tb.find('.fr-command[data-cmd="html"]');e?(t.popups.hideAll(),s(n)):(t.$box.toggleClass("fr-code-view",!1),r(n))}function a(){i()&&o(t.$tb.find('button[data-cmd="html"]')),u&&u.toTextArea(),d.val("").removeData().remove(),d=null,h&&(h.remove(),h=null)}function l(){d=e('<textarea class="fr-code" tabindex="-1">'),t.$wp.append(d),d.attr("dir",t.opts.direction),t.$box.hasClass("fr-basic")||(h=e('<a data-cmd="html" title="Code View" class="fr-command fr-btn html-switch'+(t.helpers.isMobile()?"":" fr-desktop")+'" role="button" tabindex="-1"><i class="fa fa-code"></i></button>'),t.$box.append(h),t.events.bindClick(t.$box,"a.html-switch",function(){o(!1)}));var r=function(){return!i()};t.events.on("buttons.refresh",r),t.events.on("copy",r,!0),t.events.on("cut",r,!0),t.events.on("paste",r,!0),t.events.on("destroy",a,!0),t.events.on("html.set",function(){i()&&o(!0)}),t.events.on("form.submit",function(){i()&&(t.html.set(n()),t.events.trigger("contentChanged",[],!0))},!0)}function c(){return t.$wp?void 0:!1}var d,u,h;return{_init:c,toggle:o,isActive:i,get:n}},e.FE.RegisterCommand("html",{title:"Code View",undo:!1,focus:!1,forcedRefresh:!0,callback:function(){this.codeView.toggle()},plugin:"codeView"}),e.FE.DefineIcon("html",{NAME:"code"})}),/*!
 * froala_editor v2.3.5 (https://www.froala.com/wysiwyg-editor)
 * License https://froala.com/wysiwyg-editor/terms/
 * Copyright 2014-2016 Froala Labs
 */
function(e){"function"==typeof define&&define.amd?define(["jquery"],e):"object"==typeof module&&module.exports?module.exports=function(t,i){return void 0===i&&(i="undefined"!=typeof window?require("jquery"):require("jquery")(t)),e(i),i}:e(jQuery)}(function(e){"use strict";e.extend(e.FE.POPUP_TEMPLATES,{"colors.picker":"[_BUTTONS_][_TEXT_COLORS_][_BACKGROUND_COLORS_]"}),e.extend(e.FE.DEFAULTS,{colorsText:["#61BD6D","#1ABC9C","#54ACD2","#2C82C9","#9365B8","#475577","#CCCCCC","#41A85F","#00A885","#3D8EB9","#2969B0","#553982","#28324E","#000000","#F7DA64","#FBA026","#EB6B56","#E25041","#A38F84","#EFEFEF","#FFFFFF","#FAC51C","#F37934","#D14841","#B8312F","#7C706B","#D1D5D8","REMOVE"],colorsBackground:["#61BD6D","#1ABC9C","#54ACD2","#2C82C9","#9365B8","#475577","#CCCCCC","#41A85F","#00A885","#3D8EB9","#2969B0","#553982","#28324E","#000000","#F7DA64","#FBA026","#EB6B56","#E25041","#A38F84","#EFEFEF","#FFFFFF","#FAC51C","#F37934","#D14841","#B8312F","#7C706B","#D1D5D8","REMOVE"],colorsStep:7,colorsDefaultTab:"text",colorsButtons:["colorsBack","|","-"]}),e.FE.PLUGINS.colors=function(t){function i(){var e=t.$tb.find('.fr-command[data-cmd="color"]'),i=t.popups.get("colors.picker");if(i||(i=r()),!i.hasClass("fr-active"))if(t.popups.setContainer("colors.picker",t.$tb),a(i.find(".fr-selected-tab").attr("data-param1")),e.is(":visible")){var n=e.offset().left+e.outerWidth()/2,s=e.offset().top+(t.opts.toolbarBottom?10:e.outerHeight()-10);t.popups.show("colors.picker",n,s,e.outerHeight())}else t.position.forSelection(i),t.popups.show("colors.picker")}function n(){t.popups.hide("colors.picker")}function r(){var e='<div class="fr-buttons fr-colors-buttons">';t.opts.toolbarInline&&t.opts.colorsButtons.length>0&&(e+=t.button.buildList(t.opts.colorsButtons)),e+=s()+"</div>";var i={buttons:e,text_colors:o("text"),background_colors:o("background")},n=t.popups.create("colors.picker",i);return n}function s(){var e='<div class="fr-colors-tabs">';return e+='<span class="fr-colors-tab '+("background"==t.opts.colorsDefaultTab?"":"fr-selected-tab ")+'fr-command" data-param1="text" data-cmd="colorChangeSet" title="'+t.language.translate("Text")+'">'+t.language.translate("Text")+"</span>",e+='<span class="fr-colors-tab '+("background"==t.opts.colorsDefaultTab?"fr-selected-tab ":"")+'fr-command" data-param1="background" data-cmd="colorChangeSet" title="'+t.language.translate("Background")+'">'+t.language.translate("Background")+"</span>",e+"</div>"}function o(e){for(var i="text"==e?t.opts.colorsText:t.opts.colorsBackground,n='<div class="fr-color-set fr-'+e+"-color"+(t.opts.colorsDefaultTab==e||"text"!=t.opts.colorsDefaultTab&&"background"!=t.opts.colorsDefaultTab&&"text"==e?" fr-selected-set":"")+'">',r=0;r<i.length;r++)0!==r&&0===r%t.opts.colorsStep&&(n+="<br>"),n+="REMOVE"!=i[r]?'<span class="fr-command fr-select-color" style="background: '+i[r]+';" data-cmd="'+e+'Color" data-param1="'+i[r]+'"></span>':'<span class="fr-command fr-select-color" data-cmd="'+e+'Color" data-param1="REMOVE" title="'+t.language.translate("Clear Formatting")+'">'+t.icon.create("remove")+"</span>";return n+"</div>"}function a(i){var n,r=t.popups.get("colors.picker"),s=e(t.selection.element());for(n="background"==i?"background-color":"color",r.find(".fr-"+i+"-color .fr-select-color").removeClass("fr-selected-color");s.get(0)!=t.$el.get(0);){if("transparent"!=s.css(n)&&"rgba(0, 0, 0, 0)"!=s.css(n)){r.find(".fr-"+i+'-color .fr-select-color[data-param1="'+t.helpers.RGBToHex(s.css(n))+'"]').addClass("fr-selected-color");break}s=s.parent()}}function l(e,t){e.hasClass("fr-selected-tab")||(e.siblings().removeClass("fr-selected-tab"),e.addClass("fr-selected-tab"),e.parents(".fr-popup").find(".fr-color-set").removeClass("fr-selected-set"),e.parents(".fr-popup").find(".fr-color-set.fr-"+t+"-color").addClass("fr-selected-set"),a(t))}function c(e){"REMOVE"!=e?t.format.applyStyle("background-color",t.helpers.HEXtoRGB(e)):t.format.removeStyle("background-color"),n()}function d(e){"REMOVE"!=e?t.format.applyStyle("color",t.helpers.HEXtoRGB(e)):t.format.removeStyle("color"),n()}function u(){t.popups.hide("colors.picker"),t.toolbar.showInline()}return{showColorsPopup:i,hideColorsPopup:n,changeSet:l,background:c,text:d,back:u}},e.FE.DefineIcon("colors",{NAME:"tint"}),e.FE.RegisterCommand("color",{title:"Colors",undo:!1,focus:!0,refreshOnCallback:!1,popup:!0,callback:function(){this.popups.isVisible("colors.picker")?(this.$el.find(".fr-marker")&&(this.events.disableBlur(),this.selection.restore()),this.popups.hide("colors.picker")):this.colors.showColorsPopup()},plugin:"colors"}),e.FE.RegisterCommand("textColor",{undo:!0,callback:function(e,t){this.colors.text(t)}}),e.FE.RegisterCommand("backgroundColor",{undo:!0,callback:function(e,t){this.colors.background(t)}}),e.FE.RegisterCommand("colorChangeSet",{undo:!1,focus:!1,callback:function(e,t){var i=this.popups.get("colors.picker").find('.fr-command[data-cmd="'+e+'"][data-param1="'+t+'"]');this.colors.changeSet(i,t)}}),e.FE.DefineIcon("colorsBack",{NAME:"arrow-left"}),e.FE.RegisterCommand("colorsBack",{title:"Back",undo:!1,focus:!1,back:!0,refreshAfterCallback:!1,callback:function(){this.colors.back()}}),e.FE.DefineIcon("remove",{NAME:"eraser"})}),/*!
 * froala_editor v2.3.5 (https://www.froala.com/wysiwyg-editor)
 * License https://froala.com/wysiwyg-editor/terms/
 * Copyright 2014-2016 Froala Labs
 */
function(e){"function"==typeof define&&define.amd?define(["jquery"],e):"object"==typeof module&&module.exports?module.exports=function(t,i){return void 0===i&&(i="undefined"!=typeof window?require("jquery"):require("jquery")(t)),e(i),i}:e(jQuery)}(function(e){"use strict";e.extend(e.FE.DEFAULTS,{dragInline:!0}),e.FE.PLUGINS.draggable=function(t){function i(i){return i.target&&"A"==i.target.tagName&&1==i.target.childNodes.length&&"IMG"==i.target.childNodes[0].tagName&&(i.target=i.target.childNodes[0]),e(i.target).hasClass("fr-draggable")?(e(i.target).addClass("fr-dragging"),t.opts.dragInline?t.$el.attr("contenteditable",!0):t.$el.attr("contenteditable",!1),t.opts.toolbarInline&&t.toolbar.hide(),t.undo.canDo()||t.undo.saveStep(),t.browser.msie||t.browser.edge||t.selection.clear(),i.originalEvent.dataTransfer.setData("text","Froala"),void 0):(i.preventDefault(),!1)}function n(e){return!(e&&("HTML"==e.tagName||"BODY"==e.tagName||t.node.isElement(e)))}function r(e,i,n){t.opts.iframe&&(e+=t.$iframe.offset().top,i+=t.$iframe.offset().left),h.offset().top!=e&&h.css("top",e),h.offset().left!=i&&h.css("left",i),h.width()!=n&&h.css("width",n)}function s(i){var s=t.doc.elementFromPoint(i.originalEvent.pageX-t.win.pageXOffset,i.originalEvent.pageY-t.win.pageYOffset);if(!n(s)){for(var o=0,a=s;!n(a)&&a==s&&i.originalEvent.pageY-t.win.pageYOffset-o>0;)o++,a=t.doc.elementFromPoint(i.originalEvent.pageX-t.win.pageXOffset,i.originalEvent.pageY-t.win.pageYOffset-o);(!n(a)||h&&0===t.$el.find(a).length&&a!=h.get(0))&&(a=null);for(var l=0,c=s;!n(c)&&c==s&&i.originalEvent.pageY-t.win.pageYOffset+l<e(t.doc).height();)l++,c=t.doc.elementFromPoint(i.originalEvent.pageX-t.win.pageXOffset,i.originalEvent.pageY-t.win.pageYOffset+l);(!n(c)||h&&0===t.$el.find(c).length&&c!=h.get(0))&&(c=null),s=null==c&&a?a:c&&null==a?c:c&&a?l>o?a:c:null}if(e(s).hasClass("fr-drag-helper"))return!1;if(s&&!t.node.isBlock(s)&&(s=t.node.blockParent(s)),s&&["TD","TH","TR","THEAD","TBODY"].indexOf(s.tagName)>=0&&(s=e(s).parents("table").get(0)),s&&["LI"].indexOf(s.tagName)>=0&&(s=e(s).parents("UL, OL").get(0)),s&&!e(s).hasClass("fr-drag-helper")){h||(e.FE.$draggable_helper||(e.FE.$draggable_helper=e('<div class="fr-drag-helper"></div>')),h=e.FE.$draggable_helper,t.events.on("shared.destroy",function(){h.html("").removeData().remove(),h=null},!0));var d,u=i.originalEvent.pageY;d=u<e(s).offset().top+e(s).outerHeight()/2?!0:!1;var p=e(s),f=0;d||0!==p.next().length?(d||(p=p.next()),"before"==h.data("fr-position")&&p.is(h.data("fr-tag"))||(p.prev().length>0&&(f=parseFloat(p.prev().css("margin-bottom"))||0),f=Math.max(f,parseFloat(p.css("margin-top"))||0),r(p.offset().top-f/2-t.$box.offset().top,p.offset().left-t.win.pageXOffset-t.$box.offset().left,p.width()),h.data("fr-position","before"))):"after"==h.data("fr-position")&&p.is(h.data("fr-tag"))||(f=parseFloat(p.css("margin-bottom"))||0,r(p.offset().top+e(s).height()+f/2-t.$box.offset().top,p.offset().left-t.win.pageXOffset-t.$box.offset().left,p.width()),h.data("fr-position","after")),h.data("fr-tag",p),h.addClass("fr-visible"),h.appendTo(t.$box)}else h&&t.$box.find(h).length>0&&h.removeClass("fr-visible")}function o(e){e.originalEvent.dataTransfer.dropEffect="move",t.opts.dragInline?c()||!t.browser.msie&&!t.browser.edge||e.preventDefault():(e.preventDefault(),s(e))}function a(e){e.originalEvent.dataTransfer.dropEffect="move",t.opts.dragInline||e.preventDefault()}function l(e){t.$el.attr("contenteditable",!0);var i=t.$el.find(".fr-dragging");h&&h.hasClass("fr-visible")&&t.$box.find(h).length?d(e):i.length&&(e.preventDefault(),e.stopPropagation(),h&&!h.hasClass("fr-visible")&&i.removeClass("fr-dragging")),h&&t.$box.find(h).length&&h.removeClass("fr-visible")}function c(){for(var t=null,i=0;i<e.FE.INSTANCES.length;i++)if(t=e.FE.INSTANCES[i].$el.find(".fr-dragging"),t.length)return t.get(0)}function d(i){for(var n,r,s=0;s<e.FE.INSTANCES.length;s++)if(n=e.FE.INSTANCES[s].$el.find(".fr-dragging"),n.length){r=e.FE.INSTANCES[s];break}if(n.length){if(i.preventDefault(),i.stopPropagation(),h&&h.hasClass("fr-visible")&&t.$box.find(h).length)h.data("fr-tag")[h.data("fr-position")]('<span class="fr-marker"></span>'),h.removeClass("fr-visible");else{var o=t.markers.insertAtPoint(i.originalEvent);if(o===!1)return!1}t.popups.hideAll(),r==t||t.undo.canDo()||t.undo.saveStep();var a=n;if(n.parent().is("A")&&(a=n.parent()),t.core.isEmpty())t.$el.html(a);else{var l=t.$el.find(".fr-marker");l.replaceWith(a),n.after(e.FE.MARKERS),t.selection.restore()}return n.removeClass("fr-dragging"),t.$el.find(t.html.emptyBlockTagsQuery()).not("TD, TH, LI, .fr-inner").remove(),t.html.wrap(),t.html.fillEmptyBlocks(),t.undo.saveStep(),t.opts.iframe&&t.size.syncIframe(),r!=t&&(r.popups.hideAll(),r.$el.find(t.html.emptyBlockTagsQuery()).not("TD, TH, LI, .fr-inner").remove(),r.html.wrap(),r.html.fillEmptyBlocks(),r.undo.saveStep(),r.events.trigger("element.dropped"),r.opts.iframe&&r.size.syncIframe()),t.events.trigger("element.dropped",[n]),!1}}function u(){t.opts.enter==e.FE.ENTER_BR&&(t.opts.dragInline=!0),t.events.on("dragstart",i,!0),t.events.on("dragover",o,!0),t.events.on("dragenter",a,!0),t.events.on("document.dragend",l,!0),t.events.on("document.drop",l,!0),t.events.on("drop",d,!0),t.events.on("html.get",function(e){return e=e.replace(/<(div)((?:[\w\W]*?))class="([\w\W]*?)fr-drag-helper([\w\W]*?)"((?:[\w\W]*?))>((?:[\w\W]*?))<\/(div)>/g,"")})}var h;return{_init:u}}}),/*!
 * froala_editor v2.3.5 (https://www.froala.com/wysiwyg-editor)
 * License https://froala.com/wysiwyg-editor/terms/
 * Copyright 2014-2016 Froala Labs
 */
function(e){"function"==typeof define&&define.amd?define(["jquery"],e):"object"==typeof module&&module.exports?module.exports=function(t,i){return void 0===i&&(i="undefined"!=typeof window?require("jquery"):require("jquery")(t)),e(i),i}:e(jQuery)}(function(e){"use strict";e.extend(e.FE.POPUP_TEMPLATES,{emoticons:"[_BUTTONS_][_EMOTICONS_]"}),e.extend(e.FE.DEFAULTS,{emoticonsStep:8,emoticonsSet:[{code:"1f600",desc:"Grinning face"},{code:"1f601",desc:"Grinning face with smiling eyes"},{code:"1f602",desc:"Face with tears of joy"},{code:"1f603",desc:"Smiling face with open mouth"},{code:"1f604",desc:"Smiling face with open mouth and smiling eyes"},{code:"1f605",desc:"Smiling face with open mouth and cold sweat"},{code:"1f606",desc:"Smiling face with open mouth and tightly-closed eyes"},{code:"1f607",desc:"Smiling face with halo"},{code:"1f608",desc:"Smiling face with horns"},{code:"1f609",desc:"Winking face"},{code:"1f60a",desc:"Smiling face with smiling eyes"},{code:"1f60b",desc:"Face savoring delicious food"},{code:"1f60c",desc:"Relieved face"},{code:"1f60d",desc:"Smiling face with heart-shaped eyes"},{code:"1f60e",desc:"Smiling face with sunglasses"},{code:"1f60f",desc:"Smirking face"},{code:"1f610",desc:"Neutral face"},{code:"1f611",desc:"Expressionless face"},{code:"1f612",desc:"Unamused face"},{code:"1f613",desc:"Face with cold sweat"},{code:"1f614",desc:"Pensive face"},{code:"1f615",desc:"Confused face"},{code:"1f616",desc:"Confounded face"},{code:"1f617",desc:"Kissing face"},{code:"1f618",desc:"Face throwing a kiss"},{code:"1f619",desc:"Kissing face with smiling eyes"},{code:"1f61a",desc:"Kissing face with closed eyes"},{code:"1f61b",desc:"Face with stuck out tongue"},{code:"1f61c",desc:"Face with stuck out tongue and winking eye"},{code:"1f61d",desc:"Face with stuck out tongue and tightly-closed eyes"},{code:"1f61e",desc:"Disappointed face"},{code:"1f61f",desc:"Worried face"},{code:"1f620",desc:"Angry face"},{code:"1f621",desc:"Pouting face"},{code:"1f622",desc:"Crying face"},{code:"1f623",desc:"Persevering face"},{code:"1f624",desc:"Face with look of triumph"},{code:"1f625",desc:"Disappointed but relieved face"},{code:"1f626",desc:"Frowning face with open mouth"},{code:"1f627",desc:"Anguished face"},{code:"1f628",desc:"Fearful face"},{code:"1f629",desc:"Weary face"},{code:"1f62a",desc:"Sleepy face"},{code:"1f62b",desc:"Tired face"},{code:"1f62c",desc:"Grimacing face"},{code:"1f62d",desc:"Loudly crying face"},{code:"1f62e",desc:"Face with open mouth"},{code:"1f62f",desc:"Hushed face"},{code:"1f630",desc:"Face with open mouth and cold sweat"},{code:"1f631",desc:"Face screaming in fear"},{code:"1f632",desc:"Astonished face"},{code:"1f633",desc:"Flushed face"},{code:"1f634",desc:"Sleeping face"},{code:"1f635",desc:"Dizzy face"},{code:"1f636",desc:"Face without mouth"},{code:"1f637",desc:"Face with medical mask"}],emoticonsButtons:["emoticonsBack","|"],emoticonsUseImage:!0}),e.FE.PLUGINS.emoticons=function(t){function i(){var e=t.$tb.find('.fr-command[data-cmd="emoticons"]'),i=t.popups.get("emoticons");if(i||(i=r()),!i.hasClass("fr-active")){t.popups.refresh("emoticons"),t.popups.setContainer("emoticons",t.$tb);var n=e.offset().left+e.outerWidth()/2,s=e.offset().top+(t.opts.toolbarBottom?10:e.outerHeight()-10);t.popups.show("emoticons",n,s,e.outerHeight())}}function n(){t.popups.hide("emoticons")}function r(){var e="";t.opts.toolbarInline&&t.opts.emoticonsButtons.length>0&&(e='<div class="fr-buttons fr-emoticons-buttons">'+t.button.buildList(t.opts.emoticonsButtons)+"</div>");var i={buttons:e,emoticons:s()},n=t.popups.create("emoticons",i);return t.tooltip.bind(n,".fr-emoticon"),n}function s(){for(var e='<div style="text-align: center">',i=0;i<t.opts.emoticonsSet.length;i++)0!==i&&0===i%t.opts.emoticonsStep&&(e+="<br>"),e+='<span class="fr-command fr-emoticon" data-cmd="insertEmoticon" title="'+t.language.translate(t.opts.emoticonsSet[i].desc)+'" data-param1="'+t.opts.emoticonsSet[i].code+'">'+(t.opts.emoticonsUseImage?'<img src="https://cdnjs.cloudflare.com/ajax/libs/emojione/2.0.1/assets/svg/'+t.opts.emoticonsSet[i].code+".svg"+'"/>':"&#x"+t.opts.emoticonsSet[i].code+";")+"</span>";return t.opts.emoticonsUseImage&&(e+='<p style="font-size: 12px; text-align: center; padding: 0 5px;">Emoji free by <a href="http://emojione.com/" target="_blank" rel="nofollow">Emoji One</a></p>'),e+="</div>"}function o(i,n){t.html.insert('<span class="fr-emoticon fr-deletable'+(n?" fr-emoticon-img":"")+'"'+(n?' style="background: url('+n+');"':"")+">"+(n?"&nbsp;":i)+"</span>"+"&nbsp;"+e.FE.MARKERS,!0)}function a(){t.popups.hide("emoticons"),t.toolbar.showInline()}function l(){var i=function(){for(var e=t.$el.get(0).querySelectorAll(".fr-emoticon:not(.fr-deletable)"),i=0;i<e.length;i++)e[i].className+=" fr-deletable"};i(),t.events.on("html.set",i),t.events.on("html.get",function(i){for(var n=0;n<t.opts.emoticonsSet.length;n++){var r=t.opts.emoticonsSet[n],s=e("<div>").html(r.code).text();i=i.split(s).join(r.code)}return i});var n=function(){if(!t.selection.isCollapsed())return!1;var i=t.selection.element(),n=t.selection.endElement();if(e(i).hasClass("fr-emoticon"))return i;if(e(n).hasClass("fr-emoticon"))return n;var r=t.selection.ranges(0),s=r.startContainer;if(s.nodeType==Node.ELEMENT_NODE&&s.childNodes.length>0&&r.startOffset>0){var o=s.childNodes[r.startOffset-1];if(e(o).hasClass("fr-emoticon"))return o}return!1};t.events.on("keydown",function(i){if(t.keys.isCharacter(i.which)&&t.selection.inEditor()){var r=t.selection.ranges(0),s=n();s&&(0===r.startOffset&&t.selection.element()===s?e(s).before(e.FE.MARKERS+e.FE.INVISIBLE_SPACE):e(s).after(e.FE.INVISIBLE_SPACE+e.FE.MARKERS),t.selection.restore())}}),t.events.on("keyup",function(i){for(var r=t.$el.get(0).querySelectorAll(".fr-emoticon"),s=0;s<r.length;s++)"undefined"!=typeof r[s].textContent&&0===r[s].textContent.replace(/\u200B/gi,"").length&&e(r[s]).remove();if(!(i.which>=37&&i.which<=40)){var o=n();o&&(o.className||"").indexOf("fr-emoticon-img")&&(e(o).append(e.FE.MARKERS),t.selection.restore())}})}return{_init:l,insert:o,showEmoticonsPopup:i,hideEmoticonsPopup:n,back:a}},e.FE.DefineIcon("emoticons",{NAME:"smile-o"}),e.FE.RegisterCommand("emoticons",{title:"Emoticons",undo:!1,focus:!0,refreshOnCallback:!1,popup:!0,callback:function(){this.popups.isVisible("emoticons")?(this.$el.find(".fr-marker")&&(this.events.disableBlur(),this.selection.restore()),this.popups.hide("emoticons")):this.emoticons.showEmoticonsPopup()},plugin:"emoticons"}),e.FE.RegisterCommand("insertEmoticon",{callback:function(e,t){this.emoticons.insert("&#x"+t+";",this.opts.emoticonsUseImage?"https://cdnjs.cloudflare.com/ajax/libs/emojione/2.0.1/assets/svg/"+t+".svg":null),this.emoticons.hideEmoticonsPopup()}}),e.FE.DefineIcon("emoticonsBack",{NAME:"arrow-left"}),e.FE.RegisterCommand("emoticonsBack",{title:"Back",undo:!1,focus:!1,back:!0,refreshAfterCallback:!1,callback:function(){this.emoticons.back()}})}),/*!
 * froala_editor v2.3.5 (https://www.froala.com/wysiwyg-editor)
 * License https://froala.com/wysiwyg-editor/terms/
 * Copyright 2014-2016 Froala Labs
 */
function(e){"function"==typeof define&&define.amd?define(["jquery"],e):"object"==typeof module&&module.exports?module.exports=function(t,i){return void 0===i&&(i="undefined"!=typeof window?require("jquery"):require("jquery")(t)),e(i),i}:e(jQuery)}(function(e){"use strict";e.extend(e.FE.DEFAULTS,{entities:"&quot;&#39;&iexcl;&cent;&pound;&curren;&yen;&brvbar;&sect;&uml;&copy;&ordf;&laquo;&not;&shy;&reg;&macr;&deg;&plusmn;&sup2;&sup3;&acute;&micro;&para;&middot;&cedil;&sup1;&ordm;&raquo;&frac14;&frac12;&frac34;&iquest;&Agrave;&Aacute;&Acirc;&Atilde;&Auml;&Aring;&AElig;&Ccedil;&Egrave;&Eacute;&Ecirc;&Euml;&Igrave;&Iacute;&Icirc;&Iuml;&ETH;&Ntilde;&Ograve;&Oacute;&Ocirc;&Otilde;&Ouml;&times;&Oslash;&Ugrave;&Uacute;&Ucirc;&Uuml;&Yacute;&THORN;&szlig;&agrave;&aacute;&acirc;&atilde;&auml;&aring;&aelig;&ccedil;&egrave;&eacute;&ecirc;&euml;&igrave;&iacute;&icirc;&iuml;&eth;&ntilde;&ograve;&oacute;&ocirc;&otilde;&ouml;&divide;&oslash;&ugrave;&uacute;&ucirc;&uuml;&yacute;&thorn;&yuml;&OElig;&oelig;&Scaron;&scaron;&Yuml;&fnof;&circ;&tilde;&Alpha;&Beta;&Gamma;&Delta;&Epsilon;&Zeta;&Eta;&Theta;&Iota;&Kappa;&Lambda;&Mu;&Nu;&Xi;&Omicron;&Pi;&Rho;&Sigma;&Tau;&Upsilon;&Phi;&Chi;&Psi;&Omega;&alpha;&beta;&gamma;&delta;&epsilon;&zeta;&eta;&theta;&iota;&kappa;&lambda;&mu;&nu;&xi;&omicron;&pi;&rho;&sigmaf;&sigma;&tau;&upsilon;&phi;&chi;&psi;&omega;&thetasym;&upsih;&piv;&ensp;&emsp;&thinsp;&zwnj;&zwj;&lrm;&rlm;&ndash;&mdash;&lsquo;&rsquo;&sbquo;&ldquo;&rdquo;&bdquo;&dagger;&Dagger;&bull;&hellip;&permil;&prime;&Prime;&lsaquo;&rsaquo;&oline;&frasl;&euro;&image;&weierp;&real;&trade;&alefsym;&larr;&uarr;&rarr;&darr;&harr;&crarr;&lArr;&uArr;&rArr;&dArr;&hArr;&forall;&part;&exist;&empty;&nabla;&isin;&notin;&ni;&prod;&sum;&minus;&lowast;&radic;&prop;&infin;&ang;&and;&or;&cap;&cup;&int;&there4;&sim;&cong;&asymp;&ne;&equiv;&le;&ge;&sub;&sup;&nsub;&sube;&supe;&oplus;&otimes;&perp;&sdot;&lceil;&rceil;&lfloor;&rfloor;&lang;&rang;&loz;&spades;&clubs;&hearts;&diams;"}),e.FE.PLUGINS.entities=function(t){function i(e){var t=e.textContent;if(t.match(o)){for(var i="",n=0;n<t.length;n++)i+=a[t[n]]?a[t[n]]:t[n];e.textContent=i}}function n(e){if(e&&["STYLE","SCRIPT"].indexOf(e.tagName)>=0)return!0;for(var r=t.node.contents(e),s=0;s<r.length;s++)r[s].nodeType==Node.TEXT_NODE?i(r[s]):n(r[s]);e.nodeType==Node.TEXT_NODE&&i(e)}function r(e){if(0===e.length)return"";var i=t.clean.exec(e,n).replace(/\&amp;/g,"&");return i}function s(){t.opts.htmlSimpleAmpersand||(t.opts.entities=t.opts.entities+"&amp;");var i=e("<div>").html(t.opts.entities).text(),n=t.opts.entities.split(";");a={},o="";for(var s=0;s<i.length;s++){var l=i.charAt(s);a[l]=n[s]+";",o+="\\"+l+(s<i.length-1?"|":"")}o=new RegExp("("+o+")","g"),t.events.on("html.get",r,!0)}var o,a;return{_init:s}}}),/*!
 * froala_editor v2.3.5 (https://www.froala.com/wysiwyg-editor)
 * License https://froala.com/wysiwyg-editor/terms/
 * Copyright 2014-2016 Froala Labs
 */
function(e){"function"==typeof define&&define.amd?define(["jquery"],e):"object"==typeof module&&module.exports?module.exports=function(t,i){return void 0===i&&(i="undefined"!=typeof window?require("jquery"):require("jquery")(t)),e(i),i}:e(jQuery)}(function(e){"use strict";e.extend(e.FE.POPUP_TEMPLATES,{"file.insert":"[_BUTTONS_][_UPLOAD_LAYER_][_PROGRESS_BAR_]"}),e.extend(e.FE.DEFAULTS,{fileUploadURL:"https://i.froala.com/upload",fileUploadParam:"file",fileUploadParams:{},fileUploadToS3:!1,fileUploadMethod:"POST",fileMaxSize:10485760,fileAllowedTypes:["*"],fileInsertButtons:["fileBack","|"],fileUseSelectedText:!1}),e.FE.PLUGINS.file=function(t){function i(){var e=t.$tb.find('.fr-command[data-cmd="insertFile"]'),i=t.popups.get("file.insert");if(i||(i=_()),r(),!i.hasClass("fr-active")){t.popups.refresh("file.insert"),t.popups.setContainer("file.insert",t.$tb);var n=e.offset().left+e.outerWidth()/2,s=e.offset().top+(t.opts.toolbarBottom?0:e.outerHeight());t.popups.show("file.insert",n,s,e.outerHeight())}}function n(){var e=t.popups.get("file.insert");e||(e=_()),e.find(".fr-layer.fr-active").removeClass("fr-active").addClass("fr-pactive"),e.find(".fr-file-progress-bar-layer").addClass("fr-active"),e.find(".fr-buttons").hide(),s("Uploading",0)}function r(e){var i=t.popups.get("file.insert");i&&(i.find(".fr-layer.fr-pactive").addClass("fr-active").removeClass("fr-pactive"),i.find(".fr-file-progress-bar-layer").removeClass("fr-active"),i.find(".fr-buttons").show(),e&&t.popups.show("file.insert",null,null))}function s(e,i){var n=t.popups.get("file.insert");if(n){var r=n.find(".fr-file-progress-bar-layer");r.find("h3").text(e+(i?" "+i+"%":"")),r.removeClass("fr-error"),i?(r.find("div").removeClass("fr-indeterminate"),r.find("div > span").css("width",i+"%")):r.find("div").addClass("fr-indeterminate")}}function o(e){n();var i=t.popups.get("file.insert"),r=i.find(".fr-file-progress-bar-layer");r.addClass("fr-error"),r.find("h3").text(e)}function a(e,i,n){t.edit.on(),t.events.focus(!0),t.selection.restore(),t.html.insert('<a href="'+e+'" id="fr-inserted-file" class="fr-file">'+(i||t.selection.text())+"</a>");var r=t.$el.find("#fr-inserted-file");r.removeAttr("id"),t.popups.hide("file.insert"),t.undo.saveStep(),t.events.trigger("file.inserted",[r,n])}function l(i){try{if(t.events.trigger("file.uploaded",[i],!0)===!1)return t.edit.on(),!1;var n=e.parseJSON(i);return n.link?n:(p(A,i),!1)}catch(r){return p(S,i),!1}}function c(i){try{var n=e(i).find("Location").text(),r=e(i).find("Key").text();return t.events.trigger("file.uploadedToS3",[n,r,i],!0)===!1?(t.edit.on(),!1):n}catch(s){return p(S,i),!1}}function d(e){var i=this.status,n=this.response,r=this.responseXML,s=this.responseText;try{if(t.opts.fileUploadToS3)if(201==i){var o=c(r);o&&a(o,e,n||r)}else p(S,n||r);else if(i>=200&&300>i){var d=l(s);d&&a(d.link,e,n||s)}else p(T,n||s)}catch(u){p(S,n||s)}}function u(){p(S,this.response||this.responseText||this.responseXML)}function h(e){if(e.lengthComputable){var t=0|100*(e.loaded/e.total);s("Uploading",t)}}function p(e,i){t.edit.on(),o(t.language.translate("Something went wrong. Please try again.")),t.events.trigger("file.error",[{code:e,message:D[e]},i])}function f(){t.edit.on(),r(!0)}function m(e){if(t.events.trigger("file.beforeUpload",[e])===!1)return!1;if("undefined"!=typeof e&&e.length>0){var i=e[0];if(i.size>t.opts.fileMaxSize)return p(M),!1;if(t.opts.fileAllowedTypes.indexOf("*")<0&&t.opts.fileAllowedTypes.indexOf(i.type.replace(/file\//g,""))<0)return p(N),!1;var r;if(t.drag_support.formdata&&(r=t.drag_support.formdata?new FormData:null),r){var s;if(t.opts.fileUploadToS3!==!1){r.append("key",t.opts.fileUploadToS3.keyStart+(new Date).getTime()+"-"+(i.name||"untitled")),r.append("success_action_status","201"),r.append("X-Requested-With","xhr"),r.append("Content-Type",i.type);for(s in t.opts.fileUploadToS3.params)t.opts.fileUploadToS3.params.hasOwnProperty(s)&&r.append(s,t.opts.fileUploadToS3.params[s])}for(s in t.opts.fileUploadParams)t.opts.fileUploadParams.hasOwnProperty(s)&&r.append(s,t.opts.fileUploadParams[s]);r.append(t.opts.fileUploadParam,i);var o=t.opts.fileUploadURL;t.opts.fileUploadToS3&&(o="https://"+t.opts.fileUploadToS3.region+".amazonaws.com/"+t.opts.fileUploadToS3.bucket);var a=t.core.getXHR(o,t.opts.fileUploadMethod);a.onload=function(){d.call(a,t.opts.fileUseSelectedText?null:i.name)},a.onerror=u,a.upload.onprogress=h,a.onabort=f,n(),t.edit.off();var l=t.popups.get("file.insert");l&&l.off("abortUpload").on("abortUpload",function(){4!=a.readyState&&a.abort()}),a.send(r)}}}function g(i){t.events.$on(i,"dragover dragenter",".fr-file-upload-layer",function(){return e(this).addClass("fr-drop"),!1},!0),t.events.$on(i,"dragleave dragend",".fr-file-upload-layer",function(){return e(this).removeClass("fr-drop"),!1},!0),t.events.$on(i,"drop",".fr-file-upload-layer",function(n){n.preventDefault(),n.stopPropagation(),e(this).removeClass("fr-drop");var r=n.originalEvent.dataTransfer;if(r&&r.files){var s=i.data("instance")||t;s.file.upload(r.files)}},!0),t.events.$on(i,"change",'.fr-file-upload-layer input[type="file"]',function(){if(this.files){var n=i.data("instance")||t;n.file.upload(this.files)}e(this).val("")},!0)}function v(){r()}function _(e){if(e)return t.popups.onHide("file.insert",v),!0;var i="";i='<div class="fr-buttons">'+t.button.buildList(t.opts.fileInsertButtons)+"</div>";var n="";n='<div class="fr-file-upload-layer fr-layer fr-active" id="fr-file-upload-layer-'+t.id+'"><strong>'+t.language.translate("Drop file")+"</strong><br>("+t.language.translate("or click")+')<div class="fr-form"><input type="file" name="'+t.opts.fileUploadParam+'" accept="/*" tabIndex="-1"></div></div>';var r='<div class="fr-file-progress-bar-layer fr-layer"><h3 class="fr-message">Uploading</h3><div class="fr-loader"><span class="fr-progress"></span></div><div class="fr-action-buttons"><button type="button" class="fr-command" data-cmd="fileDismissError" tabIndex="2">OK</button></div></div>',s={buttons:i,upload_layer:n,progress_bar:r},o=t.popups.create("file.insert",s);return g(o),o}function y(i){return e(i).hasClass("fr-file")?t.events.trigger("file.unlink",[i]):void 0}function b(i){var r=i.originalEvent.dataTransfer;if(r&&r.files&&r.files.length){var s=r.files[0];if(s&&"undefined"!=typeof s.type&&s.type.indexOf("image")<0&&(t.opts.fileAllowedTypes.indexOf(s.type)>=0||t.opts.fileAllowedTypes.indexOf("*")>=0)){t.markers.remove(),t.markers.insertAtPoint(i.originalEvent),t.$el.find(".fr-marker").replaceWith(e.FE.MARKERS),t.popups.hideAll();var o=t.popups.get("file.insert");return o||(o=_()),t.popups.setContainer("file.insert",e(t.opts.scrollableContainer)),t.popups.show("file.insert",i.originalEvent.pageX,i.originalEvent.pageY),n(),m(r.files),i.preventDefault(),i.stopPropagation(),!1}}}function w(){t.events.on("drop",b),t.events.$on(t.$win,"keydown",function(i){var n=i.which,r=t.popups.get("file.insert");r&&n==e.FE.KEYCODE.ESC&&r.trigger("abortUpload")}),t.events.on("destroy",function(){var e=t.popups.get("file.insert");e&&e.trigger("abortUpload")})}function k(){t.events.disableBlur(),t.selection.restore(),t.events.enableBlur(),t.popups.hide("file.insert"),t.toolbar.showInline()}function C(){w(),t.events.on("link.beforeRemove",y),_(!0)}var x=1,A=2,T=3,S=4,M=5,N=6,E=7,D={};return D[x]="File cannot be loaded from the passed link.",D[A]="No link in upload response.",D[T]="Error during file upload.",D[S]="Parsing response failed.",D[M]="File is too large.",D[N]="File file type is invalid.",D[E]="Files can be uploaded only to same domain in IE 8 and IE 9.",{_init:C,showInsertPopup:i,upload:m,insert:a,back:k,hideProgressBar:r}},e.FE.DefineIcon("insertFile",{NAME:"file-o"}),e.FE.RegisterCommand("insertFile",{title:"Upload File",undo:!1,focus:!0,refreshAfterCallback:!1,popup:!0,callback:function(){this.popups.isVisible("file.insert")?(this.$el.find(".fr-marker")&&(this.events.disableBlur(),this.selection.restore()),this.popups.hide("file.insert")):this.file.showInsertPopup()},plugin:"file"}),e.FE.DefineIcon("fileBack",{NAME:"arrow-left"}),e.FE.RegisterCommand("fileBack",{title:"Back",undo:!1,focus:!1,back:!0,refreshAfterCallback:!1,callback:function(){this.file.back()},refresh:function(e){this.opts.toolbarInline?(e.removeClass("fr-hidden"),e.next(".fr-separator").removeClass("fr-hidden")):(e.addClass("fr-hidden"),e.next(".fr-separator").addClass("fr-hidden"))}}),e.FE.RegisterCommand("fileDismissError",{title:"OK",callback:function(){this.file.hideProgressBar(!0)}})}),/*!
 * froala_editor v2.3.5 (https://www.froala.com/wysiwyg-editor)
 * License https://froala.com/wysiwyg-editor/terms/
 * Copyright 2014-2016 Froala Labs
 */
function(e){"function"==typeof define&&define.amd?define(["jquery"],e):"object"==typeof module&&module.exports?module.exports=function(t,i){return void 0===i&&(i="undefined"!=typeof window?require("jquery"):require("jquery")(t)),e(i),i}:e(jQuery)}(function(e){"use strict";e.extend(e.FE.DEFAULTS,{fontFamily:{"Arial,Helvetica,sans-serif":"Arial","Georgia,serif":"Georgia","Impact,Charcoal,sans-serif":"Impact","Tahoma,Geneva,sans-serif":"Tahoma","Times New Roman,Times,serif":"Times New Roman","Verdana,Geneva,sans-serif":"Verdana"},fontFamilySelection:!1,fontFamilyDefaultSelection:"Font Family"}),e.FE.PLUGINS.fontFamily=function(t){function i(e){t.format.applyStyle("font-family",e)}function n(e,t){t.find(".fr-command.fr-active").removeClass("fr-active"),t.find('.fr-command[data-param1="'+o()+'"]').addClass("fr-active");var i=t.find(".fr-dropdown-list"),n=t.find(".fr-active").parent();n.length?i.parent().scrollTop(n.offset().top-i.offset().top-(i.parent().outerHeight()/2-n.outerHeight()/2)):i.parent().scrollTop(0)}function r(t){var i=t.replace(/(sans-serif|serif|monospace|cursive|fantasy)/gi,"").replace(/"|'| /g,"").split(",");return e.grep(i,function(e){return e.length>0})}function s(e,t){for(var i=0;i<e.length;i++)for(var n=0;n<t.length;n++)if(e[i]==t[n])return[i,n];return null}function o(){var i=e(t.selection.element()).css("font-family"),n=r(i),o=[];for(var a in t.opts.fontFamily)if(t.opts.fontFamily.hasOwnProperty(a)){var l=r(a),c=s(n,l);c&&o.push([a,c])}return 0===o.length?null:(o.sort(function(e,t){var i=e[1][0]-t[1][0];return 0===i?e[1][1]-t[1][1]:i}),o[0][0])}function a(i){if(t.opts.fontFamilySelection){var n=e(t.selection.element()).css("font-family").replace(/(sans-serif|serif|monospace|cursive|fantasy)/gi,"").replace(/"|'|/g,"").split(",");i.find("> span").text(t.opts.fontFamily[o()]||n[0]||t.opts.fontFamilyDefaultSelection)}}return{apply:i,refreshOnShow:n,refresh:a}},e.FE.RegisterCommand("fontFamily",{type:"dropdown",displaySelection:function(e){return e.opts.fontFamilySelection},defaultSelection:function(e){return e.opts.fontFamilyDefaultSelection},displaySelectionWidth:120,html:function(){var e='<ul class="fr-dropdown-list">',t=this.opts.fontFamily;for(var i in t)t.hasOwnProperty(i)&&(e+='<li><a class="fr-command" data-cmd="fontFamily" data-param1="'+i+'" style="font-family: '+i+'" title="'+t[i]+'">'+t[i]+"</a></li>");return e+="</ul>"},title:"Font Family",callback:function(e,t){this.fontFamily.apply(t)},refresh:function(e){this.fontFamily.refresh(e)},refreshOnShow:function(e,t){this.fontFamily.refreshOnShow(e,t)},plugin:"fontFamily"}),e.FE.DefineIcon("fontFamily",{NAME:"font"})}),/*!
 * froala_editor v2.3.5 (https://www.froala.com/wysiwyg-editor)
 * License https://froala.com/wysiwyg-editor/terms/
 * Copyright 2014-2016 Froala Labs
 */
function(e){"function"==typeof define&&define.amd?define(["jquery"],e):"object"==typeof module&&module.exports?module.exports=function(t,i){return void 0===i&&(i="undefined"!=typeof window?require("jquery"):require("jquery")(t)),e(i),i}:e(jQuery)}(function(e){"use strict";e.extend(e.FE.DEFAULTS,{fontSize:["8","9","10","11","12","14","18","24","30","36","48","60","72","96"],fontSizeSelection:!1,fontSizeDefaultSelection:"12"}),e.FE.PLUGINS.fontSize=function(t){function i(e){t.format.applyStyle("font-size",e)}function n(i,n){var r=e(t.selection.element()).css("font-size");n.find(".fr-command.fr-active").removeClass("fr-active"),n.find('.fr-command[data-param1="'+r+'"]').addClass("fr-active");var s=n.find(".fr-dropdown-list"),o=n.find(".fr-active").parent();o.length?s.parent().scrollTop(o.offset().top-s.offset().top-(s.parent().outerHeight()/2-o.outerHeight()/2)):s.parent().scrollTop(0)}function r(i){if(t.opts.fontSizeSelection){var n=t.helpers.getPX(e(t.selection.element()).css("font-size"));i.find("> span").text(n)}}return{apply:i,refreshOnShow:n,refresh:r}},e.FE.RegisterCommand("fontSize",{type:"dropdown",title:"Font Size",displaySelection:function(e){return e.opts.fontSizeSelection},displaySelectionWidth:30,defaultSelection:function(e){return e.opts.fontSizeDefaultSelection},html:function(){for(var e='<ul class="fr-dropdown-list">',t=this.opts.fontSize,i=0;i<t.length;i++){var n=t[i];e+='<li><a class="fr-command" data-cmd="fontSize" data-param1="'+n+'px" title="'+n+'">'+n+"</a></li>"}return e+="</ul>"},callback:function(e,t){this.fontSize.apply(t)},refresh:function(e){this.fontSize.refresh(e)},refreshOnShow:function(e,t){this.fontSize.refreshOnShow(e,t)},plugin:"fontSize"}),e.FE.DefineIcon("fontSize",{NAME:"text-height"})}),/*!
 * froala_editor v2.3.5 (https://www.froala.com/wysiwyg-editor)
 * License https://froala.com/wysiwyg-editor/terms/
 * Copyright 2014-2016 Froala Labs
 */
function(e){"function"==typeof define&&define.amd?define(["jquery"],e):"object"==typeof module&&module.exports?module.exports=function(t,i){return void 0===i&&(i="undefined"!=typeof window?require("jquery"):require("jquery")(t)),e(i),i}:e(jQuery)}(function(e){"use strict";e.extend(e.FE.POPUP_TEMPLATES,{"forms.edit":"[_BUTTONS_]","forms.update":"[_BUTTONS_][_TEXT_LAYER_]"}),e.extend(e.FE.DEFAULTS,{formEditButtons:["inputStyle","inputEdit"],formStyles:{"fr-rounded":"Rounded","fr-large":"Large"},formMultipleStyles:!0,formUpdateButtons:["inputBack","|"]}),e.FE.PLUGINS.forms=function(t){function i(i){i.preventDefault(),t.selection.clear(),e(this).data("mousedown",!0)}function n(t){e(this).data("mousedown")&&(t.stopPropagation(),e(this).removeData("mousedown"),_=this,c(this)),t.preventDefault()}function r(){t.$el.find("input, textarea, button").removeData("mousedown")}function s(){e(this).removeData("mousedown")}function o(){t.events.$on(t.$el,t._mousedown,"input, textarea, button",i),t.events.$on(t.$el,t._mouseup,"input, textarea, button",n),t.events.$on(t.$el,"touchmove","input, textarea, button",s),t.events.$on(t.$el,t._mouseup,r),t.events.$on(t.$win,t._mouseup,r),h(!0)}function a(){return _?_:null}function l(){var e="";t.opts.formEditButtons.length>0&&(e='<div class="fr-buttons">'+t.button.buildList(t.opts.formEditButtons)+"</div>");var i={buttons:e},n=t.popups.create("forms.edit",i);return t.$wp&&t.events.$on(t.$wp,"scroll.link-edit",function(){get()&&t.popups.isVisible("forms.edit")&&c(a())}),n}function c(i){var n=t.popups.get("forms.edit");n||(n=l()),_=i;var r=e(i);t.popups.refresh("forms.edit"),t.popups.setContainer("forms.edit",e(t.opts.scrollableContainer));var s=r.offset().left+r.outerWidth()/2,o=r.offset().top+r.outerHeight();t.popups.show("forms.edit",s,o,r.outerHeight())}function d(){var i=t.popups.get("forms.update"),n=a();if(n){var r=e(n);r.is("button")?i.find('input[type="text"][name="text"]').val(r.text()):i.find('input[type="text"][name="text"]').val(r.attr("placeholder"))}i.find('input[type="text"][name="text"]').trigger("change")}function u(){_=null}function h(e){if(e)return t.popups.onRefresh("forms.update",d),t.popups.onHide("forms.update",u),!0;var i="";t.opts.formUpdateButtons.length>=1&&(i='<div class="fr-buttons">'+t.button.buildList(t.opts.formUpdateButtons)+"</div>");var n="",r=0;n='<div class="fr-forms-text-layer fr-layer fr-active">',n+='<div class="fr-input-line"><input name="text" type="text" placeholder="Text" tabIndex="'+ ++r+'"></div>',n+='<div class="fr-action-buttons"><button class="fr-command fr-submit" data-cmd="updateInput" href="#" tabIndex="'+ ++r+'" type="button">'+t.language.translate("Update")+"</button></div></div>";var s={buttons:i,text_layer:n},o=t.popups.create("forms.update",s);return o}function p(){var i=a();if(i){var n=e(i),r=t.popups.get("forms.update");r||(r=h()),t.popups.isVisible("forms.update")||t.popups.refresh("forms.update"),t.popups.setContainer("forms.update",e(t.opts.scrollableContainer));var s=n.offset().left+n.outerWidth()/2,o=n.offset().top+n.outerHeight();t.popups.show("forms.update",s,o,n.outerHeight())}}function f(i,n,r){"undefined"==typeof n&&(n=t.opts.formStyles),"undefined"==typeof r&&(r=t.opts.formMultipleStyles);var s=a();if(!s)return!1;if(!r){var o=Object.keys(n);o.splice(o.indexOf(i),1),e(s).removeClass(o.join(" "))}e(s).toggleClass(i)}function m(){t.events.disableBlur(),t.selection.restore(),t.events.enableBlur();var e=a();e&&t.$wp&&("BUTTON"==e.tagName&&t.selection.restore(),c(e))}function g(){var i=t.popups.get("forms.update"),n=a();if(n){var r=e(n),s=i.find('input[type="text"][name="text"]').val()||"";s.length&&(r.is("button")?r.text(s):r.attr("placeholder",s)),t.popups.hide("forms.update"),c(n)}}function v(){o(),t.events.$on(t.$el,"submit","form",function(e){return e.preventDefault(),!1})}var _;return{_init:v,updateInput:g,getInput:a,applyStyle:f,showUpdatePopup:p,showEditPopup:c,back:m}},e.FE.RegisterCommand("updateInput",{undo:!1,focus:!1,title:"Update",callback:function(){this.forms.updateInput()}}),e.FE.DefineIcon("inputStyle",{NAME:"magic"}),e.FE.RegisterCommand("inputStyle",{title:"Style",type:"dropdown",html:function(){var e='<ul class="fr-dropdown-list">',t=this.opts.formStyles;for(var i in t)t.hasOwnProperty(i)&&(e+='<li><a class="fr-command" data-cmd="inputStyle" data-param1="'+i+'">'+this.language.translate(t[i])+"</a></li>");return e+="</ul>"},callback:function(e,t){var i=this.forms.getInput();i&&(this.forms.applyStyle(t),this.forms.showEditPopup(i))},refreshOnShow:function(t,i){var n=this.forms.getInput();if(n){var r=e(n);i.find(".fr-command").each(function(){var t=e(this).data("param1");e(this).toggleClass("fr-active",r.hasClass(t))})}}}),e.FE.DefineIcon("inputEdit",{NAME:"edit"}),e.FE.RegisterCommand("inputEdit",{title:"Edit Button",undo:!1,refreshAfterCallback:!1,callback:function(){this.forms.showUpdatePopup()}}),e.FE.DefineIcon("inputBack",{NAME:"arrow-left"}),e.FE.RegisterCommand("inputBack",{title:"Back",undo:!1,focus:!1,back:!0,refreshAfterCallback:!1,callback:function(){this.forms.back()}}),e.FE.RegisterCommand("updateInput",{undo:!1,focus:!1,title:"Update",callback:function(){this.forms.updateInput()}})}),/*!
 * froala_editor v2.3.5 (https://www.froala.com/wysiwyg-editor)
 * License https://froala.com/wysiwyg-editor/terms/
 * Copyright 2014-2016 Froala Labs
 */
function(e){"function"==typeof define&&define.amd?define(["jquery"],e):"object"==typeof module&&module.exports?module.exports=function(t,i){return void 0===i&&(i="undefined"!=typeof window?require("jquery"):require("jquery")(t)),e(i),i}:e(jQuery)}(function(e){"use strict";e.FE.PLUGINS.fullscreen=function(t){function i(){return t.$box.hasClass("fr-fullscreen")}function n(){l=e(t.o_win).scrollTop(),t.$box.toggleClass("fr-fullscreen"),e("body").toggleClass("fr-fullscreen"),c=e('<div style="display: none;"></div>'),t.$box.after(c),t.helpers.isMobile()&&(t.$tb.data("parent",t.$tb.parent()),t.$tb.prependTo(t.$box),t.$tb.data("sticky-dummy")&&t.$tb.after(t.$tb.data("sticky-dummy"))),d=t.opts.height,u=t.opts.heightMax,t.opts.height=t.o_win.innerHeight-(t.opts.toolbarInline?0:t.$tb.outerHeight()),t.opts.heightMax=null,t.size.refresh(),t.opts.toolbarInline&&t.toolbar.showInline();for(var i=t.$box.parent();!i.is("body");)i.data("z-index",i.css("z-index")).css("z-index","9990"),i=i.parent();t.events.trigger("charCounter.update"),t.$win.trigger("scroll")}function r(){t.$box.toggleClass("fr-fullscreen"),e("body").toggleClass("fr-fullscreen"),t.$tb.prependTo(t.$tb.data("parent")),t.$tb.data("sticky-dummy")&&t.$tb.after(t.$tb.data("sticky-dummy")),t.opts.height=d,t.opts.heightMax=u,t.size.refresh(),e(t.o_win).scrollTop(l),t.opts.toolbarInline&&t.toolbar.showInline(),t.events.trigger("charCounter.update"),t.opts.toolbarSticky&&t.opts.toolbarStickyOffset&&(t.opts.toolbarBottom?t.$tb.css("bottom",t.opts.toolbarStickyOffset).data("bottom",t.opts.toolbarStickyOffset):t.$tb.css("top",t.opts.toolbarStickyOffset).data("top",t.opts.toolbarStickyOffset));for(var i=t.$box.parent();!i.is("body");)i.data("z-index")&&(i.css("z-index",""),i.css("z-index")!=i.data("z-index")&&i.css("z-index",i.data("z-index")),i.removeData("z-index")),i=i.parent();t.$win.trigger("scroll")}function s(){i()?r():n(),o(t.$tb.find('.fr-command[data-cmd="fullscreen"]'))}function o(e){var n=i();e.toggleClass("fr-active",n),e.find("> *").replaceWith(n?t.icon.create("fullscreenCompress"):t.icon.create("fullscreen"))}function a(){return t.$wp?(t.events.$on(e(t.o_win),"resize",function(){i()&&(r(),n())}),t.events.on("toolbar.hide",function(){return i()&&t.helpers.isMobile()?!1:void 0}),void 0):!1}var l,c,d,u;return{_init:a,toggle:s,refresh:o,isActive:i}},e.FE.RegisterCommand("fullscreen",{title:"Fullscreen",undo:!1,focus:!1,forcedRefresh:!0,callback:function(){this.fullscreen.toggle()},refresh:function(e){this.fullscreen.refresh(e)},plugin:"fullscreen"}),e.FE.DefineIcon("fullscreen",{NAME:"expand"}),e.FE.DefineIcon("fullscreenCompress",{NAME:"compress"})}),/*!
 * froala_editor v2.3.5 (https://www.froala.com/wysiwyg-editor)
 * License https://froala.com/wysiwyg-editor/terms/
 * Copyright 2014-2016 Froala Labs
 */
function(e){"function"==typeof define&&define.amd?define(["jquery"],e):"object"==typeof module&&module.exports?module.exports=function(t,i){return void 0===i&&(i="undefined"!=typeof window?require("jquery"):require("jquery")(t)),e(i),i}:e(jQuery)}(function(e){"use strict";e.extend(e.FE.POPUP_TEMPLATES,{"image.insert":"[_BUTTONS_][_UPLOAD_LAYER_][_BY_URL_LAYER_][_PROGRESS_BAR_]","image.edit":"[_BUTTONS_]","image.alt":"[_BUTTONS_][_ALT_LAYER_]","image.size":"[_BUTTONS_][_SIZE_LAYER_]"}),e.extend(e.FE.DEFAULTS,{imageInsertButtons:["imageBack","|","imageUpload","imageByURL"],imageEditButtons:["imageReplace","imageAlign","imageRemove","|","imageLink","linkOpen","linkEdit","linkRemove","-","imageDisplay","imageStyle","imageAlt","imageSize"],imageAltButtons:["imageBack","|"],imageSizeButtons:["imageBack","|"],imageUploadURL:"https://i.froala.com/upload",imageUploadParam:"file",imageUploadParams:{},imageUploadToS3:!1,imageUploadMethod:"POST",imageMaxSize:10485760,imageAllowedTypes:["jpeg","jpg","png","gif","svg+xml"],imageResize:!0,imageResizeWithPercent:!1,imageRoundPercent:!1,imageDefaultWidth:300,imageDefaultAlign:"center",imageDefaultDisplay:"block",imageSplitHTML:!1,imageStyles:{"fr-rounded":"Rounded","fr-bordered":"Bordered"},imageMove:!0,imageMultipleStyles:!0,imageTextNear:!0,imagePaste:!0,imagePasteProcess:!1,imageMinWidth:16,imageOutputSize:!1}),e.FE.PLUGINS.image=function(t){function i(){var e=t.popups.get("image.insert"),i=e.find(".fr-image-by-url-layer input");i.val(""),gt&&i.val(gt.attr("src")),i.trigger("change")}function n(){var e=t.$tb.find('.fr-command[data-cmd="insertImage"]'),i=t.popups.get("image.insert");if(i||(i=P()),v(),!i.hasClass("fr-active"))if(t.popups.refresh("image.insert"),t.popups.setContainer("image.insert",t.$tb),e.is(":visible")){var n=e.offset().left+e.outerWidth()/2,r=e.offset().top+(t.opts.toolbarBottom?10:e.outerHeight()-10);t.popups.show("image.insert",n,r,e.outerHeight())}else t.position.forSelection(i),t.popups.show("image.insert")}function r(){var i=t.popups.get("image.edit");i||(i=m()),t.popups.setContainer("image.edit",e(t.opts.scrollableContainer)),t.popups.refresh("image.edit");var n=gt.offset().left+gt.outerWidth()/2,r=gt.offset().top+gt.outerHeight();t.popups.show("image.edit",n,r,gt.outerHeight())}function s(){v()}function o(e){if(!e.hasClass("fr-dii")&&!e.hasClass("fr-dib")){var i=e.css("float");e.css("float","none"),"block"==e.css("display")?(e.css("float",i),t.opts.imageEditButtons.indexOf("imageAlign")>=0&&(0===parseInt(e.css("margin-left"),10)&&(e.attr("style")||"").indexOf("margin-right: auto")>=0?e.addClass("fr-fil"):0===parseInt(e.css("margin-right"),10)&&(e.attr("style")||"").indexOf("margin-left: auto")>=0&&e.addClass("fr-fir")),e.addClass("fr-dib")):(e.css("float",i),t.opts.imageEditButtons.indexOf("imageAlign")>=0&&("left"==e.css("float")?e.addClass("fr-fil"):"right"==e.css("float")&&e.addClass("fr-fir")),e.addClass("fr-dii")),e.css("margin",""),e.css("float",""),e.css("display",""),e.css("z-index",""),e.css("position",""),e.css("overflow",""),e.css("vertical-align","")}}function a(){for(var i="IMG"==t.$el.get(0).tagName?[t.$el.get(0)]:t.$el.get(0).querySelectorAll("img"),n=0;n<i.length;n++){var r=e(i[n]);(t.opts.imageEditButtons.indexOf("imageAlign")>=0||t.opts.imageEditButtons.indexOf("imageDisplay")>=0)&&o(r),r.attr("width")&&r.css("width",r.width()).removeAttr("width"),r.attr("height")&&r.css("height",r.height()).removeAttr("height"),t.opts.imageTextNear||r.removeClass("fr-dii").addClass("fr-dib"),t.opts.iframe&&r.on("load",t.size.syncIframe)}}function l(){var i,n=Array.prototype.slice.call(t.$el.get(0).querySelectorAll("img")),r=[];for(i=0;i<n.length;i++)r.push(n[i].getAttribute("src")),e(n[i]).toggleClass("fr-draggable",t.opts.imageMove),""===n[i].className&&n[i].removeAttribute("class"),""===n[i].getAttribute("style")&&n[i].removeAttribute("style");if(Nt)for(i=0;i<Nt.length;i++)r.indexOf(Nt[i].getAttribute("src"))<0&&t.events.trigger("image.removed",[e(Nt[i])]);Nt=n}function c(){vt||G();var i=t.$wp||e(t.opts.scrollableContainer);i.append(vt),vt.data("instance",t);var n=i.scrollTop()-("static"!=i.css("position")?i.offset().top:0),r=i.scrollLeft()-("static"!=i.css("position")?i.offset().left:0);r-=t.helpers.getPX(i.css("border-left-width")),n-=t.helpers.getPX(i.css("border-top-width")),t.$el.is("img")&&(n=0,r=0),vt.css("top",(t.opts.iframe?gt.offset().top:gt.offset().top+n)-1).css("left",(t.opts.iframe?gt.offset().left:gt.offset().left+r)-1).css("width",gt.get(0).getBoundingClientRect().width).css("height",gt.get(0).getBoundingClientRect().height).addClass("fr-active")}function d(e){return'<div class="fr-handler fr-h'+e+'"></div>'}function u(i){if(!t.core.sameInstance(vt))return!0;if(i.preventDefault(),i.stopPropagation(),t.$el.find("img.fr-error").left)return!1;t.undo.canDo()||t.undo.saveStep(),_t=e(this),_t.data("start-x",i.pageX||i.originalEvent.touches[0].pageX),_t.data("start-width",gt.width()),_t.data("start-height",gt.height());var n=gt.width();if(t.opts.imageResizeWithPercent){var r=gt.parentsUntil(t.$el,t.html.blockTagsQuery()).get(0)||t.$el.get(0);gt.css("width",(100*(n/e(r).outerWidth())).toFixed(2)+"%")}else gt.css("width",n);yt.show(),t.popups.hideAll(),rt()}function h(i){if(!t.core.sameInstance(vt))return!0;if(_t&&gt){if(i.preventDefault(),t.$el.find("img.fr-error").left)return!1;var n=i.pageX||(i.originalEvent.touches?i.originalEvent.touches[0].pageX:null);if(!n)return!1;var r=_t.data("start-x"),s=n-r,o=_t.data("start-width");if((_t.hasClass("fr-hnw")||_t.hasClass("fr-hsw"))&&(s=0-s),t.opts.imageResizeWithPercent){var a=gt.parentsUntil(t.$el,t.html.blockTagsQuery()).get(0)||t.$el.get(0);o=(100*((o+s)/e(a).outerWidth())).toFixed(2),t.opts.imageRoundPercent&&(o=Math.round(o)),gt.css("width",o+"%"),gt.css("height","").removeAttr("height")}else o+s>=t.opts.imageMinWidth&&gt.css("width",o+s),gt.css("height",_t.data("start-height")*gt.width()/_t.data("start-width"));c(),t.events.trigger("image.resize",[ft()])}}function p(e){if(!t.core.sameInstance(vt))return!0;if(_t&&gt){if(e&&e.stopPropagation(),t.$el.find("img.fr-error").left)return!1;_t=null,yt.hide(),c(),r(),t.undo.saveStep(),t.events.trigger("image.resizeEnd",[ft()])}}function f(e,i){t.edit.on(),gt&&gt.addClass("fr-error"),y(t.language.translate("Something went wrong. Please try again.")),t.events.trigger("image.error",[{code:e,message:Mt[e]},i])}function m(e){if(e)return t.$wp&&t.events.$on(t.$wp,"scroll",function(){gt&&t.popups.isVisible("image.edit")&&r()}),!0;var i="";t.opts.imageEditButtons.length>0&&(i+='<div class="fr-buttons">',i+=t.button.buildList(t.opts.imageEditButtons),i+="</div>");var n={buttons:i},s=t.popups.create("image.edit",n);return s}function g(i){var n=t.popups.get("image.insert");if(n||(n=P()),n.find(".fr-layer.fr-active").removeClass("fr-active").addClass("fr-pactive"),n.find(".fr-image-progress-bar-layer").addClass("fr-active"),n.find(".fr-buttons").hide(),gt){t.popups.setContainer("image.insert",e(t.opts.scrollableContainer));var r=gt.offset().left+gt.width()/2,s=gt.offset().top+gt.height();t.popups.show("image.insert",r,s,gt.outerHeight())}"undefined"==typeof i&&_("Uploading",0)}function v(e){var i=t.popups.get("image.insert");i&&(i.find(".fr-layer.fr-pactive").addClass("fr-active").removeClass("fr-pactive"),i.find(".fr-image-progress-bar-layer").removeClass("fr-active"),i.find(".fr-buttons").show(),(e||t.$el.find("img.fr-error").length)&&(t.events.focus(),t.$el.find("img.fr-error").length&&(t.$el.find("img.fr-error").remove(),t.undo.saveStep(),t.undo.run(),t.undo.dropRedo())))}function _(e,i){var n=t.popups.get("image.insert");if(n){var r=n.find(".fr-image-progress-bar-layer");r.find("h3").text(e+(i?" "+i+"%":"")),r.removeClass("fr-error"),i?(r.find("div").removeClass("fr-indeterminate"),r.find("div > span").css("width",i+"%")):r.find("div").addClass("fr-indeterminate")}}function y(e){g();var i=t.popups.get("image.insert"),n=i.find(".fr-image-progress-bar-layer");n.addClass("fr-error"),n.find("h3").text(e)}function b(){var e=t.popups.get("image.insert"),i=e.find(".fr-image-by-url-layer input");i.val().length>0&&(g(),_("Loading image"),C(i.val(),!0,[],gt),i.val(""),i.blur())}function w(e){tt.call(e.get(0))}function k(){var i=e(this);t.popups.hide("image.insert"),i.removeClass("fr-uploading"),i.next().is("br")&&i.next().remove(),w(i),t.events.trigger("image.loaded",[i])}function C(e,i,n,r,s){t.edit.off(),_("Loading image"),i&&(e=t.helpers.sanitizeURL(e));var o=new Image;o.onload=function(){var i,o;if(r){var a=r.data("fr-old-src");t.$wp?(i=r.clone().removeData("fr-old-src").removeClass("fr-uploading"),i.off("load"),a&&r.attr("src",a),r.replaceWith(i)):i=r;for(var c=i.get(0).attributes,d=0;d<c.length;d++){var u=c[d];0===u.nodeName.indexOf("data-")&&i.removeAttr(u.nodeName)}if("undefined"!=typeof n)for(o in n)n.hasOwnProperty(o)&&"link"!=o&&i.attr("data-"+o,n[o]);i.on("load",k),i.attr("src",e),t.edit.on(),l(),t.undo.saveStep(),t.events.trigger(a?"image.replaced":"image.inserted",[i,s])}else i=N(e,n,k),l(),t.undo.saveStep(),t.events.trigger("image.inserted",[i,s])},o.onerror=function(){f(wt)},o.src=e}function x(i){try{if(t.events.trigger("image.uploaded",[i],!0)===!1)return t.edit.on(),!1;var n=e.parseJSON(i);return n.link?n:(f(kt,i),!1)}catch(r){return f(xt,i),!1}}function A(i){try{var n=e(i).find("Location").text(),r=e(i).find("Key").text();return t.events.trigger("image.uploadedToS3",[n,r,i],!0)===!1?(t.edit.on(),!1):n}catch(s){return f(xt,i),!1}}function T(e){_("Loading image");var i=this.status,n=this.response,r=this.responseXML,s=this.responseText;try{if(t.opts.imageUploadToS3)if(201==i){var o=A(r);o&&C(o,!1,[],e,n||r)}else f(xt,n||r);else if(i>=200&&300>i){var a=x(s);a&&C(a.link,!1,a,e,n||s)}else f(Ct,n||s)}catch(l){f(xt,n||s)}}function S(){f(xt,this.response||this.responseText||this.responseXML)}function M(e){if(e.lengthComputable){var t=0|100*(e.loaded/e.total);_("Uploading",t)}}function N(i,n,r){var s,o="";if(n&&"undefined"!=typeof n)for(s in n)n.hasOwnProperty(s)&&"link"!=s&&(o+=" data-"+s+'="'+n[s]+'"');var a=t.opts.imageDefaultWidth;a&&"auto"!=a&&(a+=t.opts.imageResizeWithPercent?"%":"px");var l=e('<img class="'+(t.opts.imageDefaultDisplay?"fr-di"+t.opts.imageDefaultDisplay[0]:"")+(t.opts.imageDefaultAlign?"center"!=t.opts.imageDefaultAlign?" fr-fi"+t.opts.imageDefaultAlign[0]:"":"")+'" src="'+i+'"'+o+(a?' style="width: '+a+';"':"")+">");l.on("load",r),t.edit.on(),t.events.focus(!0),t.selection.restore(),t.undo.saveStep(),t.opts.imageSplitHTML?t.markers.split():t.markers.insert();var c=t.$el.find(".fr-marker");return c.replaceWith(l),t.html.wrap(),t.selection.clear(),l}function E(){t.edit.on(),v(!0)}function D(i,n,r){function s(){var r=e(this);r.off("load"),r.addClass("fr-uploading"),r.next().is("br")&&r.next().remove(),t.placeholder.refresh(),r.is(gt)||w(r),c(),g(),t.edit.off(),i.onload=function(){T.call(i,r)},i.onerror=S,i.upload.onprogress=M,i.onabort=E,r.off("abortUpload").on("abortUpload",function(){4!=i.readyState&&i.abort()}),i.send(n)}var o,a=new FileReader;a.addEventListener("load",function(){var e=a.result;if(a.result.indexOf("svg+xml")<0){for(var i=atob(a.result.split(",")[1]),n=[],r=0;r<i.length;r++)n.push(i.charCodeAt(r));e=window.URL.createObjectURL(new Blob([new Uint8Array(n)],{type:"image/jpeg"}))}gt?(gt.on("load",s),t.edit.on(),t.undo.saveStep(),gt.data("fr-old-src",gt.attr("src")),gt.attr("src",e)):o=N(e,null,s)},!1),a.readAsDataURL(r)}function O(e){if(t.events.trigger("image.beforeUpload",[e])===!1)return!1;if("undefined"!=typeof e&&e.length>0){var i=e[0];if(i.size>t.opts.imageMaxSize)return f(At),!1;if(t.opts.imageAllowedTypes.indexOf(i.type.replace(/image\//g,""))<0)return f(Tt),!1;var n;if(t.drag_support.formdata&&(n=t.drag_support.formdata?new FormData:null),n){var r;if(t.opts.imageUploadToS3!==!1){n.append("key",t.opts.imageUploadToS3.keyStart+(new Date).getTime()+"-"+(i.name||"untitled")),n.append("success_action_status","201"),n.append("X-Requested-With","xhr"),n.append("Content-Type",i.type);for(r in t.opts.imageUploadToS3.params)t.opts.imageUploadToS3.params.hasOwnProperty(r)&&n.append(r,t.opts.imageUploadToS3.params[r])}for(r in t.opts.imageUploadParams)t.opts.imageUploadParams.hasOwnProperty(r)&&n.append(r,t.opts.imageUploadParams[r]);n.append(t.opts.imageUploadParam,i);var s=t.opts.imageUploadURL;t.opts.imageUploadToS3&&(s="https://"+t.opts.imageUploadToS3.region+".amazonaws.com/"+t.opts.imageUploadToS3.bucket);var o=t.core.getXHR(s,t.opts.imageUploadMethod);D(o,n,i)}}}function R(i){t.events.$on(i,"dragover dragenter",".fr-image-upload-layer",function(){return e(this).addClass("fr-drop"),!1}),t.events.$on(i,"dragleave dragend",".fr-image-upload-layer",function(){return e(this).removeClass("fr-drop"),!1}),t.events.$on(i,"drop",".fr-image-upload-layer",function(n){n.preventDefault(),n.stopPropagation(),e(this).removeClass("fr-drop");var r=n.originalEvent.dataTransfer;if(r&&r.files){var s=i.data("instance")||t;s.events.disableBlur(),s.image.upload(r.files),s.events.enableBlur()}}),t.events.$on(i,"change",'.fr-image-upload-layer input[type="file"]',function(){if(this.files){var n=i.data("instance")||t;n.events.disableBlur(),i.find("input:focus").blur(),n.events.enableBlur(),n.image.upload(this.files)}e(this).val("")})}function L(i){var n=i.originalEvent.dataTransfer;if(n&&n.files&&n.files.length){var r=n.files[0];if(r&&r.type&&t.opts.imageAllowedTypes.indexOf(r.type.replace(/image\//g,""))>=0){t.markers.remove(),t.markers.insertAtPoint(i.originalEvent),t.$el.find(".fr-marker").replaceWith(e.FE.MARKERS),t.popups.hideAll();var s=t.popups.get("image.insert");return s||(s=P()),t.popups.setContainer("image.insert",e(t.opts.scrollableContainer)),t.popups.show("image.insert",i.originalEvent.pageX,i.originalEvent.pageY),g(),O(n.files),i.preventDefault(),i.stopPropagation(),!1}}}function I(){var i,n,r=t.selection.ranges(0);r.collapsed&&r.startContainer.nodeType==Node.ELEMENT_NODE&&(r.startContainer.childNodes.length==r.startOffset?(i=r.startContainer.childNodes[r.startOffset-1],i&&"IMG"==i.tagName&&"block"==e(i).css("display")&&(n=t.node.blockParent(i),n&&t.html.defaultTag()?n.nextSibling||(["TD","TH"].indexOf(n.tagName)<0?e(n).after("<"+t.html.defaultTag()+"><br>"+e.FE.MARKERS+"</"+t.html.defaultTag()+">"):e(img).after("<br>"+e.FE.MARKERS),t.selection.restore()):n||(e(i).after("<br>"+e.FE.MARKERS),t.selection.restore()))):0===r.startOffset&&r.startContainer.childNodes.length>r.startOffset&&(i=r.startContainer.childNodes[r.startOffset],i&&"IMG"==i.tagName&&"block"==e(i).css("display")&&(n=t.node.blockParent(i),n&&t.html.defaultTag()?n.previousSibling||(["TD","TH"].indexOf(n.tagName)<0?e(n).before("<"+t.html.defaultTag()+"><br>"+e.FE.MARKERS+"</"+t.html.defaultTag()+">"):e(img).before("<br>"+e.FE.MARKERS),t.selection.restore()):n||(e(i).before(e.FE.MARKERS+"<br>"),t.selection.restore()))))}function j(){t.events.$on(t.$el,t._mousedown,"IMG"==t.$el.get(0).tagName?null:'img:not([contenteditable="false"])',function(i){return e(this).parents('[contenteditable="false"]:not(.fr-element):not(body)').length?!0:(t.selection.clear(),bt=!0,t.browser.msie&&(t.events.disableBlur(),t.$el.attr("contenteditable",!1)),t.draggable||i.preventDefault(),i.stopPropagation(),void 0)}),t.events.$on(t.$el,t._mouseup,"IMG"==t.$el.get(0).tagName?null:'img:not([contenteditable="false"])',function(i){return e(this).parents('[contenteditable="false"]:not(.fr-element):not(body)').length?!0:(bt&&(bt=!1,i.stopPropagation(),t.browser.msie&&(t.$el.attr("contenteditable",!0),t.events.enableBlur())),void 0)}),t.events.on("keyup",function(i){if(i.shiftKey&&""===t.selection.text().replace(/\n/g,"")){var n=t.selection.element(),r=t.selection.endElement();n&&"IMG"==n.tagName?w(e(n)):r&&"IMG"==r.tagName&&w(e(r))}},!0),t.events.on("drop",L),t.events.on("mousedown window.mousedown",nt),t.events.on("window.touchmove",rt),t.events.on("mouseup window.mouseup",function(){return gt?(it(),!1):void 0}),t.events.on("commands.mousedown",function(e){e.parents(".fr-toolbar").length>0&&it()}),t.events.on("mouseup",I),t.events.on("blur image.hideResizer commands.undo commands.redo element.dropped",function(){bt=!1,it(!0)})}function P(e){if(e)return t.popups.onRefresh("image.insert",i),t.popups.onHide("image.insert",s),!0;var n,r="";t.opts.imageInsertButtons.length>1&&(r='<div class="fr-buttons">'+t.button.buildList(t.opts.imageInsertButtons)+"</div>");var o=t.opts.imageInsertButtons.indexOf("imageUpload"),a=t.opts.imageInsertButtons.indexOf("imageByURL"),l="";o>=0&&(n=" fr-active",a>=0&&o>a&&(n=""),l='<div class="fr-image-upload-layer'+n+' fr-layer" id="fr-image-upload-layer-'+t.id+'"><strong>'+t.language.translate("Drop image")+"</strong><br>("+t.language.translate("or click")+')<div class="fr-form"><input type="file" accept="image/'+t.opts.imageAllowedTypes.join(", image/").toLowerCase()+'" tabIndex="-1"></div></div>');var c="";a>=0&&(n=" fr-active",o>=0&&a>o&&(n=""),c='<div class="fr-image-by-url-layer'+n+' fr-layer" id="fr-image-by-url-layer-'+t.id+'"><div class="fr-input-line"><input type="text" placeholder="http://" tabIndex="1"></div><div class="fr-action-buttons"><button type="button" class="fr-command fr-submit" data-cmd="imageInsertByURL" tabIndex="2">'+t.language.translate("Insert")+"</button></div></div>");var d='<div class="fr-image-progress-bar-layer fr-layer"><h3 class="fr-message">Uploading</h3><div class="fr-loader"><span class="fr-progress"></span></div><div class="fr-action-buttons"><button type="button" class="fr-command fr-back" data-cmd="imageDismissError" tabIndex="2">OK</button></div></div>',u={buttons:r,upload_layer:l,by_url_layer:c,progress_bar:d},h=t.popups.create("image.insert",u);return t.$wp&&t.events.$on(t.$wp,"scroll",function(){gt&&t.popups.isVisible("image.insert")&&ut()}),R(h),h}function F(){if(gt){var e=t.popups.get("image.alt");e.find("input").val(gt.attr("alt")||"").trigger("change")}}function z(){var i=t.popups.get("image.alt");i||(i=$()),v(),t.popups.refresh("image.alt"),t.popups.setContainer("image.alt",e(t.opts.scrollableContainer));var n=gt.offset().left+gt.width()/2,r=gt.offset().top+gt.height();t.popups.show("image.alt",n,r,gt.outerHeight())}function $(e){if(e)return t.popups.onRefresh("image.alt",F),!0;var i="";i='<div class="fr-buttons">'+t.button.buildList(t.opts.imageAltButtons)+"</div>";var n="";n='<div class="fr-image-alt-layer fr-layer fr-active" id="fr-image-alt-layer-'+t.id+'"><div class="fr-input-line"><input type="text" placeholder="'+t.language.translate("Alternate Text")+'" tabIndex="1"></div><div class="fr-action-buttons"><button type="button" class="fr-command fr-submit" data-cmd="imageSetAlt" tabIndex="2">'+t.language.translate("Update")+"</button></div></div>";var r={buttons:i,alt_layer:n},s=t.popups.create("image.alt",r);return t.$wp&&t.events.$on(t.$wp,"scroll.image-alt",function(){gt&&t.popups.isVisible("image.alt")&&z()}),s}function H(e){if(gt){var i=t.popups.get("image.alt");gt.attr("alt",e||i.find("input").val()||""),i.find("input:focus").blur(),w(gt)}}function B(){if(gt){var e=t.popups.get("image.size");e.find('input[name="width"]').val(gt.get(0).style.width).trigger("change"),e.find('input[name="height"]').val(gt.get(0).style.height).trigger("change")}}function W(){var i=t.popups.get("image.size");i||(i=q()),v(),t.popups.refresh("image.size"),t.popups.setContainer("image.size",e(t.opts.scrollableContainer));var n=gt.offset().left+gt.width()/2,r=gt.offset().top+gt.height();t.popups.show("image.size",n,r,gt.outerHeight())}function q(e){if(e)return t.popups.onRefresh("image.size",B),!0;var i="";i='<div class="fr-buttons">'+t.button.buildList(t.opts.imageSizeButtons)+"</div>";var n="";n='<div class="fr-image-size-layer fr-layer fr-active" id="fr-image-size-layer-'+t.id+'"><div class="fr-image-group"><div class="fr-input-line"><input type="text" name="width" placeholder="'+t.language.translate("Width")+'" tabIndex="1"></div><div class="fr-input-line"><input type="text" name="height" placeholder="'+t.language.translate("Height")+'" tabIndex="1"></div></div><div class="fr-action-buttons"><button type="button" class="fr-command fr-submit" data-cmd="imageSetSize" tabIndex="2">'+t.language.translate("Update")+"</button></div></div>";var r={buttons:i,size_layer:n},s=t.popups.create("image.size",r);return t.$wp&&t.events.$on(t.$wp,"scroll.image-size",function(){gt&&t.popups.isVisible("image.size")&&W()}),s}function Q(e,i){if(gt){var n=t.popups.get("image.size");gt.css("width",e||n.find('input[name="width"]').val()),gt.css("height",i||n.find('input[name="height"]').val()),n.find("input:focus").blur(),w(gt)}}function U(e){var i,n,r=t.popups.get("image.insert");if(gt||t.opts.toolbarInline)gt&&(n=gt.offset().top+gt.outerHeight());else{var s=t.$tb.find('.fr-command[data-cmd="insertImage"]');i=s.offset().left+s.outerWidth()/2,n=s.offset().top+(t.opts.toolbarBottom?10:s.outerHeight()-10)}!gt&&t.opts.toolbarInline&&(n=r.offset().top-t.helpers.getPX(r.css("margin-top")),r.hasClass("fr-above")&&(n+=r.outerHeight())),r.find(".fr-layer").removeClass("fr-active"),r.find(".fr-"+e+"-layer").addClass("fr-active"),t.popups.show("image.insert",i,n,gt?gt.outerHeight():0)}function X(e){var i=t.popups.get("image.insert");i.find(".fr-image-upload-layer").hasClass("fr-active")&&e.addClass("fr-active")}function V(e){var i=t.popups.get("image.insert");i.find(".fr-image-by-url-layer").hasClass("fr-active")&&e.addClass("fr-active")}function G(){var i;t.shared.$image_resizer?(vt=t.shared.$image_resizer,yt=t.shared.$img_overlay,t.events.on("destroy",function(){vt.removeClass("fr-active").appendTo(e("body"))},!0)):(t.shared.$image_resizer=e('<div class="fr-image-resizer"></div>'),vt=t.shared.$image_resizer,t.events.$on(vt,"mousedown",function(e){e.stopPropagation()},!0),t.opts.imageResize&&(vt.append(d("nw")+d("ne")+d("sw")+d("se")),t.shared.$img_overlay=e('<div class="fr-image-overlay"></div>'),yt=t.shared.$img_overlay,i=vt.get(0).ownerDocument,e(i).find("body").append(yt))),t.events.on("shared.destroy",function(){vt.html("").removeData().remove(),vt=null,t.opts.imageResize&&(yt.remove(),yt=null)},!0),t.helpers.isMobile()||t.events.$on(e(t.o_win),"resize",function(){gt&&!gt.hasClass("fr-uploading")?it(!0):gt&&(c(),ut(),g(!1))}),t.opts.imageResize&&(i=vt.get(0).ownerDocument,t.events.$on(vt,t._mousedown,".fr-handler",u),t.events.$on(e(i),t._mousemove,h),t.events.$on(e(i.defaultView||i.parentWindow),t._mouseup,p),t.events.$on(yt,"mouseleave",p))}function Y(i){i=i||gt,i&&t.events.trigger("image.beforeRemove",[i])!==!1&&(t.popups.hideAll(),it(!0),i.get(0)==t.$el.get(0)?i.removeAttr("src"):("A"==i.get(0).parentNode.tagName?(t.selection.setBefore(i.get(0).parentNode)||t.selection.setAfter(i.get(0).parentNode)||i.parent().after(e.FE.MARKERS),e(i.get(0).parentNode).remove()):(t.selection.setBefore(i.get(0))||t.selection.setAfter(i.get(0))||i.after(e.FE.MARKERS),i.remove()),t.html.fillEmptyBlocks(),t.selection.restore()),t.undo.saveStep())}function K(){if(j(),"IMG"==t.$el.get(0).tagName&&t.$el.addClass("fr-view"),t.events.$on(t.$el,t.helpers.isMobile()&&!t.helpers.isWindowsPhone()?"touchend":"click","IMG"==t.$el.get(0).tagName?null:'img:not([contenteditable="false"])',tt),t.helpers.isMobile()&&(t.events.$on(t.$el,"touchstart","IMG"==t.$el.get(0).tagName?null:'img:not([contenteditable="false"])',function(){Et=!1}),t.events.$on(t.$el,"touchmove",function(){Et=!0})),t.events.on("window.keydown keydown",function(i){var n=i.which;if(gt&&(n==e.FE.KEYCODE.BACKSPACE||n==e.FE.KEYCODE.DELETE))return i.preventDefault(),i.stopPropagation(),Y(),!1;if(gt&&n==e.FE.KEYCODE.ESC){var r=gt;return it(!0),t.selection.setAfter(r.get(0)),t.selection.restore(),i.preventDefault(),!1}return gt&&!t.keys.ctrlKey(i)?(i.preventDefault(),!1):void 0},!0),t.events.on("window.cut window.copy",function(i){gt&&(ht(),e.FE.copied_text="\n",e.FE.copied_html=gt.get(0).outerHTML,"copy"==i.type?setTimeout(function(){w(gt)}):(it(!0),t.undo.saveStep(),setTimeout(function(){t.undo.saveStep()},0)))},!0),t.events.$on(e(t.o_win),"keydown",function(t){var i=t.which;return gt&&i==e.FE.KEYCODE.BACKSPACE?(t.preventDefault(),!1):void 0}),t.events.$on(t.$win,"keydown",function(t){var i=t.which;gt&&gt.hasClass("fr-uploading")&&i==e.FE.KEYCODE.ESC&&gt.trigger("abortUpload")}),t.events.on("destroy",function(){gt&&gt.hasClass("fr-uploading")&&gt.trigger("abortUpload")}),t.events.on("paste.before",Z),t.events.on("paste.beforeCleanup",et),t.events.on("paste.after",J),t.events.on("html.set",a),t.events.on("html.inserted",a),a(),t.events.on("destroy",function(){Nt=[]}),t.events.on("html.get",function(e){return e=e.replace(/<(img)((?:[\w\W]*?))class="([\w\W]*?)(fr-uploading|fr-error)([\w\W]*?)"((?:[\w\W]*?))>/g,"")}),t.opts.imageOutputSize){var i;t.events.on("html.beforeGet",function(){i=t.$el.get(0).querySelectorAll("img");for(var n=0;n<i.length;n++){var r=i[n].style.width||e(i[n]).width(),s=i[n].style.height||e(i[n]).height();r&&i[n].setAttribute("width",(""+r).replace(/px/,"")),s&&i[n].setAttribute("height",(""+s).replace(/px/,""))}}),t.events.on("html.afterGet",function(){for(var e=0;e<i.length;e++)i[e].removeAttribute("width"),i[e].removeAttribute("height")})}t.opts.iframe&&t.events.on("image.loaded",t.size.syncIframe),t.$wp&&(l(),t.events.on("contentChanged",l)),t.events.$on(e(t.o_win),"orientationchange.image",function(){setTimeout(function(){var e=ft();e&&w(e)},0)}),m(!0),P(!0),q(!0),$(!0),t.events.on("node.remove",function(e){return"IMG"==e.get(0).tagName?(Y(e),!1):void 0})}function J(){t.opts.imagePaste?t.$el.find("img[data-fr-image-pasted]").each(function(i,n){if(t.opts.imagePasteProcess){var s=t.opts.imageDefaultWidth;s&&"auto"!=s&&(s+=t.opts.imageResizeWithPercent?"%":"px"),e(n).css("width",s),e(n).removeClass("fr-dii fr-dib fr-fir fr-fil").addClass((t.opts.imageDefaultDisplay?"fr-di"+t.opts.imageDefaultDisplay[0]:"")+(t.opts.imageDefaultAlign?"center"!=t.opts.imageDefaultAlign?" fr-fi"+t.opts.imageDefaultAlign[0]:"":""))}if(0===n.src.indexOf("data:")){if(t.events.trigger("image.beforePasteUpload",[n])===!1)return!1;gt=e(n),c(),r(),ut(),g(),t.edit.off();for(var o=atob(e(n).attr("src").split(",")[1]),a=[],l=0;l<o.length;l++)a.push(o.charCodeAt(l));var d=new Blob([new Uint8Array(a)],{type:"image/jpeg"});O([d]),e(n).removeAttr("data-fr-image-pasted")}else 0!==n.src.indexOf("http")?(t.selection.save(),e(n).remove(),t.selection.restore()):e(n).removeAttr("data-fr-image-pasted")}):t.$el.find("img[data-fr-image-pasted]").remove()}function Z(e){if(e&&e.clipboardData&&e.clipboardData.items&&e.clipboardData.items[0]){var i=e.clipboardData.items[0].getAsFile();if(i){var n=new FileReader;return n.onload=function(e){var i=e.target.result,n=t.opts.imageDefaultWidth;n&&"auto"!=n&&(n+=t.opts.imageResizeWithPercent?"%":"px"),t.html.insert('<img data-fr-image-pasted="true" class="'+(t.opts.imageDefaultDisplay?"fr-di"+t.opts.imageDefaultDisplay[0]:"")+(t.opts.imageDefaultAlign?"center"!=t.opts.imageDefaultAlign?" fr-fi"+t.opts.imageDefaultAlign[0]:"":"")+'" src="'+i+'"'+(n?' style="width: '+n+';"':"")+">"),t.events.trigger("paste.after")},n.readAsDataURL(i),!1}}}function et(e){return e=e.replace(/<img /gi,'<img data-fr-image-pasted="true" ')}function tt(i){if(e(this).parents('[contenteditable="false"]:not(.fr-element):not(body)').length)return!0;if(i&&"touchend"==i.type&&Et)return!0;if(i&&t.edit.isDisabled())return i.stopPropagation(),i.preventDefault(),!1;for(var n=0;n<e.FE.INSTANCES.length;n++)e.FE.INSTANCES[n]!=t&&e.FE.INSTANCES[n].events.trigger("image.hideResizer");t.toolbar.disable(),i&&(i.stopPropagation(),i.preventDefault()),t.helpers.isMobile()&&(t.events.disableBlur(),t.$el.blur(),t.events.enableBlur()),t.opts.iframe&&t.size.syncIframe(),gt=e(this),ht(),c(),r(),t.selection.clear(),t.button.bulkRefresh(),t.events.trigger("video.hideResizer")}function it(e){gt&&(st()||e===!0)&&(t.toolbar.enable(),vt.removeClass("fr-active"),t.popups.hide("image.edit"),gt=null,rt())}function nt(){Dt=!0}function rt(){Dt=!1}function st(){return Dt}function ot(e){gt.removeClass("fr-fir fr-fil"),"left"==e?gt.addClass("fr-fil"):"right"==e&&gt.addClass("fr-fir"),c(),r()}function at(e){gt&&(gt.hasClass("fr-fil")?e.find("> *:first").replaceWith(t.icon.create("align-left")):gt.hasClass("fr-fir")?e.find("> *:first").replaceWith(t.icon.create("align-right")):e.find("> *:first").replaceWith(t.icon.create("align-justify")))}function lt(e,t){if(gt){var i="justify";gt.hasClass("fr-fil")?i="left":gt.hasClass("fr-fir")&&(i="right"),t.find('.fr-command[data-param1="'+i+'"]').addClass("fr-active")}}function ct(e){gt.removeClass("fr-dii fr-dib"),"inline"==e?gt.addClass("fr-dii"):"block"==e&&gt.addClass("fr-dib"),c(),r()}function dt(e,t){var i="block";gt.hasClass("fr-dii")&&(i="inline"),t.find('.fr-command[data-param1="'+i+'"]').addClass("fr-active")}function ut(){var i=t.popups.get("image.insert");i||(i=P()),t.popups.isVisible("image.insert")||(v(),t.popups.refresh("image.insert"),t.popups.setContainer("image.insert",e(t.opts.scrollableContainer)));var n=gt.offset().left+gt.width()/2,r=gt.offset().top+gt.height();t.popups.show("image.insert",n,r,gt.outerHeight())}function ht(){if(gt){t.selection.clear();var e=t.doc.createRange();e.selectNode(gt.get(0));var i=t.selection.get();i.addRange(e)}}function pt(){gt?(e(".fr-popup input:focus").blur(),w(gt)):(t.events.disableBlur(),t.selection.restore(),t.events.enableBlur(),t.popups.hide("image.insert"),t.toolbar.showInline())}function ft(){return gt}function mt(e,i,n){if("undefined"==typeof i&&(i=t.opts.imageStyles),"undefined"==typeof n&&(n=t.opts.imageMultipleStyles),!gt)return!1;if(!n){var r=Object.keys(i);r.splice(r.indexOf(e),1),gt.removeClass(r.join(" "))}gt.toggleClass(e),w(gt)}var gt,vt,_t,yt,bt=!1,wt=1,kt=2,Ct=3,xt=4,At=5,Tt=6,St=7,Mt={};Mt[wt]="Image cannot be loaded from the passed link.",Mt[kt]="No link in upload response.",Mt[Ct]="Error during file upload.",Mt[xt]="Parsing response failed.",Mt[At]="File is too large.",Mt[Tt]="Image file type is invalid.",Mt[St]="Files can be uploaded only to same domain in IE 8 and IE 9.";var Nt,Et,Dt=!1;return{_init:K,showInsertPopup:n,showLayer:U,refreshUploadButton:X,refreshByURLButton:V,upload:O,insertByURL:b,align:ot,refreshAlign:at,refreshAlignOnShow:lt,display:ct,refreshDisplayOnShow:dt,replace:ut,back:pt,get:ft,insert:C,showProgressBar:g,remove:Y,hideProgressBar:v,applyStyle:mt,showAltPopup:z,showSizePopup:W,setAlt:H,setSize:Q,exitEdit:it,edit:w}},e.FE.DefineIcon("insertImage",{NAME:"image"}),e.FE.RegisterShortcut(e.FE.KEYCODE.P,"insertImage",null,"P"),e.FE.RegisterCommand("insertImage",{title:"Insert Image",undo:!1,focus:!0,refreshAfterCallback:!1,popup:!0,callback:function(){this.popups.isVisible("image.insert")?(this.$el.find(".fr-marker")&&(this.events.disableBlur(),this.selection.restore()),this.popups.hide("image.insert")):this.image.showInsertPopup()},plugin:"image"}),e.FE.DefineIcon("imageUpload",{NAME:"upload"}),e.FE.RegisterCommand("imageUpload",{title:"Upload Image",undo:!1,focus:!1,callback:function(){this.image.showLayer("image-upload")},refresh:function(e){this.image.refreshUploadButton(e)}}),e.FE.DefineIcon("imageByURL",{NAME:"link"}),e.FE.RegisterCommand("imageByURL",{title:"By URL",undo:!1,focus:!1,callback:function(){this.image.showLayer("image-by-url")},refresh:function(e){this.image.refreshByURLButton(e)}}),e.FE.RegisterCommand("imageInsertByURL",{title:"Insert Image",undo:!0,refreshAfterCallback:!1,callback:function(){this.image.insertByURL()},refresh:function(e){var t=this.image.get();t?e.text(this.language.translate("Replace")):e.text(this.language.translate("Insert"))}}),e.FE.DefineIcon("imageDisplay",{NAME:"star"}),e.FE.RegisterCommand("imageDisplay",{title:"Display",type:"dropdown",options:{inline:"Inline",block:"Break Text"},callback:function(e,t){this.image.display(t)},refresh:function(e){this.opts.imageTextNear||e.addClass("fr-hidden")},refreshOnShow:function(e,t){this.image.refreshDisplayOnShow(e,t)}}),e.FE.ICONS.align||(e.FE.DefineIcon("align",{NAME:"align-left"}),e.FE.DefineIcon("align-left",{NAME:"align-left"}),e.FE.DefineIcon("align-right",{NAME:"align-right"}),e.FE.DefineIcon("align-center",{NAME:"align-center"}),e.FE.DefineIcon("align-justify",{NAME:"align-justify"})),e.FE.DefineIcon("imageAlign",{NAME:"align-center"}),e.FE.RegisterCommand("imageAlign",{type:"dropdown",title:"Align",options:{left:"Align Left",justify:"None",right:"Align Right"},html:function(){var t='<ul class="fr-dropdown-list">',i=e.FE.COMMANDS.imageAlign.options;for(var n in i)i.hasOwnProperty(n)&&(t+='<li><a class="fr-command fr-title" data-cmd="imageAlign" data-param1="'+n+'" title="'+this.language.translate(i[n])+'">'+this.icon.create("align-"+n)+"</a></li>");return t+="</ul>"},callback:function(e,t){this.image.align(t)},refresh:function(e){this.image.refreshAlign(e)},refreshOnShow:function(e,t){this.image.refreshAlignOnShow(e,t)
}}),e.FE.DefineIcon("imageReplace",{NAME:"exchange"}),e.FE.RegisterCommand("imageReplace",{title:"Replace",undo:!1,focus:!1,refreshAfterCallback:!1,callback:function(){this.image.replace()}}),e.FE.DefineIcon("imageRemove",{NAME:"trash"}),e.FE.RegisterCommand("imageRemove",{title:"Remove",callback:function(){this.image.remove()}}),e.FE.DefineIcon("imageBack",{NAME:"arrow-left"}),e.FE.RegisterCommand("imageBack",{title:"Back",undo:!1,focus:!1,back:!0,callback:function(){this.image.back()},refresh:function(e){var t=this.image.get();t||this.opts.toolbarInline?(e.removeClass("fr-hidden"),e.next(".fr-separator").removeClass("fr-hidden")):(e.addClass("fr-hidden"),e.next(".fr-separator").addClass("fr-hidden"))}}),e.FE.RegisterCommand("imageDismissError",{title:"OK",undo:!1,callback:function(){this.image.hideProgressBar(!0)}}),e.FE.DefineIcon("imageStyle",{NAME:"magic"}),e.FE.RegisterCommand("imageStyle",{title:"Style",type:"dropdown",html:function(){var e='<ul class="fr-dropdown-list">',t=this.opts.imageStyles;for(var i in t)t.hasOwnProperty(i)&&(e+='<li><a class="fr-command" data-cmd="imageStyle" data-param1="'+i+'">'+this.language.translate(t[i])+"</a></li>");return e+="</ul>"},callback:function(e,t){this.image.applyStyle(t)},refreshOnShow:function(t,i){var n=this.image.get();n&&i.find(".fr-command").each(function(){var t=e(this).data("param1");e(this).toggleClass("fr-active",n.hasClass(t))})}}),e.FE.DefineIcon("imageAlt",{NAME:"info"}),e.FE.RegisterCommand("imageAlt",{undo:!1,focus:!1,title:"Alternate Text",callback:function(){this.image.showAltPopup()}}),e.FE.RegisterCommand("imageSetAlt",{undo:!0,focus:!1,title:"Update",refreshAfterCallback:!1,callback:function(){this.image.setAlt()}}),e.FE.DefineIcon("imageSize",{NAME:"arrows-alt"}),e.FE.RegisterCommand("imageSize",{undo:!1,focus:!1,title:"Change Size",callback:function(){this.image.showSizePopup()}}),e.FE.RegisterCommand("imageSetSize",{undo:!0,focus:!1,title:"Update",refreshAfterCallback:!1,callback:function(){this.image.setSize()}})}),/*!
 * froala_editor v2.3.5 (https://www.froala.com/wysiwyg-editor)
 * License https://froala.com/wysiwyg-editor/terms/
 * Copyright 2014-2016 Froala Labs
 */
function(e){"function"==typeof define&&define.amd?define(["jquery"],e):"object"==typeof module&&module.exports?module.exports=function(t,i){return void 0===i&&(i="undefined"!=typeof window?require("jquery"):require("jquery")(t)),e(i),i}:e(jQuery)}(function(e){"use strict";if(e.extend(e.FE.DEFAULTS,{imageManagerLoadURL:"https://i.froala.com/load-files",imageManagerLoadMethod:"get",imageManagerLoadParams:{},imageManagerPreloader:"",imageManagerDeleteURL:"",imageManagerDeleteMethod:"post",imageManagerDeleteParams:{},imageManagerPageSize:12,imageManagerScrollOffset:20,imageManagerToggleTags:!0}),e.FE.PLUGINS.imageManager=function(t){function i(){T||a(),T.data("instance",t),T.show(),O.show(),T.data("current-image",t.image.get()),S||x(),l(),t.$doc.find("body").addClass("prevent-scroll"),t.helpers.isMobile()&&t.$doc.find("body").addClass("fr-mobile")}function n(){var e=T.data("instance")||t;e.events.enableBlur(),T.hide(),O.hide(),e.$doc.find("body").removeClass("prevent-scroll fr-mobile")}function r(){var t=e(window).outerWidth();return 768>t?2:1200>t?3:4}function s(){M.empty();for(var e=0;P>e;e++)M.append('<div class="fr-list-column"></div>')}function o(){var i="";t.opts.theme&&(i=" "+t.opts.theme+"-theme");var n='<div class="fr-modal'+i+'"><div class="fr-modal-wrapper">';return n+='<div class="fr-modal-title"><div class="fr-modal-title-line"><i class="fa fa-bars fr-modal-more fr-not-available" id="fr-modal-more-'+t.sid+'" title="'+t.language.translate("Tags")+'"></i><h4 data-text="true">'+t.language.translate("Manage Images")+'</h4><i title="'+t.language.translate("Cancel")+'" class="fa fa-times fr-modal-close" id="fr-modal-close"></i></div>',n+='<div class="fr-modal-tags" id="fr-modal-tags"></div>',n+="</div>",n+='<img class="fr-preloader" id="fr-preloader" alt="'+t.language.translate("Loading")+'.." src="'+t.opts.imageManagerPreloader+'" style="display: none;">',n+='<div class="fr-scroller" id="fr-scroller"><div class="fr-image-list" id="fr-image-list"></div></div>',n+="</div></div>",e(n)}function a(){t.shared.$modal?(T=t.shared.$modal,O=t.shared.$overlay):(t.shared.$modal=o(),T=t.shared.$modal,t.helpers.isMobile()||T.addClass("fr-desktop"),T.appendTo("body"),t.shared.$overlay=e('<div class="fr-overlay">').appendTo("body"),O=t.shared.$overlay,t.opts.theme&&O.addClass(t.opts.theme+"-theme"),n()),t.events.on("shared.destroy",function(){T.removeData().remove(),O.removeData().remove()},!0)}function l(){S.show(),M.find(".fr-list-column").empty(),t.opts.imageManagerLoadURL?e.ajax({url:t.opts.imageManagerLoadURL,method:t.opts.imageManagerLoadMethod,data:t.opts.imageManagerLoadParams,dataType:"json",crossDomain:t.opts.requestWithCORS,xhrFields:{withCredentials:t.opts.requestWithCredentials},headers:t.opts.requestHeaders}).done(function(e,i,n){t.events.trigger("imageManager.imagesLoaded",[e]),c(e,n.response),S.hide()}).fail(function(){var e=this.xhr();y(z,e.response||e.responseText)}):y($)}function c(e,t){try{M.find(".fr-list-column").empty(),L=0,I=0,j=0,R=e,d()}catch(i){y(H,t)}}function d(){if(I<R.length&&(M.outerHeight()<=N.outerHeight()+t.opts.imageManagerScrollOffset||N.scrollTop()+t.opts.imageManagerScrollOffset>M.outerHeight()-N.outerHeight())){L++;for(var e=t.opts.imageManagerPageSize*(L-1);e<Math.min(R.length,t.opts.imageManagerPageSize*L);e++)u(R[e])}}function u(i){var n=new Image,r=e('<div class="fr-image-container fr-empty fr-image-'+j++ +'" data-loading="'+t.language.translate("Loading")+'.." data-deleting="'+t.language.translate("Deleting")+'..">');m(!1),n.onload=function(){r.height(Math.floor(r.width()/n.width*n.height));var s=e("<img/>");if(i.thumb)s.attr("src",i.thumb);else{if(y(B,i),!i.url)return y(W,i),!1;s.attr("src",i.url)}if(i.url&&s.attr("data-url",i.url),i.tag)if(D.find(".fr-modal-more.fr-not-available").removeClass("fr-not-available"),D.find(".fr-modal-tags").show(),i.tag.indexOf(",")>=0){for(var o=i.tag.split(","),a=0;a<o.length;a++)o[a]=o[a].trim(),0===E.find('a[title="'+o[a]+'"]').length&&E.append('<a role="button" title="'+o[a]+'">'+o[a]+"</a>");s.attr("data-tag",o.join())}else 0===E.find('a[title="'+i.tag.trim()+'"]').length&&E.append('<a role="button" title="'+i.tag.trim()+'">'+i.tag.trim()+"</a>"),s.attr("data-tag",i.tag.trim());for(var l in i)i.hasOwnProperty(l)&&"thumb"!=l&&"url"!=l&&"tag"!=l&&s.attr("data-"+l,i[l]);r.append(s).append(e(t.icon.create("imageManagerDelete")).addClass("fr-delete-img").attr("title",t.language.translate("Delete"))).append(e(t.icon.create("imageManagerInsert")).addClass("fr-insert-img").attr("title",t.language.translate("Insert"))),E.find(".fr-selected-tag").each(function(e,t){C(s,t.text)||r.hide()}),s.on("load",function(){r.removeClass("fr-empty"),r.height("auto"),I++;var e=p(parseInt(s.parent().attr("class").match(/fr-image-(\d+)/)[1],10)+1);f(e),m(!1),0===I%t.opts.imageManagerPageSize&&d()}),t.events.trigger("imageManager.imageLoaded",[s])},n.onerror=function(){I++,r.remove();var e=p(parseInt(r.attr("class").match(/fr-image-(\d+)/)[1],10)+1);f(e),y(F,i),0===I%t.opts.imageManagerPageSize&&d()},n.src=i.thumb||i.url,h().append(r)}function h(){var t,i;return M.find(".fr-list-column").each(function(n,r){var s=e(r);0===n?(i=s.outerHeight(),t=s):s.outerHeight()<i&&(i=s.outerHeight(),t=s)}),t}function p(t){void 0===t&&(t=0);for(var i=[],n=j-1;n>=t;n--){var r=M.find(".fr-image-"+n);r.length&&(i.push(r),e('<div id="fr-image-hidden-container">').append(r),M.find(".fr-image-"+n).remove())}return i}function f(e){for(var t=e.length-1;t>=0;t--)h().append(e[t])}function m(e){if(void 0===e&&(e=!0),!T.is(":visible"))return!0;var i=r();if(i!=P){P=i;var n=p();s(),f(n)}var o=t.$win.height(),a=T.find(".fr-modal-wrapper"),l=parseFloat(a.css("margin-top"))+parseFloat(a.css("margin-bottom")),c=parseFloat(a.css("padding-top"))+parseFloat(a.css("padding-bottom")),u=parseFloat(a.css("border-top-width")),h=a.find("h4").outerHeight();N.height(Math.min(M.outerHeight(),o-l-c-h-u)),e&&d()}function g(e){var t={},i=e.data();for(var n in i)i.hasOwnProperty(n)&&"url"!=n&&"tag"!=n&&(t[n]=i[n]);return t}function v(i){var r=e(i.currentTarget).siblings("img"),s=T.data("instance")||t,o=T.data("current-image");if(n(),s.image.showProgressBar(),o)o.trigger("click");else{s.events.focus(!0),s.selection.restore();var a=s.position.getBoundingRect(),l=a.left+a.width/2,c=a.top+a.height;s.popups.setContainer("image.insert",s.$box||e("body")),s.popups.show("image.insert",l,c)}s.image.insert(r.data("url"),!1,g(r),o)}function _(i){var n=e(i.currentTarget).siblings("img"),r=t.language.translate("Are you sure? Image will be deleted.");confirm(r)&&(t.opts.imageManagerDeleteURL?t.events.trigger("imageManager.beforeDeleteImage",[n])!==!1&&(n.parent().addClass("fr-image-deleting"),e.ajax({method:t.opts.imageManagerDeleteMethod,url:t.opts.imageManagerDeleteURL,data:e.extend(e.extend({src:n.attr("src")},g(n)),t.opts.imageManagerDeleteParams),crossDomain:t.opts.requestWithCORS,xhrFields:{withCredentials:t.opts.requestWithCredentials},headers:t.opts.requestHeaders}).done(function(e){t.events.trigger("imageManager.imageDeleted",[e]);var i=p(parseInt(n.parent().attr("class").match(/fr-image-(\d+)/)[1],10)+1);n.parent().remove(),f(i),m(!0)}).fail(function(){var e=this.xhr();y(q,e.response||e.responseText)})):y(Q))}function y(i,n){i>=10&&20>i?S.hide():i>=20&&30>i&&e(".fr-image-deleting").removeClass("fr-image-deleting"),t.events.trigger("imageManager.error",[{code:i,message:U[i]},n])}function b(){var e=D.find(".fr-modal-title-line").outerHeight(),t=E.outerHeight();D.toggleClass(".fr-show-tags"),D.hasClass(".fr-show-tags")?(D.css("height",e+t),E.find("a").css("opacity",1)):(D.css("height",e),E.find("a").css("opacity",0))}function w(){var t=E.find(".fr-selected-tag");t.length>0?(M.find("img").parent().show(),t.each(function(t,i){M.find("img").each(function(t,n){var r=e(n);C(r,i.text)||r.parent().hide()})})):M.find("img").parent().show();var i=p();f(i),d()}function k(i){i.preventDefault();var n=e(i.currentTarget);n.toggleClass("fr-selected-tag"),t.opts.imageManagerToggleTags&&n.siblings("a").removeClass("fr-selected-tag"),w()}function C(e,t){for(var i=e.attr("data-tag").split(","),n=0;n<i.length;n++)if(i[n]==t)return!0;return!1}function x(){S=T.find("#fr-preloader"),M=T.find("#fr-image-list"),N=T.find("#fr-scroller"),E=T.find("#fr-modal-tags"),D=E.parent(),P=r(),s();var i=D.find(".fr-modal-title-line").outerHeight();D.css("height",i),N.css("margin-top",i),t.events.bindClick(T,"i#fr-modal-close",n),t.events.$on(e(t.o_win),"resize",function(){R?m(!0):m(!1)}),t.helpers.isMobile()&&(t.events.bindClick(M,"div.fr-image-container",function(t){T.find(".fr-mobile-selected").removeClass("fr-mobile-selected"),e(t.currentTarget).addClass("fr-mobile-selected")}),T.on(t._mousedown,function(){T.find(".fr-mobile-selected").removeClass("fr-mobile-selected")})),t.events.bindClick(M,".fr-insert-img",v),t.events.bindClick(M,".fr-delete-img",_),T.on(t._mousedown+" "+t._mouseup,function(e){e.stopPropagation()}),T.on(t._mousedown,"*",function(){t.events.disableBlur()}),N.on("scroll",d),t.events.bindClick(T,"i#fr-modal-more-"+t.sid,b),t.events.bindClick(E,"a",k)}function A(){return t.$wp||"IMG"==t.$el.get(0).tagName?void 0:!1}var T,S,M,N,E,D,O,R,L,I,j,P,F=10,z=11,$=12,H=13,B=14,W=15,q=21,Q=22,U={};return U[F]="Image cannot be loaded from the passed link.",U[z]="Error during load images request.",U[$]="Missing imageManagerLoadURL option.",U[H]="Parsing load response failed.",U[B]="Missing image thumb.",U[W]="Missing image URL.",U[q]="Error during delete image request.",U[Q]="Missing imageManagerDeleteURL option.",{require:["image"],_init:A,show:i,hide:n}},!e.FE.PLUGINS.image)throw new Error("Image manager plugin requires image plugin.");e.FE.DEFAULTS.imageInsertButtons.push("imageManager"),e.FE.RegisterCommand("imageManager",{title:"Browse",undo:!1,focus:!1,callback:function(){this.imageManager.show()},plugin:"imageManager"}),e.FE.DefineIcon("imageManager",{NAME:"folder"}),e.FE.DefineIcon("imageManagerInsert",{NAME:"plus"}),e.FE.DefineIcon("imageManagerDelete",{NAME:"trash"})}),/*!
 * froala_editor v2.3.5 (https://www.froala.com/wysiwyg-editor)
 * License https://froala.com/wysiwyg-editor/terms/
 * Copyright 2014-2016 Froala Labs
 */
function(e){"function"==typeof define&&define.amd?define(["jquery"],e):"object"==typeof module&&module.exports?module.exports=function(t,i){return void 0===i&&(i="undefined"!=typeof window?require("jquery"):require("jquery")(t)),e(i),i}:e(jQuery)}(function(e){"use strict";e.extend(e.FE.DEFAULTS,{inlineStyles:{"Big Red":"font-size: 20px; color: red;","Small Blue":"font-size: 14px; color: blue;"}}),e.FE.PLUGINS.inlineStyle=function(t){function i(i){""!==t.selection.text()?t.html.insert(e.FE.START_MARKER+'<span style="'+i+'">'+t.selection.text()+"</span>"+e.FE.END_MARKER):t.html.insert('<span style="'+i+'">'+e.FE.INVISIBLE_SPACE+e.FE.MARKERS+"</span>")}return{apply:i}},e.FE.RegisterCommand("inlineStyle",{type:"dropdown",html:function(){var e='<ul class="fr-dropdown-list">',t=this.opts.inlineStyles;for(var i in t)t.hasOwnProperty(i)&&(e+='<li><span style="'+t[i]+'"><a class="fr-command" data-cmd="inlineStyle" data-param1="'+t[i]+'" title="'+this.language.translate(i)+'">'+this.language.translate(i)+"</a></span></li>");return e+="</ul>"},title:"Inline Style",callback:function(e,t){this.inlineStyle.apply(t)},plugin:"inlineStyle"}),e.FE.DefineIcon("inlineStyle",{NAME:"paint-brush"})}),/*!
 * froala_editor v2.3.5 (https://www.froala.com/wysiwyg-editor)
 * License https://froala.com/wysiwyg-editor/terms/
 * Copyright 2014-2016 Froala Labs
 */
function(e){"function"==typeof define&&define.amd?define(["jquery"],e):"object"==typeof module&&module.exports?module.exports=function(t,i){return void 0===i&&(i="undefined"!=typeof window?require("jquery"):require("jquery")(t)),e(i),i}:e(jQuery)}(function(e){"use strict";e.extend(e.FE.DEFAULTS,{lineBreakerTags:["table","hr","form","dl","span.fr-video"],lineBreakerOffset:15}),e.FE.PLUGINS.lineBreaker=function(t){function i(i,n){var r,s,o,a,l,c,d,u;if(null==i)a=n.parent(),l=a.offset().top,d=n.offset().top,r=d-Math.min((d-l)/2,t.opts.lineBreakerOffset),o=a.outerWidth(),s=a.offset().left;else if(null==n)a=i.parent(),c=a.offset().top+a.outerHeight(),u=i.offset().top+i.outerHeight(),r=u+Math.min((c-u)/2,t.opts.lineBreakerOffset),o=a.outerWidth(),s=a.offset().left;else{a=i.parent();var h=i.offset().top+i.height(),f=n.offset().top;if(h>f)return!1;r=(h+f)/2,o=a.outerWidth(),s=a.offset().left}t.opts.iframe&&(s+=t.$iframe.offset().left-e(t.o_win).scrollLeft(),r+=t.$iframe.offset().top-e(t.o_win).scrollTop()),t.$box.append(p),p.css("top",r-t.win.pageYOffset),p.css("left",s-t.win.pageXOffset),p.css("width",o),p.data("tag1",i),p.data("tag2",n),p.addClass("fr-visible").data("instance",t)}function n(e,n){var s,o,a=e.offset().top,l=e.offset().top+e.outerHeight();if(Math.abs(l-n)<=t.opts.lineBreakerOffset||Math.abs(n-a)<=t.opts.lineBreakerOffset)if(Math.abs(l-n)<Math.abs(n-a)){o=e.get(0);for(var c=o.nextSibling;c&&c.nodeType==Node.TEXT_NODE&&0===c.textContent.length;)c=c.nextSibling;if(!c)return i(e,null),!0;if(s=r(c))return i(e,s),!0}else{if(o=e.get(0),!o.previousSibling)return i(null,e),!0;if(s=r(o.previousSibling))return i(s,e),!0}p.removeClass("fr-visible").removeData("instance")}function r(i){if(i){var n=e(i);if(0===t.$el.find(n).length)return null;if(i.nodeType!=Node.TEXT_NODE&&n.is(t.opts.lineBreakerTags.join(",")))return n;if(n.parents(t.opts.lineBreakerTags.join(",")).length>0)return i=n.parents(t.opts.lineBreakerTags.join(",")).get(0),e(i)}return null}function s(i){m=null;var s,o,a,l=null,c=t.doc.elementFromPoint(i.pageX-t.win.pageXOffset,i.pageY-t.win.pageYOffset);if(c&&("HTML"==c.tagName||"BODY"==c.tagName||t.node.isElement(c)))for(s=1;s<=t.opts.lineBreakerOffset;s++){if(o=t.doc.elementFromPoint(i.pageX-t.win.pageXOffset,i.pageY-t.win.pageYOffset-s),o&&!t.node.isElement(o)&&o!=t.$wp.get(0)&&e(o).parents(t.$wp).length){l=r(o);break}if(a=t.doc.elementFromPoint(i.pageX-t.win.pageXOffset,i.pageY-t.win.pageYOffset+s),a&&!t.node.isElement(a)&&a!=t.$wp.get(0)&&e(a).parents(t.$wp).length){l=r(a);break}}else l=r(c);l?n(l,i.pageY):t.core.sameInstance(p)&&p.removeClass("fr-visible").removeData("instance")}function o(e){return p.hasClass("fr-visible")&&!t.core.sameInstance(p)?!1:t.popups.areVisible()||t.$el.get(0).querySelectorAll(".fr-selected-cell").length?(p.removeClass("fr-visible"),!0):(f===!1&&(m&&clearTimeout(m),m=setTimeout(s,30,e)),void 0)}function a(){m&&clearTimeout(m),p.hasClass("fr-visible")&&p.removeClass("fr-visible").removeData("instance")}function l(){f=!0,a()}function c(){f=!1}function d(i){if(!t.core.sameInstance(p))return!0;i.preventDefault(),p.removeClass("fr-visible").removeData("instance");var n=p.data("tag1"),r=p.data("tag2"),s=t.html.defaultTag();null==n?s&&"TD"!=r.parent().get(0).tagName?r.before("<"+s+">"+e.FE.MARKERS+"<br></"+s+">"):r.before(e.FE.MARKERS+"<br>"):s&&"TD"!=n.parent().get(0).tagName&&0===n.parents(s).length?n.after("<"+s+">"+e.FE.MARKERS+"<br></"+s+">"):n.after(e.FE.MARKERS+"<br>"),t.selection.restore()}function u(){t.shared.$line_breaker||(t.shared.$line_breaker=e('<div class="fr-line-breaker"><a class="fr-floating-btn" role="button" tabindex="-1" title="'+t.language.translate("Break")+'"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32"><rect x="21" y="11" width="2" height="8"/><rect x="14" y="17" width="7" height="2"/><path d="M14.000,14.000 L14.000,22.013 L9.000,18.031 L14.000,14.000 Z"/></svg></a></div>')),p=t.shared.$line_breaker,t.events.on("shared.destroy",function(){p.html("").removeData().remove(),p=null},!0),t.events.on("destroy",function(){p.removeData("instance").removeClass("fr-visible").appendTo("body"),clearTimeout(m)},!0),t.events.$on(p,"mouseleave",a,!0),t.events.$on(p,"mousemove",function(e){e.stopPropagation()},!0),t.events.$on(p,"mousedown","a",function(e){e.stopPropagation()},!0),t.events.$on(p,"click","a",d,!0)}function h(){return t.$wp?(u(),f=!1,t.events.$on(t.$win,"mousemove",o),t.events.$on(e(t.win),"scroll",a),t.events.on("popups.show.table.edit",a),t.events.on("commands.after",a),t.events.$on(e(t.win),"mousedown",l),t.events.$on(e(t.win),"mouseup",c),void 0):!1}var p,f,m;return{_init:h}}}),/*!
 * froala_editor v2.3.5 (https://www.froala.com/wysiwyg-editor)
 * License https://froala.com/wysiwyg-editor/terms/
 * Copyright 2014-2016 Froala Labs
 */
function(e){"function"==typeof define&&define.amd?define(["jquery"],e):"object"==typeof module&&module.exports?module.exports=function(t,i){return void 0===i&&(i="undefined"!=typeof window?require("jquery"):require("jquery")(t)),e(i),i}:e(jQuery)}(function(e){"use strict";e.extend(e.FE.POPUP_TEMPLATES,{"link.edit":"[_BUTTONS_]","link.insert":"[_BUTTONS_][_INPUT_LAYER_]"}),e.extend(e.FE.DEFAULTS,{linkEditButtons:["linkOpen","linkStyle","linkEdit","linkRemove"],linkInsertButtons:["linkBack","|","linkList"],linkAttributes:{},linkAutoPrefix:"http://",linkStyles:{"fr-green":"Green","fr-strong":"Thick"},linkMultipleStyles:!0,linkConvertEmailAddress:!0,linkAlwaysBlank:!1,linkAlwaysNoFollow:!1,linkList:[{text:"Froala",href:"https://froala.com",target:"_blank"},{text:"Google",href:"https://google.com",target:"_blank"},{displayText:"Facebook",href:"https://facebook.com"}],linkText:!0}),e.FE.PLUGINS.link=function(t){function i(){var i=t.image?t.image.get():null;if(!i&&t.$wp){var n=t.selection.element(),r=t.selection.endElement();return"A"==n.tagName||t.node.isElement(n)||(n=e(n).parentsUntil(t.$el,"a:first").get(0)),"A"==r.tagName||t.node.isElement(r)||(r=e(r).parentsUntil(t.$el,"a:first").get(0)),r&&r==n&&"A"==r.tagName?n:null}return"A"==t.$el.get(0).tagName&&t.core.hasFocus()?t.$el.get(0):i&&i.get(0).parentNode&&"A"==i.get(0).parentNode.tagName?i.get(0).parentNode:void 0}function n(){var e=t.image?t.image.get():null,i=[];if(e)"A"==e.get(0).parentNode.tagName&&i.push(e.get(0).parentNode);else{var n,r,s,o;if(t.win.getSelection){var a=t.win.getSelection();if(a.getRangeAt&&a.rangeCount){o=t.doc.createRange();for(var l=0;l<a.rangeCount;++l)if(n=a.getRangeAt(l),r=n.commonAncestorContainer,r&&1!=r.nodeType&&(r=r.parentNode),r&&"a"==r.nodeName.toLowerCase())i.push(r);else{s=r.getElementsByTagName("a");for(var c=0;c<s.length;++c)o.selectNodeContents(s[c]),o.compareBoundaryPoints(n.END_TO_START,n)<1&&o.compareBoundaryPoints(n.START_TO_END,n)>-1&&i.push(s[c])}}}else if(t.doc.selection&&"Control"!=t.doc.selection.type)if(n=t.doc.selection.createRange(),r=n.parentElement(),"a"==r.nodeName.toLowerCase())i.push(r);else{s=r.getElementsByTagName("a"),o=t.doc.body.createTextRange();for(var d=0;d<s.length;++d)o.moveToElementText(s[d]),o.compareEndPoints("StartToEnd",n)>-1&&o.compareEndPoints("EndToStart",n)<1&&i.push(s[d])}}return i}function r(n){o(),setTimeout(function(){if(!n||n&&(1==n.which||"mouseup"!=n.type)){var r=i(),o=t.image?t.image.get():null;if(r&&!o){if(t.image){var a=t.node.contents(r);if(1==a.length&&"IMG"==a[0].tagName){var l=t.selection.ranges(0);return 0===l.startOffset&&0===l.endOffset?e(r).before(e.FE.MARKERS):e(r).after(e.FE.MARKERS),t.selection.restore(),!1}}n&&n.stopPropagation(),s(r)}}},t.helpers.isIOS()?100:0)}function s(i){var n=t.popups.get("link.edit");n||(n=a());var r=e(i);t.popups.isVisible("link.edit")||t.popups.refresh("link.edit"),t.popups.setContainer("link.edit",e(t.opts.scrollableContainer));var s=r.offset().left+e(i).outerWidth()/2,o=r.offset().top+r.outerHeight();t.popups.show("link.edit",s,o,r.outerHeight())}function o(){t.popups.hide("link.edit")}function a(){var e="";t.opts.linkEditButtons.length>1&&("A"==t.$el.get(0).tagName&&t.opts.linkEditButtons.indexOf("linkRemove")>=0&&t.opts.linkEditButtons.splice(t.opts.linkEditButtons.indexOf("linkRemove"),1),e='<div class="fr-buttons">'+t.button.buildList(t.opts.linkEditButtons)+"</div>");var n={buttons:e},r=t.popups.create("link.edit",n);return t.$wp&&t.events.$on(t.$wp,"scroll.link-edit",function(){i()&&t.popups.isVisible("link.edit")&&s(i())}),r}function l(){}function c(){var n=t.popups.get("link.insert"),r=i();if(r){var s,o,a=e(r),l=n.find('input.fr-link-attr[type="text"]'),c=n.find('input.fr-link-attr[type="checkbox"]');for(s=0;s<l.length;s++)o=e(l[s]),o.val(a.attr(o.attr("name")||""));for(c.prop("checked",!1),s=0;s<c.length;s++)o=e(c[s]),a.attr(o.attr("name"))==o.data("checked")&&o.prop("checked",!0);n.find('input.fr-link-attr[type="text"][name="text"]').val(a.text())}else n.find('input.fr-link-attr[type="text"]').val(""),n.find('input.fr-link-attr[type="checkbox"]').prop("checked",!1),n.find('input.fr-link-attr[type="text"][name="text"]').val(t.selection.text());n.find("input.fr-link-attr").trigger("change");var d=t.image?t.image.get():null;d?n.find('.fr-link-attr[name="text"]').parent().hide():n.find('.fr-link-attr[name="text"]').parent().show()}function d(){var i=t.$tb.find('.fr-command[data-cmd="insertLink"]'),n=t.popups.get("link.insert");if(n||(n=u()),!n.hasClass("fr-active"))if(t.popups.refresh("link.insert"),t.popups.setContainer("link.insert",t.$tb||e(t.opts.scrollableContainer)),i.is(":visible")){var r=i.offset().left+i.outerWidth()/2,s=i.offset().top+(t.opts.toolbarBottom?10:i.outerHeight()-10);t.popups.show("link.insert",r,s,i.outerHeight())}else t.position.forSelection(n),t.popups.show("link.insert")}function u(e){if(e)return t.popups.onRefresh("link.insert",c),t.popups.onHide("link.insert",l),!0;var n="";t.opts.linkInsertButtons.length>=1&&(n='<div class="fr-buttons">'+t.button.buildList(t.opts.linkInsertButtons)+"</div>");var r='<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="10" height="10" viewBox="0 0 32 32"><path d="M27 4l-15 15-7-7-5 5 12 12 20-20z" fill="#FFF"></path></svg>',s="",o=0;s='<div class="fr-link-insert-layer fr-layer fr-active" id="fr-link-insert-layer-'+t.id+'">',s+='<div class="fr-input-line"><input name="href" type="text" class="fr-link-attr" placeholder="URL" tabIndex="'+ ++o+'"></div>',t.opts.linkText&&(s+='<div class="fr-input-line"><input name="text" type="text" class="fr-link-attr" placeholder="'+t.language.translate("Text")+'" tabIndex="'+ ++o+'"></div>');for(var a in t.opts.linkAttributes)if(t.opts.linkAttributes.hasOwnProperty(a)){var d=t.opts.linkAttributes[a];s+='<div class="fr-input-line"><input name="'+a+'" type="text" class="fr-link-attr" placeholder="'+t.language.translate(d)+'" tabIndex="'+ ++o+'"></div>'}t.opts.linkAlwaysBlank||(s+='<div class="fr-checkbox-line"><span class="fr-checkbox"><input name="target" class="fr-link-attr" data-checked="_blank" type="checkbox" id="fr-link-target-'+t.id+'" tabIndex="'+ ++o+'"><span>'+r+'</span></span><label for="fr-link-target-'+t.id+'">'+t.language.translate("Open in new tab")+"</label></div>"),s+='<div class="fr-action-buttons"><button class="fr-command fr-submit" data-cmd="linkInsert" href="#" tabIndex="'+ ++o+'" type="button">'+t.language.translate("Insert")+"</button></div></div>";var u={buttons:n,input_layer:s},h=t.popups.create("link.insert",u);return t.$wp&&t.events.$on(t.$wp,"scroll.link-insert",function(){var e=t.image?t.image.get():null;e&&t.popups.isVisible("link.insert")&&b(),i&&t.popups.isVisible("link.insert")&&_()}),h}function h(){var n=i(),r=t.image?t.image.get():null;return t.events.trigger("link.beforeRemove",[n])===!1?!1:(r&&n?(r.unwrap(),t.image.edit(r)):n&&(t.selection.save(),e(n).replaceWith(e(n).html()),t.selection.restore(),o()),void 0)}function p(){t.events.on("keyup",function(t){t.which!=e.FE.KEYCODE.ESC&&r(t)}),t.events.on("window.mouseup",r),t.helpers.isMobile()&&t.events.$on(t.$doc,"selectionchange",r),u(!0),"A"==t.$el.get(0).tagName&&t.$el.addClass("fr-view")}function f(i){var n,r,s=t.opts.linkList[i],o=t.popups.get("link.insert"),a=o.find('input.fr-link-attr[type="text"]'),l=o.find('input.fr-link-attr[type="checkbox"]');for(r=0;r<a.length;r++)n=e(a[r]),s[n.attr("name")]?n.val(s[n.attr("name")]):"text"!=n.attr("name")&&n.val("");for(r=0;r<l.length;r++)n=e(l[r]),n.prop("checked",n.data("checked")==s[n.attr("name")])}function m(){var i,n,r=t.popups.get("link.insert"),s=r.find('input.fr-link-attr[type="text"]'),o=r.find('input.fr-link-attr[type="checkbox"]'),a=s.filter('[name="href"]').val(),l=s.filter('[name="text"]').val(),c={};for(n=0;n<s.length;n++)i=e(s[n]),["href","text"].indexOf(i.attr("name"))<0&&(c[i.attr("name")]=i.val());for(n=0;n<o.length;n++)i=e(o[n]),c[i.attr("name")]=i.is(":checked")?i.data("checked"):i.data("unchecked");var d=e(t.o_win).scrollTop();v(a,l,c),e(t.o_win).scrollTop(d)}function g(){if(!t.selection.isCollapsed()){t.selection.save();for(var i=t.$el.find(".fr-marker").addClass("fr-unprocessed").toArray();i.length;){var n=e(i.pop());n.removeClass("fr-unprocessed");var r=t.node.deepestParent(n.get(0));if(r){var s=n.get(0),o="",a="";do s=s.parentNode,t.node.isBlock(s)||(o+=t.node.closeTagString(s),a=t.node.openTagString(s)+a);while(s!=r);var l=t.node.openTagString(n.get(0))+n.html()+t.node.closeTagString(n.get(0));n.replaceWith('<span id="fr-break"></span>');var c=e(r).html();c=c.replace(/<span id="fr-break"><\/span>/g,o+l+a),e(r).html(c)}i=t.$el.find(".fr-marker.fr-unprocessed").toArray()}t.selection.restore()}}function v(s,o,a){"undefined"==typeof a&&(a={});var l=t.image?t.image.get():null;l||"A"==t.$el.get(0).tagName?"A"==t.$el.get(0).tagName&&t.$el.focus():(t.selection.restore(),t.popups.hide("link.insert"));var c=s;if(t.opts.linkConvertEmailAddress){var d=/^[\w._]+@[a-z\u00a1-\uffff0-9_-]+?\.[a-z\u00a1-\uffff0-9]{2,}$/i;d.test(s)&&!/^mailto:.*/i.test(s)&&(s="mailto:"+s)}if(""===t.opts.linkAutoPrefix||/^(mailto|tel|sms|notes|data):.*/i.test(s)||/^data:image.*/i.test(s)||/^(https?:|ftps?:|file:|)\/\//i.test(s)||["/","{","[","#","("].indexOf((s||"")[0])<0&&(s=t.opts.linkAutoPrefix+s),s=t.helpers.sanitizeURL(s),t.opts.linkAlwaysBlank&&(a.target="_blank"),t.opts.linkAlwaysNoFollow&&(a.rel="nofollow"),o=o||"",s===t.opts.linkAutoPrefix){var u=t.popups.get("link.insert");return u.find('input[name="href"]').addClass("fr-error"),t.events.trigger("link.bad",[c]),!1}var h,p=i();if(p){h=e(p);var f=t.node.rawAttributes(p);for(var m in f)f.hasOwnProperty(m)&&"class"!=m&&"style"!=m&&"id"!=m&&"contenteditable"!=m&&h.removeAttr(m);h.attr("href",s),o.length>0&&h.text()!=o&&!l&&h.text(o),l||h.prepend(e.FE.START_MARKER).append(e.FE.END_MARKER),h.attr(a),l||t.selection.restore()}else{l?l.wrap('<a href="'+s+'"></a>'):(t.format.remove("a"),t.selection.isCollapsed()?(o=0===o.length?c:o,t.html.insert('<a href="'+s+'">'+e.FE.START_MARKER+o+e.FE.END_MARKER+"</a>"),t.selection.restore()):o.length>0&&o!=t.selection.text().replace(/\n/g,"")?(t.selection.remove(),t.html.insert('<a href="'+s+'">'+e.FE.START_MARKER+o+e.FE.END_MARKER+"</a>"),t.selection.restore()):(g(),t.format.apply("a",{href:s})));for(var v=n(),_=0;_<v.length;_++)h=e(v[_]),h.attr(a),h.removeAttr("_moz_dirty");1==v.length&&t.$wp&&!l&&(e(v[0]).prepend(e.FE.START_MARKER).append(e.FE.END_MARKER),t.selection.restore())}if(l){var y=t.popups.get("link.insert");y.find("input:focus").blur(),t.image.edit(l)}else r()}function _(){o();var n=i();if(n){var r=t.popups.get("link.insert");r||(r=u()),t.popups.isVisible("link.insert")||(t.popups.refresh("link.insert"),t.selection.save(),t.helpers.isMobile()&&(t.events.disableBlur(),t.$el.blur(),t.events.enableBlur())),t.popups.setContainer("link.insert",e(t.opts.scrollableContainer));var s=(t.image?t.image.get():null)||e(n),a=s.offset().left+s.outerWidth()/2,l=s.offset().top+s.outerHeight();t.popups.show("link.insert",a,l,s.outerHeight())}}function y(){var e=t.image?t.image.get():null;if(e)t.image.back();else{t.events.disableBlur(),t.selection.restore(),t.events.enableBlur();var n=i();n&&t.$wp?(t.selection.restore(),o(),r()):"A"==t.$el.get(0).tagName?(t.$el.focus(),r()):(t.popups.hide("link.insert"),t.toolbar.showInline())}}function b(){var i=t.image?t.image.get():null;if(i){var n=t.popups.get("link.insert");n||(n=u()),c(!0),t.popups.setContainer("link.insert",e(t.opts.scrollableContainer));var r=i.offset().left+i.outerWidth()/2,s=i.offset().top+i.outerHeight();t.popups.show("link.insert",r,s,i.outerHeight())}}function w(n,s,o){"undefined"==typeof o&&(o=t.opts.linkMultipleStyles),"undefined"==typeof s&&(s=t.opts.linkStyles);var a=i();if(!a)return!1;if(!o){var l=Object.keys(s);l.splice(l.indexOf(n),1),e(a).removeClass(l.join(" "))}e(a).toggleClass(n),r()}return{_init:p,remove:h,showInsertPopup:d,usePredefined:f,insertCallback:m,insert:v,update:_,get:i,allSelected:n,back:y,imageLink:b,applyStyle:w}},e.FE.DefineIcon("insertLink",{NAME:"link"}),e.FE.RegisterShortcut(e.FE.KEYCODE.K,"insertLink",null,"K"),e.FE.RegisterCommand("insertLink",{title:"Insert Link",undo:!1,focus:!0,refreshOnCallback:!1,popup:!0,callback:function(){this.popups.isVisible("link.insert")?(this.$el.find(".fr-marker")&&(this.events.disableBlur(),this.selection.restore()),this.popups.hide("link.insert")):this.link.showInsertPopup()},plugin:"link"}),e.FE.DefineIcon("linkOpen",{NAME:"external-link"}),e.FE.RegisterCommand("linkOpen",{title:"Open Link",undo:!1,refresh:function(e){var t=this.link.get();t?e.removeClass("fr-hidden"):e.addClass("fr-hidden")},callback:function(){var e=this.link.get();e&&this.o_win.open(e.href)}}),e.FE.DefineIcon("linkEdit",{NAME:"edit"}),e.FE.RegisterCommand("linkEdit",{title:"Edit Link",undo:!1,refreshAfterCallback:!1,callback:function(){this.link.update()},refresh:function(e){var t=this.link.get();t?e.removeClass("fr-hidden"):e.addClass("fr-hidden")}}),e.FE.DefineIcon("linkRemove",{NAME:"unlink"}),e.FE.RegisterCommand("linkRemove",{title:"Unlink",callback:function(){this.link.remove()},refresh:function(e){var t=this.link.get();t?e.removeClass("fr-hidden"):e.addClass("fr-hidden")}}),e.FE.DefineIcon("linkBack",{NAME:"arrow-left"}),e.FE.RegisterCommand("linkBack",{title:"Back",undo:!1,focus:!1,back:!0,refreshAfterCallback:!1,callback:function(){this.link.back()},refresh:function(e){var t=this.link.get(),i=this.image?this.image.get():null;i||t||this.opts.toolbarInline?(e.removeClass("fr-hidden"),e.next(".fr-separator").removeClass("fr-hidden")):(e.addClass("fr-hidden"),e.next(".fr-separator").addClass("fr-hidden"))}}),e.FE.DefineIcon("linkList",{NAME:"search"}),e.FE.RegisterCommand("linkList",{title:"Choose Link",type:"dropdown",focus:!1,undo:!1,refreshAfterCallback:!1,html:function(){for(var e='<ul class="fr-dropdown-list">',t=this.opts.linkList,i=0;i<t.length;i++)e+='<li><a class="fr-command" data-cmd="linkList" data-param1="'+i+'">'+(t[i].displayText||t[i].text)+"</a></li>";return e+="</ul>"},callback:function(e,t){this.link.usePredefined(t)}}),e.FE.RegisterCommand("linkInsert",{focus:!1,refreshAfterCallback:!1,callback:function(){this.link.insertCallback()},refresh:function(e){var t=this.link.get();t?e.text(this.language.translate("Update")):e.text(this.language.translate("Insert"))}}),e.FE.DefineIcon("imageLink",{NAME:"link"}),e.FE.RegisterCommand("imageLink",{title:"Insert Link",undo:!1,focus:!1,callback:function(){this.link.imageLink()},refresh:function(e){var t,i=this.link.get();i?(t=e.prev(),t.hasClass("fr-separator")&&t.removeClass("fr-hidden"),e.addClass("fr-hidden")):(t=e.prev(),t.hasClass("fr-separator")&&t.addClass("fr-hidden"),e.removeClass("fr-hidden"))}}),e.FE.DefineIcon("linkStyle",{NAME:"magic"}),e.FE.RegisterCommand("linkStyle",{title:"Style",type:"dropdown",html:function(){var e='<ul class="fr-dropdown-list">',t=this.opts.linkStyles;for(var i in t)t.hasOwnProperty(i)&&(e+='<li><a class="fr-command" data-cmd="linkStyle" data-param1="'+i+'">'+this.language.translate(t[i])+"</a></li>");return e+="</ul>"},callback:function(e,t){this.link.applyStyle(t)},refreshOnShow:function(t,i){var n=this.link.get();if(n){var r=e(n);i.find(".fr-command").each(function(){var t=e(this).data("param1");e(this).toggleClass("fr-active",r.hasClass(t))})}}})}),/*!
 * froala_editor v2.3.5 (https://www.froala.com/wysiwyg-editor)
 * License https://froala.com/wysiwyg-editor/terms/
 * Copyright 2014-2016 Froala Labs
 */
function(e){"function"==typeof define&&define.amd?define(["jquery"],e):"object"==typeof module&&module.exports?module.exports=function(t,i){return void 0===i&&(i="undefined"!=typeof window?require("jquery"):require("jquery")(t)),e(i),i}:e(jQuery)}(function(e){"use strict";e.FE.PLUGINS.lists=function(t){function i(e){return'<span class="fr-open-'+e.toLowerCase()+'"></span>'}function n(e){return'<span class="fr-close-'+e.toLowerCase()+'"></span>'}function r(t,i){for(var n=[],r=0;r<t.length;r++){var s=t[r].parentNode;"LI"==t[r].tagName&&s.tagName!=i&&n.indexOf(s)<0&&n.push(s)}for(r=n.length-1;r>=0;r--){var o=e(n[r]);o.replaceWith("<"+i.toLowerCase()+">"+o.html()+"</"+i.toLowerCase()+">")}}function s(i,n){r(i,n);for(var s=t.html.defaultTag(),o=0;o<i.length;o++)"LI"!=i[o].tagName&&(s&&i[o].tagName.toLowerCase()==s?e(i[o]).replaceWith("<"+n+"><li"+t.node.attributes(i[o])+">"+e(i[o]).html()+"</li></"+n+">"):e(i[o]).wrap("<"+n+"><li></li></"+n+">"));t.clean.lists()}function o(r){var s,o;for(s=r.length-1;s>=0;s--)for(o=s-1;o>=0;o--)if(e(r[o]).find(r[s]).length||r[o]==r[s]){r.splice(s,1);break}var a=[];for(s=0;s<r.length;s++){var l=e(r[s]),c=r[s].parentNode;l.before(n(c.tagName)),"LI"==c.parentNode.tagName?(l.before(n("LI")),l.after(i("LI"))):(t.node.isEmpty(l.get(0),!0)||0!==l.find(t.html.blockTagsQuery()).length||l.append("<br>"),l.append(i("LI")),l.prepend(n("LI"))),l.after(i(c.tagName)),"LI"==c.parentNode.tagName&&(c=c.parentNode.parentNode),a.indexOf(c)<0&&a.push(c)}for(s=0;s<a.length;s++){var d=e(a[s]),u=d.html();u=u.replace(/<span class="fr-close-([a-z]*)"><\/span>/g,"</$1>"),u=u.replace(/<span class="fr-open-([a-z]*)"><\/span>/g,"<$1>"),d.replaceWith(t.node.openTagString(d.get(0))+u+t.node.closeTagString(d.get(0)))}t.$el.find("li:empty").remove(),t.$el.find("ul:empty, ol:empty").remove(),t.clean.lists(),t.html.wrap()}function a(e,t){for(var i=!0,n=0;n<e.length;n++){if("LI"!=e[n].tagName)return!1;e[n].parentNode.tagName!=t&&(i=!1)}return i}function l(e){t.selection.save(),t.html.wrap(!0,!0,!0,!0),t.selection.restore();for(var i=t.selection.blocks(),n=0;n<i.length;n++)"LI"!=i[n].tagName&&"LI"==i[n].parentNode.tagName&&(i[n]=i[n].parentNode);t.selection.save(),a(i,e)?o(i):s(i,e),t.html.unwrap(),t.selection.restore()}function c(i,n){var r=e(t.selection.element());if(r.get(0)!=t.$el.get(0)){var s=r.get(0);"LI"!=s.tagName&&(s=r.parents("li").get(0)),s&&s.parentNode.tagName==n&&t.$el.get(0).contains(s.parentNode)&&i.addClass("fr-active")}}function d(i){t.selection.save();for(var n=0;n<i.length;n++){var r=i[n].previousSibling;if(r){var s=e(i[n]).find("> ul, > ol").last().get(0);if(s){for(var o=e("<li>").prependTo(e(s)),a=t.node.contents(i[n])[0];a&&!t.node.isList(a);){var l=a.nextSibling;o.append(a),a=l}e(r).append(e(s)),e(i[n]).remove()}else{var c=e(r).find("> ul, > ol").last().get(0);if(c)e(c).append(e(i[n]));else{var d=e("<"+i[n].parentNode.tagName+">");e(r).append(d),d.append(e(i[n]))}}}}t.clean.lists(),t.selection.restore()}function u(e){t.selection.save(),o(e),t.selection.restore()}function h(e){if("indent"==e||"outdent"==e){for(var i=!1,n=t.selection.blocks(),r=[],s=0;s<n.length;s++)"LI"==n[s].tagName?(i=!0,r.push(n[s])):"LI"==n[s].parentNode.tagName&&(i=!0,r.push(n[s].parentNode));i&&("indent"==e?d(r):u(r))}}function p(){t.events.on("commands.after",h),t.events.on("keydown",function(i){if(i.which==e.FE.KEYCODE.TAB){for(var n=t.selection.blocks(),r=[],s=0;s<n.length;s++)"LI"==n[s].tagName?r.push(n[s]):"LI"==n[s].parentNode.tagName&&r.push(n[s].parentNode);if(r.length>1||r.length&&t.selection.info(r[0]).atStart)return i.preventDefault(),i.stopPropagation(),i.shiftKey?u(r):d(r),!1}},!0)}return{_init:p,format:l,refresh:c}},e.FE.RegisterCommand("formatUL",{title:"Unordered List",refresh:function(e){this.lists.refresh(e,"UL")},callback:function(){this.lists.format("UL")},plugin:"lists"}),e.FE.RegisterCommand("formatOL",{title:"Ordered List",refresh:function(e){this.lists.refresh(e,"OL")},callback:function(){this.lists.format("OL")},plugin:"lists"}),e.FE.DefineIcon("formatUL",{NAME:"list-ul"}),e.FE.DefineIcon("formatOL",{NAME:"list-ol"})}),/*!
 * froala_editor v2.3.5 (https://www.froala.com/wysiwyg-editor)
 * License https://froala.com/wysiwyg-editor/terms/
 * Copyright 2014-2016 Froala Labs
 */
function(e){"function"==typeof define&&define.amd?define(["jquery"],e):"object"==typeof module&&module.exports?module.exports=function(t,i){return void 0===i&&(i="undefined"!=typeof window?require("jquery"):require("jquery")(t)),e(i),i}:e(jQuery)}(function(e){"use strict";e.extend(e.FE.DEFAULTS,{paragraphFormat:{N:"Normal",H1:"Heading 1",H2:"Heading 2",H3:"Heading 3",H4:"Heading 4",PRE:"Code"},paragraphFormatSelection:!1}),e.FE.PLUGINS.paragraphFormat=function(t){function i(i,n){var r=t.html.defaultTag();if(n&&n.toLowerCase()!=r)if(i.find("ul, ol").length>0){var s=e("<"+n+">");i.prepend(s);for(var o=t.node.contents(i.get(0))[0];o&&["UL","OL"].indexOf(o.tagName)<0;){var a=o.nextSibling;s.append(o),o=a}}else i.html("<"+n+">"+i.html()+"</"+n+">")}function n(i,n){var r=t.html.defaultTag();n||(n='div class="fr-temp-div" data-empty="true"'),n.toLowerCase()==r?i.replaceWith(i.html()):i.replaceWith(e("<"+n+">").html(i.html()))}function r(i,n){var r=t.html.defaultTag();n||(n='div class="fr-temp-div"'+(t.node.isEmpty(i.get(0),!0)?' data-empty="true"':"")),n.toLowerCase()==r?(t.node.isEmpty(i.get(0),!0)||i.append("<br/>"),i.replaceWith(i.html())):i.replaceWith(e("<"+n+">").html(i.html()))}function s(i,n){n||(n='div class="fr-temp-div"'+(t.node.isEmpty(i.get(0),!0)?' data-empty="true"':"")),i.replaceWith(e("<"+n+" "+t.node.attributes(i.get(0))+">").html(i.html()))}function o(o){"N"==o&&(o=t.html.defaultTag()),t.selection.save(),t.html.wrap(!0,!0,!0,!0),t.selection.restore();var a=t.selection.blocks();t.selection.save(),t.$el.find("pre").attr("skip",!0);for(var l=0;l<a.length;l++)if(a[l].tagName!=o&&!t.node.isList(a[l])){var c=e(a[l]);"LI"==a[l].tagName?i(c,o):"LI"==a[l].parentNode.tagName&&a[l]?n(c,o):["TD","TH"].indexOf(a[l].parentNode.tagName)>=0?r(c,o):s(c,o)}t.$el.find('pre:not([skip="true"]) + pre:not([skip="true"])').each(function(){e(this).prev().append("<br>"+e(this).html()),e(this).remove()}),t.$el.find("pre").removeAttr("skip"),t.html.unwrap(),t.selection.restore()}function a(e,i){var n=t.selection.blocks();if(n.length){var r=n[0],s="N",o=t.html.defaultTag();r.tagName.toLowerCase()!=o&&r!=t.$el.get(0)&&(s=r.tagName),i.find('.fr-command[data-param1="'+s+'"]').addClass("fr-active")}else i.find('.fr-command[data-param1="N"]').addClass("fr-active")}function l(e){if(t.opts.paragraphFormatSelection){var i=t.selection.blocks();if(i.length){var n=i[0],r="N",s=t.html.defaultTag();n.tagName.toLowerCase()!=s&&n!=t.$el.get(0)&&(r=n.tagName),["LI","TD","TH"].indexOf(r)>=0&&(r="N"),e.find("> span").text(t.opts.paragraphFormat[r])}else e.find("> span").text(t.opts.paragraphFormat.N)}}return{apply:o,refreshOnShow:a,refresh:l}},e.FE.RegisterCommand("paragraphFormat",{type:"dropdown",displaySelection:function(e){return e.opts.paragraphFormatSelection},defaultSelection:"Normal",displaySelectionWidth:100,html:function(){var e='<ul class="fr-dropdown-list">',t=this.opts.paragraphFormat;for(var i in t)if(t.hasOwnProperty(i)){var n=this.shortcuts.get("paragraphFormat."+i);n=n?'<span class="fr-shortcut">'+n+"</span>":"",e+="<li><"+("N"==i?this.html.defaultTag()||"DIV":i)+' style="padding: 0 !important; margin: 0 !important;"><a class="fr-command" data-cmd="paragraphFormat" data-param1="'+i+'" title="'+this.language.translate(t[i])+'">'+this.language.translate(t[i])+"</a></"+("N"==i?this.html.defaultTag()||"DIV":i)+"></li>"}return e+="</ul>"},title:"Paragraph Format",callback:function(e,t){this.paragraphFormat.apply(t)},refresh:function(e){this.paragraphFormat.refresh(e)},refreshOnShow:function(e,t){this.paragraphFormat.refreshOnShow(e,t)},plugin:"paragraphFormat"}),e.FE.DefineIcon("paragraphFormat",{NAME:"paragraph"})}),/*!
 * froala_editor v2.3.5 (https://www.froala.com/wysiwyg-editor)
 * License https://froala.com/wysiwyg-editor/terms/
 * Copyright 2014-2016 Froala Labs
 */
function(e){"function"==typeof define&&define.amd?define(["jquery"],e):"object"==typeof module&&module.exports?module.exports=function(t,i){return void 0===i&&(i="undefined"!=typeof window?require("jquery"):require("jquery")(t)),e(i),i}:e(jQuery)}(function(e){"use strict";e.extend(e.FE.DEFAULTS,{paragraphStyles:{"fr-text-gray":"Gray","fr-text-bordered":"Bordered","fr-text-spaced":"Spaced","fr-text-uppercase":"Uppercase"},paragraphMultipleStyles:!0}),e.FE.PLUGINS.paragraphStyle=function(t){function i(i,n,r){"undefined"==typeof n&&(n=t.opts.paragraphStyles),"undefined"==typeof r&&(r=t.opts.paragraphMultipleStyles);var s="";r||(s=Object.keys(n),s.splice(s.indexOf(i),1),s=s.join(" ")),t.selection.save(),t.html.wrap(!0,!0,!0,!0),t.selection.restore();var o=t.selection.blocks();t.selection.save();for(var a=e(o[0]).hasClass(i),l=0;l<o.length;l++)e(o[l]).removeClass(s).toggleClass(i,!a),e(o[l]).hasClass("fr-temp-div")&&e(o[l]).removeClass("fr-temp-div"),""===e(o[l]).attr("class")&&e(o[l]).removeAttr("class");t.html.unwrap(),t.selection.restore()}function n(i,n){var r=t.selection.blocks();if(r.length){var s=e(r[0]);n.find(".fr-command").each(function(){var t=e(this).data("param1");e(this).toggleClass("fr-active",s.hasClass(t))})}}function r(){}return{_init:r,apply:i,refreshOnShow:n}},e.FE.RegisterCommand("paragraphStyle",{type:"dropdown",html:function(){var e='<ul class="fr-dropdown-list">',t=this.opts.paragraphStyles;for(var i in t)t.hasOwnProperty(i)&&(e+='<li><a class="fr-command '+i+'" data-cmd="paragraphStyle" data-param1="'+i+'" title="'+this.language.translate(t[i])+'">'+this.language.translate(t[i])+"</a></li>");return e+="</ul>"},title:"Paragraph Style",callback:function(e,t){this.paragraphStyle.apply(t)},refreshOnShow:function(e,t){this.paragraphStyle.refreshOnShow(e,t)},plugin:"paragraphStyle"}),e.FE.DefineIcon("paragraphStyle",{NAME:"magic"})}),/*!
 * froala_editor v2.3.5 (https://www.froala.com/wysiwyg-editor)
 * License https://froala.com/wysiwyg-editor/terms/
 * Copyright 2014-2016 Froala Labs
 */
function(e){"function"==typeof define&&define.amd?define(["jquery"],e):"object"==typeof module&&module.exports?module.exports=function(t,i){return void 0===i&&(i="undefined"!=typeof window?require("jquery"):require("jquery")(t)),e(i),i}:e(jQuery)}(function(e){"use strict";e.extend(e.FE.DEFAULTS,{quickInsertButtons:["image","table","ul","ol","hr"],quickInsertTags:["p","div","h1","h2","h3","h4","h5","h6","pre","blockquote"]}),e.FE.QUICK_INSERT_BUTTONS={image:{icon:"insertImage",callback:function(){var t=this;t.shared.$qi_image_input||(t.shared.$qi_image_input=e('<input accept="image/*" name="quickInsertImage'+this.id+'" style="display: none;" type="file">'),e("body").append(t.shared.$qi_image_input),t.events.$on(t.shared.$qi_image_input,"change",function(){var t=e(this).data("inst");this.files&&(t.quickInsert.hide(),t.image.upload(this.files)),e(this).val("")},!0)),t.$qi_image_input=t.shared.$qi_image_input,t.helpers.isMobile()&&t.selection.save(),t.$qi_image_input.data("inst",t).trigger("click")},requiredPlugin:"image",title:"Insert Image"},table:{icon:"insertTable",callback:function(){this.quickInsert.hide(),this.table.insert(2,2),this.undo.saveStep()},requiredPlugin:"table",title:"Insert Table"},ol:{icon:"formatOL",callback:function(){this.quickInsert.hide(),this.lists.format("OL"),this.undo.saveStep()},requiredPlugin:"lists",title:"Ordered List"},ul:{icon:"formatUL",callback:function(){this.quickInsert.hide(),this.lists.format("UL"),this.undo.saveStep()},requiredPlugin:"lists",title:"Unordered List"},hr:{icon:"insertHR",callback:function(){this.quickInsert.hide(),this.commands.insertHR(),this.undo.saveStep()},title:"Insert Horizontal Line"}},e.FE.RegisterQuickInsertCommand=function(t,i){e.FE.QUICK_INSERT_BUTTONS[t]=i},e.FE.PLUGINS.quickInsert=function(t){function i(i){c||a(),t.$box.append(c);var n,r;n=i.offset().top-t.$box.offset().top-(c.outerHeight()-i.outerHeight())/2,r=0-c.outerWidth(),t.opts.iframe&&(n+=t.$iframe.offset().top-e(t.o_win).scrollTop()),c.css("top",n),c.css("left",r),c.data("tag",i),c.addClass("fr-visible")}function n(){var n=t.selection.element();t.node.isBlock(n)||(n=t.node.blockParent(n)),n&&t.node.isEmpty(n)&&t.node.isElement(n.parentNode)?n&&t.selection.isCollapsed()&&i(e(n)):r()}function r(){c&&(t.html.checkIfEmpty(),c.hasClass("fr-on")&&o(),c.removeClass("fr-visible fr-on"),c.css("left",-9999).css("top",-9999))}function s(i){if(i.preventDefault(),c.hasClass("fr-on"))o();else{if(!t.shared.$qi_helper){for(var n=t.opts.quickInsertButtons,r='<div class="fr-qi-helper">',s=0,a=0;a<n.length;a++){var l=e.FE.QUICK_INSERT_BUTTONS[n[a]];l&&(!l.requiredPlugin||e.FE.PLUGINS[l.requiredPlugin]&&t.opts.pluginsEnabled.indexOf(l.requiredPlugin)>=0)&&(r+='<a class="fr-btn fr-floating-btn" role="button" title="'+t.language.translate(l.title)+'" tabindex="-1" data-cmd="'+n[a]+'" style="transition-delay: '+.025*s++ +'s;">'+t.icon.create(l.icon)+"</a>")}r+="</div>",t.shared.$qi_helper=e(r),t.tooltip.bind(t.shared.$qi_helper,".fr-qi-helper > a.fr-btn")}d=t.shared.$qi_helper,d.appendTo(t.$box),setTimeout(function(){d.css("top",parseFloat(c.css("top"))),d.css("left",parseFloat(c.css("left"))+c.outerWidth()),d.find("a").addClass("fr-size-1"),c.addClass("fr-on")},10)}}function o(){var e=t.$box.find(".fr-qi-helper");e.length&&(e.find("a").removeClass("fr-size-1"),e.css("left",-9999),c.removeClass("fr-on"))}function a(){t.shared.$quick_insert||(t.shared.$quick_insert=e('<div class="fr-quick-insert"><a class="fr-floating-btn" role="button" tabindex="-1" title="'+t.language.translate("Quick Insert")+'"><svg viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg"><path d="M22,16.75 L16.75,16.75 L16.75,22 L15.25,22.000 L15.25,16.75 L10,16.75 L10,15.25 L15.25,15.25 L15.25,10 L16.75,10 L16.75,15.25 L22,15.25 L22,16.75 Z"/></svg></a></div>')),c=t.shared.$quick_insert,t.tooltip.bind(t.$box,".fr-quick-insert > a.fr-floating-btn"),t.events.on("destroy",function(){c.removeClass("fr-on").appendTo(e("body")).css("left",-9999).css("top",-9999),d&&(o(),d.appendTo(e("body")))},!0),t.events.on("shared.destroy",function(){c.html("").removeData().remove(),c=null,d&&(d.html("").removeData().remove(),d=null)},!0),t.events.on("commands.before",r),t.events.on("commands.after",function(){t.popups.areVisible()||n()}),t.events.bindClick(t.$box,".fr-quick-insert > a",s),t.events.bindClick(t.$box,".fr-qi-helper > a.fr-btn",function(i){var n=e(i.currentTarget).data("cmd");e.FE.QUICK_INSERT_BUTTONS[n].callback.apply(t,[i.currentTarget])})}function l(){return t.$wp?(t.opts.iframe&&t.$el.parent("html").find("head").append('<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.4.0/css/font-awesome.min.css">'),t.popups.onShow("image.edit",r),t.events.on("mouseup",n),t.helpers.isMobile()&&t.events.$on(e(t.o_doc),"selectionchange",n),t.events.on("blur",r),t.events.on("keyup",n),void 0):!1}var c,d;return{_init:l,hide:r}}}),/*!
 * froala_editor v2.3.5 (https://www.froala.com/wysiwyg-editor)
 * License https://froala.com/wysiwyg-editor/terms/
 * Copyright 2014-2016 Froala Labs
 */
function(e){"function"==typeof define&&define.amd?define(["jquery"],e):"object"==typeof module&&module.exports?module.exports=function(t,i){return void 0===i&&(i="undefined"!=typeof window?require("jquery"):require("jquery")(t)),e(i),i}:e(jQuery)}(function(e){"use strict";e.FE.PLUGINS.quote=function(t){function i(e){for(;e.parentNode&&e.parentNode!=t.$el.get(0);)e=e.parentNode;return e}function n(){var n,r=t.selection.blocks();for(n=0;n<r.length;n++)r[n]=i(r[n]);t.selection.save();var s=e("<blockquote>");for(s.insertBefore(r[0]),n=0;n<r.length;n++)s.append(r[n]);t.html.unwrap(),t.selection.restore()}function r(){var i,n=t.selection.blocks();for(i=0;i<n.length;i++)"BLOCKQUOTE"!=n[i].tagName&&(n[i]=e(n[i]).parentsUntil(t.$el,"BLOCKQUOTE").get(0));for(t.selection.save(),i=0;i<n.length;i++)n[i]&&e(n[i]).replaceWith(n[i].innerHTML);t.html.unwrap(),t.selection.restore()}function s(e){t.selection.save(),t.html.wrap(!0,!0,!0,!0),t.selection.restore(),"increase"==e?n():"decrease"==e&&r()}return{apply:s}},e.FE.RegisterShortcut(e.FE.KEYCODE.SINGLE_QUOTE,"quote","increase","'"),e.FE.RegisterShortcut(e.FE.KEYCODE.SINGLE_QUOTE,"quote","decrease","'",!0),e.FE.RegisterCommand("quote",{title:"Quote",type:"dropdown",options:{increase:"Increase",decrease:"Decrease"},callback:function(e,t){this.quote.apply(t)},plugin:"quote"}),e.FE.DefineIcon("quote",{NAME:"quote-left"})}),/*!
 * froala_editor v2.3.5 (https://www.froala.com/wysiwyg-editor)
 * License https://froala.com/wysiwyg-editor/terms/
 * Copyright 2014-2016 Froala Labs
 */
function(e){"function"==typeof define&&define.amd?define(["jquery"],e):"object"==typeof module&&module.exports?module.exports=function(t,i){return void 0===i&&(i="undefined"!=typeof window?require("jquery"):require("jquery")(t)),e(i),i}:e(jQuery)}(function(e){"use strict";e.extend(e.FE.DEFAULTS,{saveInterval:1e4,saveURL:null,saveParams:{},saveParam:"body",saveMethod:"POST"}),e.FE.PLUGINS.save=function(t){function i(e,i){t.events.trigger("save.error",[{code:e,message:p[e]},i])}function n(n){if("undefined"==typeof n&&(n=t.html.get()),t.events.trigger("save.before")===!1)return!1;if(t.opts.saveURL){var r={};for(var s in t.opts.saveParams)if(t.opts.saveParams.hasOwnProperty(s)){var o=t.opts.saveParams[s];r[s]="function"==typeof o?o.call(this):o}var a={};a[t.opts.saveParam]=n,e.ajax({type:t.opts.saveMethod,url:t.opts.saveURL,data:e.extend(a,r),crossDomain:t.opts.requestWithCORS,xhrFields:{withCredentials:t.opts.requestWithCredentials},headers:t.opts.requestHeaders}).done(function(e){t.events.trigger("save.after",[e])}).fail(function(e){i(h,e.response||e.responseText)})}else i(u)}function r(){clearTimeout(l),l=setTimeout(function(){var e=t.html.get();(c!=e||d)&&(c=e,d=!1,n(e))},t.opts.saveInterval)}function s(){r(),d=!1}function o(){d=!0}function a(){t.opts.saveInterval&&(c=t.html.get(),t.events.on("contentChanged",r),t.events.on("keydown destroy",function(){clearTimeout(l)}))}var l=null,c=null,d=!1,u=1,h=2,p={};return p[u]="Missing saveURL option.",p[h]="Something went wrong during save.",{_init:a,save:n,reset:s,force:o}},e.FE.DefineIcon("save",{NAME:"floppy-o"}),e.FE.RegisterCommand("save",{title:"Save",undo:!1,focus:!1,refreshAfterCallback:!1,callback:function(){this.save.save()},plugin:"save"})}),/*!
 * froala_editor v2.3.5 (https://www.froala.com/wysiwyg-editor)
 * License https://froala.com/wysiwyg-editor/terms/
 * Copyright 2014-2016 Froala Labs
 */
function(e){"function"==typeof define&&define.amd?define(["jquery"],e):"object"==typeof module&&module.exports?module.exports=function(t,i){return void 0===i&&(i="undefined"!=typeof window?require("jquery"):require("jquery")(t)),e(i),i}:e(jQuery)}(function(e){"use strict";e.extend(e.FE.POPUP_TEMPLATES,{"table.insert":"[_BUTTONS_][_ROWS_COLUMNS_]","table.edit":"[_BUTTONS_]","table.colors":"[_BUTTONS_][_COLORS_]"}),e.extend(e.FE.DEFAULTS,{tableInsertMaxSize:10,tableEditButtons:["tableHeader","tableRemove","|","tableRows","tableColumns","tableStyle","-","tableCells","tableCellBackground","tableCellVerticalAlign","tableCellHorizontalAlign","tableCellStyle"],tableInsertButtons:["tableBack","|"],tableResizer:!0,tableResizerOffset:5,tableResizingLimit:30,tableColorsButtons:["tableBack","|"],tableColors:["#61BD6D","#1ABC9C","#54ACD2","#2C82C9","#9365B8","#475577","#CCCCCC","#41A85F","#00A885","#3D8EB9","#2969B0","#553982","#28324E","#000000","#F7DA64","#FBA026","#EB6B56","#E25041","#A38F84","#EFEFEF","#FFFFFF","#FAC51C","#F37934","#D14841","#B8312F","#7C706B","#D1D5D8","REMOVE"],tableColorsStep:7,tableCellStyles:{"fr-highlighted":"Highlighted","fr-thick":"Thick"},tableStyles:{"fr-dashed-borders":"Dashed Borders","fr-alternate-rows":"Alternate Rows"},tableCellMultipleStyles:!0,tableMultipleStyles:!0,tableInsertHelper:!0,tableInsertHelperOffset:15}),e.FE.PLUGINS.table=function(t){function i(){var e=t.$tb.find('.fr-command[data-cmd="insertTable"]'),i=t.popups.get("table.insert");if(i||(i=o()),!i.hasClass("fr-active")){t.popups.refresh("table.insert"),t.popups.setContainer("table.insert",t.$tb);var n=e.offset().left+e.outerWidth()/2,r=e.offset().top+(t.opts.toolbarBottom?10:e.outerHeight()-10);t.popups.show("table.insert",n,r,e.outerHeight())}}function n(){var i=D();if(i){var n=t.popups.get("table.edit");n||(n=l()),t.popups.setContainer("table.edit",e(t.opts.scrollableContainer));var r=F(i),s=(r.left+r.right)/2,o=r.bottom;t.popups.show("table.edit",s,o,r.bottom-r.top),t.edit.isDisabled()&&(t.toolbar.disable(),t.$el.removeClass("fr-no-selection"),t.edit.on(),t.selection.setAtEnd(t.$el.find(".fr-selected-cell:last").get(0)),t.selection.restore(),t.button.bulkRefresh())}}function r(){var i=D();if(i){var n=t.popups.get("table.colors");n||(n=c()),t.popups.setContainer("table.colors",e(t.opts.scrollableContainer));var r=F(i),s=(r.left+r.right)/2,o=r.bottom;u(),t.popups.show("table.colors",s,o,r.bottom-r.top)}}function s(){0===dt().length&&t.toolbar.enable()}function o(i){if(i)return t.popups.onHide("table.insert",function(){t.popups.get("table.insert").find('.fr-table-size .fr-select-table-size > span[data-row="1"][data-col="1"]').trigger("mouseenter")}),!0;var n="";t.opts.tableInsertButtons.length>0&&(n='<div class="fr-buttons">'+t.button.buildList(t.opts.tableInsertButtons)+"</div>");var r={buttons:n,rows_columns:a()},s=t.popups.create("table.insert",r);return t.events.$on(s,"mouseenter",".fr-table-size .fr-select-table-size .fr-table-cell",function(i){var n=e(i.currentTarget),r=n.data("row"),s=n.data("col"),o=n.parent();o.siblings(".fr-table-size-info").html(r+" &times; "+s),o.find("> span").removeClass("hover");for(var a=1;a<=t.opts.tableInsertMaxSize;a++)for(var l=0;l<=t.opts.tableInsertMaxSize;l++){var c=o.find('> span[data-row="'+a+'"][data-col="'+l+'"]');r>=a&&s>=l?c.addClass("hover"):r+1>=a||2>=a&&!t.helpers.isMobile()?c.css("display","inline-block"):a>2&&!t.helpers.isMobile()&&c.css("display","none")}},!0),s}function a(){for(var e='<div class="fr-table-size"><div class="fr-table-size-info">1 &times; 1</div><div class="fr-select-table-size">',i=1;i<=t.opts.tableInsertMaxSize;i++){for(var n=1;n<=t.opts.tableInsertMaxSize;n++){var r="inline-block";i>2&&!t.helpers.isMobile()&&(r="none");var s="fr-table-cell ";1==i&&1==n&&(s+=" hover"),e+='<span class="fr-command '+s+'" data-cmd="tableInsert" data-row="'+i+'" data-col="'+n+'" data-param1="'+i+'" data-param2="'+n+'" style="display: '+r+';"><span></span></span>'}e+='<div class="new-line"></div>'}return e+="</div></div>"}function l(e){if(e)return t.popups.onHide("table.edit",s),!0;var i="";t.opts.tableEditButtons.length>0&&(i='<div class="fr-buttons">'+t.button.buildList(t.opts.tableEditButtons)+"</div>");var r={buttons:i},o=t.popups.create("table.edit",r);return t.events.$on(t.$wp,"scroll.table-edit",function(){t.popups.isVisible("table.edit")&&n()}),o}function c(){var e="";t.opts.tableColorsButtons.length>0&&(e='<div class="fr-buttons fr-table-colors-buttons">'+t.button.buildList(t.opts.tableColorsButtons)+"</div>");var i={buttons:e,colors:d()},n=t.popups.create("table.colors",i);return t.events.$on(t.$wp,"scroll.table-colors",function(){t.popups.isVisible("table.colors")&&r()}),n}function d(){for(var e='<div class="fr-table-colors">',i=0;i<t.opts.tableColors.length;i++)0!==i&&0===i%t.opts.tableColorsStep&&(e+="<br>"),e+="REMOVE"!=t.opts.tableColors[i]?'<span class="fr-command" style="background: '+t.opts.tableColors[i]+';" data-cmd="tableCellBackgroundColor" data-param1="'+t.opts.tableColors[i]+'"></span>':'<span class="fr-command" data-cmd="tableCellBackgroundColor" data-param1="REMOVE" title="'+t.language.translate("Clear Formatting")+'"><i class="fa ficon-eraser"></i></span>';return e+="</div>"}function u(){var e=t.popups.get("table.colors"),i=t.$el.find(".fr-selected-cell:first");e.find(".fr-selected-color").removeClass("fr-selected-color"),e.find('span[data-param1="'+t.helpers.RGBToHex(i.css("background-color"))+'"]').addClass("fr-selected-color")}function h(i,n){var r,s,o='<table style="width: 100%;"><tbody>',a=100/n;for(r=0;i>r;r++){for(o+="<tr>",s=0;n>s;s++)o+='<td style="width: '+a.toFixed(4)+'%;">',0===r&&0===s&&(o+=e.FE.MARKERS),o+="<br></td>";o+="</tr>"}o+="</tbody></table>",t.html.insert(o),t.selection.restore()}function p(){if(dt().length>0){var e=ut();t.selection.setBefore(e.get(0))||t.selection.setAfter(e.get(0)),t.selection.restore(),t.popups.hide("table.edit"),e.remove(),t.toolbar.enable()}}function f(){var t=ut();if(t.length>0&&0===t.find("th").length){var i,r="<thead><tr>",s=0;for(t.find("tr:first > td").each(function(){var t=e(this);s+=parseInt(t.attr("colspan"),10)||1}),i=0;s>i;i++)r+="<th><br></th>";r+="</tr></thead>",t.prepend(r),n()}}function m(){var e=ut(),i=e.find("thead");if(i.length>0)if(0===e.find("tbody tr").length)p();else if(i.remove(),dt().length>0)n();else{t.popups.hide("table.edit");var r=e.find("tbody tr:first td:first").get(0);r&&(t.selection.setAtEnd(r),t.selection.restore())}}function g(i){var r=ut();if(r.length>0){if(t.$el.find("th.fr-selected-cell").length>0&&"above"==i)return;var s,o,a=D(),l=j(a);o="above"==i?l.min_i:l.max_i;var c="<tr>";for(s=0;s<a[o].length;s++)if("below"==i&&o<a.length-1&&a[o][s]==a[o+1][s]||"above"==i&&o>0&&a[o][s]==a[o-1][s]){if(0===s||s>0&&a[o][s]!=a[o][s-1]){var d=e(a[o][s]);d.attr("rowspan",parseInt(d.attr("rowspan"),10)+1)}}else c+="<td><br></td>";c+="</tr>";var u=e(r.find("tr").not(r.find("table tr")).get(o));"below"==i?u.after(c):"above"==i&&(u.before(c),t.popups.isVisible("table.edit")&&n())}}function v(){var i=ut();if(i.length>0){var n,r,s,o=D(),a=j(o);if(0===a.min_i&&a.max_i==o.length-1)p();else{for(n=a.max_i;n>=a.min_i;n--){for(s=e(i.find("tr").not(i.find("table tr")).get(n)),r=0;r<o[n].length;r++)if(0===r||o[n][r]!=o[n][r-1]){var l=e(o[n][r]);if(parseInt(l.attr("rowspan"),10)>1){var c=parseInt(l.attr("rowspan"),10)-1;1==c?l.removeAttr("rowspan"):l.attr("rowspan",c)}if(n<o.length-1&&o[n][r]==o[n+1][r]&&(0===n||o[n][r]!=o[n-1][r])){for(var d=o[n][r],u=r;u>0&&o[n][u]==o[n][u-1];)u--;0===u?e(i.find("tr").not(i.find("table tr")).get(n+1)).prepend(d):e(o[n+1][u-1]).after(d)}}var h=s.parent();s.remove(),0===h.find("tr").length&&h.remove(),o=D(i)}C(0,o.length-1,0,o[0].length-1,i),a.min_i>0?t.selection.setAtEnd(o[a.min_i-1][0]):t.selection.setAtEnd(o[0][0]),t.selection.restore(),t.popups.hide("table.edit")}}}function _(i){var r=ut();if(r.length>0){var s,o=D(),a=j(o);s="before"==i?a.min_j:a.max_j;var l,c=100/o[0].length,d=100/(o[0].length+1);r.find("th, td").each(function(){l=e(this),l.data("old-width",100*(l.outerWidth()/r.outerWidth()))}),r.find("tr").not(r.find("table tr")).each(function(t){for(var n,r=e(this),a=0,l=0;s>a-1;){if(n=r.find("> th, > td").get(l),!n){n=null;break}n==o[t][a]?(a+=parseInt(e(n).attr("colspan"),10)||1,l++):(a+=parseInt(e(o[t][a]).attr("colspan"),10)||1,"after"==i&&(n=0===l?-1:r.find("> th, > td").get(l-1)))}var u=e(n);if("after"==i&&a-1>s||"before"==i&&s>0&&o[t][s]==o[t][s-1]){if(0===t||t>0&&o[t][s]!=o[t-1][s]){var h=parseInt(u.attr("colspan"),10)+1;u.attr("colspan",h),u.css("width",(u.data("old-width")*d/c+d).toFixed(4)+"%"),u.removeData("old-width")}}else{var p;p=r.find("th").length>0?'<th style="width: '+d.toFixed(4)+'%;"><br></th>':'<td style="width: '+d.toFixed(4)+'%;"><br></td>',-1==n?r.prepend(p):null==n?r.append(p):"before"==i?u.before(p):"after"==i&&u.after(p)}}),r.find("th, td").each(function(){l=e(this),l.data("old-width")&&(l.css("width",(l.data("old-width")*d/c).toFixed(4)+"%"),l.removeData("old-width"))}),t.popups.isVisible("table.edit")&&n()}}function y(){var i=ut();if(i.length>0){var n,r,s,o=D(),a=j(o);if(0===a.min_j&&a.max_j==o[0].length-1)p();else{var l=100/o[0].length,c=100/(o[0].length-a.max_j+a.min_j-1);for(i.find("th, td").each(function(){s=e(this),s.hasClass("fr-selected-cell")||s.data("old-width",100*(s.outerWidth()/i.outerWidth()))}),r=a.max_j;r>=a.min_j;r--)for(n=0;n<o.length;n++)if(0===n||o[n][r]!=o[n-1][r])if(s=e(o[n][r]),(parseInt(s.attr("colspan"),10)||1)>1){var d=parseInt(s.attr("colspan"),10)-1;1==d?s.removeAttr("colspan"):s.attr("colspan",d),s.css("width",((s.data("old-width")-it(r,o))*c/l).toFixed(4)+"%"),s.removeData("old-width")}else{var u=e(s.parent().get(0));s.remove(),0===u.find("> th, > td").length&&(0===u.prev().length||0===u.next().length||u.prev().find("> th[rowspan], > td[rowspan]").length<u.prev().find("> th, > td").length)&&u.remove()}C(0,o.length-1,0,o[0].length-1,i),a.min_j>0?t.selection.setAtEnd(o[a.min_i][a.min_j-1]):t.selection.setAtEnd(o[a.min_i][0]),t.selection.restore(),t.popups.hide("table.edit"),i.find("th, td").each(function(){s=e(this),s.data("old-width")&&(s.css("width",(s.data("old-width")*c/l).toFixed(4)+"%"),s.removeData("old-width"))})}}}function b(e,t,i){var n,r,s,o,a,l=0,c=D(i);for(t=Math.min(t,c[0].length-1),r=e;t>=r;r++)if(!(r>e&&c[0][r]==c[0][r-1])&&(o=parseInt(c[0][r].getAttribute("colspan"),10)||1,o>1&&c[0][r]==c[0][r+1]))for(l=o-1,n=1;n<c.length;n++)if(c[n][r]!=c[n-1][r]){for(s=r;r+o>s;s++)if(a=parseInt(c[n][s].getAttribute("colspan"),10)||1,a>1&&c[n][s]==c[n][s+1])l=Math.min(l,a-1),s+=l;else if(l=Math.max(0,l-1),!l)break;if(!l)break}l&&k(c,l,"colspan",0,c.length-1,e,t)}function w(e,t,i){var n,r,s,o,a,l=0,c=D(i);for(t=Math.min(t,c.length-1),n=e;t>=n;n++)if(!(n>e&&c[n][0]==c[n-1][0])&&(o=parseInt(c[n][0].getAttribute("rowspan"),10)||1,o>1&&c[n][0]==c[n+1][0]))for(l=o-1,r=1;r<c[0].length;r++)if(c[n][r]!=c[n][r-1]){for(s=n;n+o>s;s++)if(a=parseInt(c[s][r].getAttribute("rowspan"),10)||1,a>1&&c[s][r]==c[s+1][r])l=Math.min(l,a-1),s+=l;else if(l=Math.max(0,l-1),!l)break;if(!l)break}l&&k(c,l,"rowspan",e,t,0,c[0].length-1)}function k(e,t,i,n,r,s,o){var a,l,c;for(a=n;r>=a;a++)for(l=s;o>=l;l++)a>n&&e[a][l]==e[a-1][l]||l>s&&e[a][l]==e[a][l-1]||(c=parseInt(e[a][l].getAttribute(i),10)||1,c>1&&(c-t>1?e[a][l].setAttribute(i,c-t):e[a][l].removeAttribute(i)))}function C(e,t,i,n,r){w(e,t,r),b(i,n,r)}function x(){if(dt().length>1&&(0===t.$el.find("th.fr-selected-cell").length||0===t.$el.find("td.fr-selected-cell").length)){var i,r,s=D(),o=j(s),a=t.$el.find(".fr-selected-cell"),l=e(a[0]),c=l.parent(),d=c.find(".fr-selected-cell"),u=l.closest("table"),h=l.html(),p=0;for(i=0;i<d.length;i++)p+=e(d[i]).outerWidth();for(l.css("width",(100*(p/u.outerWidth())).toFixed(4)+"%"),o.min_j<o.max_j&&l.attr("colspan",o.max_j-o.min_j+1),o.min_i<o.max_i&&l.attr("rowspan",o.max_i-o.min_i+1),i=1;i<a.length;i++)r=e(a[i]),"<br>"!=r.html()&&""!==r.html()&&(h+="<br>"+r.html()),r.remove();l.html(h),t.selection.setAtEnd(l.get(0)),t.selection.restore(),t.toolbar.enable(),w(o.min_i,o.max_i,u);var f=u.find("tr:empty");for(i=f.length-1;i>=0;i--)e(f[i]).remove();b(o.min_j,o.max_j,u),n()}}function A(){if(1==dt().length){var i=t.$el.find(".fr-selected-cell"),n=i.parent(),r=i.closest("table"),s=parseInt(i.attr("rowspan"),10),o=D(),a=O(i.get(0),o),l=i.clone().html("<br>");if(s>1){var c=Math.ceil(s/2);c>1?i.attr("rowspan",c):i.removeAttr("rowspan"),s-c>1?l.attr("rowspan",s-c):l.removeAttr("rowspan");for(var d=a.row+c,u=0===a.col?a.col:a.col-1;u>=0&&(o[d][u]==o[d][u-1]||d>0&&o[d][u]==o[d-1][u]);)u--;-1==u?e(r.find("tr").not(r.find("table tr")).get(d)).prepend(l):e(o[d][u]).after(l)}else{var h,p=e("<tr>").append(l);for(h=0;h<o[0].length;h++)if(0===h||o[a.row][h]!=o[a.row][h-1]){var f=e(o[a.row][h]);f.is(i)||f.attr("rowspan",(parseInt(f.attr("rowspan"),10)||1)+1)}n.after(p)}L(),t.popups.hide("table.edit")}}function T(){if(1==dt().length){var i=t.$el.find(".fr-selected-cell"),n=parseInt(i.attr("colspan"),10)||1,r=i.parent().outerWidth(),s=i.outerWidth(),o=i.clone().html("<br>"),a=D(),l=O(i.get(0),a);if(n>1){var c=Math.ceil(n/2);s=100*(nt(l.col,l.col+c-1,a)/r);var d=100*(nt(l.col+c,l.col+n-1,a)/r);c>1?i.attr("colspan",c):i.removeAttr("colspan"),n-c>1?o.attr("colspan",n-c):o.removeAttr("colspan"),i.css("width",s.toFixed(4)+"%"),o.css("width",d.toFixed(4)+"%")}else{var u;for(u=0;u<a.length;u++)if(0===u||a[u][l.col]!=a[u-1][l.col]){var h=e(a[u][l.col]);if(!h.is(i)){var p=(parseInt(h.attr("colspan"),10)||1)+1;h.attr("colspan",p)}}s=100*(s/r)/2,i.css("width",s.toFixed(4)+"%"),o.css("width",s.toFixed(4)+"%")}i.after(o),L(),t.popups.hide("table.edit")}}function S(e){"REMOVE"!=e?t.$el.find(".fr-selected-cell").css("background-color",t.helpers.HEXtoRGB(e)):t.$el.find(".fr-selected-cell").css("background-color","")}function M(e){t.$el.find(".fr-selected-cell").css("vertical-align",e)}function N(e){t.$el.find(".fr-selected-cell").css("text-align",e)}function E(e,t,i,n){if(t.length>0){if(!i){var r=Object.keys(n);r.splice(r.indexOf(e),1),t.removeClass(r.join(" "))}t.toggleClass(e)}}function D(t){t=t||null;var i=[];return null==t&&dt().length>0&&(t=ut()),t?(t.find("tr").not(t.find("table tr")).each(function(t,n){var r=e(n),s=0;r.find("> th, > td").each(function(n,r){for(var o=e(r),a=parseInt(o.attr("colspan"),10)||1,l=parseInt(o.attr("rowspan"),10)||1,c=t;t+l>c;c++)for(var d=s;s+a>d;d++)i[c]||(i[c]=[]),i[c][d]?s++:i[c][d]=r;s+=a})}),i):void 0}function O(e,t){for(var i=0;i<t.length;i++)for(var n=0;n<t[i].length;n++)if(t[i][n]==e)return{row:i,col:n}}function R(e,t,i){for(var n=e+1,r=t+1;n<i.length;){if(i[n][t]!=i[e][t]){n--;break}n++}for(n==i.length&&n--;r<i[e].length;){if(i[e][r]!=i[e][t]){r--;break}r++}return r==i[e].length&&r--,{row:n,col:r}}function L(){var i=t.$el.find(".fr-selected-cell");i.length>0&&i.each(function(){var t=e(this);t.removeClass("fr-selected-cell"),""===t.attr("class")&&t.removeAttr("class")})}function I(){setTimeout(function(){t.selection.clear(),t.$el.addClass("fr-no-selection"),t.$el.blur()},0)}function j(e){var i,n=e.length,r=0,s=e[0].length,o=0,a=t.$el.find(".fr-selected-cell");for(i=0;i<a.length;i++){var l=O(a[i],e),c=R(l.row,l.col,e);n=Math.min(l.row,n),r=Math.max(c.row,r),s=Math.min(l.col,s),o=Math.max(c.col,o)}return{min_i:n,max_i:r,min_j:s,max_j:o}}function P(t,i,n,r,s){var o,a,l,c,d=t,u=i,h=n,p=r;for(o=d;u>=o;o++)((parseInt(e(s[o][h]).attr("rowspan"),10)||1)>1||(parseInt(e(s[o][h]).attr("colspan"),10)||1)>1)&&(l=O(s[o][h],s),c=R(l.row,l.col,s),d=Math.min(l.row,d),u=Math.max(c.row,u),h=Math.min(l.col,h),p=Math.max(c.col,p)),((parseInt(e(s[o][p]).attr("rowspan"),10)||1)>1||(parseInt(e(s[o][p]).attr("colspan"),10)||1)>1)&&(l=O(s[o][p],s),c=R(l.row,l.col,s),d=Math.min(l.row,d),u=Math.max(c.row,u),h=Math.min(l.col,h),p=Math.max(c.col,p));for(a=h;p>=a;a++)((parseInt(e(s[d][a]).attr("rowspan"),10)||1)>1||(parseInt(e(s[d][a]).attr("colspan"),10)||1)>1)&&(l=O(s[d][a],s),c=R(l.row,l.col,s),d=Math.min(l.row,d),u=Math.max(c.row,u),h=Math.min(l.col,h),p=Math.max(c.col,p)),((parseInt(e(s[u][a]).attr("rowspan"),10)||1)>1||(parseInt(e(s[u][a]).attr("colspan"),10)||1)>1)&&(l=O(s[u][a],s),c=R(l.row,l.col,s),d=Math.min(l.row,d),u=Math.max(c.row,u),h=Math.min(l.col,h),p=Math.max(c.col,p));return d==t&&u==i&&h==n&&p==r?{min_i:t,max_i:i,min_j:n,max_j:r}:P(d,u,h,p,s)}function F(t){var i=j(t),n=e(t[i.min_i][i.min_j]),r=e(t[i.min_i][i.max_j]),s=e(t[i.max_i][i.min_j]),o=n.offset().left,a=r.offset().left+r.outerWidth(),l=n.offset().top,c=s.offset().top+s.outerHeight();return{left:o,right:a,top:l,bottom:c}}function z(i,n){if(e(i).is(n))L(),t.edit.on(),e(i).addClass("fr-selected-cell");else{I(),t.edit.off();var r=D(),s=O(i,r),o=O(n,r),a=P(Math.min(s.row,o.row),Math.max(s.row,o.row),Math.min(s.col,o.col),Math.max(s.col,o.col),r);L();for(var l=a.min_i;l<=a.max_i;l++)for(var c=a.min_j;c<=a.max_j;c++)e(r[l][c]).addClass("fr-selected-cell")}}function $(i){var n=null,r=e(i.target);return"TD"==i.target.tagName||"TH"==i.target.tagName?n=i.target:r.closest("td").length>0?n=r.closest("td").get(0):r.closest("th").length>0&&(n=r.closest("th").get(0)),0===t.$el.find(n).length?null:n}function H(){L(),t.popups.hide("table.edit")}function B(i){var n=$(i);if(dt().length>0&&!n&&H(),!t.edit.isDisabled()||t.popups.isVisible("table.edit"))if(1!=i.which||1==i.which&&t.helpers.isMac()&&i.ctrlKey)(3==i.which||1==i.which&&t.helpers.isMac()&&i.ctrlKey)&&n&&H();else if(gt=!0,n){dt().length>0&&!i.shiftKey&&H(),i.stopPropagation(),t.events.trigger("image.hideResizer"),t.events.trigger("video.hideResizer"),mt=!0;var r=n.tagName.toLowerCase();i.shiftKey&&t.$el.find(r+".fr-selected-cell").length>0?e(t.$el.find(r+".fr-selected-cell").closest("table")).is(e(n).closest("table"))?z(vt,n):I():((t.keys.ctrlKey(i)||i.shiftKey)&&(dt().length>1||0===e(n).find(t.selection.element()).length&&!e(n).is(t.selection.element()))&&I(),vt=n,z(vt,vt))}}function W(i){if(mt||t.$tb.is(i.target)||t.$tb.is(e(i.target).closest(t.$tb.get(0)))||(dt().length>0&&t.toolbar.enable(),L()),!(1!=i.which||1==i.which&&t.helpers.isMac()&&i.ctrlKey)){if(gt=!1,mt){mt=!1;var r=$(i);r||1!=dt().length?dt().length>0&&(t.selection.isCollapsed()?n():L()):L()}if(yt){yt=!1,pt.removeClass("fr-moving"),t.$el.removeClass("fr-no-selection"),t.edit.on();var s=parseFloat(pt.css("left"))+t.opts.tableResizerOffset;t.opts.iframe&&(s-=t.$iframe.offset().left),pt.data("release-position",s),pt.removeData("max-left"),pt.removeData("max-right"),tt(i),X()}}}function q(i){if(mt===!0){var n=e(i.currentTarget);if(n.closest("table").is(ut())){if("TD"==i.currentTarget.tagName&&0===t.$el.find("th.fr-selected-cell").length)return z(vt,i.currentTarget),void 0;if("TH"==i.currentTarget.tagName&&0===t.$el.find("td.fr-selected-cell").length)return z(vt,i.currentTarget),void 0}I()}}function Q(e){(37==e.which||38==e.which||39==e.which||40==e.which)&&dt().length>0&&H()}function U(){t.shared.$table_resizer||(t.shared.$table_resizer=e('<div class="fr-table-resizer"><div></div></div>')),pt=t.shared.$table_resizer,t.events.$on(pt,"mousedown",function(e){return t.core.sameInstance(pt)?(dt().length>0&&H(),1==e.which?(t.selection.save(),yt=!0,pt.addClass("fr-moving"),I(),t.edit.off(),pt.find("div").css("opacity",1),!1):void 0):!0}),t.events.$on(pt,"mousemove",function(e){return t.core.sameInstance(pt)?(yt&&(t.opts.iframe&&(e.pageX-=t.$iframe.offset().left),rt(e)),void 0):!0}),t.events.on("shared.destroy",function(){pt.html("").removeData().remove(),pt=null},!0),t.events.on("destroy",function(){t.$el.find(".fr-selected-cell").removeClass("fr-selected-cell"),pt.hide().appendTo(e("body"))},!0)}function X(){pt&&(pt.find("div").css("opacity",0),pt.css("top",0),pt.css("left",0),pt.css("height",0),pt.find("div").css("height",0),pt.hide())}function V(){ft&&ft.removeClass("fr-visible").css("left","-9999px")}function G(i,n){var r=e(n),s=r.closest("table"),o=s.parent();if(n&&"TD"!=n.tagName&&"TH"!=n.tagName&&(r.closest("td").length>0?n=r.closest("td"):r.closest("th").length>0&&(n=r.closest("th"))),!n||"TD"!=n.tagName&&"TH"!=n.tagName)pt&&r.get(0)!=pt.get(0)&&r.parent().get(0)!=pt.get(0)&&t.core.sameInstance(pt)&&X();else{if(r=e(n),0===t.$el.find(r).length)return!1;var a=r.offset().left-1,l=a+r.outerWidth();if(Math.abs(i.pageX-a)<=t.opts.tableResizerOffset||Math.abs(l-i.pageX)<=t.opts.tableResizerOffset){var c,d,u,h,p,f=D(s),m=O(n,f),g=R(m.row,m.col,f),v=s.offset().top,_=s.outerHeight()-1;"rtl"!=t.opts.direction?m.col>0&&i.pageX-a<=t.opts.tableResizerOffset?(u=a,h=a-it(m.col-1,f)+t.opts.tableResizingLimit,p=a+it(m.col,f)-t.opts.tableResizingLimit,c=m.col-1,d=m.col):l-i.pageX<=t.opts.tableResizerOffset&&(u=l,g.col<f[g.row].length&&f[g.row][g.col+1]?(h=l-it(g.col,f)+t.opts.tableResizingLimit,p=l+it(g.col+1,f)-t.opts.tableResizingLimit,c=g.col,d=g.col+1):(c=g.col,d=null,h=s.offset().left-1+f[0].length*t.opts.tableResizingLimit,p=o.offset().left-1+o.width()+parseFloat(o.css("padding-left")))):m.col>0&&l-i.pageX<=t.opts.tableResizerOffset?(u=l,h=l-it(m.col,f)+t.opts.tableResizingLimit,p=l+it(m.col-1,f)-t.opts.tableResizingLimit,c=m.col,d=m.col-1):i.pageX-a<=t.opts.tableResizerOffset&&(u=a,g.col<f[g.row].length&&f[g.row][g.col+1]?(h=a-it(g.col+1,f)+t.opts.tableResizingLimit,p=a+it(g.col,f)-t.opts.tableResizingLimit,c=g.col+1,d=g.col):(c=null,d=g.col,h=o.offset().left+parseFloat(o.css("padding-left")),p=o.offset().left-1+o.width()+parseFloat(o.css("padding-left"))-f[0].length*t.opts.tableResizingLimit)),pt||U(),pt.data("table",s),pt.data("first",c),pt.data("second",d),pt.data("instance",t),t.$wp.append(pt);var y=u-t.win.pageXOffset-t.opts.tableResizerOffset,b=v-t.win.pageYOffset;t.opts.iframe&&(y+=t.$iframe.offset().left-e(t.o_win).scrollLeft(),b+=t.$iframe.offset().top-e(t.o_win).scrollTop(),h+=t.$iframe.offset().left,p+=t.$iframe.offset().left),pt.data("max-left",h),pt.data("max-right",p),pt.data("origin",u-t.win.pageXOffset),pt.css("top",b),pt.css("left",y),pt.css("height",_),pt.find("div").css("height",_),pt.css("padding-left",t.opts.tableResizerOffset),pt.css("padding-right",t.opts.tableResizerOffset),pt.show()}else t.core.sameInstance(pt)&&X()}}function Y(i,n){if(t.$box.find(".fr-line-breaker").is(":visible"))return!1;ft||at(),t.$box.append(ft),ft.data("instance",t);var r=e(n),s=r.find("tr:first"),o=i.pageX,a=0,l=0;t.opts.iframe&&(a+=t.$iframe.offset().left-e(t.o_win).scrollLeft(),l+=t.$iframe.offset().top-e(t.o_win).scrollTop());var c;s.find("th, td").each(function(){var i=e(this);return i.offset().left<=o&&o<i.offset().left+i.outerWidth()/2?(c=parseInt(ft.find("a").css("width"),10),ft.css("top",l+i.offset().top-t.win.pageYOffset-c-5),ft.css("left",a+i.offset().left-t.win.pageXOffset-c/2),ft.data("selected-cell",i),ft.data("position","before"),ft.addClass("fr-visible"),!1):i.offset().left+i.outerWidth()/2<=o&&o<i.offset().left+i.outerWidth()?(c=parseInt(ft.find("a").css("width"),10),ft.css("top",l+i.offset().top-t.win.pageYOffset-c-5),ft.css("left",a+i.offset().left+i.outerWidth()-t.win.pageXOffset-c/2),ft.data("selected-cell",i),ft.data("position","after"),ft.addClass("fr-visible"),!1):void 0})}function K(i,n){if(t.$box.find(".fr-line-breaker").is(":visible"))return!1;ft||at(),t.$box.append(ft),ft.data("instance",t);var r=e(n),s=i.pageY,o=0,a=0;t.opts.iframe&&(o+=t.$iframe.offset().left-e(t.o_win).scrollLeft(),a+=t.$iframe.offset().top-e(t.o_win).scrollTop());var l;r.find("tr").each(function(){var i=e(this);return i.offset().top<=s&&s<i.offset().top+i.outerHeight()/2?(l=parseInt(ft.find("a").css("width"),10),ft.css("top",a+i.offset().top-t.win.pageYOffset-l/2),ft.css("left",o+i.offset().left-t.win.pageXOffset-l-5),ft.data("selected-cell",i.find("td:first")),ft.data("position","above"),ft.addClass("fr-visible"),!1):i.offset().top+i.outerHeight()/2<=s&&s<i.offset().top+i.outerHeight()?(l=parseInt(ft.find("a").css("width"),10),ft.css("top",a+i.offset().top+i.outerHeight()-t.win.pageYOffset-l/2),ft.css("left",o+i.offset().left-t.win.pageXOffset-l-5),ft.data("selected-cell",i.find("td:first")),ft.data("position","below"),ft.addClass("fr-visible"),!1):void 0})}function J(i,n){if(0===dt().length){var r,s,o;if(n&&("HTML"==n.tagName||"BODY"==n.tagName||t.node.isElement(n)))for(r=1;r<=t.opts.tableInsertHelperOffset;r++){if(s=t.doc.elementFromPoint(i.pageX-t.win.pageXOffset,i.pageY-t.win.pageYOffset+r),e(s).hasClass("fr-tooltip"))return!0;if(s&&("TH"==s.tagName||"TD"==s.tagName||"TABLE"==s.tagName)&&(e(s).parents(".fr-wrapper").length||t.opts.iframe))return Y(i,e(s).closest("table")),!0;if(o=t.doc.elementFromPoint(i.pageX-t.win.pageXOffset+r,i.pageY-t.win.pageYOffset),e(o).hasClass("fr-tooltip"))return!0;if(o&&("TH"==o.tagName||"TD"==o.tagName||"TABLE"==o.tagName)&&(e(o).parents(".fr-wrapper").length||t.opts.iframe))return K(i,e(o).closest("table")),!0}t.core.sameInstance(ft)&&V()}}function Z(e){_t=null;var i=t.doc.elementFromPoint(e.pageX-t.win.pageXOffset,e.pageY-t.win.pageYOffset);t.opts.tableResizer&&(!t.popups.areVisible()||t.popups.areVisible()&&t.popups.isVisible("table.edit"))&&G(e,i),!t.opts.tableInsertHelper||t.popups.areVisible()||t.$tb.hasClass("fr-inline")&&t.$tb.is(":visible")||J(e,i)}function et(){if(yt){var i=pt.data("table"),n=i.offset().top-t.win.pageYOffset;t.opts.iframe&&(n+=t.$iframe.offset().top-e(t.o_win).scrollTop()),pt.css("top",n)}}function tt(){var i=pt.data("origin"),n=pt.data("release-position");if(i!==n){var r=pt.data("first"),s=pt.data("second"),o=pt.data("table"),a=o.outerWidth();if(null!==r&&null!==s){var l,c,d,u=D(o),h=[],p=[],f=[],m=[];for(l=0;l<u.length;l++)c=e(u[l][r]),d=e(u[l][s]),h[l]=c.outerWidth(),f[l]=d.outerWidth(),p[l]=100*(h[l]/a),m[l]=100*(f[l]/a);for(l=0;l<u.length;l++){c=e(u[l][r]),d=e(u[l][s]);var g=(p[l]*(h[l]+n-i)/h[l]).toFixed(4);c.css("width",g+"%"),d.css("width",(p[l]+m[l]-g).toFixed(4)+"%")}}else{var v,_=o.parent(),y=100*(a/_.width());v=null==r?(a-n+i)/a*y:(a+n-i)/a*y,o.css("width",Math.round(v).toFixed(4)+"%")}t.selection.restore(),t.undo.saveStep()}pt.removeData("origin"),pt.removeData("release-position"),pt.removeData("first"),pt.removeData("second"),pt.removeData("table")}function it(t,i){var n,r=e(i[0][t]).outerWidth();for(n=1;n<i.length;n++)r=Math.min(r,e(i[n][t]).outerWidth());return r}function nt(e,t,i){var n,r=0;for(n=e;t>=n;n++)r+=it(n,i);return r}function rt(e){if(dt().length>1&&gt&&I(),gt===!1&&mt===!1&&yt===!1)_t&&clearTimeout(_t),(!t.edit.isDisabled()||t.popups.isVisible("table.edit"))&&(_t=setTimeout(Z,30,e));else if(yt){var i=e.pageX-t.win.pageXOffset;t.opts.iframe&&(i+=t.$iframe.offset().left);var n=pt.data("max-left"),r=pt.data("max-right");i>=n&&r>=i?pt.css("left",i-t.opts.tableResizerOffset):n>i&&parseFloat(pt.css("left"),10)>n-t.opts.tableResizerOffset?pt.css("left",n-t.opts.tableResizerOffset):i>r&&parseFloat(pt.css("left"),10)<r-t.opts.tableResizerOffset&&pt.css("left",r-t.opts.tableResizerOffset)}else gt&&V()}function st(i){t.node.isEmpty(i.get(0))?i.prepend(e.FE.MARKERS):i.prepend(e.FE.START_MARKER).append(e.FE.END_MARKER)}function ot(i){var n=i.which;if(n==e.FE.KEYCODE.TAB&&0===t.opts.tabSpaces){var r;if(dt().length>0)r=t.$el.find(".fr-selected-cell:last");else{var s=t.selection.element();"TD"==s.tagName||"TH"==s.tagName?r=e(s):e(s).closest("td").length>0?r=e(s).closest("td"):e(s).closest("th").length>0&&(r=e(s).closest("th"))}if(r)return i.preventDefault(),H(),i.shiftKey?r.prev().length>0?st(r.prev()):r.closest("tr").length>0&&r.closest("tr").prev().length>0?st(r.closest("tr").prev().find("td:last")):r.closest("tbody").length>0&&r.closest("table").find("thead tr").length>0&&st(r.closest("table").find("thead tr th:last")):r.next().length>0?st(r.next()):r.closest("tr").length>0&&r.closest("tr").next().length>0?st(r.closest("tr").next().find("td:first")):r.closest("thead").length>0&&r.closest("table").find("tbody tr").length>0?st(r.closest("table").find("tbody tr td:first")):(r.addClass("fr-selected-cell"),g("below"),L(),st(r.closest("tr").next().find("td:first"))),t.selection.restore(),!1}}function at(){t.shared.$ti_helper||(t.shared.$ti_helper=e('<div class="fr-insert-helper"><a class="fr-floating-btn" role="button" tabindex="-1" title="'+t.language.translate("Insert")+'"><svg viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg"><path d="M22,16.75 L16.75,16.75 L16.75,22 L15.25,22.000 L15.25,16.75 L10,16.75 L10,15.25 L15.25,15.25 L15.25,10 L16.75,10 L16.75,15.25 L22,15.25 L22,16.75 Z"/></svg></a></div>'),t.events.bindClick(t.shared.$ti_helper,"a",function(){var e=ft.data("selected-cell"),i=ft.data("position"),n=ft.data("instance")||t;"before"==i?(e.addClass("fr-selected-cell"),n.table.insertColumn(i),e.removeClass("fr-selected-cell")):"after"==i?(e.addClass("fr-selected-cell"),n.table.insertColumn(i),e.removeClass("fr-selected-cell")):"above"==i?(e.addClass("fr-selected-cell"),n.table.insertRow(i),e.removeClass("fr-selected-cell")):"below"==i&&(e.addClass("fr-selected-cell"),n.table.insertRow(i),e.removeClass("fr-selected-cell")),V()}),t.events.on("shared.destroy",function(){t.shared.$ti_helper.html("").removeData().remove(),t.shared.$ti_helper=null},!0),t.events.$on(t.shared.$ti_helper,"mousemove",function(e){e.stopPropagation()},!0),t.events.$on(e(t.o_win),"scroll",function(){V()},!0),t.events.$on(t.$wp,"scroll",function(){V()},!0)),ft=t.shared.$ti_helper,t.events.on("destroy",function(){ft=null}),t.tooltip.bind(t.$box,".fr-insert-helper > a.fr-floating-btn")}function lt(){vt=null,clearTimeout(_t)}function ct(){dt().length>0?n():(t.popups.hide("table.insert"),t.toolbar.showInline())}function dt(){return t.$el.get(0).querySelectorAll(".fr-selected-cell")}function ut(){var i=dt();if(i.length){for(var n=i[0];n&&"TABLE"!=n.tagName&&n.parentNode!=t.$el.get(0);)n=n.parentNode;return n&&"TABLE"==n.tagName?e(n):e([])}return e([])}function ht(){if(!t.$wp)return!1;if(!t.helpers.isMobile()){gt=!1,mt=!1,yt=!1,t.events.$on(t.$el,"mousedown",B),t.popups.onShow("image.edit",function(){L(),gt=!1,mt=!1}),t.popups.onShow("link.edit",function(){L(),gt=!1,mt=!1}),t.events.on("commands.mousedown",function(e){e.parents(".fr-toolbar").length>0&&L()}),t.events.$on(t.$el,"mouseenter","th, td",q),t.events.$on(t.$win,"mouseup",W),t.opts.iframe&&t.events.$on(e(t.o_win),"mouseup",W),t.events.$on(t.$el,"keydown",Q),t.events.$on(t.$win,"mousemove",rt),t.events.$on(e(t.o_win),"scroll",et),t.events.on("contentChanged",function(){dt().length>0&&(n(),t.$el.find("img").on("load.selected-cells",function(){e(this).off("load.selected-cells"),dt().length>0&&n()}))}),t.events.$on(e(t.o_win),"resize",function(){L()}),t.events.on("keydown",function(i){var n=dt();if(n.length>0){if(i.which==e.FE.KEYCODE.ESC&&t.popups.isVisible("table.edit"))return L(),t.popups.hide("table.edit"),i.preventDefault(),i.stopPropagation(),i.stopImmediatePropagation(),n=[],!1;if(n.length>1&&i.which==e.FE.KEYCODE.BACKSPACE){t.undo.saveStep();for(var r=0;r<n.length;r++)e(n[r]).html("<br>"),r==n.length-1&&e(n[r]).prepend(e.FE.MARKERS);return t.selection.restore(),t.undo.saveStep(),n=[],!1}if(n.length>1&&!t.keys.ctrlKey(i))return i.preventDefault(),n=[],!1}n=[]},!0);var i=[];t.events.on("html.beforeGet",function(){i=dt();for(var e=0;e<i.length;e++)i[e].className=(i[e].className||"").replace(/fr-selected-cell/g,"")}),t.events.on("html.get",function(e){return e=e.replace(/<(td|th)((?:[\w\W]*?)) class=""((?:[\w\W]*?))>((?:[\w\W]*?))<\/(td|th)>/g,"<$1$2$3>$4</$5>")}),t.events.on("html.afterGet",function(){for(var e=0;e<i.length;e++)i[e].className=(i[e].className?i[e].className+" ":"")+"fr-selected-cell";i=[]}),o(!0),l(!0)}t.events.on("keydown",ot),t.events.on("destroy",lt)}var pt,ft,mt,gt,vt,_t,yt;return{_init:ht,insert:h,remove:p,insertRow:g,deleteRow:v,insertColumn:_,deleteColumn:y,mergeCells:x,splitCellVertically:T,splitCellHorizontally:A,addHeader:f,removeHeader:m,setBackground:S,showInsertPopup:i,showEditPopup:n,showColorsPopup:r,back:ct,verticalAlign:M,horizontalAlign:N,applyStyle:E,selectedTable:ut,selectedCells:dt}},e.FE.DefineIcon("insertTable",{NAME:"table"}),e.FE.RegisterCommand("insertTable",{title:"Insert Table",undo:!1,focus:!0,refreshOnCallback:!1,popup:!0,callback:function(){this.popups.isVisible("table.insert")?(this.$el.find(".fr-marker")&&(this.events.disableBlur(),this.selection.restore()),this.popups.hide("table.insert")):this.table.showInsertPopup()},plugin:"table"}),e.FE.RegisterCommand("tableInsert",{callback:function(e,t,i){this.table.insert(t,i),this.popups.hide("table.insert")}}),e.FE.DefineIcon("tableHeader",{NAME:"header"}),e.FE.RegisterCommand("tableHeader",{title:"Table Header",focus:!1,callback:function(){var e=this.popups.get("table.edit").find('.fr-command[data-cmd="tableHeader"]');e.hasClass("fr-active")?this.table.removeHeader():this.table.addHeader()},refresh:function(e){var t=this.table.selectedTable();t.length>0&&(0===t.find("th").length?e.removeClass("fr-active"):e.addClass("fr-active"))}}),e.FE.DefineIcon("tableRows",{NAME:"bars"}),e.FE.RegisterCommand("tableRows",{type:"dropdown",focus:!1,title:"Row",options:{above:"Insert row above",below:"Insert row below","delete":"Delete row"},html:function(){var t='<ul class="fr-dropdown-list">',i=e.FE.COMMANDS.tableRows.options;
for(var n in i)i.hasOwnProperty(n)&&(t+='<li><a class="fr-command" data-cmd="tableRows" data-param1="'+n+'" title="'+this.language.translate(i[n])+'">'+this.language.translate(i[n])+"</a></li>");return t+="</ul>"},callback:function(e,t){"above"==t||"below"==t?this.table.insertRow(t):this.table.deleteRow()}}),e.FE.DefineIcon("tableColumns",{NAME:"bars fa-rotate-90"}),e.FE.RegisterCommand("tableColumns",{type:"dropdown",focus:!1,title:"Column",options:{before:"Insert column before",after:"Insert column after","delete":"Delete column"},html:function(){var t='<ul class="fr-dropdown-list">',i=e.FE.COMMANDS.tableColumns.options;for(var n in i)i.hasOwnProperty(n)&&(t+='<li><a class="fr-command" data-cmd="tableColumns" data-param1="'+n+'" title="'+this.language.translate(i[n])+'">'+this.language.translate(i[n])+"</a></li>");return t+="</ul>"},callback:function(e,t){"before"==t||"after"==t?this.table.insertColumn(t):this.table.deleteColumn()}}),e.FE.DefineIcon("tableCells",{NAME:"square-o"}),e.FE.RegisterCommand("tableCells",{type:"dropdown",focus:!1,title:"Cell",options:{merge:"Merge cells","vertical-split":"Vertical split","horizontal-split":"Horizontal split"},html:function(){var t='<ul class="fr-dropdown-list">',i=e.FE.COMMANDS.tableCells.options;for(var n in i)i.hasOwnProperty(n)&&(t+='<li><a class="fr-command" data-cmd="tableCells" data-param1="'+n+'" title="'+this.language.translate(i[n])+'">'+this.language.translate(i[n])+"</a></li>");return t+="</ul>"},callback:function(e,t){"merge"==t?this.table.mergeCells():"vertical-split"==t?this.table.splitCellVertically():this.table.splitCellHorizontally()},refreshOnShow:function(e,t){this.$el.find(".fr-selected-cell").length>1?(t.find('a[data-param1="vertical-split"]').addClass("fr-disabled"),t.find('a[data-param1="horizontal-split"]').addClass("fr-disabled"),t.find('a[data-param1="merge"]').removeClass("fr-disabled")):(t.find('a[data-param1="merge"]').addClass("fr-disabled"),t.find('a[data-param1="vertical-split"]').removeClass("fr-disabled"),t.find('a[data-param1="horizontal-split"]').removeClass("fr-disabled"))}}),e.FE.DefineIcon("tableRemove",{NAME:"trash"}),e.FE.RegisterCommand("tableRemove",{title:"Remove Table",focus:!1,callback:function(){this.table.remove()}}),e.FE.DefineIcon("tableStyle",{NAME:"paint-brush"}),e.FE.RegisterCommand("tableStyle",{title:"Table Style",type:"dropdown",focus:!1,html:function(){var e='<ul class="fr-dropdown-list">',t=this.opts.tableStyles;for(var i in t)t.hasOwnProperty(i)&&(e+='<li><a class="fr-command" data-cmd="tableStyle" data-param1="'+i+'" title="'+this.language.translate(t[i])+'">'+this.language.translate(t[i])+"</a></li>");return e+="</ul>"},callback:function(e,t){this.table.applyStyle(t,this.$el.find(".fr-selected-cell").closest("table"),this.opts.tableMultipleStyles,this.opts.tableStyles)},refreshOnShow:function(t,i){var n=this.$el.find(".fr-selected-cell").closest("table");n&&i.find(".fr-command").each(function(){var t=e(this).data("param1");e(this).toggleClass("fr-active",n.hasClass(t))})}}),e.FE.DefineIcon("tableCellBackground",{NAME:"tint"}),e.FE.RegisterCommand("tableCellBackground",{title:"Cell Background",focus:!1,callback:function(){this.table.showColorsPopup()}}),e.FE.RegisterCommand("tableCellBackgroundColor",{undo:!0,focus:!1,callback:function(e,t){this.table.setBackground(t)}}),e.FE.DefineIcon("tableBack",{NAME:"arrow-left"}),e.FE.RegisterCommand("tableBack",{title:"Back",undo:!1,focus:!1,back:!0,callback:function(){this.table.back()},refresh:function(e){0!==this.table.selectedCells().length||this.opts.toolbarInline?(e.removeClass("fr-hidden"),e.next(".fr-separator").removeClass("fr-hidden")):(e.addClass("fr-hidden"),e.next(".fr-separator").addClass("fr-hidden"))}}),e.FE.DefineIcon("tableCellVerticalAlign",{NAME:"arrows-v"}),e.FE.RegisterCommand("tableCellVerticalAlign",{type:"dropdown",focus:!1,title:"Vertical Align",options:{Top:"Align Top",Middle:"Align Middle",Bottom:"Align Bottom"},html:function(){var t='<ul class="fr-dropdown-list">',i=e.FE.COMMANDS.tableCellVerticalAlign.options;for(var n in i)i.hasOwnProperty(n)&&(t+='<li><a class="fr-command" data-cmd="tableCellVerticalAlign" data-param1="'+n.toLowerCase()+'" title="'+this.language.translate(i[n])+'">'+this.language.translate(n)+"</a></li>");return t+="</ul>"},callback:function(e,t){this.table.verticalAlign(t)},refreshOnShow:function(e,t){t.find('.fr-command[data-param1="'+this.$el.find(".fr-selected-cell").css("vertical-align")+'"]').addClass("fr-active")}}),e.FE.DefineIcon("tableCellHorizontalAlign",{NAME:"align-left"}),e.FE.DefineIcon("align-left",{NAME:"align-left"}),e.FE.DefineIcon("align-right",{NAME:"align-right"}),e.FE.DefineIcon("align-center",{NAME:"align-center"}),e.FE.DefineIcon("align-justify",{NAME:"align-justify"}),e.FE.RegisterCommand("tableCellHorizontalAlign",{type:"dropdown",focus:!1,title:"Horizontal Align",options:{left:"Align Left",center:"Align Center",right:"Align Right",justify:"Align Justify"},html:function(){var t='<ul class="fr-dropdown-list">',i=e.FE.COMMANDS.tableCellHorizontalAlign.options;for(var n in i)i.hasOwnProperty(n)&&(t+='<li><a class="fr-command fr-title" data-cmd="tableCellHorizontalAlign" data-param1="'+n+'" title="'+this.language.translate(i[n])+'">'+this.icon.create("align-"+n)+"</a></li>");return t+="</ul>"},callback:function(e,t){this.table.horizontalAlign(t)},refresh:function(t){var i=this.table.selectedCells();i.length&&t.find("> *:first").replaceWith(this.icon.create("align-"+this.helpers.getAlignment(e(i[0]))))},refreshOnShow:function(e,t){t.find('.fr-command[data-param1="'+this.helpers.getAlignment(this.$el.find(".fr-selected-cell:first"))+'"]').addClass("fr-active")}}),e.FE.DefineIcon("tableCellStyle",{NAME:"magic"}),e.FE.RegisterCommand("tableCellStyle",{title:"Cell Style",type:"dropdown",focus:!1,html:function(){var e='<ul class="fr-dropdown-list">',t=this.opts.tableCellStyles;for(var i in t)t.hasOwnProperty(i)&&(e+='<li><a class="fr-command" data-cmd="tableCellStyle" data-param1="'+i+'" title="'+this.language.translate(t[i])+'">'+this.language.translate(t[i])+"</a></li>");return e+="</ul>"},callback:function(e,t){this.table.applyStyle(t,this.$el.find(".fr-selected-cell"),this.opts.tableCellMultipleStyles,this.opts.tableCellStyles)},refreshOnShow:function(t,i){var n=this.$el.find(".fr-selected-cell:first");n&&i.find(".fr-command").each(function(){var t=e(this).data("param1");e(this).toggleClass("fr-active",n.hasClass(t))})}})}),/*!
 * froala_editor v2.3.5 (https://www.froala.com/wysiwyg-editor)
 * License https://froala.com/wysiwyg-editor/terms/
 * Copyright 2014-2016 Froala Labs
 */
function(e){"function"==typeof define&&define.amd?define(["jquery"],e):"object"==typeof module&&module.exports?module.exports=function(t,i){return void 0===i&&(i="undefined"!=typeof window?require("jquery"):require("jquery")(t)),e(i),i}:e(jQuery)}(function(e){"use strict";e.extend(e.FE.DEFAULTS,{}),e.FE.URLRegEx=/(\s|^|>)((http|https|ftp|ftps)\:\/\/[a-zA-Z0-9\-\.]+(\.[a-zA-Z]{2,3})?(:\d*)?(\/[^\s<]*)?)(\s|$|<)/gi,e.FE.PLUGINS.url=function(t){function i(n){n.each(function(){if("IFRAME"!=this.tagName)if(3==this.nodeType){var n=this.textContent.replace(/&nbsp;/gi,"");e.FE.URLRegEx.test(n)&&(e(this).before(n.replace(e.FE.URLRegEx,"$1<a"+(t.opts.linkAlwaysBlank?' target="_blank"':"")+(t.opts.linkAlwaysNoFollow?' rel="nofollow"':"")+' href="$2">$2</a>$7')),e(this).remove())}else 1==this.nodeType&&["A","BUTTON","TEXTAREA"].indexOf(this.tagName)<0&&i(t.node.contents(this))})}function n(){t.events.on("paste.afterCleanup",function(t){return e.FE.URLRegEx.test(t)?t.replace(e.FE.URLRegEx,'$1<a href="$2">$2</a>$7'):void 0}),t.events.on("keyup",function(n){var r=n.which;(r==e.FE.KEYCODE.ENTER||r==e.FE.KEYCODE.SPACE)&&i(t.node.contents(t.$el.get(0)))}),t.events.on("keydown",function(i){var n=i.which;if(n==e.FE.KEYCODE.ENTER){var r=t.selection.element();if(("A"==r.tagName||e(r).parents("a").length)&&t.selection.info(r).atEnd)return i.stopImmediatePropagation(),"A"!==r.tagName&&(r=e(r).parents("a")[0]),e(r).after("&nbsp;"+e.FE.MARKERS),t.selection.restore(),!1}})}return{_init:n}}}),/*!
 * froala_editor v2.3.5 (https://www.froala.com/wysiwyg-editor)
 * License https://froala.com/wysiwyg-editor/terms/
 * Copyright 2014-2016 Froala Labs
 */
function(e){"function"==typeof define&&define.amd?define(["jquery"],e):"object"==typeof module&&module.exports?module.exports=function(t,i){return void 0===i&&(i="undefined"!=typeof window?require("jquery"):require("jquery")(t)),e(i),i}:e(jQuery)}(function(e){"use strict";e.extend(e.FE.POPUP_TEMPLATES,{"video.insert":"[_BUTTONS_][_BY_URL_LAYER_][_EMBED_LAYER_]","video.edit":"[_BUTTONS_]","video.size":"[_BUTTONS_][_SIZE_LAYER_]"}),e.extend(e.FE.DEFAULTS,{videoInsertButtons:["videoBack","|","videoByURL","videoEmbed"],videoEditButtons:["videoDisplay","videoAlign","videoSize","videoRemove"],videoResize:!0,videoSizeButtons:["videoBack","|"],videoSplitHTML:!1,videoTextNear:!0,videoDefaultAlign:"center",videoDefaultDisplay:"block",videoMove:!0}),e.FE.VIDEO_PROVIDERS=[{test_regex:/^.*((youtu.be)|(youtube.com))\/((v\/)|(\/u\/\w\/)|(embed\/)|(watch\?))?\??v?=?([^#\&\?]*).*/,url_regex:/(?:https?:\/\/)?(?:www\.)?(?:m\.)?(?:youtube\.com|youtu\.be)\/(?:watch\?v=|embed\/)?([0-9a-zA-Z_\-]+)(.+)?/g,url_text:"//www.youtube.com/embed/$1",html:'<iframe width="640" height="360" src="{url}?wmode=opaque" frameborder="0" allowfullscreen></iframe>'},{test_regex:/^.*(vimeo\.com\/)((channels\/[A-z]+\/)|(groups\/[A-z]+\/videos\/))?([0-9]+)/,url_regex:/(?:https?:\/\/)?(?:www\.)?(?:vimeo\.com)\/(?:channels\/[A-z]+\/|groups\/[A-z]+\/videos\/)?(.+)/g,url_text:"//player.vimeo.com/video/$1",html:'<iframe width="640" height="360" src="{url}" frameborder="0" allowfullscreen></iframe>'},{test_regex:/^.+(dailymotion.com|dai.ly)\/(video|hub)?\/?([^_]+)[^#]*(#video=([^_&]+))?/,url_regex:/(?:https?:\/\/)?(?:www\.)?(?:dailymotion\.com|dai\.ly)\/(?:video|hub)?\/?(.+)/g,url_text:"//www.dailymotion.com/embed/video/$1",html:'<iframe width="640" height="360" src="{url}" frameborder="0" allowfullscreen></iframe>'},{test_regex:/^.+(screen.yahoo.com)\/[^_&]+/,url_regex:"",url_text:"",html:'<iframe width="640" height="360" src="{url}?format=embed" frameborder="0" allowfullscreen="true" mozallowfullscreen="true" webkitallowfullscreen="true" allowtransparency="true"></iframe>'},{test_regex:/^.+(rutube.ru)\/[^_&]+/,url_regex:/(?:https?:\/\/)?(?:www\.)?(?:rutube\.ru)\/(?:video)?\/?(.+)/g,url_text:"//rutube.ru/play/embed/$1",html:'<iframe width="640" height="360" src="{url}" frameborder="0" allowfullscreen="true" mozallowfullscreen="true" webkitallowfullscreen="true" allowtransparency="true"></iframe>'}],e.FE.VIDEO_EMBED_REGEX=/^\W*((<iframe.*><\/iframe>)|(<embed.*>))\W*$/i,e.FE.PLUGINS.video=function(t){function i(){var e=t.popups.get("video.insert"),i=e.find(".fr-video-by-url-layer input");i.val("").trigger("change");var n=e.find(".fr-video-embed-layer textarea");n.val("").trigger("change")}function n(){var e=t.$tb.find('.fr-command[data-cmd="insertVideo"]'),i=t.popups.get("video.insert");if(i||(i=s()),!i.hasClass("fr-active")){t.popups.refresh("video.insert"),t.popups.setContainer("video.insert",t.$tb);var n=e.offset().left+e.outerWidth()/2,r=e.offset().top+(t.opts.toolbarBottom?10:e.outerHeight()-10);t.popups.show("video.insert",n,r,e.outerHeight())}}function r(){var i=t.popups.get("video.edit");i||(i=x()),t.popups.setContainer("video.edit",e(t.opts.scrollableContainer)),t.popups.refresh("video.edit");var n=W.find("iframe, embed, video"),r=n.offset().left+n.outerWidth()/2,s=n.offset().top+n.outerHeight();t.popups.show("video.edit",r,s,n.outerHeight())}function s(e){if(e)return t.popups.onRefresh("video.insert",i),!0;var n="";t.opts.videoInsertButtons.length>1&&(n='<div class="fr-buttons">'+t.button.buildList(t.opts.videoInsertButtons)+"</div>");var r="";t.opts.videoInsertButtons.indexOf("videoByURL")>=0&&(r='<div class="fr-video-by-url-layer fr-layer fr-active" id="fr-video-by-url-layer-'+t.id+'"><div class="fr-input-line"><input type="text" placeholder="http://" tabIndex="1"></div><div class="fr-action-buttons"><button type="button" class="fr-command fr-submit" data-cmd="videoInsertByURL" tabIndex="2">'+t.language.translate("Insert")+"</button></div></div>");var s="";t.opts.videoInsertButtons.indexOf("videoEmbed")>=0&&(s='<div class="fr-video-embed-layer fr-layer" id="fr-video-embed-layer-'+t.id+'"><div class="fr-input-line"><textarea type="text" placeholder="'+t.language.translate("Embedded Code")+'" tabIndex="1" rows="5"></textarea></div><div class="fr-action-buttons"><button type="button" class="fr-command fr-submit" data-cmd="videoInsertEmbed" tabIndex="2">'+t.language.translate("Insert")+"</button></div></div>");var o={buttons:n,by_url_layer:r,embed_layer:s},a=t.popups.create("video.insert",o);return a}function o(e){var i,n,r=t.popups.get("video.insert");if(!W&&!t.opts.toolbarInline){var s=t.$tb.find('.fr-command[data-cmd="insertVideo"]');i=s.offset().left+s.outerWidth()/2,n=s.offset().top+(t.opts.toolbarBottom?10:s.outerHeight()-10)}t.opts.toolbarInline&&(n=r.offset().top-t.helpers.getPX(r.css("margin-top")),r.hasClass("fr-above")&&(n+=r.outerHeight())),r.find(".fr-layer").removeClass("fr-active"),r.find(".fr-"+e+"-layer").addClass("fr-active"),t.popups.show("video.insert",i,n,0)}function a(e){var i=t.popups.get("video.insert");i.find(".fr-video-by-url-layer").hasClass("fr-active")&&e.addClass("fr-active")}function l(e){var i=t.popups.get("video.insert");i.find(".fr-video-embed-layer").hasClass("fr-active")&&e.addClass("fr-active")}function c(e){t.events.focus(!0),t.selection.restore(),t.html.insert('<span contenteditable="false" draggable="true" class="fr-jiv fr-video fr-dv'+t.opts.videoDefaultDisplay[0]+("center"!=t.opts.videoDefaultAlign?" fr-fv"+t.opts.videoDefaultAlign[0]:"")+'">'+e+"</span>",!1,t.opts.videoSplitHTML),t.popups.hide("video.insert");var i=t.$el.find(".fr-jiv");i.removeClass("fr-jiv"),i.toggleClass("fr-draggable",t.opts.videoMove),t.events.trigger("video.inserted",[i])}function d(i){if("undefined"==typeof i){var n=t.popups.get("video.insert");i=n.find('.fr-video-by-url-layer input[type="text"]').val()||""}var r=null;if(t.helpers.isURL(i))for(var s=0;s<e.FE.VIDEO_PROVIDERS.length;s++){var o=e.FE.VIDEO_PROVIDERS[s];if(o.test_regex.test(i)){r=i.replace(o.url_regex,o.url_text),r=o.html.replace(/\{url\}/,r);break}}r?c(r):t.events.trigger("video.linkError",[i])}function u(i){if("undefined"==typeof i){var n=t.popups.get("video.insert");i=n.find(".fr-video-embed-layer textarea").val()||""}0!==i.length&&e.FE.VIDEO_EMBED_REGEX.test(i)?c(i):t.events.trigger("video.codeError",[i])}function h(i){if(!t.core.sameInstance(B))return!0;i.preventDefault(),i.stopPropagation();var n=i.pageX||(i.originalEvent.touches?i.originalEvent.touches[0].pageX:null),r=i.pageY||(i.originalEvent.touches?i.originalEvent.touches[0].pageY:null);return n&&r?(t.undo.canDo()||t.undo.saveStep(),H=e(this),H.data("start-x",n),H.data("start-y",r),$.show(),t.popups.hideAll(),w(),void 0):!1}function p(e){if(!t.core.sameInstance(B))return!0;if(H){e.preventDefault();var i=e.pageX||(e.originalEvent.touches?e.originalEvent.touches[0].pageX:null),n=e.pageY||(e.originalEvent.touches?e.originalEvent.touches[0].pageY:null);if(!i||!n)return!1;var r=H.data("start-x"),s=H.data("start-y");H.data("start-x",i),H.data("start-y",n);var o=i-r,a=n-s,l=W.find("iframe, embed, video"),c=l.width(),d=l.height();(H.hasClass("fr-hnw")||H.hasClass("fr-hsw"))&&(o=0-o),(H.hasClass("fr-hnw")||H.hasClass("fr-hne"))&&(a=0-a),l.css("width",c+o),l.css("height",d+a),l.removeAttr("width"),l.removeAttr("height"),v()}}function f(e){return t.core.sameInstance(B)?(H&&W&&(e&&e.stopPropagation(),H=null,$.hide(),v(),r(),t.undo.saveStep()),void 0):!0}function m(e){return'<div class="fr-handler fr-h'+e+'"></div>'}function g(){var i;t.shared.$video_resizer?(B=t.shared.$video_resizer,$=t.shared.$vid_overlay,t.events.on("destroy",function(){B.removeClass("fr-active").appendTo(e("body"))},!0)):(t.shared.$video_resizer=e('<div class="fr-video-resizer"></div>'),B=t.shared.$video_resizer,t.events.$on(B,"mousedown",function(e){e.stopPropagation()},!0),t.opts.videoResize&&(B.append(m("nw")+m("ne")+m("sw")+m("se")),t.shared.$vid_overlay=e('<div class="fr-video-overlay"></div>'),$=t.shared.$vid_overlay,i=B.get(0).ownerDocument,e(i).find("body").append($))),t.events.on("shared.destroy",function(){B.html("").removeData().remove(),B=null,t.opts.videoResize&&($.remove(),$=null)},!0),t.helpers.isMobile()||t.events.$on(e(t.o_win),"resize.video",function(){y(!0)}),t.opts.videoResize&&(i=B.get(0).ownerDocument,t.events.$on(B,t._mousedown,".fr-handler",h),t.events.$on(e(i),t._mousemove,p),t.events.$on(e(i.defaultView||i.parentWindow),t._mouseup,f),t.events.$on($,"mouseleave",f))}function v(){B||g(),(t.$wp||e(t.opts.scrollableContainer)).append(B),B.data("instance",t);var i=W.find("iframe, embed, video");B.css("top",(t.opts.iframe?i.offset().top-1:i.offset().top-t.$wp.offset().top-1)+t.$wp.scrollTop()).css("left",(t.opts.iframe?i.offset().left-1:i.offset().left-t.$wp.offset().left-1)+t.$wp.scrollLeft()).css("width",i.outerWidth()).css("height",i.height()).addClass("fr-active")}function _(i){if(i&&"touchend"==i.type&&q)return!0;if(i.preventDefault(),i.stopPropagation(),t.edit.isDisabled())return!1;for(var n=0;n<e.FE.INSTANCES.length;n++)e.FE.INSTANCES[n]!=t&&e.FE.INSTANCES[n].events.trigger("video.hideResizer");t.toolbar.disable(),t.helpers.isMobile()&&(t.events.disableBlur(),t.$el.blur(),t.events.enableBlur()),W=e(this),e(this).addClass("fr-active"),t.opts.iframe&&t.size.syncIframe(),v(),r(),t.selection.clear(),t.button.bulkRefresh(),t.events.trigger("image.hideResizer")}function y(e){W&&(k()||e===!0)&&(B.removeClass("fr-active"),t.toolbar.enable(),W.removeClass("fr-active"),W=null,w())}function b(){t.shared.vid_exit_flag=!0}function w(){t.shared.vid_exit_flag=!1}function k(){return t.shared.vid_exit_flag}function C(){t.events.on("mousedown window.mousedown",b),t.events.on("window.touchmove",w),t.events.on("mouseup window.mouseup",y),t.events.on("commands.mousedown",function(e){e.parents(".fr-toolbar").length>0&&y()}),t.events.on("blur video.hideResizer commands.undo commands.redo element.dropped",function(){y(!0)})}function x(){var e="";t.opts.videoEditButtons.length>=1&&(e+='<div class="fr-buttons">',e+=t.button.buildList(t.opts.videoEditButtons),e+="</div>");var i={buttons:e},n=t.popups.create("video.edit",i);return t.events.$on(t.$wp,"scroll.video-edit",function(){W&&t.popups.isVisible("video.edit")&&r()}),n}function A(){if(W){var e=t.popups.get("video.size"),i=W.find("iframe, embed, video");e.find('input[name="width"]').val(i.get(0).style.width||i.attr("width")).trigger("change"),e.find('input[name="height"]').val(i.get(0).style.height||i.attr("height")).trigger("change")}}function T(){var i=t.popups.get("video.size");i||(i=S()),t.popups.refresh("video.size"),t.popups.setContainer("video.size",e(t.opts.scrollableContainer));var n=W.find("iframe, embed, video"),r=n.offset().left+n.width()/2,s=n.offset().top+n.height();t.popups.show("video.size",r,s,n.height())}function S(e){if(e)return t.popups.onRefresh("video.size",A),!0;var i="";i='<div class="fr-buttons">'+t.button.buildList(t.opts.videoSizeButtons)+"</div>";var n="";n='<div class="fr-video-size-layer fr-layer fr-active" id="fr-video-size-layer-'+t.id+'"><div class="fr-video-group"><div class="fr-input-line"><input type="text" name="width" placeholder="'+t.language.translate("Width")+'" tabIndex="1"></div><div class="fr-input-line"><input type="text" name="height" placeholder="'+t.language.translate("Height")+'" tabIndex="1"></div></div><div class="fr-action-buttons"><button type="button" class="fr-command fr-submit" data-cmd="videoSetSize" tabIndex="2">'+t.language.translate("Update")+"</button></div></div>";var r={buttons:i,size_layer:n},s=t.popups.create("video.size",r);return t.events.$on(t.$wp,"scroll",function(){W&&t.popups.isVisible("video.size")&&T()}),s}function M(e){W.removeClass("fr-fvr fr-fvl"),"left"==e?W.addClass("fr-fvl"):"right"==e&&W.addClass("fr-fvr"),v(),r()}function N(e){return W?(W.hasClass("fr-fvl")?e.find("> *:first").replaceWith(t.icon.create("align-left")):W.hasClass("fr-fvr")?e.find("> *:first").replaceWith(t.icon.create("align-right")):e.find("> *:first").replaceWith(t.icon.create("align-justify")),void 0):!1}function E(e,t){var i="justify";W.hasClass("fr-fvl")?i="left":W.hasClass("fr-fvr")&&(i="right"),t.find('.fr-command[data-param1="'+i+'"]').addClass("fr-active")}function D(e){W.removeClass("fr-dvi fr-dvb"),"inline"==e?W.addClass("fr-dvi"):"block"==e&&W.addClass("fr-dvb"),v(),r()}function O(e,t){var i="block";W.hasClass("fr-dvi")&&(i="inline"),t.find('.fr-command[data-param1="'+i+'"]').addClass("fr-active")}function R(){if(W&&t.events.trigger("video.beforeRemove",[W])!==!1){var e=W;t.popups.hideAll(),y(!0),t.selection.setBefore(e.get(0))||t.selection.setAfter(e.get(0)),e.remove(),t.selection.restore(),t.html.fillEmptyBlocks(),t.events.trigger("video.removed",[e])}}function L(e){if(!e.hasClass("fr-dvi")&&!e.hasClass("fr-dvb")){var i=e.css("float");e.css("float","none"),"block"==e.css("display")?(e.css("float",i),0===parseInt(e.css("margin-left"),10)&&(e.attr("style")||"").indexOf("margin-right: auto")>=0?e.addClass("fr-fvl"):0===parseInt(e.css("margin-right"),10)&&(e.attr("style")||"").indexOf("margin-left: auto")>=0&&e.addClass("fr-fvr"),e.addClass("fr-dvb")):(e.css("float",i),"left"==e.css("float")?e.addClass("fr-fvl"):"right"==e.css("float")&&e.addClass("fr-fvr"),e.addClass("fr-dvi")),e.css("margin",""),e.css("float",""),e.css("display",""),e.css("z-index",""),e.css("position",""),e.css("overflow",""),e.css("vertical-align","")}t.opts.videoTextNear||e.removeClass("fr-dvi").addClass("fr-dvb")}function I(){t.$el.find("video").filter(function(){return 0===e(this).parents("span.fr-video").length}).wrap('<span class="fr-video" contenteditable="false"></span>'),t.$el.find("embed, iframe").filter(function(){if(t.browser.safari&&this.getAttribute("src")&&this.setAttribute("src",this.src),e(this).parents("span.fr-video").length>0)return!1;for(var i=e(this).attr("src"),n=0;n<e.FE.VIDEO_PROVIDERS.length;n++){var r=e.FE.VIDEO_PROVIDERS[n];if(r.test_regex.test(i))return!0}return!1}).map(function(){return 0===e(this).parents("object").length?this:e(this).parents("object").get(0)}).wrap('<span class="fr-video" contenteditable="false"></span>');for(var i=t.$el.find("span.fr-video"),n=0;n<i.length;n++)L(e(i[n]));i.toggleClass("fr-draggable",t.opts.videoMove)}function j(){C(),t.helpers.isMobile()&&(t.events.$on(t.$el,"touchstart","span.fr-video",function(){q=!1}),t.events.$on(t.$el,"touchmove",function(){q=!0})),t.events.on("html.set",I),I(),t.events.$on(t.$el,"mousedown","span.fr-video",function(e){e.stopPropagation()}),t.events.$on(t.$el,"click touchend","span.fr-video",_),t.events.on("keydown",function(i){var n=i.which;return!W||n!=e.FE.KEYCODE.BACKSPACE&&n!=e.FE.KEYCODE.DELETE?W&&n==e.FE.KEYCODE.ESC?(y(!0),i.preventDefault(),!1):W&&!t.keys.ctrlKey(i)?(i.preventDefault(),!1):void 0:(i.preventDefault(),R(),!1)},!0),t.events.on("keydown",function(){t.$el.find("span.fr-video:empty").remove()}),s(!0),S(!0)}function P(){W?W.trigger("click"):(t.events.disableBlur(),t.selection.restore(),t.events.enableBlur(),t.popups.hide("video.insert"),t.toolbar.showInline())}function F(e,i){if(W){var n=t.popups.get("video.size"),r=W.find("iframe, embed, video");r.css("width",e||n.find('input[name="width"]').val()),r.css("height",i||n.find('input[name="height"]').val()),r.get(0).style.width&&r.removeAttr("width"),r.get(0).style.height&&r.removeAttr("height"),n.find("input").blur(),setTimeout(function(){W.trigger("click")},t.helpers.isAndroid()?50:0)}}function z(){return W}var $,H,B,W,q;return t.shared.vid_exit_flag=!1,{_init:j,showInsertPopup:n,showLayer:o,refreshByURLButton:a,refreshEmbedButton:l,insertByURL:d,insertEmbed:u,insert:c,align:M,refreshAlign:N,refreshAlignOnShow:E,display:D,refreshDisplayOnShow:O,remove:R,showSizePopup:T,back:P,setSize:F,get:z}},e.FE.RegisterCommand("insertVideo",{title:"Insert Video",undo:!1,focus:!0,refreshAfterCallback:!1,popup:!0,callback:function(){this.popups.isVisible("video.insert")?(this.$el.find(".fr-marker")&&(this.events.disableBlur(),this.selection.restore()),this.popups.hide("video.insert")):this.video.showInsertPopup()},plugin:"video"}),e.FE.DefineIcon("insertVideo",{NAME:"video-camera"}),e.FE.DefineIcon("videoByURL",{NAME:"link"}),e.FE.RegisterCommand("videoByURL",{title:"By URL",undo:!1,focus:!1,callback:function(){this.video.showLayer("video-by-url")},refresh:function(e){this.video.refreshByURLButton(e)}}),e.FE.DefineIcon("videoEmbed",{NAME:"code"}),e.FE.RegisterCommand("videoEmbed",{title:"Embedded Code",undo:!1,focus:!1,callback:function(){this.video.showLayer("video-embed")},refresh:function(e){this.video.refreshEmbedButton(e)}}),e.FE.RegisterCommand("videoInsertByURL",{undo:!0,focus:!0,callback:function(){this.video.insertByURL()}}),e.FE.RegisterCommand("videoInsertEmbed",{undo:!0,focus:!0,callback:function(){this.video.insertEmbed()}}),e.FE.DefineIcon("videoDisplay",{NAME:"star"}),e.FE.RegisterCommand("videoDisplay",{title:"Display",type:"dropdown",options:{inline:"Inline",block:"Break Text"},callback:function(e,t){this.video.display(t)},refresh:function(e){this.opts.videoTextNear||e.addClass("fr-hidden")},refreshOnShow:function(e,t){this.video.refreshDisplayOnShow(e,t)}}),e.FE.DefineIcon("videoAlign",{NAME:"align-center"}),e.FE.RegisterCommand("videoAlign",{type:"dropdown",title:"Align",options:{left:"Align Left",justify:"None",right:"Align Right"},html:function(){var t='<ul class="fr-dropdown-list">',i=e.FE.COMMANDS.videoAlign.options;for(var n in i)i.hasOwnProperty(n)&&(t+='<li><a class="fr-command fr-title" data-cmd="videoAlign" data-param1="'+n+'" title="'+this.language.translate(i[n])+'">'+this.icon.create("align-"+n)+"</a></li>");return t+="</ul>"},callback:function(e,t){this.video.align(t)},refresh:function(e){this.video.refreshAlign(e)},refreshOnShow:function(e,t){this.video.refreshAlignOnShow(e,t)}}),e.FE.DefineIcon("videoRemove",{NAME:"trash"}),e.FE.RegisterCommand("videoRemove",{title:"Remove",callback:function(){this.video.remove()}}),e.FE.DefineIcon("videoSize",{NAME:"arrows-alt"}),e.FE.RegisterCommand("videoSize",{undo:!1,focus:!1,title:"Change Size",callback:function(){this.video.showSizePopup()}}),e.FE.DefineIcon("videoBack",{NAME:"arrow-left"}),e.FE.RegisterCommand("videoBack",{title:"Back",undo:!1,focus:!1,back:!0,callback:function(){this.video.back()},refresh:function(e){var t=this.video.get();t||this.opts.toolbarInline?(e.removeClass("fr-hidden"),e.next(".fr-separator").removeClass("fr-hidden")):(e.addClass("fr-hidden"),e.next(".fr-separator").addClass("fr-hidden"))}}),e.FE.RegisterCommand("videoSetSize",{undo:!0,focus:!1,callback:function(){this.video.setSize()}})}),function(e){"function"==typeof define&&define.amd?define(["jquery"],e):"object"==typeof module&&module.exports?module.exports=function(t,i){return void 0===i&&(i="undefined"!=typeof window?require("jquery"):require("jquery")(t)),e(i),i}:e(jQuery)}(function(e){"use strict";e.extend(e.FroalaEditor.POPUP_TEMPLATES,{"codeInsert.popup":"[_CUSTOM_LAYER_]"}),e.FE.PLUGINS.codeInsert=function(t){function i(){n(),l()}function n(){if(!e(".code_popup").get(0)){var i='<form id="InsertCodeForm" class="insert_code" data-overlay-event=false ><label for="insert_text_area" class="text_area_label font-small">Enter code snippet and select language</label><div class="insert_code_dropdown pull-right mb5"><div class="vertical-alignment font-small m6">Language : </div>'+r()+"</div>"+'<textarea id="insert_text_area" style="width: 99%; height: 250px;"></textarea>'+'<span class="code_note font-small">Note: Code highlighting will be applied on articles published on your portal.</span>'+"</form>"+'<div class="fr_modal_footer">'+'<a href="javascript:void(null);" class="btn hide pull-left" id="code_delete_btn" style="color: #000;"> Delete </a>'+'<div class="btns_box">'+'<a href="javascript:void(null);" class="btn" id="btn_modal_close"> Cancel </a>  '+'<input type="button" class="btn btn-primary" id="insert_code_btn" value="Save" />'+"</div>"+"</div>",n='<div class="code_popup fr-overlay" id="code_popup" style="display: none"></div><div class="fr-modal code_popup fr-insert-code" style="display: none"> <div class="fr-modal-wrapper"><div id="fr_modal_header " class="fr_modal_header fr-modal-title"> <div class="fr-modal-title-line"><h4> Code Snippet </h4><i id="fr_modal_close" class="fr_modal_close fr-modal-close"></i></div></div>'+i+"</div></div>";e("body").append(n)}e("#insert_code_btn").off().on("click",function(){if(h){var e=o(h);h.html(e)}else{var e=s();t.selection.restore(),t.html.insert(e),t.undo.saveStep()}l(),d()}),e("#btn_modal_close, #fr_modal_close").off().on("click",function(){d()}),e("#code_delete_btn").off().on("click",function(){t.selection.restore(),h.remove(),t.undo.saveStep(),d()})}function r(){var t='<select id="insertCode_selector" name="highlight-brush-type" data-minimum-results-for-search="100" class="select2 input-medium">';return e.each(u,function(e,i){t+='<option value="'+e+'">'+i+"</option>"}),t+="</select>"}function s(){var t=e("#insert_text_area").val(),i=t.split(/\r|\r\n|\n/),n=e("#insertCode_selector").val(),r="";i.length>10&&(r="code-large"),t=t.replace(/\t/g,"  ");var s=e("<div />");return s.append(e("<pre />").attr("rel","highlighter").attr("data-code-brush",n).attr("contenteditable",!1).addClass(r).text(t)).append(e("<p><br/></p>")),s.html()}function o(t){var i=e("#insert_text_area").val(),n=i.split(/\r|\r\n|\n/),r=e("#insertCode_selector").val(),s="";return n.length>10&&(s="code-large"),i=i.replace(/\t/g,"  "),t.attr("data-code-brush",r).removeClass("code-large").data("codeBrush",r).addClass(s).text(i),t.html()}function a(t){h=e(t.currentTarget);var i=e(t.currentTarget).html().replace(/<br>/g,"\n").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(new RegExp("&nbsp;","g")," ");e("#insert_text_area").val(i),e("#code_delete_btn").removeClass("hide"),c(),e("#insertCode_selector").val(h.data("codeBrush")).trigger("change.select2")}function l(){t.$el.find("pre").each(function(t,i){e(i).attr("contenteditable",!1)}),e(document).off(".editor").on("click.code_insert",".fr-view [rel='highlighter']",a)}function c(){t.selection.save(),e(".code_popup").show(),e(".code_popup #insert_text_area").focus(),e("body").css("overflow","hidden"),e("#insertCode_selector").val(e("#insertCode_selector option:first").val())}function d(){h="",e("#insert_text_area").val(""),e("#insertCode_selector").val("").trigger("change.select2"),e(".code_popup").hide(),e("body").css("overflow",""),e("#code_delete_btn").addClass("hide")}var u={html:"Html",css:"Css",js:"JavaScript",sass:"Sass",xml:"Xml",ruby:"Ruby",php:"PHP",java:"Java",csharp:"C#",cpp:"C++",objc:"Obj C",perl:"Perl",python:"Python",vbnet:"VB",sql:"SQL",text:"Generic Language"},h="";return{_init:i,showPopup:c}},e.FE.DefineIcon("codeInsert",{NAME:"code-snippet"}),e.FE.RegisterCommand("codeInsert",{title:"Code Insert",undo:!1,focus:!1,callback:function(){this.codeInsert.showPopup()},plugin:"codeInsert"})}),function(e){e.FroalaEditor.DEFAULTS=e.extend(e.FroalaEditor.DEFAULTS,{SANDBOX_BLACKLIST:["allow-pointer-lock","allow-popups","allow-modals","allow-top-navigation"]}),e.FroalaEditor.PLUGINS.commonEvents=function(t){function i(){t.events.on("keydown",function(i){var n=i.which;t.fullscreen.isActive()&&n==e.FE.KEYCODE.ESC&&(i.preventDefault(),t.fullscreen.toggle(),e(t.opts.toolbarContainer).removeClass("fr-fullscreen"))}),t.$oel.on("froalaEditor.commands.after",function(t,i,r){if("fullscreen"==r)e(i.opts.toolbarContainer).toggleClass("fr-fullscreen");else if("html"==r&&!i.$oel.froalaEditor("codeView.isActive")&&e(".fr-element").get(0)){var s=i.opts.SANDBOX_BLACKLIST,o=e(".fr-element").find("iframe");n(o,s)}});var i=t.$oel.get(0).form;e(i).on("submit",function(){var t=jQuery(this).find("#solution_article_description"),i=e("<div />").append(t.val()),r=i.find("iframe"),s=t.data("froala.editor").opts.SANDBOX_BLACKLIST;n(r,s),jQuery(this).find("#solution_article_description").val(i.html())})}function n(t,i){t.each(function(){var t=e(this).attr("sandbox")?e(this).attr("sandbox").split(" "):["allow-scripts","allow-forms","allow-same-origin","allow-presentation"],n=t.filter(function(e){return i.indexOf(e)<0});e(this).attr("sandbox",n.join(" "))})}return{_init:i}}}(jQuery),function(e){"function"==typeof define&&define.amd?define(["jquery"],e):"object"==typeof module&&module.exports?module.exports=function(t,i){return void 0===i&&(i="undefined"!=typeof window?require("jquery"):require("jquery")(t)),e(i),i}:e(jQuery)}(function(e){"use strict";jQuery.FroalaEditor.DEFAULTS=jQuery.extend(jQuery.FroalaEditor.DEFAULTS,{formatePasteContent:!0}),e.FroalaEditor.PLUGINS.pasteHandler=function(e){function t(e){return Sanitizer.cleanMicrosoftContent(e)}function i(e,t){return Normalize.normalizeContent(e,t)}function n(){e.$oel.on("froalaEditor.paste.beforeCleanup",function(e,n,r){return n.opts.formatePasteContent&&"string"==typeof r&&(r=t(r),r=i(n,r)),r}),e.$oel.on("froalaEditor.paste.afterCleanup",function(e,t,i){return"string"==typeof i&&(i=i.replace(/\>\s+\</g,"><"),i=i.replace(/<div(.*?)><p(.*?)>((?:[\w\W]*?))<\/p><\/div>/g,"<p $1>$3</p>")),i})}return{_init:n}}}),function(e){"function"==typeof define&&define.amd?define(["jquery"],e):"object"==typeof module&&module.exports?module.exports=function(t,i){return void 0===i&&(i="undefined"!=typeof window?require("jquery"):require("jquery")(t)),e(i),i}:e(jQuery)}(function(e){"use strict";e.FroalaEditor.PLUGINS.pasteToggler=function(t){function i(){var i=f("editor_paste_type");null==i&&p("editor_paste_type","defaultFormatting"),c(),t.$oel.on("froalaEditor.paste.before",function(e,t,i){""===v&&""===g&&(m=i,jQuery.browser.msie||jQuery.browser.msedge||(v=s(m)),r())}),t.$oel.on("froalaEditor.paste.beforeCleanup",function(e,t,i){"string"==typeof i&&(g=i)}),t.$oel.on("froalaEditor.paste.afterCleanup",function(t,i,n){var r,s,o;if("string"!=typeof n||_)_=!1;else{var a=jQuery(window.getSelection().anchorNode).prop("tagName");if(e(i.selection.element()),jQuery.browser.msie||jQuery.browser.msedge?(s=b||(void 0==a||"SPAN"==a)&&"DIV"!=e(i.selection.element()).find('[rel="clipboard_data"]').prop("tagName"),o=!e(i.selection.element()).find('[rel="clipboard_data"]').get(0)&&!e(i.selection.element()).parents('[rel="clipboard_data"]').get(0)&&"clipboard_data"!=e(i.selection.element()).attr("rel")):jQuery.browser.mozilla?(r=/text\/html/.test(v),s=r&&(void 0==a||"SPAN"==e(i.selection.element()).prop("tagName")||"SPAN"==jQuery(i.selection.element()).find('[rel="clipboard_data"]').prop("tagName"))&&" "!=window.getSelection().anchorNode.textContent&&"DIV"!=e(i.selection.element()).prop("tagName"),o=r&&!e(i.selection.element()).find('[rel="clipboard_data"]').get(0)&&"clipboard_data"!=e(i.selection.element()).attr("rel")):jQuery.browser.safari?(r=/text\/rtf/.test(v),s=w?!1:void 0==a,o=w?!1:!e(i.selection.element()).find('[rel="clipboard_data"]').get(0)&&"clipboard_data"!=e(i.selection.element()).attr("rel")):(r=/text\/html/.test(v),s=r&&void 0==a&&" "!=window.getSelection().anchorNode.textContent&&"DIV"!=e(i.selection.element()).prop("tagName"),o=r&&!e(i.selection.element()).find('[rel="clipboard_data"]').get(0)&&"clipboard_data"!=e(i.selection.element()).attr("rel")),s){b=!0,n.replace(/<div(.*?)>([\w\W]*?)<\/div>/gi,"<span$1>$2</span>"),n.replace(/<p(.*?)>([\w\W]*?)<\/p>/gi,"<span$1>$2</span>");var l=e("<div />"),c=e("<span rel='clipboard_data'/>").append(n);return l.append(c),l.html()}if(o){w=!0;var l=e("<div />"),d=e("<div rel='clipboard_data'/>").append(n);return l.append(d),l.html()}}jQuery.browser.msie||jQuery.browser.msedge||jQuery.browser.safari||(y=!1)}),t.$oel.on("froalaEditor.paste.after",function(e,t){y&&u();var i=t.$el.find('div[rel="clipboard_data"]');!t.$el.children("p").get(0)&&i.get(0)&&i.after("<p><br /></p>")}),t.$oel.on("froalaEditor.commands.after",function(e,t,i){"originalFormatting"!=i&&"defaultFormatting"!=i&&"plainText"!=i&&l()}),t.events.on("keydown",function(e){l(e)}),t.events.on("click",function(){l()})}function n(t){var i=e("[rel='clipboard_data']").get(0);if(i&&e(".fr-fromat-btn").is(":visible")){if(document.createRange){var n=document.createRange();n.selectNode(i);var s=window.getSelection();s.removeAllRanges(),s.addRange(n)}p("editor_paste_type",t),r(t),d(t),y=!1}else _=!0,y=!1,g=o(),r("plainText");a()}function r(e){var e=e||f("editor_paste_type"),i=t.opts.pasteDeniedAttrs.indexOf("style");t.opts.pastePlain=!1,t.opts.formatePasteContent=!0,"defaultFormatting"==e?(-1==i&&t.opts.pasteDeniedAttrs.push("style"),t.opts.formatePasteContent=!1):"originalFormatting"==e?-1!=i&&t.opts.pasteDeniedAttrs.splice(2):(t.opts.pastePlain=!0,t.opts.formatePasteContent=!1)}function s(e){var i="";if(""!=m){var n=e.clipboardData.types;if(t.helpers.isArray(n))for(var r=0;r<n.length;r++)i+=n[r]+";";else i=n}return i}function o(){var e="";if(window.getSelection){var t=window.getSelection();if(t.rangeCount){for(var i=document.createElement("div"),n=0,r=t.rangeCount;r>n;++n)i.appendChild(t.getRangeAt(n).cloneContents());e=i.innerHTML}}else document.selection&&"Text"===document.selection.type&&(e=document.selection.createRange().htmlText);return e}function a(){var e=jQuery.Event("paste");e.clipboardData={dataHTML:g,type:"manual"},t.$el.trigger(e)}function l(i){var n=e("[rel='clipboard_data']");if(n.get(0)){n.length>1&&void 0!=i&&i.which==jQuery.FroalaEditor.KEYCODE.ENTER&&n.last().remove(),t.selection.save();var r=n.html();n.replaceWith(r),t.selection.restore()}m="",g="",v="",b=!1,w=!1,h(),y=!0}function c(){e("[data-cmd='plainText']").addClass("fr-paste-formatting"),e("[data-cmd='defaultFormatting']").addClass("fr-paste-formatting fr-fromat-btn"),e("[data-cmd='originalFormatting']").addClass("fr-paste-formatting fr-fromat-btn")}function d(t){var i=t||"defaultFormatting";e(".fr-paste-formatting").removeClass("active"),e("[data-cmd='"+i+"']").addClass("active")}function u(){d(f("editor_paste_type")),setTimeout(function(){e(".fr-fromat-btn").show(300),setTimeout(function(){e(".fr-paste-formatting").addClass("fr-flash")},500),setTimeout(function(){e(".fr-paste-formatting").removeClass("fr-flash")},1e3)},100)}function h(){e(".fr-fromat-btn").hide(200),e(".fr-paste-formatting").removeClass("active")}function p(e,t){localStorage.setItem(e,JSON.stringify(t))}function f(e){return JSON.parse(localStorage.getItem(e))}var m="",g="",v="",_=!1,y=!0,b=!1,w=!1;return{_init:i,pasteFormat:n}},e.FE.DefineIcon("plainText",{NAME:"plain-text"}),e.FE.RegisterCommand("plainText",{title:"Convert to Plain Text",callback:function(e){this.pasteToggler.pasteFormat(e)},plugin:"pasteToggler"}),e.FE.DefineIcon("defaultFormatting",{NAME:"default-format"}),e.FE.RegisterCommand("defaultFormatting",{title:"Convert to Default Formatting",callback:function(e){this.pasteToggler.pasteFormat(e)},plugin:"pasteToggler"}),e.FE.DefineIcon("originalFormatting",{NAME:"preserve-format"}),e.FE.RegisterCommand("originalFormatting",{title:"Preserve Original Formatting",callback:function(e){this.pasteToggler.pasteFormat(e)},plugin:"pasteToggler"})}),function(e){"use strict";e.FroalaEditor.DEFAULTS.key="Qg1Ti1LXd2URVJh1DWXG==",e.FroalaEditor.DefineIconTemplate("fd_design_icon",'<i class="ficon-[NAME]"></i>'),e.FroalaEditor.ICON_DEFAULT_TEMPLATE="fd_design_icon",e.FE.VIDEO_EMBED_REGEX=/<\/?([a-z][a-z0-9]*)\b[^>]*>/gi}(jQuery);